if (self.CavalryLogger) { CavalryLogger.start_js(["Zo6bY"]); }

__d("MessengerPlatformBubbleAspectRatio",[],(function(a,b,c,d,e,f){e.exports={IMAGE_ASPECT_RATIO_HORIZONTAL:1.91,IMAGE_ASPECT_RATIO_SQUARE:1}}),null);
__d("PageProductTransactionPaymentTypeDataKey",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ACCOUNT_NAME:"account_name",ACCOUNT_NO:"account_no"})}),null);
__d("XOmnipickerPhotoUploadController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/omnipicker/upload/file/photo/",{source:{type:"Enum",required:!0,enumType:0},waterfall_id:{type:"String"},vault_fbid:{type:"String"}})}),null);
__d("CommerceContactMerchantManualPaymentSection.react",["cx","fbt","FBPaymentsStringHelper","FileInput.react","FileInputUploader","Image.react","PageProductTransactionPaymentTypeDataKey","React","ReactDOM","XOmnipickerPhotoUploadController","XUIButton.react","XUIGrayText.react","XUISpinner.react","XUIText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;var j=29,k=120;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(a){__p&&__p();i.constructor.call(this,a),this.$6=function(event,a){a=a.response.getPayload()[0];this.setState({photoUploading:!1,receiptPhotoID:a.fbid,receiptPhotoURL:a.src});this.props.onReceiptUpdated(a.fbid,a.src)}.bind(this),this.$2=function(a){a=b("XOmnipickerPhotoUploadController").getURIBuilder().setEnum("source",j).getURI();var c=this.refs.fileInput;a=new(b("FileInputUploader"))(b("ReactDOM").findDOMNode(c)).setURI(a);a.subscribe("failure",this.$5);a.subscribe("success",this.$6);a.send();c.getFileInput().clear();this.setState({photoUploading:!0})}.bind(this),this.state={receiptPhotoID:null,receiptPhotoURL:null,photoUploading:!1}}a.prototype.render=function(){var a=this.props.paymentOptionDetails,c=a[b("PageProductTransactionPaymentTypeDataKey").ACCOUNT_NAME],d=a[b("PageProductTransactionPaymentTypeDataKey").ACCOUNT_NO];a=b("FBPaymentsStringHelper").stringToMarkup(a.description);d=d==null?null:b("React").createElement(b("XUIGrayText.react"),{display:"block",shade:"dark",size:"meta1",className:"_3-8m"},h._("Account Number"),": ",d);c=c==null?null:b("React").createElement(b("XUIGrayText.react"),{display:"block",shade:"dark",size:"meta1",className:"_3-8m"},h._("Name on Account"),": ",c);return b("React").createElement("div",{className:"_2ph-"},b("React").createElement(b("XUIGrayText.react"),{display:"block",shade:"light",size:"meta1"},this.$1()),b("React").createElement(b("XUIText.react"),{display:"block",weight:"bold",size:"meta1",className:"_3-8m"},this.props.paymentOptionDetails.name),d,c,b("React").createElement(b("XUIGrayText.react"),{display:"block",shade:"dark",size:"meta1",className:"_3-8m"},a),b("React").createElement(b("XUIGrayText.react"),{className:"_3-97",display:"block",size:"meta1"},h._("Order #{order_number}",[h._param("order_number",this.props.invoiceID)])),b("React").createElement("div",null,b("React").createElement(b("XUISpinner.react"),{className:"_3-9c"+(this.state.photoUploading?"":" hidden_elem")}),b("React").createElement("div",{className:(this.state.photoUploading?"hidden_elem":"")+" _3-96"},b("React").createElement(b("FileInput.react"),{name:"file",multiple:!1,ref:"fileInput",accept:"image/*",onChange:this.$2},b("React").createElement(b("XUIButton.react"),{href:{url:"#"},label:this.$3()})))),this.$4())};a.prototype.$4=function(){return!this.state.receiptPhotoURL?null:b("React").createElement(b("Image.react"),{src:this.state.receiptPhotoURL,height:k,width:k})};a.prototype.$3=function(){return this.state.receiptPhotoID?h._("Attach Different Receipt"):h._("Attach Receipt")};a.prototype.$1=function(){return h._("Payment instructions from seller")};a.prototype.$5=function(a){};a.propTypes={paymentOptionDetails:c.object.isRequired,invoiceID:c.string.isRequired,onReceiptUpdated:c.func.isRequired};e.exports=a}),null);
__d("MercuryAttachmentConstants",[],(function(a,b,c,d,e,f){a=Object.freeze({SIDE_LENGTH:9});e.exports=a}),null);
__d("FBAccordion.react",["cx","invariant","React","joinClasses"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(a){var c=0,d=this.state?this.state.expandedSectionKey:null,e=null;b("React").Children.forEach(a.children,function(a,b){a=a.props.expanded;e=d===b?d:e;a&&d===null?(c===0||h(0),c++,e=b):e===null&&(e=b)});return e}.bind(this),this.$2=function(a){this.state.expandedSectionKey!==a&&this.setState({expandedSectionKey:a})}.bind(this),this.state={expandedSectionKey:this.$1(this.props)},c}a.prototype.UNSAFE_componentWillReceiveProps=function(a){"use strict";a=this.$1(a);this.state.expandedSectionKey!==a&&this.setState({expandedSectionKey:a})};a.prototype.render=function(){"use strict";var a=b("React").Children.map(this.props.children,function(a,c){return b("React").cloneElement(a,{isExpanded:this.state.expandedSectionKey===c,onSectionClick:this.$2,sectionKey:c})}.bind(this));return b("React").createElement("div",babelHelpers["extends"]({},this.props,{className:b("joinClasses")(this.props.className,"_5ygd")}),a)};e.exports=a}),null);
__d("FBAccordionSection.react",["cx","React","ShimButton.react","emptyFunction"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.onClick=function(){this.props.onSectionClick(this.props.sectionKey),this.props.onClick(this.props.sectionKey)}.bind(this),b}a.prototype.render=function(){"use strict";var a=this.props.maxHeight||"100%";return b("React").createElement("div",{className:"_4r-a"+(this.props.isExpanded?" _3uxn":"")},b("React").createElement(b("ShimButton.react"),{className:"_5yg8",onClick:this.onClick},this.props.header),b("React").createElement("div",{className:"_1flr",style:{maxHeight:this.props.isExpanded?a:0}},this.props.children))};a.propTypes={expanded:c.bool,header:c.node.isRequired,maxHeight:c.number,onClick:c.func};a.defaultProps={expanded:!1,onClick:b("emptyFunction")};e.exports=a}),null);
__d("FBButtonMenuCombo.react",["invariant","FBActionSelector.react","React","Tooltip","XUIButton.react","XUIButtonGroup.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("FBActionSelector.react").Option;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=function(){__p&&__p();var a=[],c=[];b("React").Children.forEach(this.props.children,function(d,e){d.type.__FBButtonMenuComboItem__||g(0);if(e<this.props.numberOfButtons){e=this.props.useImageOnlyButtons?null:d.props.label;a.push(b("React").createElement(b("XUIButton.react"),babelHelpers["extends"]({},b("Tooltip").propsFor(d.props.tooltip),{"data-testid":d.props["data-testid"],"data-tooltip-alignh":this.props.tooltipAlignH,"data-tooltip-position":this.props.tooltipPosition,disabled:this.props.disabled||d.props.disabled,image:d.props.image,key:d.props.value,label:e,onClick:function(){return this.props.onClick(d.props.value)}.bind(this),size:this.props.size})))}else c.push(b("React").createElement(i,babelHelpers["extends"]({},b("Tooltip").propsFor(d.props.tooltip),{"data-tooltip-alignh":this.props.tooltipAlignH,"data-tooltip-position":this.props.tooltipPosition,disabled:this.props.disabled||d.props.disabled,key:d.props.value,value:d.props.value}),d.props.label))}.bind(this));return{buttons:a,menuItems:c}}.bind(this),c}a.prototype.render=function(){var a=this.$1(),c=a.buttons;a=a.menuItems;var d=null;a.length>0&&(d=b("React").createElement(b("FBActionSelector.react"),{alignment:"right",disabled:this.props.disabled,onAction:this.props.onClick,size:this.props.size},a));return b("React").createElement(b("XUIButtonGroup.react"),{className:"uiContextualLayerParent"},c,d)};a.__FBButtonMenuCombo__=!0;a.propTypes={disabled:c.bool,numberOfButtons:c.number,onClick:c.func.isRequired,size:c.oneOf(["small","medium","large","xlarge","xxlarge"]),tooltipPosition:c.oneOf(["above","below","left","right"]),tooltipAlignH:c.oneOf(["left","right","center"]),useImageOnlyButtons:c.bool};a.defaultProps={numberOfButtons:1,size:"medium"};a.Item=(d=f=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("React").PureComponent);a&&a.prototype;c.prototype.render=function(){"use strict";return null};function c(){"use strict";a.apply(this,arguments)}return c}(),f.__FBButtonMenuComboItem__=!0,f.propTypes={disabled:c.bool,image:c.element,label:c.string.isRequired,tooltip:c.string,value:c.string.isRequired},d);e.exports=a}),null);
__d("FBPaymentsPaymentMethodShape_DEPRECATED",["FBPaymentsMethodType","React"],(function(a,b,c,d,e,f){"use strict";a=b("React").PropTypes;c=a.shape({title:a.string,type:a.oneOf(Object.values(b("FBPaymentsMethodType"))).isRequired});e.exports=c}),null);
__d("FBPaymentsChoosePaymentMethodForm_DEPRECATED.react",["cx","fbt","FBAccordion.react","FBAccordionSection.react","FBPaymentsBankSelector_DEPRECATED.react","FBPaymentsCreditCardForm_DEPRECATED.react","FBPaymentsMethodType","FBPaymentsPaymentMethodShape_DEPRECATED","Link.react","P2PCreditCardDetails.react","P2PLinkConstants","P2PText.react","React","XUIRadioList.react","emptyFunction","setImmediate"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("XUIRadioList.react").Item;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(a){__p&&__p();i.constructor.call(this,a),this.handleBankSelected=function(a){this.props.onPaymentMethodConfigured({bank:a,isValid:!!a,type:b("FBPaymentsMethodType").NET_BANKING})}.bind(this),this.handleCreditCardFormValidation=function(a,c){this.props.onPaymentMethodConfigured({isValid:a,formData:c,type:b("FBPaymentsMethodType").NEW_CREDIT_CARD})}.bind(this),this.renderPaymentMethodItem=function(a,c){__p&&__p();var d=null,e=null;switch(a.type){case b("FBPaymentsMethodType").GENERIC_CARD:d=b("React").createElement(b("P2PCreditCardDetails.react"),{creditCard:a.creditCard});break;case b("FBPaymentsMethodType").NEW_CREDIT_CARD:d=h._("Credit or Debit Card");e=this.renderCreditCardFormSection(c);break;case b("FBPaymentsMethodType").NET_BANKING:d=h._("Online Banking");e=this.renderBankSelectorSection(a);break;case b("FBPaymentsMethodType").PAY_OVER_COUNTER:d=h._("Payment at Store Counter");break;case b("FBPaymentsMethodType").MANUAL_TRANSFER:d=a.title;break;default:d=a.title?a.title:a.type;e=b("React").createElement(b("P2PText.react"),{type:"primary"},"Expanded content for ",d);break}e=e?b("React").createElement("div",{className:"_51c-"},e):null;a=b("React").createElement(j,{className:"_51c_",selectedValue:this.state.selectedKey,value:c},b("React").createElement(b("P2PText.react"),{type:"primary"},d));return b("React").createElement(b("FBAccordionSection.react"),{header:a,key:c,onClick:this.onSectionClick.bind(this)},e)}.bind(this),this.state={selectedKey:0}}a.prototype.UNSAFE_componentWillMount=function(){b("setImmediate")(function(){return this.onSectionClick(this.state.selectedKey)}.bind(this))};a.prototype.onSectionClick=function(a){__p&&__p();this.setState({selectedKey:a});a=this.props.paymentMethods[a];this.props.onPaymentMethodSelected(a);switch(a.type){case b("FBPaymentsMethodType").PAY_OVER_COUNTER:this.props.onPaymentMethodConfigured({isValid:!0,type:a.type});break;case b("FBPaymentsMethodType").MANUAL_TRANSFER:var c=a.manual_transfer_info&&a.manual_transfer_info.id;this.props.onPaymentMethodConfigured({isValid:!0,type:a.type,optionId:c});break;case b("FBPaymentsMethodType").GENERIC_CARD:this.props.onPaymentMethodConfigured({isValid:!0,creditCard:a.creditCard,type:a.type});break}};a.prototype.getSections=function(){return this.props.paymentMethods.map(this.renderPaymentMethodItem,this)};a.prototype.renderCreditCardFormSection=function(a){return a!==this.state.selectedKey?null:b("React").createElement("div",null,b("React").createElement(b("FBPaymentsCreditCardForm_DEPRECATED.react"),{onValidation:this.handleCreditCardFormValidation,saveErrors:this.props.saveErrors,showIcons:!1,showSecondaryIcons:!0,showZipCodeField:!1,useGutters:!0}),b("React").createElement(b("P2PText.react"),{className:"_3-8y",type:"secondary"},h._("Your payment info is stored securely. {Link with text that goes to learn more page}",[h._param("Link with text that goes to learn more page",b("React").createElement(b("Link.react"),{href:b("P2PLinkConstants").securePayInfoLearnMoreURI,target:"_blank"},h._("Learn More")))])))};a.prototype.renderBankSelectorSection=function(a){return b("React").createElement(b("FBPaymentsBankSelector_DEPRECATED.react"),{banks:a.banks,onBankSelected:this.handleBankSelected})};a.prototype.render=function(){return b("React").createElement("ul",{className:"_51d0"},b("React").createElement(b("FBAccordion.react"),null,this.getSections()))};a.propTypes={onPaymentMethodConfigured:c.func.isRequired,onPaymentMethodSelected:c.func.isRequired,paymentMethods:c.arrayOf(b("FBPaymentsPaymentMethodShape_DEPRECATED")).isRequired,saveErrors:c.object};a.defaultProps={onPaymentMethodConfigured:b("emptyFunction")};e.exports=a}),null);
__d("FBPaymentsLegalDisclaimer_DEPRECATED.react",["fbt","FBPaymentsLinkHelper","FBPaymentsMethodType","Link.react","P2PText.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(a){h.constructor.call(this,a)}a.prototype.getLegalDisclaimerText=function(){var a=b("FBPaymentsLinkHelper").getPayTermsAndPoliciesURI(this.props.paymentType),c=g._("By clicking Complete Purchase, you agree to Facebook's {=terms and policies}",[g._param("=terms and policies",b("React").createElement(b("Link.react"),{href:a,target:"_blank"},"terms and policies"))]),d=g._("By clicking Pay, you agree to Facebook's and 2C2P's {=terms and policies}",[g._param("=terms and policies",b("React").createElement(b("Link.react"),{href:a,target:"_blank"},"terms and policies"))]),e=g._("By clicking Log In and Pay, you agree to Facebook's and 2C2P's {=terms and policies}",[g._param("=terms and policies",b("React").createElement(b("Link.react"),{href:a,target:"_blank"},"terms and policies"))]);a=g._("By clicking Continue to Pay, you agree to Facebook's and 2C2P's {=terms and policies}",[g._param("=terms and policies",b("React").createElement(b("Link.react"),{href:a,target:"_blank"},"terms and policies"))]);switch(this.props.paymentMethodType){case b("FBPaymentsMethodType").GENERIC_CARD:return d;case b("FBPaymentsMethodType").NET_BANKING:return e;case b("FBPaymentsMethodType").PAY_OVER_COUNTER:return a;case b("FBPaymentsMethodType").MANUAL_TRANSFER:return c;default:return null}};a.prototype.render=function(){return b("React").createElement(b("P2PText.react"),{type:"secondary"},this.getLegalDisclaimerText())};a.propTypes={paymentMethodType:c.string.isRequired,paymentType:c.string.isRequired};a.defaultProps={paymentType:""};e.exports=a}),null);
__d("FBPaymentsCreditCardVerificationDialog_DEPRECATED.react",["cx","fbt","CreditCardFormParam","FBPaymentsCreditCardVerificationForm_DEPRECATED.react","P2PButton.react","P2PCreditCard","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PLoadingMask.react","P2PText.react","PaymentMethodUtils","React","emptyFunction"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={cscInput:null,isValid:!1},this.handleValidation=function(a,c){this.setState({cscInput:c[b("CreditCardFormParam").CSC],isValid:a})}.bind(this),this.handleConfirmClick=function(){this.props.onConfirm(this.state.cscInput)}.bind(this),this.getMaxCSCLength=function(){var a=this.props.creditCard.getCardType();return b("PaymentMethodUtils").getCardTypeFromCode(a).cscDigits}.bind(this),this.getMessage=function(){if(this.getMaxCSCLength()===3)return h._("Please re-enter your card's three-digit security code.");else return h._("Please re-enter your card's four-digit security code.")}.bind(this),this.renderFooter=function(){var a=h._("\u10d2\u10d0\u10e3\u10e5\u10db\u10d4\u10d1\u10d0");a=this.props.showCancelButton?b("React").createElement(b("P2PButton.react"),{label:a,onClick:this.props.onCancel,use:"default"}):null;return b("React").createElement(b("P2PDialogFooter.react"),{className:"_3-8-",leftContent:this.props.leftContent},a,b("React").createElement(b("P2PButton.react"),{disabled:!this.state.isValid,label:this.props.primaryButtonText,onClick:this.handleConfirmClick,use:"confirm"}))}.bind(this),c}a.prototype.render=function(){var a={};a[b("CreditCardFormParam").CARD_NUMBER]=this.props.creditCard.getCreditCardNumberMask();a[b("CreditCardFormParam").CARD_EXPIRATION]=this.props.creditCard.getExpFormattedShort();return b("React").createElement(b("P2PDialog.react"),{layerHideOnBlur:!1,repositionOnUpdate:!0,shown:!0},b("React").createElement(b("P2PDialogTitle.react"),null,h._("Enter Security Code")),b("React").createElement(b("P2PDialogBody.react"),null,b("React").createElement(b("FBPaymentsCreditCardVerificationForm_DEPRECATED.react"),{cscMaxLength:this.getMaxCSCLength(),onValidation:this.handleValidation,prefilledFormData:a}),b("React").createElement(b("P2PText.react"),{className:"_3-8y",type:"secondary"},this.getMessage())),this.renderFooter(),b("React").createElement(b("P2PLoadingMask.react"),{visible:this.props.loading}))};a.propTypes={creditCard:c.instanceOf(b("P2PCreditCard")).isRequired,leftContent:c.node,loading:c.bool,onCancel:c.func,onConfirm:c.func.isRequired,primaryButtonText:c.node,showCancelButton:c.bool};a.defaultProps={loading:!1,onCancel:b("emptyFunction"),onConfirm:b("emptyFunction"),primaryButtonText:h._("\u10d3\u10d0\u10d3\u10d0\u10e1\u10e2\u10e3\u10e0\u10d4\u10d1\u10d0"),showCancelButton:!0};e.exports=a}),null);
__d("BrowserExtensionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:BrowserExtensionsLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:BrowserExtensionsLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:BrowserExtensionsLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setAPIEndpoint=function(a){this.$1.api_endpoint=a;return this};a.prototype.setAppID=function(a){this.$1.appid=a;return this};a.prototype.setAppversion=function(a){this.$1.appversion=a;return this};a.prototype.setClientUserID=function(a){this.$1.client_userid=a;return this};a.prototype.setClienttime=function(a){this.$1.clienttime=a;return this};a.prototype.setCountry=function(a){this.$1.country=a;return this};a.prototype.setDeviceid=function(a){this.$1.deviceid=a;return this};a.prototype.setErrorCode=function(a){this.$1.error_code=a;return this};a.prototype.setErrorMessage=function(a){this.$1.error_message=a;return this};a.prototype.setExtraClientData=function(a){this.$1.extra_client_data=a;return this};a.prototype.setIsemployee=function(a){this.$1.isemployee=a;return this};a.prototype.setName=function(a){this.$1.name=a;return this};a.prototype.setSessionid=function(a){this.$1.sessionid=a;return this};a.prototype.setStartURL=function(a){this.$1.start_url=a;return this};a.prototype.setStringPageID=function(a){this.$1.string_page_id=a;return this};a.prototype.setThreadID=function(a){this.$1.thread_id=a;return this};a.prototype.setWebsiteURL=function(a){this.$1.website_url=a;return this};c={api_endpoint:!0,appid:!0,appversion:!0,client_userid:!0,clienttime:!0,country:!0,deviceid:!0,error_code:!0,error_message:!0,extra_client_data:!0,isemployee:!0,name:!0,sessionid:!0,start_url:!0,string_page_id:!0,thread_id:!0,website_url:!0};e.exports=a}),null);
__d("MNContentSubscriptionMessageUserEngagementTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:MNContentSubscriptionMessageUserEngagementLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:MNContentSubscriptionMessageUserEngagementLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:MNContentSubscriptionMessageUserEngagementLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setAppID=function(a){this.$1.appid=a;return this};a.prototype.setAppversion=function(a){this.$1.appversion=a;return this};a.prototype.setBroadcastUnitID=function(a){this.$1.broadcast_unit_id=a;return this};a.prototype.setClientUserID=function(a){this.$1.client_userid=a;return this};a.prototype.setClienttime=function(a){this.$1.clienttime=a;return this};a.prototype.setCommerceItemID=function(a){this.$1.commerce_item_id=a;return this};a.prototype.setCommerceMessageType=function(a){this.$1.commerce_message_type=a;return this};a.prototype.setCountry=function(a){this.$1.country=a;return this};a.prototype.setDeviceid=function(a){this.$1.deviceid=a;return this};a.prototype.setInterface=function(a){this.$1["interface"]=a;return this};a.prototype.setMessageID=function(a){this.$1.message_id=a;return this};a.prototype.setMessageTs=function(a){this.$1.message_ts=a;return this};a.prototype.setName=function(a){this.$1.name=a;return this};a.prototype.setPageID=function(a){this.$1.page_id=a;return this};c={appid:!0,appversion:!0,broadcast_unit_id:!0,client_userid:!0,clienttime:!0,commerce_item_id:!0,commerce_message_type:!0,country:!0,deviceid:!0,"interface":!0,message_id:!0,message_ts:!0,name:!0,page_id:!0};e.exports=a}),null);
__d("MNPlatformMessageUserEngagementTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:MNPlatformMessageUserEngagementLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:MNPlatformMessageUserEngagementLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:MNPlatformMessageUserEngagementLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setAppID=function(a){this.$1.appid=a;return this};a.prototype.setAppversion=function(a){this.$1.appversion=a;return this};a.prototype.setClientUserID=function(a){this.$1.client_userid=a;return this};a.prototype.setClienttime=function(a){this.$1.clienttime=a;return this};a.prototype.setCommerceItemID=function(a){this.$1.commerce_item_id=a;return this};a.prototype.setCommerceMessageType=function(a){this.$1.commerce_message_type=a;return this};a.prototype.setCountry=function(a){this.$1.country=a;return this};a.prototype.setDeviceid=function(a){this.$1.deviceid=a;return this};a.prototype.setInterface=function(a){this.$1["interface"]=a;return this};a.prototype.setMessageID=function(a){this.$1.message_id=a;return this};a.prototype.setMessageTs=function(a){this.$1.message_ts=a;return this};a.prototype.setName=function(a){this.$1.name=a;return this};a.prototype.setPageID=function(a){this.$1.page_id=a;return this};c={appid:!0,appversion:!0,client_userid:!0,clienttime:!0,commerce_item_id:!0,commerce_message_type:!0,country:!0,deviceid:!0,"interface":!0,message_id:!0,message_ts:!0,name:!0,page_id:!0};e.exports=a}),null);
__d("ChatImageArrowDirection",["keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({BOTH:null,LEFT:null,RIGHT:null});e.exports=a}),null);
__d("ChatImageWithArrow.react",["cx","ChatImageArrowDirection","CssBackgroundImage.react","Link.react","MercuryAttachmentConstants","React","XUISpinner.react","cssURL","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;var i=30,j=15;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$3=function(){return Math.max(this.props.width,j)}.bind(this),this.$6=function(){return Math.max(this.props.height,i)}.bind(this),this.$7=function(a,c,d,e){if(c===b("ChatImageArrowDirection").LEFT)return"translate("+d+"px, "+e+"px)rotate(45deg)";else return"translate("+(a-d)+"px, "+e+"px)rotate(45deg)"},this.$8=function(a,c,d,e){if(c===b("ChatImageArrowDirection").LEFT)return"rotate(-45deg)translate(-"+(this.$1+d)+"px,-"+e+"px)";else return"rotate(-45deg)translate(-"+(a-d)+"px, -"+e+"px)"}.bind(this),c}a.prototype.render=function(){this.$1=Math.floor(this.props.sideLength/Math.sqrt(2));this.$2=Math.ceil(this.$3()+this.$1);if(this.props.isLoading)return this.$4();var a=b("joinClasses")("_4yp6"+(this.props.round?" _3lk2":""),this.props.rootClassName);return this.$5(b("React").createElement("div",{className:a},b("React").createElement("div",{className:"_52kr"+(this.props.round?" _3_om":""),style:{width:this.$3(),height:this.$6()}},b("React").createElement(b("CssBackgroundImage.react"),{className:"_4yp9"+(this.props.isSpherical?" _3603":""),imageURI:this.props.source,backgroundPosition:"center",style:{width:this.$3(),height:this.$6(),borderRadius:"inherit"}},this.props.isSpherical?b("React").createElement("div",{className:"_64ks"}):null))))};a.prototype.$5=function(a){return this.props.onClick?b("React").createElement(b("Link.react"),{onClick:this.props.onClick},a):a};a.prototype.$4=function(){var a={width:this.props.sideLength,height:this.props.sideLength};this.props.source&&(a.backgroundImage=b("cssURL")(this.props.source));a={width:this.props.sideLength,height:this.props.sideLength};this.props.source&&(a.opacity=0);a={width:this.$3(),height:this.$6()};this.props.source&&(a.backgroundImage=b("cssURL")(this.props.source),a.backgroundSize="cover");return b("React").createElement("div",{className:"_4yp6"},b("React").createElement("div",{className:"_4ypb _3_om",style:a},b("React").createElement(b("XUISpinner.react"),{size:"small"})))};a.propTypes={arrowDirection:c.oneOf(Object.keys(b("ChatImageArrowDirection"))),onClick:c.func,height:c.number.isRequired,isLoading:c.bool,isSpherical:c.bool,round:c.bool,rootClassName:c.string,sideLength:c.number,source:c.string,width:c.number.isRequired};a.defaultProps={sideLength:b("MercuryAttachmentConstants").SIDE_LENGTH,isLoading:!1,isSpherical:!1,round:!1};e.exports=a}),null);
__d("ChatContentSearchContextualDialog.react",["cx","ContextualLayerAutoFlipHorizontal","LayerHideOnEscape","ReactAbstractContextualDialog","ReactLayer"],(function(a,b,c,d,e,f,g){"use strict";a=b("ReactLayer").createClass(b("ReactAbstractContextualDialog").createSpec({addedBehaviors:[b("ContextualLayerAutoFlipHorizontal"),b("LayerHideOnEscape")],displayName:"StickerXUIContextualDialog",theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:47,length:16}}}));e.exports=a}),null);
__d("ChatContentSearchButton.react",["cx","fbt","BootloadOnRender.react","ChatFlyoutPlaceholder.react","ChatContentSearchContextualDialog.react","JSResource","LazyComponent.react","Link.react","ReactComponentWithPureRenderMixin","React","MercuryShareAttachmentRenderLocations","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=b("React").PropTypes;var i=278;c=b("React").createClass({displayName:"ChatContentSearchButton",_clickGuard:!1,mixins:[b("ReactComponentWithPureRenderMixin")],propTypes:{clicked:a.bool,ContextualDialogClass:a.func,flyoutAlignment:a.oneOf(["left","right"]),getQuery:a.func.isRequired,location:a.oneOf(b("MercuryShareAttachmentRenderLocations").getValues()),onLoad:a.func,onSelect:a.func.isRequired},getDefaultProps:function(){return{flyoutAlignment:"left",location:b("MercuryShareAttachmentRenderLocations").CHAT}},getInitialState:function(){return{query:"",shown:!!this.props.clicked}},componentDidMount:function(){this.props.onLoad&&this.props.onLoad(this)},updateQuery:function(){this.setState({query:this.props.getQuery()})},hideFlyout:function(){this.setState(this.getInitialState())},render:function(){return b("React").createElement("span",null,b("React").createElement(b("Link.react"),{className:b("joinClasses")(this.props.className,this.state.shown?"open":""),href:"#",onMouseDown:this._handleMouseDown,onClick:this._handleClick,role:"button",title:h._("\u10d0\u10d8\u10e0\u10e9\u10d8\u10d4\u10d7 \u10db\u10dd\u10eb\u10e0\u10d0\u10d5\u10d8 \u10e4\u10dd\u10e2\u10dd"),ref:"link"}),this.renderLayers())},renderLayers:function(){if(!this.state.shown)return null;var a=this.props.ContextualDialogClass||b("ChatContentSearchContextualDialog.react");return b("React").createElement(a,{alignment:this.props.flyoutAlignment,contextRef:function(){return this.refs.link}.bind(this),onBlur:this.hideFlyout,onToggle:this._handleContextualDialogToggle,shown:this.state.shown,width:i,key:"contextualDialog"},b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{location:this.props.location,onEscKeyDown:this.hideFlyout,onSelect:this._handleSelect,query:this.state.query}),loader:b("JSResource")("ChatContentSearchFlyout.react").__setRef("ChatContentSearchButton.react"),placeholder:b("React").createElement(b("ChatFlyoutPlaceholder.react"),null)}))},_handleMouseDown:function(a){this._clickGuard=this.state.shown},_handleClick:function(a){a.stopPropagation();if(this.state.shown||this._clickGuard)return;this.setState({query:this.props.getQuery(),shown:!this.state.shown})},_handleSelect:function(a,b){this.props.onSelect(a,b),this.hideFlyout()},_handleContextualDialogToggle:function(a){this.setState({shown:a})}});e.exports=c}),null);
__d("MNCommerceOrderConfigActions",["MessengerDispatcher","MNCommerceActionTypes"],(function(a,b,c,d,e,f){"use strict";a={itemLoaded:function(a){b("MessengerDispatcher").dispatch({type:b("MNCommerceActionTypes").RETAIL_ITEM.LOADED,item:a})},itemLoadError:function(a){b("MessengerDispatcher").dispatch({type:b("MNCommerceActionTypes").RETAIL_ITEM.LOAD_ERROR,itemID:a})},itemReload:function(a){b("MessengerDispatcher").dispatch({type:b("MNCommerceActionTypes").RETAIL_ITEM.RELOAD,itemID:a})}};e.exports=a}),null);
__d("MessengerAttachmentImageBlockUtils",["isFacebookURI","isLinkshimURI"],(function(a,b,c,d,e,f){"use strict";function g(a){return a.getPath().indexOf("/moments_app")===0}function h(a,b){return a<=300&&b<=300}function a(a,c,d){return h(a,c)?!0:b("isFacebookURI")(d)&&!b("isLinkshimURI")(d)&&!g(d)}e.exports={isIcon:a}}),null);
__d("MessengerAttachmentImageBlock.react",["cx","React","StoryAttachmentStyle","URI","cssURL","gkx","joinClasses","MessengerAttachmentImageBlockUtils"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:b("joinClasses")(this.props.className,this.$1())},this.$2(),b("React").createElement("div",{className:"_5swm"},this.props.children))};a.prototype.$2=function(){__p&&__p();if(!this.props.attachment.media||!this.props.attachment.media.image)return null;var a=this.$3(),c=a.height;a=a.width;var d=c>a,e=new(b("URI"))(this.props.attachment.uri);e=b("MessengerAttachmentImageBlockUtils").isIcon(c,a,e);c=c&&a?c/a*100:100;a=d||e?.2:1;e=d||e?c:52;d={backgroundImage:b("cssURL")(this.props.attachment.media.image),minHeight:"0px",paddingBottom:d&&c>150?"136px":e*a+"%"};this.props.attachment.description&&this.props.attachment.source&&(d.minHeight="112px");return b("React").createElement("div",{className:"_3xn1",style:d})};a.prototype.$1=function(){if(!this.props.attachment.media||!this.props.attachment.media.image)return"_3xn3 _5swn";var a=this.$3(),c=a.height;a=a.width;var d=c>a,e=new(b("URI"))(this.props.attachment.uri);e=b("MessengerAttachmentImageBlockUtils").isIcon(c,a,e);return"_3xn3"+(e&&!d?" _3xn5":"")+(d?" _3xn6":"")+(a>=c&&!e?" _3xn7":"")+(b("gkx")("AT5jVqghs9R-Nalfuant-OpQGexKpV-Lvk0zsjcgyNeCAPkQFy-F7Ku4x6WSSnQxEXUiMEmPIqbnxuBACYn4sSsR")&&this.$4()?" _2e9e":"")};a.prototype.$4=function(){var a=this.props.attachment.style_list;return Array.isArray(a)&&a[0]==b("StoryAttachmentStyle").LIGHTWEIGHT_ACTION};a.prototype.$5=function(){var a=this.props.attachment.properties;return!a||!a.height||!a.width?null:{height:a.height,width:a.width}};a.prototype.$3=function(){var a=this.$5()||this.props.attachment.media.image_size||{},b=a.height;a=a.width;if(b&&a){b=parseInt(b,10);a=parseInt(a,10);return{height:b,width:a}}return{height:0,width:0}};function a(){h.apply(this,arguments)}a.propTypes={attachment:c.object.isRequired};e.exports=a}),null);
__d("MessengerGamesPlayGameLink.react",["ix","cx","BootloadOnRender.react","FbtResultBase","InstantGameContextType","JSResource","LazyComponent.react","Link.react","MercuryIDs","QuicksilverSources","React","asset","emptyFunction"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={playerOpen:!1},this.$1=function(event){this.props.onClick&&this.props.onClick(event),this.$3()}.bind(this),this.$2=function(){this.setState({playerOpen:!1})}.bind(this),b}a.prototype.componentDidMount=function(){this.props.onResize()};a.prototype.render=function(){var a=b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID),c=this.props.contextType,d=this.props.contextSourceID;c||(c=b("InstantGameContextType").THREAD,d=a);return b("React").createElement("div",null,b("React").createElement(b("Link.react"),{className:this.props.className,onClick:this.$1},this.props.showGameImage?b("React").createElement("div",{className:"_46b2"},b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("Image.react").__setRef("MessengerGamesPlayGameLink.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{className:"_68df",src:g("529301")})})):null,this.props.title),this.state.playerOpen?b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("MessengerGamesQuicksilverPlayerContainer.react").__setRef("MessengerGamesPlayGameLink.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{initialContextType:c,initialContextSourceID:d,initialEntryPointData:this.props.payload,initialGameID:this.props.gameID,onHide:this.$2,initialSource:this.props.source||b("QuicksilverSources").UNKNOWN,sourceID:a})}):null)};a.prototype.$3=function(){this.setState({playerOpen:!0})};a.defaultProps={showGameImage:!1,onResize:b("emptyFunction")};e.exports=a}),null);
__d("MNCommerceBubbleImage.react",["cx","React","cssURL","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:b("joinClasses")("_4y9n"+(this.props.isSquare?" _2j_n":"")+(this.props.isSquare?"":" _2j_r"),this.props.className),style:{backgroundImage:b("cssURL")(this.props.source)}})};function a(){h.apply(this,arguments)}a.propTypes={location:c.string,source:c.string.isRequired,width:c.number,isSquare:c.bool};e.exports=a}),null);
__d("MNCommerceAgentItemSuggestionMercuryAttachment.react",["ix","cx","fbt","Image.react","LeftRight.react","Link.react","LineClamp.react","MercuryShareAttachmentRenderLocations","MNCommerceAgenItemSuggestionReactShape","MNCommerceBubbleImage.react","React","ShimButton.react"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=b("React").PropTypes;var k=3;d=babelHelpers.inherits(a,b("React").PureComponent);j=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=j.constructor).call.apply(a,[this].concat(d)),this.$2=function(a){a.preventDefault(),this.props.onBuyClick&&this.props.onBuyClick()}.bind(this),b}a.prototype.render=function(){var a=this.props.itemSuggestion,c=a.thumb_url?b("React").createElement("div",{className:"_522n"},b("React").createElement(b("MNCommerceBubbleImage.react"),{location:this.props.location,source:a.thumb_url,width:this.props.width})):null,d=null;a.desc&&(d=b("React").createElement(b("LineClamp.react"),{lines:k},a.desc));var e={};this.props.location===b("MercuryShareAttachmentRenderLocations").CHAT&&this.props.width&&(e.width=this.props.width);e=b("React").createElement("div",{className:a.target_url?"":"_522-",style:e},c,b("React").createElement("div",{className:"_522o"},b("React").createElement("div",{className:"_522p"},a.name),d,b("React").createElement("div",{className:"_522q"},a.merchant_name)),this.$1());return a.target_url?b("React").createElement(b("Link.react"),{className:"_522-",target:"_blank",href:{url:a.target_url,shimhash:a.shimhash}},e):e};a.prototype.$1=function(){var a=this.props.itemSuggestion.total_cost;if(!a||a.amount<=0)return null;a=void 0;!this.props.isPurchased?a=b("React").createElement(b("ShimButton.react"),{className:"_522s",onClick:this.$2},i._("Get")):a=b("React").createElement("div",{className:"_1x98"},b("React").createElement(b("Image.react"),{className:"_1x99",src:g("86977")}),i._("\u10e4\u10d0\u10e1\u10d8\u10d0\u10dc\u10d8"));return b("React").createElement(b("LeftRight.react"),{className:"_522r"},i._("Total: {total cost}",[i._param("total cost",this.props.itemSuggestion.display_total_cost)]),a)};a.propTypes={isPurchased:c.bool,itemSuggestion:b("MNCommerceAgenItemSuggestionReactShape").isRequired,location:c.oneOf(b("MercuryShareAttachmentRenderLocations").getValues()),onBuyClick:c.func,width:c.number};e.exports=a}),null);
__d("MercuryFallbackShareAttachmentTextBlock.react",["cx","LineClamp.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){if(!this.props||!this.props.attachment)return b("React").createElement("div",{className:"__6j"});return b("MercuryShareAttachmentRenderLocations").MESSENGER===this.props.location?b("React").createElement("div",{className:"__6j"},this.renderMessengerTitle(),this.renderMessengerDescription(),this.renderMessengerSource()):b("React").createElement("div",{className:"__6j"},this.renderTitle(),this.renderDescription(),this.renderSource(),this.props.extraComponent)};a.prototype.renderMessengerTitle=function(){return!this.props.attachment.title?null:b("React").createElement("div",{className:"__6k"},b("React").createElement(b("LineClamp.react"),{customEllipsis:" ",lines:2,lineHeight:18},this.props.attachment.title))};a.prototype.renderMessengerDescription=function(){return!this.props.attachment.description?null:b("React").createElement("div",{className:"__6l"},b("React").createElement(b("LineClamp.react"),{customEllipsis:" ",lines:2,lineHeight:16},this.props.attachment.description))};a.prototype.renderMessengerSource=function(){return!this.props.attachment.source?null:b("React").createElement("div",{className:"__6m"},this.props.attachment.source)};a.prototype.renderTitle=function(){return!this.props.attachment.title?null:b("React").createElement("div",{className:"__6k"+(!this.props.attachment.uri&&!this.props.attachment.description||this.props.attachment.target!=null&&this.props.attachment.target.lwa_type!=null&&this.props.attachment.target.lwa_state==="INITIATED"?" _2xsq":"")+(this.props.extraComponent?" _1dw9":"")},this.props.attachment.title)};a.prototype.renderDescription=function(){return!this.props.attachment.description?null:b("React").createElement("div",{className:"__6l"},this.props.attachment.description)};a.prototype.renderSource=function(){return!this.props.attachment.source?null:b("React").createElement("div",{className:"__6m"},this.props.attachment.source)};function a(){h.apply(this,arguments)}a.propTypes={attachment:b("MercuryShareAttachmentReactShape"),extraComponent:c.object,location:c.oneOf(b("MercuryShareAttachmentRenderLocations").getValues())};e.exports=a}),null);
__d("MercuryShareImage.react",["cx","ChatImageArrowDirection","ChatImageWithArrow.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_4hsl"},b("React").createElement(b("ChatImageWithArrow.react"),{arrowDirection:b("ChatImageArrowDirection").BOTH,height:this.props.height,round:!!this.props.round,source:this.props.source,width:this.props.width}))};function a(){h.apply(this,arguments)}a.propTypes={height:c.number.isRequired,round:c.bool,source:c.string.isRequired,width:c.number.isRequired};e.exports=a}),null);
__d("MercuryFallbackShareAttachmentContent.react",["cx","Image.react","ImageBlock.react","MercuryFallbackShareAttachmentTextBlock.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","MercuryShareImage.react","MessengerAttachmentImageBlock.react","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;var i=72;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.renderTextBlock=function(){return b("React").createElement(b("MercuryFallbackShareAttachmentTextBlock.react"),this.props)};a.prototype.renderChatImage=function(a){return b("React").createElement(b("ImageBlock.react"),{className:a,spacing:"medium"},b("React").createElement(b("MercuryShareImage.react"),{height:i,source:this.props.attachment.media.image,width:i}),b("React").createElement("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column",height:i}},this.renderTextBlock()))};a.prototype.renderMessengerImage=function(a){return b("React").createElement(b("MessengerAttachmentImageBlock.react"),{className:a,attachment:this.props.attachment},this.renderTextBlock(),this.props.children)};a.prototype.renderDefaultImage=function(a){return b("React").createElement(b("ImageBlock.react"),{className:b("joinClasses")(this.props.className,a)},b("React").createElement(b("Image.react"),{className:"__6n",src:this.props.attachment.media.image,width:i}),this.renderTextBlock(),this.props.children)};a.prototype.getCSSClasses=function(){var a=this.props.attachment,c=this.props.location;return(b("MercuryShareAttachmentRenderLocations").CHAT===c?"_49or":"")+(b("MercuryShareAttachmentRenderLocations").CHAT_PREVIEW===c?" _324d":"")+(b("MercuryShareAttachmentRenderLocations").CHAT!==c?" _tih":"")+(a&&a.media.image?"":" _49ou")+" _310t"};a.prototype.render=function(){var a=this.props.attachment,c=this.props.location,d=this.getCSSClasses();if(a.media&&a.media.image){if(b("MercuryShareAttachmentRenderLocations").CHAT===c||b("MercuryShareAttachmentRenderLocations").CHAT_PREVIEW===c)return this.renderChatImage(d);else if(b("MercuryShareAttachmentRenderLocations").MESSENGER===c)return this.renderMessengerImage(d);return this.renderDefaultImage(d)}return b("React").createElement("div",{className:b("joinClasses")(this.props.className,d)},this.renderTextBlock(),this.props.children)};function a(){h.apply(this,arguments)}a.propType={attachment:b("MercuryShareAttachmentReactShape"),location:c.oneOf(b("MercuryShareAttachmentRenderLocations").getValues())};e.exports=a}),null);
__d("SaveMessageUtils",["immutable","MessengerDotComSaveModule","StoryAttachmentStyle","QE2Logger"],(function(a,b,c,d,e,f){__p&&__p();var g=b("immutable").Set.of(b("StoryAttachmentStyle").FALLBACK,b("StoryAttachmentStyle").SHARE,b("StoryAttachmentStyle").EVENT,b("StoryAttachmentStyle").ATTACHED_STORY,b("StoryAttachmentStyle").MUSIC_AGGREGATION,b("StoryAttachmentStyle").AVATAR),h=b("immutable").Set.of(b("StoryAttachmentStyle").GROUP_SELL_PRODUCT_ITEM);a={isSavableMessageAttachment:function(a){__p&&__p();var c=!0;for(var d=0;d<a.length;d++){if(a[d]==b("StoryAttachmentStyle").GROUP_SELL_PRODUCT_ITEM)if(b("MessengerDotComSaveModule").can_save_for_sale_item_attachment!=null){b("QE2Logger").logExposureForUser("marketplace_www_messenger_save");return b("MessengerDotComSaveModule").can_save_for_sale_item_attachment}else return!1;if(h.has(a[d]))return!0;g.has(a[d])||(c=!1)}return c}};e.exports=a}),null);
__d("XMessengerDotComSavedForLaterNuxSeenController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/save/savemessagenux/",{})}),null);
__d("MercuryFallbackShareAttachment.react",["cx","fbt","AsyncRequest","CollectionsDisplaySurface","CollectionCurationMechanisms","Link.react","MercuryFallbackShareAttachmentContent.react","MercuryShareAttachmentRenderLocations","MercuryShareAttachmentReactShape","MessengerAdsWebTypedLogger","MessengerDotComSaveModule","MNAdsLoggerEventEnum","React","ReactFragment","SaveMessageUtils","XMessengerDotComSavedForLaterNuxSeenController","XUIAmbientNUX.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;var j="focus",k="click",l="scroll",m=1e4,n=3e4;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){i.constructor.call(this),this.state={showNux:!1,nuxDisabled:!1}}a.prototype.renderLink=function(a){return b("MercuryShareAttachmentRenderLocations").isPreview(this.props.location)||!this.props.attachment.uri?a:b("React").createElement(b("Link.react"),{className:"_5rw4",href:this.props.attachment.uri,onClick:this.$1.bind(this),target:"_blank"},a,this.renderLayers())};a.prototype.render=function(){return this.renderLink(b("React").createElement(b("MercuryFallbackShareAttachmentContent.react"),babelHelpers["extends"]({ref:"mercury_fallback_share_attachment"},this.props)))};a.prototype.$1=function(event){__p&&__p();if(this.props.isSponsored){var a=this.props.attachment&&this.props.attachment.subattachments;if(!a)return;for(var a=a,c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;new(b("MessengerAdsWebTypedLogger"))().setEvent(b("MNAdsLoggerEventEnum").LINK_CLICK).setIsSponsored(this.props.isSponsored).setItemID(e&&e.id).setMessageID(this.props.messageID).setPageID(this.props.pageID).log()}}if(this.state.nuxDisabled||!this.$2())return;this.$3();this.interactionTime=0;this.cancelMinConsumeTimeout=setTimeout(function(){this.$4()||this.setState({showNux:!0,nuxDisabled:!0})}.bind(this),m);this.cancelMaxConsumeTimeout=setTimeout(function(){this.$4()||(this.setState({showNux:!1,nuxDisabled:!1}),this.clearTimeouts())}.bind(this),n);var f=Date.now();this.cancelWindowInteractionTimeout=setTimeout(function(){this.$5(function(){this.interactionTime||(this.interactionTime=Date.now()-f)}.bind(this))}.bind(this),0)};a.prototype.clearTimeouts=function(){this.cancelWindowInteractionTimeout&&(clearTimeout(this.cancelWindowInteractionTimeout),this.cancelWindowInteractionTimeout=null),this.cancelMaxConsumeTimeout&&(clearTimeout(this.cancelMaxConsumeTimeout),this.cancelMaxConsumeTimeout=null),this.cancelMinConsumeTimeout&&(clearTimeout(this.cancelMinConsumeTimeout),this.cancelMinConsumeTimeout=null)};a.prototype.onNUXCloseButtonClick=function(){this.setState({showNux:!1}),this.$6(),this.$7(),this.clearTimeouts()};a.prototype.renderLayers=function(){return this.$2()?b("ReactFragment").create(b("React").createElement(b("XUIAmbientNUX.react"),{contextRef:function(){return this.refs.mercury_fallback_share_attachment}.bind(this),shown:this.state.showNux,onCloseButtonClick:this.onNUXCloseButtonClick.bind(this),position:"below",width:"custom",customwidth:300},h._("You can now save links and videos to Facebook by right clicking on a message."))):null};a.prototype.$3=function(){this.$8||(this.$9=[],this.$8=[Event.listen(window,"click",this.$10.bind(this,k)),Event.listen(window,"focus",this.$10.bind(this,j)),Event.listen(window,"scroll",this.$10.bind(this,l))])};a.prototype.$10=function(a){this.$9.forEach(function(b){b.call(this,a)},this)};a.prototype.$5=function(a){this.$9.push(a)};a.prototype.$4=function(){return this.interactionTime&&this.interactionTime>0};a.prototype.$7=function(){if(this.$8){while(this.$8.length)this.$8.pop().remove();this.$8=null;this.$9=null}};a.prototype.$2=function(){return b("MessengerDotComSaveModule").eligible_for_nux&&this.$11()};a.prototype.$11=function(){var a=this.props.attachment;if(!a)return!1;a=a.style_list;return b("SaveMessageUtils").isSavableMessageAttachment(a)};a.prototype.$6=function(){new(b("AsyncRequest"))().setURI(b("XMessengerDotComSavedForLaterNuxSeenController").getURIBuilder().getURI()).setData({action:"impression",surface:b("CollectionsDisplaySurface").MESSENGER_DOT_COM_MESSAGE,mechanism:b("CollectionCurationMechanisms").SAVE_MESSAGE_NUX,object_id:this.props.message_id,collection_id:98}).send()};a.propTypes={attachment:b("MercuryShareAttachmentReactShape"),isSponsored:c.bool,location:c.oneOf(b("MercuryShareAttachmentRenderLocations").getValues()),messageID:c.string,pageID:c.string};e.exports=a}),null);
__d("P2PCreditCardForm.react",["CreditCardFormParam","FBPaymentsCreditCardForm_DEPRECATED.react","MessengerPaymentProductType","P2PAPIUtils","P2PAPI","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").Component);g=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.state={binError:"",isFormValid:!1,previousBINNumber:"",validateBINRequestID:""},this.handleValidation=function(a,c){var d=c[b("CreditCardFormParam").CARD_NUMBER];!this.props.editMode&&this.props.productType===b("MessengerPaymentProductType").P2P&&d&&this.validateBIN(d);this.setState({isFormValid:a});this.props.onValidation({isValid:a&&this.state.validateBINRequestID===""&&!this.state.binError,formData:c})}.bind(this),c}a.prototype.UNSAFE_componentWillReceiveProps=function(a){a=a.asyncRequestState;a=a?a[this.state.validateBINRequestID]:null;a&&(this.setState({validateBINRequestID:""}),a.error?this.handleValidateBINNumberError(a.error):this.handleValidateBINNumberSuccess())};a.prototype.handleValidateBINNumberSuccess=function(){this.props.onValidation({isValid:this.state.isFormValid}),this.setState({binError:""})};a.prototype.handleValidateBINNumberError=function(a){a=a.message;this.props.onValidation({isValid:!1});this.setState({binError:a})};a.prototype.validateBIN=function(a){var c=void 0,d=void 0;a=a.replace(/ /g,"");c=a.substr(0,6);c!==this.state.previousBINNumber&&c.length>=6?(d=b("P2PAPIUtils").genRequestID(),this.setState({validateBINRequestID:d}),this.props.onValidation({isValid:!1}),b("P2PAPI").validateBINNumber({binNumber:c,requestID:d})):c.length<6&&this.setState({binError:"",validateBINRequestID:""});this.setState({previousBINNumber:c})};a.prototype.render=function(){return b("React").createElement(b("FBPaymentsCreditCardForm_DEPRECATED.react"),babelHelpers["extends"]({},this.props,{autoTab:!0,allowCredit:this.props.productType===b("MessengerPaymentProductType").MESSENGER_COMMERCE,isBinErrorLoading:this.state.validateBINRequestID!=="",binError:this.state.binError,onValidation:this.handleValidation,postalRegex:this.props.postalRegex}))};a.defaultProps={asyncRequestState:{},productType:b("MessengerPaymentProductType").P2P};e.exports=a}),null);
__d("P2PAddCreditCardDialog.react",["cx","fbt","CreditCardFormParam","MessengerEnvironment","Link.react","MessengerPaymentProductType","Middot.react","P2PAPI","P2PAPIUtils","P2PPaymentConfig","P2PCreditCardStore","P2PCreditCardForm.react","P2PLoadingMask.react","P2PLogger","P2PPaymentLoggerEvent","P2PLinkConstants","React","P2PButton.react","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PText.react","emptyFunction"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j="fbP2PAddCreditCardDialog_learnMoreSentenceID";c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={isValid:!1,formData:{},loading:!1,requestID:"",saveErrors:null,asyncRequestState:{}},this.onCreditCardStoreChange=function(){var a=b("P2PCreditCardStore").getAsyncRequestState(),c=a[this.state.requestID];this.setState({asyncRequestState:a});c&&(this.setState({requestID:""}),c.error?this.handleOnSaveError(c.error):this.handleOnSaveSuccess(c))}.bind(this),this.onSaveClick=function(){__p&&__p();var a=this.props.p2pPaymentConfig;if(!a){this.setState({loading:!1,saveErrors:{general:{message:h._("Cannot identify country.")}}});return}var c=b("P2PAPIUtils").genRequestID();this.setState(function(d){return{loading:!0,requestID:c,saveErrors:null,formData:babelHelpers["extends"]({},d.formData,(d={},d[b("CreditCardFormParam").COUNTRY]=a.countryCode,d))}},function(){b("P2PAPI").addCreditCard(babelHelpers["extends"]({requestID:c,product_type:this.props.productType},this.state.formData))}.bind(this));this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_CARD_DETAILS)}.bind(this),this.handleValidation=function(a){this.setState(a)}.bind(this),this.onToggle=function(a){a||(this.props.onCancel(),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CANCEL_ADD_CARD))}.bind(this),this.onCancelClicked=function(){this.onToggle(!1)}.bind(this),c}a.prototype.componentDidMount=function(){this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_ADD_CARD),this.creditCardStoreSub=b("P2PCreditCardStore").addListener("change",this.onCreditCardStoreChange)};a.prototype.componentWillUnmount=function(){this.creditCardStoreSub&&(this.creditCardStoreSub.remove(),this.creditCardStoreSub=null)};a.prototype.log=function(a,c){b("P2PLogger").log(a,babelHelpers["extends"]({www_event_flow:this.props.eventFlow,object_id:this.props.loggingObjectID},this.props.loggingData,c))};a.prototype.handleOnSaveSuccess=function(a){this.props.onSuccess(a),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_ADD_CARD_SUCCESS)};a.prototype.handleOnSaveError=function(a){this.setState({loading:!1,saveErrors:a}),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_ADD_CARD_FAIL,{message:a&&a.general?a.general.message:""})};a.prototype.isSaveButtonDisabled=function(){return this.state.loading||!this.state.isValid};a.prototype.renderAddCardForm=function(){var a=this.props.p2pPaymentConfig;if(!a)return null;var c=void 0,d=this.props.title;this.props.showCancelButton&&(c=b("React").createElement(b("P2PButton.react"),{use:"default",size:"medium",label:this.props.cancelButtonText,disabled:this.state.loading,onClick:this.onCancelClicked}));return b("React").createElement("div",null,b("React").createElement(b("P2PDialogTitle.react"),null,d),b("React").createElement(b("P2PDialogBody.react"),null,b("React").createElement(b("P2PText.react"),{type:"primary",className:"_3-96"},this.props.text),b("React").createElement(b("P2PCreditCardForm.react"),{asyncRequestState:this.state.asyncRequestState,compactMode:!0,onValidation:this.handleValidation,postalRegex:a.postalRegex,productType:this.props.productType,saveErrors:this.state.saveErrors,showIcons:!1,showLabels:!0,showPlaceholderOnFocus:!0,showSecondaryIcons:!0,useGutters:!0}),b("React").createElement(b("P2PText.react"),{className:"_3-8y",id:j,type:"secondary"},h._("Your payment info is stored securely."),b("React").createElement("div",null,b("React").createElement(b("Link.react"),{"aria-describedby":j,href:b("P2PLinkConstants").addDebitCardHelpURI,target:"_blank"},h._("\u10db\u10d4\u10e2\u10d8\u10e1 \u10d2\u10d0\u10d2\u10d4\u10d1\u10d0")),b("React").createElement(b("Middot.react"),null),b("React").createElement(b("Link.react"),{"aria-describedby":j,href:b("P2PLinkConstants").paymentsTermsURI,target:"_blank"},h._("\u10de\u10d8\u10e0\u10dd\u10d1\u10d4\u10d1\u10d8"))))),b("React").createElement(b("P2PDialogFooter.react"),{leftContent:this.props.leftContent},c,b("React").createElement(b("P2PButton.react"),{use:"confirm",size:"medium",label:this.props.saveButtonText,disabled:this.isSaveButtonDisabled(),onClick:this.onSaveClick})))};a.prototype.render=function(){return!this.props.p2pPaymentConfig?null:b("React").createElement(b("P2PDialog.react"),{behaviors:this.props.behaviors,layerHideOnBlur:!1,ref:"dialog",onToggle:this.onToggle,repositionOnUpdate:!0,shown:!0,width:this.props.width},this.renderAddCardForm(),b("React").createElement(b("P2PLoadingMask.react"),{visible:this.state.loading}))};a.defaultProps={cancelButtonText:h._("\u10d2\u10d0\u10e3\u10e5\u10db\u10d4\u10d1\u10d0"),loggingData:{},onCancel:b("emptyFunction"),onSuccess:b("emptyFunction"),p2pPaymentConfig:b("P2PPaymentConfig").config,productType:b("MessengerPaymentProductType").P2P,saveButtonText:h._("\u10e8\u10d4\u10dc\u10d0\u10ee\u10d5\u10d0"),showCancelButton:!0,text:h._("Please enter a Visa or MasterCard debit card. Credit cards can't be used."),title:h._("Add Debit Card"),width:b("MessengerEnvironment").messengerui?480:430};e.exports=a}),null);
__d("P2PChooseCreditCardDialog.react",["cx","fbt","MessengerEnvironment","P2PButton.react","P2PChooseCreditCardForm.react","P2PCreditCard","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PLoadingMask.react","P2PText.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("MessengerEnvironment").messengerui;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={loading:!1,selectedCreditCard:this.props.selectedCreditCard},this.handleAddDebitCardOptionClicked=function(){this.props.onAddDebitCardOptionSelected()}.bind(this),this.handleCreditCardSelected=function(a){this.setState({selectedCreditCard:a})}.bind(this),this.handleSelected=function(){this.setState({loading:!0}),this.props.onSelected(this.state.selectedCreditCard)}.bind(this),this.handleToggle=function(a){a||this.props.onClose()}.bind(this),b}a.prototype.render=function(){var a=void 0;this.props.showCancelButton&&(a=b("React").createElement(b("P2PButton.react"),{disabled:this.props.showLoading,label:this.props.cancelButtonText,onClick:this.props.onClose,size:"medium",use:"default"}));return b("React").createElement(b("P2PDialog.react"),{behaviors:this.props.behaviors,className:j?"_auz":"",onToggle:this.handleToggle,width:this.props.width},b("React").createElement(b("P2PDialogTitle.react"),null,this.props.title),b("React").createElement(b("P2PDialogBody.react"),{className:"_383d"},b("React").createElement(b("P2PText.react"),{type:"primary",className:"_au_"},this.props.text),b("React").createElement(b("P2PChooseCreditCardForm.react"),{addCardOptionText:this.props.addCardOptionText,className:"_2pi4",creditCards:this.props.creditCards,onAddDebitCardOptionSelected:this.handleAddDebitCardOptionClicked,onChange:this.handleCreditCardSelected,selectedCard:this.props.selectedCreditCard,showAddDebitCardOption:!0})),b("React").createElement(b("P2PDialogFooter.react"),null,a,b("React").createElement(b("P2PButton.react"),{disabled:this.props.showLoading,label:this.props.saveButtonText,onClick:this.handleSelected,size:"medium",use:"confirm"})),b("React").createElement(b("P2PLoadingMask.react"),{visible:this.props.showLoading}))};a.propTypes={addCardOptionText:c.node,cancelButtonText:c.node,creditCards:c.arrayOf(c.instanceOf(b("P2PCreditCard"))).isRequired,onAddDebitCardOptionSelected:c.func.isRequired,onClose:c.func.isRequired,onSelected:c.func.isRequired,saveButtonText:c.node.isRequired,selectedCreditCard:c.instanceOf(b("P2PCreditCard")).isRequired,showCancelButton:c.bool,showLoading:c.bool,text:c.node,title:c.node,width:c.number};a.defaultProps={cancelButtonText:h._("\u10d2\u10d0\u10e3\u10e5\u10db\u10d4\u10d1\u10d0"),showCancelButton:!1,text:h._("You can use a debit card you've already added to Facebook or add a new one."),title:h._("Select Debit Card")};e.exports=a}),null);
__d("P2PEditCreditCardDialog.react",["cx","fbt","CreditCardFormParam","MessengerEnvironment","Link.react","React","P2PAPI","P2PAPIUtils","P2PCreditCard","P2PCreditCardForm.react","P2PLoadingMask.react","P2PLinkConstants","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PButton.react","P2PText.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j="fbP2PEditCreditCardDialog_learnMoreSentenceID";c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={formData:{},isValid:!1,loading:!1,requestID:"",saveErrors:null},this.clearSaveErrors=function(){this.setState({saveErrors:null})}.bind(this),this.onSaveClick=function(a){a={};var c=b("P2PAPIUtils").genRequestID();a[b("CreditCardFormParam").CREDENTIAL_ID]=this.props.creditCard.getCredentialId();this.clearSaveErrors();this.setState({loading:!0,requestID:c});b("P2PAPI").updateCreditCard(babelHelpers["extends"]({requestID:c},a,this.state.formData))}.bind(this),this.handleOnSaveSuccess=function(a){this.props.onSuccess(a)}.bind(this),this.onCancelClick=function(a){this.props.onCancel()}.bind(this),this.handleOnSaveError=function(a){this.setState({loading:!1,saveErrors:a})}.bind(this),this.isSaveDisabled=function(){return!this.state.isValid||this.state.loading}.bind(this),this.isCancelDisabled=function(){return this.state.loading}.bind(this),this.handleValidation=function(a,b){this.setState({isValid:a,formData:b})}.bind(this),this.getPrefilledFormData=function(){var a={};a[b("CreditCardFormParam").CARD_NUMBER]=this.props.creditCard.getCreditCardNumberMask();a[b("CreditCardFormParam").CARD_EXPIRATION]=this.props.creditCard.getExpFormattedShort();a[b("CreditCardFormParam").ZIP]=this.props.creditCard.getZipCode();return a}.bind(this),this.handleErrorDialogOKClick=function(){this.clearSaveErrors()}.bind(this),this.onToggle=function(a){a||this.props.onCancel()}.bind(this),c}a.prototype.UNSAFE_componentWillReceiveProps=function(a){a=a.asyncRequestState?a.asyncRequestState[this.state.requestID]:null;a&&(this.setState({requestID:""}),a.error?this.handleOnSaveError(a.error):this.handleOnSaveSuccess(a))};a.prototype.render=function(){var a=void 0,c=this.props.text;c||(c=h._("Please update the expiration date for your card ending in {card numbers}.",[h._param("card numbers",this.props.creditCard.getCreditCardNumber())]));this.props.showCancelButton&&(a=b("React").createElement(b("P2PButton.react"),{use:"default",size:"medium",label:h._("\u10d2\u10d0\u10e3\u10e5\u10db\u10d4\u10d1\u10d0"),disabled:this.isCancelDisabled(),onClick:this.onCancelClick}));return b("React").createElement(b("P2PDialog.react"),{behaviors:this.props.behaviors,layerHideOnBlur:!1,onToggle:this.onToggle,repositionOnUpdate:!0,shown:!0,width:this.props.width},b("React").createElement(b("P2PDialogTitle.react"),null,h._("Update Debit Card")),b("React").createElement(b("P2PDialogBody.react"),null,b("React").createElement(b("P2PText.react"),{className:"_3-96",type:"primary"},c),b("React").createElement(b("P2PCreditCardForm.react"),{onValidation:this.handleValidation,saveErrors:this.state.saveErrors,editMode:!0,prefilledFormData:this.getPrefilledFormData(),cscMaxLength:this.props.creditCard.getMaxCSCLength()}),b("React").createElement(b("P2PText.react"),{className:"_3-8y",id:j,type:"secondary"},h._("Your payment info is stored securely. {Learn more about p2p link}",[h._param("Learn more about p2p link",b("React").createElement(b("Link.react"),{"aria-describedby":j,href:b("P2PLinkConstants").addDebitCardHelpURI,target:"_blank"},h._("\u10d2\u10d0\u10d8\u10d2\u10d4 \u10db\u10d4\u10e2\u10d8.")))]))),b("React").createElement(b("P2PDialogFooter.react"),null,a,b("React").createElement(b("P2PButton.react"),{use:"confirm",size:"medium",label:this.props.saveButtonText,disabled:this.isSaveDisabled(),onClick:this.onSaveClick})),b("React").createElement(b("P2PLoadingMask.react"),{visible:this.state.loading}))};a.propTypes={asyncRequestState:c.object.isRequired,creditCard:c.instanceOf(b("P2PCreditCard")).isRequired,onCancel:c.func.isRequired,onSuccess:c.func.isRequired,saveButtonText:c.node,showCancelButton:c.bool};a.defaultProps={saveButtonText:h._("\u10e8\u10d4\u10dc\u10d0\u10ee\u10d5\u10d0"),showCancelButton:!0,width:b("MessengerEnvironment").messengerui?350:300};e.exports=a}),null);
__d("P2PMoneypennyCheckoutDialog.react",["cx","fbt","ix","MessengerEnvironment","Link.react","MNCommerceAgenItemSuggestionReactShape","P2PBigAmount.react","P2PButton.react","P2PCreditCard","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PLoadingMask.react","P2PMoneypennyProductItemDetails.react","P2PText.react","React"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);j=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=j.constructor).call.apply(a,[this].concat(e)),this.handleToggle=function(a){a||this.props.onClose()}.bind(this),this.renderPaymentDetails=function(){var a=this.props.selectedCreditCard;return!a?null:b("React").createElement(b("P2PText.react"),{className:"_1t0k",shade:"light",size:"small",type:"secondary"},a.getDetailsFormatted()+" \xb7 ",b("React").createElement(b("Link.react"),{className:"_1t0l",onClick:this.props.onChangeCreditCard,href:"#"},h._("\u10e8\u10d4\u10ea\u10d5\u10da\u10d0")))}.bind(this),this.renderFooter=function(){var a=void 0,c=void 0,d=void 0;!this.props.selectedCreditCard?(a=b("React").createElement(b("P2PText.react"),{className:"_1t0n",type:"secondary"},this.props.leftContentText),c=b("React").createElement(b("P2PButton.react"),{label:h._("\u10e8\u10d4\u10db\u10d3\u10d4\u10d2\u10d8"),onClick:this.props.onNextClicked,size:"medium",type:"primary",use:"default"})):c=b("React").createElement(b("P2PButton.react"),{label:h._("Pay"),onClick:this.props.onPurchaseClicked,size:"medium",type:"primary",use:"confirm"});this.props.showCancelButton&&(d=b("React").createElement(b("P2PButton.react"),{use:"default",size:"medium",label:this.props.cancelButtonText,disabled:this.props.showLoading,onClick:this.props.onClose}));return b("React").createElement(b("P2PDialogFooter.react"),{leftContent:a},d,c)}.bind(this),c}a.prototype.renderAmountSection=function(){return b("React").createElement("div",{className:"_1t0o"},b("React").createElement("div",{className:"_4qbr"},b("React").createElement(b("P2PBigAmount.react"),{amount:this.props.item.raw_amount,className:"_3oh-",currencyCode:this.props.item.currencyCode,size:"large"})),this.renderPaymentDetails(),b("React").createElement(b("P2PText.react"),{className:"_1wb1",shade:"light",size:"small",type:"secondary"},"We","'","ll place your order with the business when we receive your payment."))};a.prototype.render=function(){var a=void 0;b("MessengerEnvironment").messengerui||(a=b("React").createElement(b("P2PDialogTitle.react"),null,h._("\u10d2\u10d0\u10d3\u10d0\u10ee\u10d3\u10d0")));return b("React").createElement(b("P2PDialog.react"),{layerHideOnBlur:!1,onToggle:this.handleToggle,shown:!0,width:this.props.width},a,b("React").createElement(b("P2PDialogBody.react"),null,b("React").createElement("div",{className:"_b0z"},b("React").createElement(b("P2PMoneypennyProductItemDetails.react"),{item:this.props.item})),this.renderAmountSection()),this.renderFooter(),b("React").createElement(b("P2PLoadingMask.react"),{visible:this.props.showLoading}))};a.propTypes={cancelButtonText:c.node,item:b("MNCommerceAgenItemSuggestionReactShape").isRequired,leftContentText:c.node,onClose:c.func.isRequired,onChangeCreditCard:c.func.isRequired,onNextClicked:c.func.isRequired,onPurchaseClicked:c.func.isRequired,selectedCreditCard:c.instanceOf(b("P2PCreditCard")),showCancelButton:c.bool,showLoading:c.bool};a.defaultProps={cancelButtonText:h._("\u10d2\u10d0\u10e3\u10e5\u10db\u10d4\u10d1\u10d0"),leftContentText:h._("You'll add a debit card next."),showCancelButton:!1,width:360};e.exports=a}),null);
__d("P2PMoneypennyStore",["P2PActionConstants","EventEmitter","ImmutableObject","P2PDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;void 0;var h=void 0,i=void 0;function j(a,c){a&&(i[a]=new(b("ImmutableObject"))(c))}function k(a,b){a&&(i[a]={error:b})}c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(){g.constructor.call(this),i={},h=[],b("P2PDispatcher").register(this.onEventDispatched.bind(this))}a.prototype.onEventDispatched=function(a){var c=a.data;a=a.type;switch(a){case b("P2PActionConstants").MONEYPENNY_TRANSFER_CREATED:this.handleMoneypennyTransferCreated(c);this.emit("change");break;case b("P2PActionConstants").MONEYPENNY_TRANSFER_CREATED_ERROR:this.handleMoneypennyTransferCreatedError(c);this.emit("change");break}};a.prototype.getAsyncRequestState=function(){return i};a.prototype.handleMoneypennyTransferCreated=function(a){var c;void 0;j(a.requestID,a);c=h.filter(function(b){return b.payment_id===a.payment_id})[0];c||h.push(new(b("ImmutableObject"))(a))};a.prototype.handleMoneypennyTransferCreatedError=function(a){k(a.requestID,a.error)};a.prototype.getTransferByID=function(a){return h.filter(function(b){return b.item_id===a})[0]};e.exports=new a()}),null);
__d("P2PPasswordProtectionNUXDialog.react",["cx","fbt","MessengerEnvironment","Link.react","P2PAPI","P2PErrorDialog.react","P2PLinkConstants","P2PLoadingMask.react","P2PLogger","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PPasswordProtectionParam","P2PPasswordProtectionStatusTypes","React","P2PButton.react","P2PDialog.react","P2PDialogTitle.react","P2PDialogBody.react","P2PDialogFooter.react","P2PText.react","emptyFunction"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={saveErrorObject:null,loading:!1},this.log=function(a,c){b("P2PLogger").log(a,babelHelpers["extends"]({www_event_flow:b("P2PPaymentLoggerEventFlow").UI_FLOW_P2P_SETTINGS},c))},this.onSaveClick=function(){this.setState({loading:!0,saveErrorObject:null}),this.setPasswordProtection(b("P2PPasswordProtectionStatusTypes").ENABLED),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_OPT_IN_PASSWORD_PROTECTION_NUX)}.bind(this),this.setPasswordProtection=function(a){var c={};c[b("P2PPasswordProtectionParam").STATUS]=a;b("P2PAPI").setPasswordProtectionSetting({formData:c,success:this.handleOnSaveSuccess,error:this.handleOnSaveError})}.bind(this),this.handleOnSaveSuccess=function(){this.setState({loading:!1}),this.props.onComplete()}.bind(this),this.handleOnSaveError=function(a){this.setState({loading:!1,saveErrorObject:a})}.bind(this),this.isSaveButtonDisabled=function(){return this.state.loading}.bind(this),this.isCancelButtonDisabled=function(){return this.state.loading}.bind(this),this.onCancelClick=function(){this.setState({loading:!0,saveErrorObject:null}),this.setPasswordProtection(b("P2PPasswordProtectionStatusTypes").DISABLED),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_OPT_OUT_PASSWORD_PROTECTION_NUX)}.bind(this),this.handleErrorBackClick=function(){this.setState({saveErrorObject:null})}.bind(this),this.handleErrorOKClick=function(){this.setState({saveErrorObject:null}),this.props.onComplete()}.bind(this),c}a.prototype.UNSAFE_componentWillMount=function(){this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_PASSWORD_PROTECTION_NUX)};a.prototype.render=function(){return this.state.saveErrorObject?b("React").createElement(b("P2PErrorDialog.react"),{allowBack:!0,title:h._("Problem Saving"),onBackClick:this.handleErrorBackClick,onOKClick:this.handleErrorOKClick,error:this.state.saveErrorObject}):b("React").createElement(b("P2PDialog.react"),{className:b("MessengerEnvironment").messengerui?"_-el":"",behaviors:{LayerFadeOnShow:!1},layerHideOnBlur:!1,shown:!0,width:this.props.width},b("React").createElement(b("P2PDialogTitle.react"),{showCloseButton:!1},h._("Use Password?")),b("React").createElement(b("P2PDialogBody.react"),null,b("React").createElement(b("P2PText.react"),{className:"_5sor",type:"primary"},h._("For additional security, you can enter your Facebook password to send money. You can always update this in {link}.",[h._param("link",b("React").createElement(b("Link.react"),{href:b("P2PLinkConstants").settingsWWWURI,target:"_blank"},h._("\u10de\u10d0\u10e0\u10d0\u10db\u10d4\u10e2\u10e0\u10d4\u10d1\u10d8")))]))),b("React").createElement(b("P2PDialogFooter.react"),null,b("React").createElement(b("P2PButton.react"),{className:"_5sov",disabled:this.isCancelButtonDisabled(),label:h._("\u10d0\u10ee\u10da\u10d0 \u10d0\u10e0\u10d0"),onClick:this.onCancelClick,size:"medium",use:"default"}),b("React").createElement(b("P2PButton.react"),{className:"_5sox",disabled:this.isSaveButtonDisabled(),label:h._("Use Password"),onClick:this.onSaveClick,size:"medium",use:"confirm"})),b("React").createElement(b("P2PLoadingMask.react"),{visible:this.state.loading}))};a.propTypes={onComplete:c.func};a.defaultProps={onComplete:b("emptyFunction"),width:b("MessengerEnvironment").messengerui?320:300};e.exports=a}),null);
__d("P2PSuccessDialog.react",["fbt","ix","MessengerEnvironment","Image.react","LayerSlowlyFadeOnShow","P2PConfirmationDialog.react","React","emptyFunction"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.getImage=function(){return b("React").createElement(b("Image.react"),{height:62,width:62,src:h("94361")})},c}a.prototype.render=function(){var a=this.getImage();return b("React").createElement(b("P2PConfirmationDialog.react"),{behaviors:babelHelpers["extends"]({LayerSlowlyFadeOnShow:b("LayerSlowlyFadeOnShow")},this.props.behaviors),allowBack:this.props.allowBack,buttonLabel:this.props.buttonLabel,buttonUse:this.props.buttonUse,centered:this.props.centered,image:a,onOKClick:this.props.onOKClick,onSecondaryClick:this.props.onSecondaryClick,onToggle:this.props.onToggle,showCloseButton:this.props.showCloseButton,showSecondaryButton:this.props.showSecondaryButton,secondaryButtonLabel:this.props.secondaryButtonLabel,secondaryButtonUse:this.props.secondaryButtonUse,title:this.props.title,width:this.props.width},this.props.children)};a.propTypes={allowBack:c.bool,buttonLabel:c.node,buttonUse:c.string,onOKClick:c.func,onSecondaryClick:c.func,onToggle:c.func,secondaryButtonLabel:c.node,secondaryButtonUse:c.string,showCloseButton:c.bool,showSecondaryButton:c.bool,title:c.node.isRequired,width:c.number};a.defaultProps={allowBack:!1,buttonLabel:g._("OK"),buttonUse:"default",onOKClick:b("emptyFunction"),showCloseButton:!1,width:b("MessengerEnvironment").messengerui?350:300};e.exports=a}),null);
__d("P2PMoneypennyCheckoutDialogContainer.react",["cx","fbt","Arbiter","CreditCardFormParam","MessengerEnvironment","MessengerPaymentProductType","MNCommerceAgenItemSuggestionReactShape","P2PAPI","P2PAPIUtils","P2PAddCreditCardDialog.react","P2PChooseCreditCardDialog.react","P2PCreditCardStore","P2PEditCreditCardDialog.react","P2PErrorDialog.react","P2PLogger","P2PMoneypennyCheckoutDialog.react","P2PMoneypennyStore","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PPasswordProtectionNUXDialog.react","P2PPasswordProtectionStatusTypes","P2PSuccessDialog.react","P2PText.react","P2PVerifyCreditCardDialog.react","React","setImmediate"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=h._("Pay"),k={LayerFadeOnShow:!1},l=360,m=b("P2PPaymentLoggerEventFlow").UI_FLOW_MONEYPENNY_CHECKOUT;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(a,c){i.constructor.call(this,a,c);n.call(this);a=this.getCards();this.state={addCreditCardDialogShown:!1,editCreditCardDialogShown:!1,creditCards:a,creditCardAsyncRequestState:b("P2PCreditCardStore").getAsyncRequestState(),chooseCreditCardDialogShown:!1,loading:!1,moneypennyAsyncRequestState:b("P2PMoneypennyStore").getAsyncRequestState(),p2pPasswordProtectionNUXDialogShown:!1,transferErrors:null,transferRequestID:"",selectedCreditCard:a[0],successDialogPending:!1,successDialogShown:!1,verifyCreditCardDialogShown:!1}}a.prototype.UNSAFE_componentWillMount=function(){this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_MONEYPENNY_ORDER,{}),this.creditCardStoreSub=b("P2PCreditCardStore").addListener("change",this.onCreditCardStoreChange),this.moneypennyTransferStoreSub=b("P2PMoneypennyStore").addListener("change",this.onMoneypennyStoreChange)};a.prototype.componentWillUnmount=function(){this.creditCardStoreSub&&(this.creditCardStoreSub.remove(),this.creditCardStoreSub=null),this.moneypennyTransferStoreSub&&(this.moneypennyTransferStoreSub.remove(),this.moneypennyTransferStoreSub=null),this.passwordCancelSubscribeToken!==null&&(b("Arbiter").unsubscribe(this.passwordCancelSubscribeToken),this.passwordCancelSubscribeToken=null)};a.prototype.getProductType=function(){return b("MessengerPaymentProductType").MESSENGER_COMMERCE};a.prototype.getCards=function(){return b("P2PCreditCardStore").getAll(this.getProductType())};a.prototype.log=function(a,c){b("P2PLogger").log(a,babelHelpers["extends"]({raw_amount:this.props.item.raw_amount,currency:this.props.item.total_cost.currency,object_id:this.props.item.id,www_event_flow:m},c))};a.prototype.handleMoneypennyTransferSuccess=function(a){this.hideAllDialogs(),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_MONEYPENNY_ORDER_SUCCESS,{}),a.passwordProtection===b("P2PPasswordProtectionStatusTypes").NOT_SET&&(this.passwordNUXPending=!0),this.successDialogPending?(this.successDialogPending=!1,this.setState({successDialogShown:!0})):this.handleCheckoutSuccess()};a.prototype.handleMoneypennyTransferError=function(a){this.hideAllDialogs(),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_MONEYPENNY_ORDER_FAIL,{}),this.setState({loading:!1,transferErrors:a})};a.prototype.hideAllDialogs=function(){this.setState({addCreditCardDialogShown:!1,editCreditCardDialogShown:!1,chooseCreditCardDialogShown:!1,successDialogShown:!1,transferErrors:null,verifyCreditCardDialogShown:!1,p2pPasswordProtectionNUXDialogShown:!1})};a.prototype.render=function(){__p&&__p();var a=this.props.item,c=b("MessengerEnvironment").messengerui,d=void 0,e=void 0,f=void 0,g=void 0,i=void 0,n=void 0;this.getProductType()===b("MessengerPaymentProductType").MESSENGER_COMMERCE?(d=h._("Please enter a debit or credit card to get {Product name}.",[h._param("Product name",a.name)]),e=h._("Add Card"),g=h._("Select Card"),f=h._("You can use a card you've already added to Facebook or add a new one to get {Product name}.",[h._param("Product name",this.props.item.name)]),i=h._("New Card"),n=h._("You'll add a card next.")):(d=h._("Please enter a debit card to get {Product name}. Credit cards can't be used yet.",[h._param("Product name",a.name)]),f=h._("You can use a debit card you've already added to Facebook or add a new one to get {Product name}.",[h._param("Product name",this.props.item.name)]));if(this.state.p2pPasswordProtectionNUXDialogShown)return b("React").createElement(b("P2PPasswordProtectionNUXDialog.react"),{onComplete:this.props.onClose,width:l});else if(this.state.transferErrors)return b("React").createElement(b("P2PErrorDialog.react"),{behaviors:k,error:this.state.transferErrors,onOKClick:this.handleCheckoutCancel,title:h._("Problem with your payment"),width:l});else if(this.state.verifyCreditCardDialogShown)return b("React").createElement(b("P2PVerifyCreditCardDialog.react"),{asyncRequestState:this.state.creditCardAsyncRequestState,behaviors:k,creditCard:this.state.selectedCreditCard,isPurchasing:!0,purchaseName:this.props.item.name,onCancel:this.handleCheckoutCancel,onSuccess:this.purchase,saveButtonText:j,showCancelButton:c,width:l});else if(this.state.editCreditCardDialogShown)return b("React").createElement(b("P2PEditCreditCardDialog.react"),{asyncRequestState:this.state.creditCardAsyncRequestState,behaviors:k,creditCard:this.state.selectedCreditCard,onCancel:this.handleCheckoutCancel,onSuccess:this.purchase,saveButtonText:j,showCancelButton:c,text:h._("Please update the expiration date for your card ending in {card numbers} to get {Product name}.",[h._param("card numbers",this.state.selectedCreditCard.getCreditCardNumber()),h._param("Product name",this.props.item.name)]),width:l});else if(this.state.successDialogShown)return b("React").createElement(b("P2PSuccessDialog.react"),{behaviors:babelHelpers["extends"]({LayerSlowlyFadeOnShow:!1},k),onOKClick:this.handleCheckoutSuccess,title:h._("Payment Sent"),width:l},b("React").createElement(b("P2PText.react"),{className:"_3-97",type:"primary"},h._("We received your payment and are placing your order with the business.")),b("React").createElement(b("P2PText.react"),{type:"primary"},h._("{Bold text that says, Tip:} You can also use {Credit card name and number} to send money to friends in your conversations.",[h._param("Bold text that says, Tip:",b("React").createElement(b("P2PText.react"),{display:"inline",type:"primary",weight:"bold"},h._("\u10db\u10dd\u10dc\u10d8\u10e8\u10dc\u10d4:"))),h._param("Credit card name and number",this.state.selectedCreditCard.getDetailsFormatted())])));else if(this.state.chooseCreditCardDialogShown)return b("React").createElement(b("P2PChooseCreditCardDialog.react"),{addCardOptionText:i,behaviors:k,creditCards:this.state.creditCards,onAddDebitCardOptionSelected:this.handleAddDebitCardClicked,onClose:this.handleCheckoutCancel,onSelected:this.handleCreditCardSelected,saveButtonText:j,selectedCreditCard:this.state.selectedCreditCard,showCancelButton:c,showLoading:this.state.loading,text:f,title:g,width:l});else if(this.state.addCreditCardDialogShown)return b("React").createElement(b("P2PAddCreditCardDialog.react"),{behaviors:k,eventFlow:m,loggingData:{amount:a.raw_amount,object_id:a.id},onCancel:this.handleCheckoutCancel,onSuccess:this.handleAddCreditCardSuccess,productType:this.getProductType(),saveButtonText:j,showCancelButton:c,text:d,title:e,width:l});else return b("React").createElement(b("P2PMoneypennyCheckoutDialog.react"),{item:this.props.item,leftContentText:n,onChangeCreditCard:this.handleChangeCreditCardClicked,onClose:this.handleCheckoutCancel,onNextClicked:this.handleAddDebitCardClicked,onPurchaseClicked:this.purchase,selectedCreditCard:this.state.selectedCreditCard,showCancelButton:c,showLoading:this.state.loading,width:l})};a.propTypes={item:b("MNCommerceAgenItemSuggestionReactShape").isRequired,onClose:c.func.isRequired};var n=function(){__p&&__p();this.creditCardStoreSub=null,this.moneypennyTransferStoreSub=null,this.passwordCancelSubscribeToken=null,this.passwordNUXPending=!1,this.successDialogPending=!1,this.onCreditCardStoreChange=function(){var a=this.getCards(),c=void 0;this.state.selectedCreditCard&&(c=b("P2PCreditCardStore").getCreditCardByCredentialID(this.state.selectedCreditCard.getCredentialId()));c||(c=a[0]);this.setState({creditCards:a,creditCardAsyncRequestState:b("P2PCreditCardStore").getAsyncRequestState(),selectedCreditCard:c})}.bind(this),this.onMoneypennyStoreChange=function(){var a=b("P2PMoneypennyStore").getAsyncRequestState(),c=a[this.state.transferRequestID];this.setState({moneypennyAsyncRequestState:a});c&&(this.setState({transferRequestID:""}),c.error?this.handleMoneypennyTransferError(c.error):this.handleMoneypennyTransferSuccess(c))}.bind(this),this.handleChangeCreditCardClicked=function(){this.hideAllDialogs(),this.state.creditCards.length>1?(this.setState({chooseCreditCardDialogShown:!0}),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_CHOOSE_CARD,{})):this.setState({addCreditCardDialogShown:!0})}.bind(this),this.handleAddDebitCardClicked=function(){this.hideAllDialogs(),this.setState({addCreditCardDialogShown:!0})}.bind(this),this.handleCreditCardSelected=function(a){this.setState({selectedCreditCard:a},function(){this.purchase()}.bind(this))}.bind(this),this.purchase=function(){__p&&__p();var a=void 0;if(!this.state.selectedCreditCard.getIsVerified()){this.log(b("P2PPaymentLoggerEvent").UI_ACTN_VERIFY_CSC,{});this.hideAllDialogs();this.setState({verifyCreditCardDialogShown:!0});return}else if(this.state.selectedCreditCard.isExpired()){this.log(b("P2PPaymentLoggerEvent").UI_ACTN_EDIT_CARD,{});this.hideAllDialogs();this.setState({editCreditCardDialogShown:!0});return}this.passwordCancelSubscribeToken=b("Arbiter").subscribeOnce("PasswordReauthDialogCancelClick",this.handlePasswordReauthDialogCancelClick);a=b("P2PAPIUtils").genRequestID();this.setState({loading:!0,transferRequestID:a,transferErrors:null});b("P2PAPI").createMoneypennyTransfer({amount:this.props.item.raw_amount,credential_id:this.state.selectedCreditCard.getCredentialId(),item_id:this.props.item.id,external_request_id:b("P2PAPIUtils").genRequestID(),requestID:a});this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_MONEYPENNY_ORDER,{})}.bind(this),this.handlePasswordReauthDialogCancelClick=function(){this.passwordCancelSubscribeToken=null,this.setState({loading:!1}),this.hideAllDialogs()}.bind(this),this.handleCheckoutSuccess=function(){this.hideAllDialogs(),this.passwordNUXPending?(this.passwordNUXPending=!1,this.setState({p2pPasswordProtectionNUXDialogShown:!0})):b("setImmediate")(this.props.onClose)}.bind(this),this.handleAddCreditCardSuccess=function(a){this.successDialogPending=this.getCards().length===1,this.setState({selectedCreditCard:b("P2PCreditCardStore").getCreditCardByCredentialID(a[b("CreditCardFormParam").CREDENTIAL_ID])},function(){this.purchase()}.bind(this))}.bind(this),this.handleCheckoutCancel=function(){this.log(b("P2PPaymentLoggerEvent").UI_ACTN_MONEYPENNY_ORDER_CANCEL,{}),this.props.onClose()}.bind(this)};e.exports=a}),null);
__d("MNCommerceAgentItemSuggestionMercuryShareAttachment.react",["MercuryFallbackShareAttachment.react","MercuryShareAttachmentReactShape","MercuryShareAttachmentRenderLocations","MNCommerceAgentItemSuggestionMercuryAttachment.react","P2PActions","P2PMoneypennyCheckoutDialogContainer.react","P2PMoneypennyStore","React","ReactComponentWithPureRenderMixin","StoreAndPropBasedStateMixin"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"MNCommerceAgentItemSuggestionMercuryShareAttachment",mixins:[b("ReactComponentWithPureRenderMixin"),b("StoreAndPropBasedStateMixin")(b("P2PMoneypennyStore"))],propTypes:{attachment:b("MercuryShareAttachmentReactShape"),maxWidth:a.number,location:a.oneOf(b("MercuryShareAttachmentRenderLocations").getValues())},statics:{calculateState:function(a){a=a.attachment&&a.attachment.target;var c=!!(a&&a.payment_id);if(!c){a=b("P2PMoneypennyStore").getTransferByID(a.id);c=!!(a&&a.payment_id)}return{isItemPurchased:c}}},_handleBuyClick:function(){b("P2PActions").showDialog(b("P2PMoneypennyCheckoutDialogContainer.react"),{item:this._getItem(),onClose:b("P2PActions").hideDialog})},_getItem:function(){var a=this.props.attachment;return a&&a.target},render:function(){var a=this._getItem();return!a?b("React").createElement(b("MercuryFallbackShareAttachment.react"),this.props):b("React").createElement(b("MNCommerceAgentItemSuggestionMercuryAttachment.react"),{itemSuggestion:a,isPurchased:this.state.isItemPurchased,location:this.props.location,onBuyClick:this._handleBuyClick,width:this.props.maxWidth})}});e.exports=c}),null);
__d("MNCommerceCheckoutButton.react",["cx","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;var i="medium";h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.getButtonSize=function(a){return i};a.prototype.render=function(){var a="_48a0"+(this.props.disabled?" _48a1":"")+(this.props.use==="default"?" _48a2":"")+(this.props.use==="confirm"&&!this.props.disabled?" _48a3":"");return b("React").createElement("span",{className:b("joinClasses")(this.props.className,a),use:"default"},this.props.children)};function a(){h.apply(this,arguments)}a.propTypes={disabled:c.bool,use:c.oneOf(["default","confirm"])};e.exports=a}),null);
__d("MNCommerceCheckoutOrderConfigReactShape",["React"],(function(a,b,c,d,e,f){"use strict";a=b("React").PropTypes;c=a.shape({allVariantOptions:a.object,id:a.string,initialVariantOptions:a.object,itemIDToItem:a.object,logo:a.string,name:a.string,optionToItems:a.object,ordered_product_items:a.array,product_item_id:a.string,variant_labels:a.array});e.exports=c}),null);
__d("MNCommerceCheckoutOrderConfigUtils",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={DELIMITER:"!@*",addVariantOptions:function(a){__p&&__p();a=a;var b=this._buildItemMaps(a),c=b.optionToItems,d=b.itemIDToItem;b=b.variantToItemID;var e=this._getVariantOptionsAndEligibleItems(a,c,d),f=e.allVariantOptions;e=e.initialVariantOptions;a.itemIDToItem=d;a.optionToItems=c;a.variantToItemID=b;a.allVariantOptions=f;a.initialVariantOptions=e;return a},_buildItemMaps:function(a){__p&&__p();var b=new Map(),c=new Map(),d=new Map();a.ordered_product_items.forEach(function(a){__p&&__p();var e=a.variant_values,f=[];Object.keys(e).forEach(function(a){f.push(e[a])});var h=f.join(g.DELIMITER);d.set(h,a.item_id);b.set(a.item_id,a);for(var h=0;h<f.length;h++){c.has(h)||c.set(h,new Map());var i=f[h],j=c.get(h);!j.has(i)?j.set(i,new Set([a.item_id])):j.get(i).add(a.item_id)}});return{itemIDToItem:b,optionToItems:c,variantToItemID:d}},_getVariantOptionsAndEligibleItems:function(a,b,c){__p&&__p();var d={},e={};for(var f=0;f<a.variant_labels.length;f++){d[f]={};var g=[];b.get(f).forEach(function(h,i){__p&&__p();h=new Map();g.push({label:i,available:!0});for(var j=0;j<a.variant_labels.length;j++){if(f===j)continue;var k=[];b.get(j).forEach(function(a,d){a=this._getIntersection(a,b.get(f).get(i));var e=!1;a.size>0&&(e=this._isInStock(a,c));k.push({label:d,available:e})}.bind(this),this);h.set(j,k)}d[f][i]=h;e[f]=g}.bind(this),this)}return{allVariantOptions:d,initialVariantOptions:e}},_getIntersection:function(a,b){var c=new Set([]);a.forEach(function(a){b.has(a)&&c.add(a)});return c},_isInStock:function(a,b){var c=!1;a.forEach(function(a){a=b.get(a);a.commerce_inventory>0&&(c=!0)});return c}};e.exports=g}),null);
__d("MNCommerceLogoHeaderReact.bs",["cx","React","ImageReact.bs","ReasonReact.bs","bs_js_primitive"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h="24px",i="12px",j=b("ReasonReact.bs").statelessComponent("MNCommerceLogoHeader");function k(a,c,d,e){__p&&__p();var f=function(){__p&&__p();if(a){var c=a[0],d=c.src;if(d==null)return null;else{var e=c.width/c.height;e=Math.abs(3-e)<=.75?i:h;return b("React").createElement("div",{key:"logo",className:"_b0-"},b("React").createElement("div",{className:"_fz0"},b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make(["_56rs"],0,0,0,[d],[c.height],0,[c.width],[{maxHeight:e}],[]))))}}else return null};return[j[0],j[1],j[2],j[3],j[4],j[5],j[6],j[7],function(){__p&&__p();var g=f(0);if(e.length!==0){var h=b("React").createElement("div",{key:"children",className:"_fy-"+((c?!1:!0)?" _fy_":"")},b("React").createElement("div",{className:"_56rv"},e));if(a){var i=a[0].src;i=i==null?[!0,[h]]:c?[!1,[h,g]]:[!1,[g,h]]}else i=[!0,[h]];return b("React").createElement("div",{className:(i[0]&&(d?!0:!1)?"_fy_":"")+" _56rt"},i[1])}else return g},j[9],j[10],j[11],j[12]]}a=b("ReasonReact.bs").wrapReasonForJs(j,function(a){var c=a.children;return k(b("bs_js_primitive").null_undefined_to_opt(a.logo),a.logoPosition==="right"?1:0,a.childPosition==="right"?1:0,c==null?[]:[].concat(c))});c=3;d=.75;f.defaultMaxHeight=h;f.defaultHalfMaxHeight=i;f.defaultAspectRatio=c;f.aspectRatioMargin=d;f.component=j;f.make=k;f.jsComponent=a}),null);
__d("MNCommerceItemTextReact.bs",["cx","fbt","React","Utils.bs","ReasonReact.bs","joinClasses","MNCommerceOrderItemsStatus"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("ReasonReact.bs").statelessComponent("MNCommerceItemText");function a(a,c,d,e,f,g,j,k){__p&&__p();var l=function(a){if(f)return null;else{a=a?a[0]:null;if(g&&g[0]===b("MNCommerceOrderItemsStatus").CANCELED)return b("React").createElement("div",undefined,b("React").createElement("span",{className:"__hz"},h._("\u10d2\u10d0\u10e3\u10e5\u10db\u10d4\u10d1\u10e3\u10da\u10d8\u10d0")," \xb7"),a);else return b("React").createElement("div",undefined,a)}},m=function(a){if(a)return b("React").createElement("div",undefined,a[0]);else return null},n=function(){if(d){var a=d[0];return b("React").createElement("div",undefined,m(a[0]),m(a[1]),l(a[2]))}else return null};return[i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],function(){return b("React").createElement("div",{className:b("joinClasses")(b("Utils.bs").$pipe$unknown(a,""),"_swr"+((f?!0:!1)?" _sws":"")),style:{left:c,paddingLeft:e},title:b("Utils.bs").$pipe$unknown(j,"")},b("React").createElement("div",{className:"_51fw"},j?j[0]:null),b("React").createElement("div",{className:"_2y0f"},n(0)))},i[9],i[10],i[11],i[12]]}f.component=i;f.make=a}),null);
__d("MNCommerceSingleListItemReact.bs",["cx","React","Utils.bs","ImageReact.bs","ReasonReact.bs","joinClasses","bs_js_primitive","MNCommerceItemTextReact.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ReasonReact.bs").statelessComponent("MNCommerceSingleListItem");function i(a,c,d,e,f,g,i,j,k){var l=function(){if(c)return b("React").createElement("div",{className:"_1fld"},b("ReasonReact.bs").element(0,0,b("ImageReact.bs").make(["_1fle"],0,0,0,[c[0]],[d],0,[d],0,[])));else return null};return[h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],function(){return b("React").createElement("div",{className:b("joinClasses")(b("Utils.bs").$pipe$unknown(a,""),"_39q_"),style:{height:String(d)+"px",width:b("Utils.bs").$pipe$unknown(g,"auto")}},l(0),b("ReasonReact.bs").element(0,0,b("MNCommerceItemTextReact.bs").make(["_1flf"],c?String(d)+"px":"auto",i,c?"6px":"auto",e,f,j,[])))},h[9],h[10],h[11],h[12]]}a=b("ReasonReact.bs").wrapReasonForJs(h,function(a){var c=a.width,d=a.metalines;return i(b("bs_js_primitive").null_undefined_to_opt(a.className),b("bs_js_primitive").null_undefined_to_opt(a.thumbURL),a.imageDimension,a.size==="large"?0:1,b("bs_js_primitive").null_undefined_to_opt(a.statusType),c==null?0:[String(c)+"px"],d==null?0:[[b("bs_js_primitive").null_undefined_to_opt(d.metaline_1),b("bs_js_primitive").null_undefined_to_opt(d.metaline_2),b("bs_js_primitive").null_undefined_to_opt(d.metaline_3)]],b("bs_js_primitive").null_undefined_to_opt(a.title),[])});f.component=h;f.make=i;f.jsComponent=a}),null);
__d("MNCommerceCheckoutOrderConfigDialog.react",["cx","fbt","MessengerEnvironment","MNCommerceButton.react","MNCommerceCheckoutButton.react","MNCommerceCheckoutOrderConfigReactShape","MNCommerceCheckoutOrderConfigUtils","MNCommerceDetailsDialog.react","MNCommerceDialogFooter.react","MNCommerceDialogBody.react","MNCommerceLogoHeaderReact.bs","MNCommerceSingleListItemReact.bs","React","XUIRadioButtonGroup.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("MNCommerceLogoHeaderReact.bs").jsComponent,k=b("MNCommerceSingleListItemReact.bs").jsComponent;c=b("React").PropTypes;var l=18,m="\xb7";d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(a,b){i.constructor.call(this,a,b),n.call(this),this.state=this.$1()}a.prototype.UNSAFE_componentWillReceiveProps=function(a){this.setState(this.$1(a))};a.prototype.render=function(){var a=h._("Your item couldn't be shown.");return b("React").createElement(b("MNCommerceDetailsDialog.react"),babelHelpers["extends"]({errorMessage:a},this.props),this.$2())};a.prototype.$2=function(){__p&&__p();if(this.props.error||this.props.loading)return null;var a=h._("\u10d2\u10d0\u10d2\u10e0\u10eb\u10d4\u10da\u10d4\u10d1\u10d0"),c=h._("\u10d2\u10d0\u10e3\u10e5\u10db\u10d4\u10d1\u10d0"),d=this.props.checkoutOrderConfig,e=null,f=this.$3(),g=d&&d.ordered_product_items;if(f&&f.size){f=f.values().next().value;f=d&&d.itemIDToItem.get(f);e=f&&f.images}else g&&g.length&&(e=g[0].images);f=this.state.variants.filter(function(a){return a}).join(" "+m+" ");g=f?{metaline_1:f}:null;f=this.state.variants;var i=d&&d.variant_labels;f=d&&(!i||i.length===0||f.length>0&&f.every(function(a){return a}));var n={src:d?d.logo:"",width:l,height:l};c=b("React").createElement(b("MNCommerceButton.react"),{className:"_23qd",label:c,onClick:this.$4,use:"default"});c=b("MessengerEnvironment").messengerui?null:c;i=d&&i&&i.length>0;return b("React").createElement("div",{className:"_vg4"},b("React").createElement(b("MNCommerceDialogBody.react"),null,b("React").createElement("div",{className:i?"_vg5":""},b("React").createElement(j,{className:"_vg6",logo:n,logoPosition:"left"}),b("React").createElement("div",{className:"_vg7"},b("React").createElement(k,{imageDimension:60,metalines:g,size:"large",thumbURL:e,title:d&&d.name}))),this.$5()),b("React").createElement(b("MNCommerceDialogFooter.react"),null,c,b("React").createElement(b("MNCommerceButton.react"),{className:"_23qe",disabled:!f,label:a,onClick:this.$6,use:"default"})))};a.prototype.$3=function(a){__p&&__p();var c=this.props.checkoutOrderConfig;if(!c)return null;a=a||this.state.variants;c=c.optionToItems;var d=null;for(var e=0;e<a.length;e++){var f=a[e];if(f){var g=c.get(e);g=g&&g.get(f);!d?d=g:d=b("MNCommerceCheckoutOrderConfigUtils").$7(d,g)}}return d};a.prototype.$8=function(a,b){this.setState(this.$9(a,b))};a.prototype.$10=function(a,c,d){__p&&__p();var e=this.props.checkoutOrderConfig;if(!e)return null;var f=this.state.variants.slice();this.state.variants[a]!==c&&(f[a]=c,f[d]=null);var g=this.$3(f),h=[];a=e.optionToItems;var i=e.itemIDToItem;a.get(d).forEach(function(a,c){a=b("MNCommerceCheckoutOrderConfigUtils").$7(a,g?g:new Set());var d=!1;a.size>0&&(d=b("MNCommerceCheckoutOrderConfigUtils").$11(a,i));h.push({label:c,available:d})},this);return h};a.prototype.$5=function(){var a=this.props.checkoutOrderConfig;if(!a)return null;var c=h._("\u10d0\u10e0\u10e9\u10d4\u10d5\u10d0");a=a.variant_labels.map(function(a,d){return b("React").createElement("div",{key:d},b("React").createElement("div",{className:"_vg8"},c+" "+a),b("React").createElement("div",{className:"_vg9"},this.$12(this.state.variantOptions[d],this.$8.bind(this,d),this.state.variants[d])))}.bind(this));return a};a.propTypes={error:c.object,checkoutOrderConfig:b("MNCommerceCheckoutOrderConfigReactShape"),loading:c.bool.isRequired,onContinue:c.func.isRequired,onTryAgain:c.func,shown:c.bool.isRequired,statusType:c.number};a.defaultProps={shown:!1};var n=function(){__p&&__p();this.$1=function(a){a=a||this.props;a=a.checkoutOrderConfig;return!a?{}:{variantOptions:a.initialVariantOptions,variants:[]}}.bind(this),this.$9=function(a,b){__p&&__p();var c=this.props.checkoutOrderConfig;if(!c)return null;var d=[],e=[],f=c.allVariantOptions[a][b];for(var g=0;g<c.variant_labels.length;g++)if(g===a)d.push(b),e.push(this.state.variantOptions[g]);else{var h=this.state.variants.filter(function(a){return a});c.variant_labels.length<=2||h.length<2?h=f.get(g):h=this.$10(a,b,g);e.push(h);d.push(this.state.variants[g])}return{variants:d,variantOptions:e}}.bind(this),this.$6=function(a){a=this.props.checkoutOrderConfig;if(!a||this.state.variants.some(function(a){return!a}))return;var c=a.seller_id,d=this.state.variants.join(b("MNCommerceCheckoutOrderConfigUtils").DELIMITER);a=a.variantToItemID.get(d);this.props.onContinue(a,c,this.state.variants.join(" "+m+" "));this.props.onToggle(!1)}.bind(this),this.$4=function(a){this.props.onToggle(!1)}.bind(this),this.$12=function(a,c,d){a=a.map(function(a,c){return b("React").createElement(b("MNCommerceCheckoutButton.react"),{key:c,disabled:a.available===!1,use:"default",value:a.label},a.label)});return b("React").createElement(b("XUIRadioButtonGroup.react"),{onValueChange:c,selectedValue:d,selectedUse:"confirm"},a)}};e.exports=a}),null);
__d("XMNCommerceCheckoutOrderConfigController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messages/commerce/checkout_order_config/",{item_id:{type:"String",required:!0},owner_id:{type:"String",required:!0}})}),null);
__d("MNCommerceOrderConfigDataManager",["AsyncRequest","MNCommerceOrderConfigActions","XMNCommerceCheckoutOrderConfigController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a.prototype.fetchItem=function(a,c){a=b("XMNCommerceCheckoutOrderConfigController").getURIBuilder().setString("item_id",a).setString("owner_id",c).getURI();new(b("AsyncRequest"))().setURI(a).setHandler(this.$1).setErrorHandler(this.$2).send()};a.prototype.$1=function(a){b("MNCommerceOrderConfigActions").itemLoaded(a.payload)};a.prototype.$2=function(a){a=a.getRequest().uri.getQueryData();a=a.item_id;b("MNCommerceOrderConfigActions").itemLoadError(a)};function a(){}e.exports=new a()}),null);
__d("MNCommerceOrderConfigStore",["Cache","FluxStore","LoadObject","MessengerDispatcher","MNCommerceActionTypes","MNCommerceCacheTimeoutLimits","MNCommerceCheckoutOrderConfigUtils","MNCommerceOrderConfigDataManager"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("FluxStore"));g=c&&c.prototype;function a(){g.constructor.call(this,b("MessengerDispatcher")),this.$MNCommerceOrderConfigStore1=new(b("Cache"))()}a.prototype.__onDispatch=function(a){__p&&__p();var c=a.type,d=a.item?a.item.id:a.itemID;switch(c){case b("MNCommerceActionTypes").RETAIL_ITEM.LOADED:c=a.item;c=b("MNCommerceCheckoutOrderConfigUtils").addVariantOptions(c);this.$MNCommerceOrderConfigStore1.set(d,b("LoadObject").empty().setValue(c),null,b("MNCommerceCacheTimeoutLimits").SUCCESS_TIMEOUT);this.__emitChange();break;case b("MNCommerceActionTypes").RETAIL_ITEM.LOAD_ERROR:this.$MNCommerceOrderConfigStore1.set(d,b("LoadObject").empty().setError(new Error("Unable to load item: "+d)),null,b("MNCommerceCacheTimeoutLimits").ERROR_TIMEOUT);this.__emitChange();break;case b("MNCommerceActionTypes").RETAIL_ITEM.RELOAD:d&&(this.$MNCommerceOrderConfigStore1.set(d,b("LoadObject").loading()),b("MNCommerceOrderConfigDataManager").fetchItem(d));this.__emitChange();break}};a.prototype.getItem=function(a,c){a&&!this.$MNCommerceOrderConfigStore1.has(a)&&(this.$MNCommerceOrderConfigStore1.set(a,b("LoadObject").loading().setValue({itemID:a})),b("MNCommerceOrderConfigDataManager").fetchItem(a,c));return this.$MNCommerceOrderConfigStore1.get(a)||b("LoadObject").empty()};a.__moduleID=e.id;e.exports=new a()}),null);
__d("MNCommerceCheckoutOrderConfigDialogContainer.react",["BanzaiLogger","MNCommerceDialogStateActions","MNCommerceDialogStateStore","MNCommerceLoggingConstants","MNCommerceLoggerEvents","MNCommerceCheckoutOrderConfigDialog.react","MNCommerceOrderConfigActions","MNCommerceOrderConfigStore","PureStoreBasedStateMixin","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=b("React").createClass({displayName:"MNCommerceCheckoutOrderConfigDialogContainer",mixins:[b("PureStoreBasedStateMixin")(b("MNCommerceOrderConfigStore"))],statics:{calculateState:function(){var a=b("MNCommerceDialogStateStore").getState(),c=null,d=null,e=null;a&&(c=a.itemID,d=a.ownerID,e=a.onContinue);d=b("MNCommerceOrderConfigStore").getItem(c,d);d.isLoading()||b("BanzaiLogger").log("MessengerCommerceLoggerConfig",{event:d.hasError()?b("MNCommerceLoggerEvents").DIALOG_LOAD_ERROR:b("MNCommerceLoggerEvents").DIALOG_LOAD_SUCCESS,debug_data:JSON.stringify({dialog_surface:b("MNCommerceLoggingConstants").DIALOG_SURFACE.CHECKOUT_ORDER_CONFIG,item_id:c})});return{shown:!!a,loading:d.isLoading(),itemID:c,checkoutOrderConfig:d.getValue(),onContinue:e,error:d.getError()}}},render:function(){return b("React").createElement(b("MNCommerceCheckoutOrderConfigDialog.react"),{error:this.state.error,checkoutOrderConfig:this.state.loading?null:this.state.checkoutOrderConfig,loading:this.state.loading,onContinue:this.state.onContinue,onToggle:this._onToggle,onTryAgain:this._onTryAgainClick,shown:this.state.shown})},_onToggle:function(a){a||(b("BanzaiLogger").log("MessengerCommerceLoggerConfig",{event:b("MNCommerceLoggerEvents").DIALOG_CLOSED,debug_data:JSON.stringify({dialog_surface:b("MNCommerceLoggingConstants").DIALOG_SURFACE.CHECKOUT_ORDER_CONFIG,item_id:this.state.itemID})}),b("MNCommerceDialogStateActions").hideDialog())},_onTryAgainClick:function(){b("MNCommerceOrderConfigActions").itemReload(this.state.itemID)}});e.exports=a}),null);
__d("BrowserExtensionsErrorHandler",["errorCode","errorDesc"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a={getExternalError:function(a){__p&&__p();switch(a){case 2018062:return{code:2018062,message:h._(function(a,b){return a._("The URL provided is not whitelisted for messenger extensions")},{})};case 2018067:return{code:2018067,message:h._(function(a,b){return a._("Pages using Messenger Extensions must use https and not include any port.")},{})};case 2018164:return{code:2018164,message:h._(function(a,b){return a._("Please pass in a valid app ID.")},{})};case 2018166:return{code:2018166,message:h._(function(a,b){return a._("Permission not valid to call the SDK API.")},{})};case 2018159:return{code:2018159,message:h._(function(a,b){return a._("Invalid payload were passed to the share flow.")},{})};case 2018160:return{code:2018160,message:h._(function(a,b){return a._("The provided open graph template is not supported.")},{})};case 2018161:return{code:2018161,message:h._(function(a,b){return a._("Open graph URL in the preview content does not match the one in share content.")},{})};case 2018053:return{code:2018053,message:h._(function(a,b){return a._("Element button title cannot be empty.")},{})};case 2018125:return{code:2018125,message:h._(function(a,b){return a._("Invalid URL button fields provided. Please check documentation for details.")},{})};case 2018041:return{code:2018041,message:h._(function(a,b){return a._("Web url cannot be empty for url type button")},{})};case 2018158:return{code:2018158,message:h._(function(a,b){return a._("There was a problem creating the share attachment. Please try again later.")},{})};case 2018142:return{code:2018142,message:h._(function(a,b){return a._("Beginshare parameters are not valid.")},{})};case 2018034:return{code:2018034,message:h._(function(a,b){return a._("Message cannot be empty, must provide valid attachment or text")},{})};case 2018167:return{code:2018167,message:h._(function(a,b){return a._("Another API operation is in progress.")},{})};case 2018012:return{code:2018012,message:h._(function(a,b){return a._("Unexpected internal error")},{})};case 2018162:return{code:2018162,message:h._(function(a,b){return a._("This feature is currently not available")},{})};case 2018154:default:return{code:2018154,message:h._(function(a,b){return a._("Messenger Extensions unexpected error.")},{})}}}};e.exports=a}),null);
__d("MessengerPlatformBeginShareMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLMutationBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1467034453348931"};c.getQueryID=function(){"use strict";return"294980674291966"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("BrowserExtensionsShareChatTabDialog.react",["cx","fbt","AbstractTextArea.react","AsyncRequest","MessengerPlatformBeginShareMutationWebGraphQLMutation","CurrentUser","BrowserExtensionsErrorHandler","Image.react","immutable","MessengerComposeViewHeader.react","MessengerTextWithEntities.react","React","XUIDialogBody.react","XUIDialogButton.react","XUIDialogCancelButton.react","XUIDialogFooter.react","XUIDialogHeader.react","XUIDialogHeaderTitle.react","XUISpinner.react","emptyFunction","idx"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;var j="broadcast";d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={isSending:!1,message:"",recipients:b("immutable").List()},this.$3=function(a){this.setState({recipients:this.state.recipients.push(a)})}.bind(this),this.$4=function(a){var b=this.state.recipients;this.setState({recipients:b["delete"](b.indexOf(a))})}.bind(this),this.$2=function(){this.setState({recipients:b("immutable").List()})}.bind(this),this.$6=function(){__p&&__p();this.setState({isSending:!0});var a=this.state.recipients.map(function(a){return a.getUniqueID()}).toArray();a=b("MessengerPlatformBeginShareMutationWebGraphQLMutation").getURI({content_for_preview:{button_url:this.props.buttonUrl,button_title:this.props.buttonTitle,image_url:this.props.imageUrl,item_url:this.props.itemUrl,open_graph_url:this.props.openGraphUrl,preview_type:this.props.previewType,subtitle:this.props.subtitle,target_display:this.props.targetDisplay,title:this.props.title,attachment_id:this.props.attachmentID,facebook_media_url:this.props.facebookMediaUrl,media_type:this.props.mediaType},content_for_share:this.props.contentForShare,message_text:this.state.message,page_id:this.props.pageID,thread_ids:this.props.sharingType===j?a:this.props.threadID,trigger:this.props.sharingType===j?"JS_BRIDGE_BROADCAST":"JS_BRIDGE_DIRECT"});new(b("AsyncRequest"))(a).setHandler(function(a){this.$1&&this.setState({isSending:!1});a=(a=a)!=null?(a=a.payload)!=null?(a=a.errors)!=null?a[0]:a:a:a;if(a){a=a?a.code:null;this.props.errorCallback(b("BrowserExtensionsErrorHandler").getExternalError(a))}else this.props.successCallback({is_sent:!0})}.bind(this)).send()}.bind(this),c}a.prototype.componentDidMount=function(){this.$1=!0};a.prototype.componentWillUnmount=function(){this.$1=!1};a.prototype.render=function(){var a=this.props.sharingType===j?h._("\u10d2\u10d0\u10d6\u10d8\u10d0\u10e0\u10d4\u10d1\u10d0"):h._("Send To Current Thread"),c=this.props.sharingType===j?this.state.recipients.size!==0:!0,d=this.props.sharingType===j?b("React").createElement(b("MessengerComposeViewHeader.react"),{className:"_189v",forceHideClearButton:!1,onClear:this.$2,onAddRecipient:this.$3,onRemoveRecipient:this.$4,onResize:b("emptyFunction"),recipients:this.state.recipients,viewer:b("CurrentUser").getID()}):null,e=this.props.sharingType===j?b("React").createElement("div",{className:"_4te6"},b("React").createElement(b("AbstractTextArea.react"),{autoFocus:!0,className:"_4te8",disabled:this.state.isSending,onChange:function(a){return this.setState({message:a.target.value})}.bind(this),placeholder:h._("Type a message..."),rows:2,value:this.state.message})):null,f=this.state.isSending?b("React").createElement(b("XUISpinner.react"),{size:"large"}):null,g=this.props.imageUrl?this.props.imageUrl:this.props.facebookMediaPreviewUrl;return b("React").createElement("div",null,b("React").createElement(b("XUIDialogHeader.react"),null,b("React").createElement(b("XUIDialogHeaderTitle.react"),null,a)),b("React").createElement(b("XUIDialogBody.react"),{className:"_189w"},d,e,b("React").createElement("div",{className:"_5l-3"},b("React").createElement("div",{className:"_4tea"},b("React").createElement(b("Image.react"),{src:g})),b("React").createElement("div",{className:"_4tef"},b("React").createElement("div",{style:{fontWeight:"bold"}},this.$5(this.props.title)),b("React").createElement("div",null,this.$5(this.props.subtitle)),b("React").createElement("div",null,this.$5(this.props.targetDisplay))))),b("React").createElement(b("XUIDialogFooter.react"),{leftContent:f},b("React").createElement(b("XUIDialogCancelButton.react"),null),b("React").createElement(b("XUIDialogButton.react"),{action:"confirm",disabled:this.state.isSending||!c,label:h._("\u10d2\u10d0\u10d2\u10d6\u10d0\u10d5\u10dc\u10d0"),onClick:this.$6,use:"default"})))};a.prototype.$5=function(a){return b("React").createElement(b("MessengerTextWithEntities.react"),{renderEmoji:!0,text:a||""})};a.propTypes={buttonTitle:c.string,buttonUrl:c.string,contentForShare:c.string,imageUrl:c.string,itemUrl:c.string,openGraphUrl:c.string,facebookMediaUrl:c.string,facebookMediaPreviewUrl:c.string,attachmentID:c.string,mediaType:c.string,previewType:c.string,subtitle:c.string,targetDisplay:c.string,title:c.string,sharingType:c.string.isRequired,pageID:c.string.isRequired,threadID:c.string.isRequired,successCallback:c.func.isRequired,errorCallback:c.func.isRequired};e.exports=a}),null);
__d("BrowserExtensionsShareMessengerDialog.react",["cx","fbt","AbstractTextArea.react","AsyncRequest","MessengerPlatformBeginShareMutationWebGraphQLMutation","CurrentUser","BrowserExtensionsErrorHandler","Image.react","immutable","LayerFadeOnHide","MessengerComposeViewHeader.react","MessengerDialog.react","MessengerDialogs.bs","MessengerDialogBodyReact.bs","MessengerDialogButton.react","MessengerDialogCancelButton.react","MessengerDialogFooter.react","MessengerDialogHeader.react","MessengerDialogTitle.react","MessengerSpinner.react","MessengerTextWithEntities.react","React","emptyFunction","idx"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("MessengerDialogBodyReact.bs").jsComponent;c=b("React").PropTypes;var k="broadcast";d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={clickedSend:!1,isSending:!1,message:"",recipients:b("immutable").List()},this.$3=function(a){this.setState({recipients:this.state.recipients.push(a)})}.bind(this),this.$4=function(a){var b=this.state.recipients;this.setState({recipients:b["delete"](b.indexOf(a))})}.bind(this),this.$2=function(){this.setState({recipients:b("immutable").List()})}.bind(this),this.$7=function(){__p&&__p();this.setState({clickedSend:!0,isSending:!0});var a=this.state.recipients.map(function(a){return a.getUniqueID()}).toArray();a=b("MessengerPlatformBeginShareMutationWebGraphQLMutation").getURI({content_for_preview:{button_url:this.props.buttonUrl,button_title:this.props.buttonTitle,image_url:this.props.imageUrl,item_url:this.props.itemUrl,open_graph_url:this.props.openGraphUrl,preview_type:this.props.previewType,subtitle:this.props.subtitle,target_display:this.props.targetDisplay,title:this.props.title,attachment_id:this.props.attachmentID,facebook_media_url:this.props.facebookMediaUrl,media_type:this.props.mediaType},content_for_share:this.props.contentForShare,message_text:this.state.message,page_id:this.props.pageID,thread_ids:this.props.sharingType===k?a:this.props.threadID,trigger:this.props.sharingType===k?"JS_BRIDGE_BROADCAST":"JS_BRIDGE_DIRECT"});new(b("AsyncRequest"))(a).setHandler(function(a){this.$1&&this.setState({isSending:!1},function(){b("MessengerDialogs.bs").removeDialog()});a=(a=a)!=null?(a=a.payload)!=null?(a=a.errors)!=null?a[0]:a:a:a;if(a){a=a?a.code:null;this.props.errorCallback(b("BrowserExtensionsErrorHandler").getExternalError(a))}else this.props.successCallback({is_sent:!0})}.bind(this)).send()}.bind(this),this.$5=function(a){a||(this.state.clickedSend||this.props.successCallback({is_sent:!1}),b("MessengerDialogs.bs").removeDialog())}.bind(this),c}a.prototype.componentDidMount=function(){this.$1=!0};a.prototype.componentWillUnmount=function(){this.$1=!1};a.prototype.render=function(){var a=this.props.sharingType===k?h._("\u10d2\u10d0\u10d6\u10d8\u10d0\u10e0\u10d4\u10d1\u10d0"):h._("Send To Current Thread"),c=this.props.sharingType===k?this.state.recipients.size!==0:!0,d=this.props.sharingType===k?b("React").createElement(b("MessengerComposeViewHeader.react"),{className:"_189v",forceHideClearButton:!1,onClear:this.$2,onAddRecipient:this.$3,onRemoveRecipient:this.$4,onResize:b("emptyFunction"),recipients:this.state.recipients,viewer:b("CurrentUser").getID()}):null,e=this.props.sharingType===k?b("React").createElement("div",{className:"_4te6"},b("React").createElement(b("AbstractTextArea.react"),{autoFocus:!0,className:"_4te8",disabled:this.state.isSending,onChange:function(a){return this.setState({message:a.target.value})}.bind(this),placeholder:h._("Type a message..."),rows:2,value:this.state.message})):null,f=this.state.isSending?b("React").createElement(b("MessengerSpinner.react"),null):null,g=this.props.imageUrl?this.props.imageUrl:this.props.facebookMediaPreviewUrl;return b("React").createElement(b("MessengerDialog.react"),{behaviors:{LayerFadeOnHide:b("LayerFadeOnHide")},hideOnEscape:!0,onToggle:this.$5,shown:!0,width:500},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogTitle.react"),null,a)),b("React").createElement(j,{className:"_189w"},d,e,b("React").createElement("div",{className:"_5l-3"},b("React").createElement("div",{className:"_4tea"},b("React").createElement(b("Image.react"),{src:g})),b("React").createElement("div",{className:"_4tef"},b("React").createElement("div",{style:{fontWeight:"bold"}},this.$6(this.props.title)),b("React").createElement("div",null,this.$6(this.props.subtitle)),b("React").createElement("div",null,this.$6(this.props.targetDisplay))))),b("React").createElement(b("MessengerDialogFooter.react"),{leftContent:f},b("React").createElement(b("MessengerDialogCancelButton.react"),null),b("React").createElement(b("MessengerDialogButton.react"),{action:"confirm",disabled:this.state.isSending||!c,label:h._("\u10d2\u10d0\u10d2\u10d6\u10d0\u10d5\u10dc\u10d0"),onClick:this.$7,type:"primary"})))};a.prototype.$6=function(a){return b("React").createElement(b("MessengerTextWithEntities.react"),{renderEmoji:!0,text:a||""})};a.propTypes={buttonTitle:c.string,buttonUrl:c.string,contentForShare:c.string,imageUrl:c.string,itemUrl:c.string,openGraphUrl:c.string,facebookMediaUrl:c.string,facebookMediaPreviewUrl:c.string,attachmentID:c.string,mediaType:c.string,previewType:c.string,subtitle:c.string,targetDisplay:c.string,title:c.string,sharingType:c.string.isRequired,pageID:c.string.isRequired,threadID:c.string.isRequired,successCallback:c.func.isRequired,errorCallback:c.func.isRequired};e.exports=a}),null);
__d("MessengerPlatformMediaAttachmentPreviewWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLQueryBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1480172682071484"};c.getQueryID=function(){"use strict";return"1145458142265315"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("BrowserExtensionsBeginShareHelper",["AsyncRequest","BrowserExtensionsErrorHandler","BrowserExtensionsShareChatTabDialog.react","BrowserExtensionsShareMessengerDialog.react","DialogX","LayerDestroyOnHide","LayerFadeOnHide","LayerHideOnBlur","MessengerDialogs.bs","MessengerEnvironment","MessengerPlatformMediaAttachmentPreviewWebGraphQLQuery","React","WebGraphQL","XShareScrapeAttachmentAsyncController","idx","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="OPEN_GRAPH",h=150,i=150;function j(a,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){b("MessengerEnvironment").messengerui?b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(b("BrowserExtensionsShareMessengerDialog.react"),{buttonTitle:a,buttonUrl:c,contentForShare:d,imageUrl:e,itemUrl:f,openGraphUrl:g,facebookMediaUrl:h,facebookMediaPreviewUrl:i,attachmentID:j,mediaType:k,previewType:l,subtitle:m,targetDisplay:n,title:o,sharingType:p,pageID:q,threadID:r,successCallback:s,errorCallback:t})}):(function(){var u={width:500,addedBehaviors:[b("LayerDestroyOnHide"),b("LayerFadeOnHide"),b("LayerHideOnBlur")]},v=b("React").createElement(b("BrowserExtensionsShareChatTabDialog.react"),{buttonTitle:a,buttonUrl:c,contentForShare:d,imageUrl:e,itemUrl:f,openGraphUrl:g,facebookMediaUrl:h,facebookMediaPreviewUrl:i,attachmentID:j,mediaType:k,previewType:l,subtitle:m,targetDisplay:n,title:o,sharingType:p,pageID:q,threadID:r,successCallback:s,errorCallback:t}),w=new(b("DialogX"))(u,v);w.subscribe("confirm",function(){w.hide()});w.subscribe("cancel",function(){s({is_sent:!1})});w.show()})()}a={beginShareFlow:function(a,c,d,e,f,k,l){__p&&__p();if(f.preview_type===g){var m=b("XShareScrapeAttachmentAsyncController").getURIBuilder().getURI();new(b("AsyncRequest"))().setMethod("POST").setURI(m).setData({image_height:h,image_width:i,uri:f.open_graph_url}).setHandler(function(b){var g,h;g=(g=b)!=null?(g=g.payload)!=null?(g=g.media)!=null?g.image:g:g:g;h=(h=b)!=null?(h=h.payload)!=null?h.title:h:h;b=(b=b)!=null?(b=b.payload)!=null?(b=b.target)!=null?(b=b.artists)!=null?b[0]:b:b:b:b;j(f.button_title,f.button_url,e,g,f.item_url,f.open_graph_url,null,null,null,null,f.preview_type,b,f.target_display,h,d,a,c,k,l)}).send()}else!f.image_url?b("promiseDone")(b("WebGraphQL").exec(new(b("MessengerPlatformMediaAttachmentPreviewWebGraphQLQuery"))({params:{attachment_id:f.attachment_id,page_id:a,url:f.facebook_media_url,media_type:f.media_type}})),function(b){b=b.messenger_platform_media_attachment_preview_info;j(f.button_title,f.button_url,e,null,f.item_url,f.open_graph_url,f.facebook_media_url,b.media_attachment.image.uri,f.attachment_id,f.media_type,f.preview_type,f.subtitle,f.target_display,f.title,d,a,c,k,l)},function(a){a=(a=a)!=null?(a=a.errors)!=null?(a=a[0])!=null?a.code:a:a:a;l(b("BrowserExtensionsErrorHandler").getExternalError(a))}):j(f.button_title,f.button_url,e,f.image_url,f.item_url,f.open_graph_url,f.facebook_media_url,null,f.attachment_id,f.media_type,f.preview_type,f.subtitle,f.target_display,f.title,d,a,c,k,l)}};e.exports=a}),null);
__d("BrowserExtensionsAskPermissionsChatTabDialog.react",["cx","BrowserExtensionsTypedLogger","BrowserExtensionsPermissionsHelper","Image.react","React","URI","XUIDialogBody.react","XUIDialogButton.react","XUIDialogFooter.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement("div",null,b("React").createElement(b("XUIDialogBody.react"),null,b("React").createElement("div",null,b("React").createElement(b("Image.react"),{className:"_5_jw",src:this.props.profileImageUrl})),this.props.message),b("React").createElement(b("XUIDialogFooter.react"),null,b("React").createElement(b("XUIDialogButton.react"),{action:"cancel",label:this.props.rejectButtonTitle,onClick:function(){this.$1(!1)}.bind(this)}),b("React").createElement(b("XUIDialogButton.react"),{action:"cancel",label:this.props.confirmButtonTitle,onClick:function(){this.$1(!0),b("BrowserExtensionsPermissionsHelper").grantPermissions(this.props.pageID,this.props.threadID,this.props.permissionToGrant,this.props.successCallback,this.props.errorCallback)}.bind(this),use:"confirm"})))};a.prototype.$1=function(a){new(b("BrowserExtensionsTypedLogger"))().setAPIEndpoint("askPermission").setExtraClientData(JSON.stringify({source:"platform_api",extension_type:"messenger_extension",permission_requested:this.props.permissionToGrant,permission_accepted:a})).setName("browser_extensions_permission_dialog_action").setWebsiteURL(this.props.thirdPartyURI.toString()).setStartURL(this.props.thirdPartyURI.toString()).setStringPageID(this.props.pageID).setThreadID(this.props.threadID).log()};function a(){h.apply(this,arguments)}a.propTypes={thirdPartyURI:c.instanceOf(b("URI")).isRequired,pageID:c.string.isRequired,threadID:c.string.isRequired,message:c.string.isRequired,profileImageUrl:c.string.isRequired,confirmButtonTitle:c.string.isRequired,rejectButtonTitle:c.string.isRequired,permissionToGrant:c.string.isRequired,successCallback:c.func.isRequired,errorCallback:c.func.isRequired};e.exports=a}),null);
__d("BrowserExtensionsAskPermissionsMessengerDialog.react",["cx","BrowserExtensionsPermissionsHelper","BrowserExtensionsTypedLogger","Image.react","LayerFadeOnHide","MessengerDialog.react","MessengerDialogs.bs","MessengerDialogBodyReact.bs","MessengerDialogButton.react","MessengerDialogCancelButton.react","MessengerDialogFooter.react","React","URI"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("MessengerDialogBodyReact.bs").jsComponent;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={clickedConfirm:!1},this.$1=function(a){a||(this.state.clickedConfirm||this.props.successCallback({permissions:this.props.grantedPermissions}),b("MessengerDialogs.bs").removeDialog())}.bind(this),c}a.prototype.render=function(){return b("React").createElement(b("MessengerDialog.react"),{behaviors:{LayerFadeOnHide:b("LayerFadeOnHide")},hideOnEscape:!0,onToggle:this.$1,shown:!0},b("React").createElement(i,null,b("React").createElement("div",null,b("React").createElement(b("Image.react"),{className:"_5_jw",src:this.props.profileImageUrl})),this.props.message),b("React").createElement(b("MessengerDialogFooter.react"),null,b("React").createElement(b("MessengerDialogCancelButton.react"),{label:this.props.rejectButtonTitle,onClick:function(){this.$2(!1)}.bind(this)}),b("React").createElement(b("MessengerDialogButton.react"),{action:"confirm",label:this.props.confirmButtonTitle,onClick:function(){this.setState({clickedConfirm:!0},function(){this.$2(!0),b("MessengerDialogs.bs").removeDialog(),b("BrowserExtensionsPermissionsHelper").grantPermissions(this.props.pageID,this.props.threadID,this.props.permissionToGrant,this.props.successCallback,this.props.errorCallback)}.bind(this))}.bind(this),type:"primary"})))};a.prototype.$2=function(a){new(b("BrowserExtensionsTypedLogger"))().setAPIEndpoint("askPermission").setExtraClientData(JSON.stringify({source:"platform_api",extension_type:"messenger_extension",permission_requested:this.props.permissionToGrant,permission_accepted:a})).setName("browser_extensions_permission_dialog_action").setWebsiteURL(this.props.thirdPartyURI.toString()).setStartURL(this.props.thirdPartyURI.toString()).setStringPageID(this.props.pageID).setThreadID(this.props.threadID).log()};a.propTypes={thirdPartyURI:c.instanceOf(b("URI")).isRequired,pageID:c.string.isRequired,threadID:c.string.isRequired,message:c.string.isRequired,profileImageUrl:c.string.isRequired,confirmButtonTitle:c.string.isRequired,rejectButtonTitle:c.string.isRequired,permissionToGrant:c.string.isRequired,grantedPermissions:c.arrayOf(c.string).isRequired,successCallback:c.func.isRequired,errorCallback:c.func.isRequired};e.exports=a}),null);
__d("MessengerPlatformGrantPermissionsMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLMutationBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1544630875548192"};c.getQueryID=function(){"use strict";return"611085139087610"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("MessengerPlatformPermissionWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLQueryBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1068951296538364"};c.getQueryID=function(){"use strict";return"1526731417350771"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("BrowserExtensionsPermissionsHelper",["AsyncRequest","BrowserExtensionsAskPermissionsChatTabDialog.react","BrowserExtensionsAskPermissionsMessengerDialog.react","BrowserExtensionsTypedLogger","DialogX","BrowserExtensionsErrorHandler","MessengerPlatformGrantPermissionsMutationWebGraphQLMutation","LayerDestroyOnHide","LayerFadeOnHide","LayerHideOnBlur","MessengerDialogs.bs","MessengerEnvironment","MessengerPlatformPermissionWebGraphQLQuery","React","idx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a,c,d,e,f,g,h,i,j,k,l){__p&&__p();b("MessengerEnvironment").messengerui?b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(b("BrowserExtensionsAskPermissionsMessengerDialog.react"),{thirdPartyURI:a,pageID:c,threadID:d,message:e,profileImageUrl:f,confirmButtonTitle:g,rejectButtonTitle:h,permissionToGrant:i,grantedPermissions:j,successCallback:k,errorCallback:l})}):(function(){var m={width:400,addedBehaviors:[b("LayerDestroyOnHide"),b("LayerFadeOnHide"),b("LayerHideOnBlur")]},n=b("React").createElement(b("BrowserExtensionsAskPermissionsChatTabDialog.react"),{thirdPartyURI:a,pageID:c,threadID:d,message:e,profileImageUrl:f,confirmButtonTitle:g,rejectButtonTitle:h,permissionToGrant:i,successCallback:k,errorCallback:l});m=new(b("DialogX"))(m,n);var o=!1;m.subscribe("confirm",function(){o=!0});m.subscribe("hide",function(){o||k({permissions:j})});m.show()})(),new(b("BrowserExtensionsTypedLogger"))().setAPIEndpoint("askPermission").setName("browser_extensions_permission_dialog_shown").setWebsiteURL(a.toString()).setStartURL(a.toString()).setStringPageID(c).setThreadID(d).log()}a={askPermissions:function(a,c,d,e,f,h){__p&&__p();var i=b("MessengerPlatformPermissionWebGraphQLQuery").getURI({params:{page_id:c,thread_id:d},selected_permissions:[e]});new(b("AsyncRequest"))().setURI(i).setHandler(function(i){__p&&__p();var j,k;j=(j=i)!=null?(j=j.payload)!=null?(j=j.data)!=null?(j=j.messenger_platform_permission)!=null?(j=j.selected_permission_infos)!=null?j[0]:j:j:j:j:j;k=(k=i)!=null?(k=k.payload)!=null?(k=k.data)!=null?(k=k.messenger_platform_permission)!=null?k.granted_permission_infos:k:k:k:k;i=(i=i)!=null?(i=i.payload)!=null?(i=i.errors)!=null?i[0]:i:i:i;if(!k){i=i?i.code:null;h(b("BrowserExtensionsErrorHandler").getExternalError(i))}else{i=k.map(function(a){return a.permission_type});if(!j||j.is_granted)f({permissions:i});else{k=j.dialog_info;g(a,c,d,k.title,k.profile_image.uri,k.confirm_button_text,k.reject_button_text,e,i,f,h)}}}).send()},grantPermissions:function(a,c,d,e,f){__p&&__p();a=b("MessengerPlatformGrantPermissionsMutationWebGraphQLMutation").getURI({page_id:a,thread_id:c,permissions:[d]});new(b("AsyncRequest"))().setURI(a).setHandler(function(a){__p&&__p();var c;c=(c=a)!=null?(c=c.payload)!=null?(c=c.data)!=null?(c=c.messenger_platform_grant_permissions)!=null?c.granted_permission_infos:c:c:c:c;a=(a=a)!=null?(a=a.payload)!=null?(a=a.errors)!=null?a[0]:a:a:a;if(c){c=c.map(function(a){return a.permission_type});e({permissions:c})}else{c=a?a.code:null;f(b("BrowserExtensionsErrorHandler").getExternalError(c))}}).send()}};e.exports=a}),null);
__d("MessengerPlatformGetContextMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLMutationBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1350985785027565"};c.getQueryID=function(){"use strict";return"182243942324918"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("WorkChatPlatformGetContextMutationWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLMutationBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1471152822996828"};c.getQueryID=function(){"use strict";return"172454613443187"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("BrowserExtensionsDesktopController",["errorCode","AsyncRequest","BrowserExtensionsBeginShareHelper","BrowserExtensionsPermissionsHelper","BrowserExtensionsTypedLogger","CurrentUser","DOMEventListener","BrowserExtensionsErrorHandler","MessengerPlatformGetContextMutationWebGraphQLMutation","WorkChatPlatformGetContextMutationWebGraphQLMutation","JSONRPC","MessengerPlatformPermissionWebGraphQLQuery","idx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h="MESSENGER_EXTENSIONS_RPC:";function i(a,c,d,e,f,g,h){__p&&__p();e=b("CurrentUser").isWorkUser()?b("WorkChatPlatformGetContextMutationWebGraphQLMutation").getURI({actor_id:e,app_id:f,page_id:c,thread_id:d,extension_uri:a.getOrigin()}):b("MessengerPlatformGetContextMutationWebGraphQLMutation").getURI({actor_id:e,app_id:f,page_id:c,thread_id:d,extension_uri:a.getOrigin()});new(b("AsyncRequest"))().setURI(e).setHandler(function(a){var c;c=(c=a)!=null?(c=c.payload)!=null?(c=c.data)!=null?c.messenger_platform_get_context:c:c:c;a=(a=a)!=null?(a=a.payload)!=null?(a=a.errors)!=null?a[0]:a:a:a;if(c)g(c);else{c=a?a.code:null;h(b("BrowserExtensionsErrorHandler").getExternalError(c))}}).send()}function j(a,c,d,e){__p&&__p();a=b("MessengerPlatformPermissionWebGraphQLQuery").getURI({params:{page_id:a,thread_id:c}});new(b("AsyncRequest"))().setURI(a).setHandler(function(a){__p&&__p();var c;c=(c=a)!=null?(c=c.payload)!=null?(c=c.data)!=null?(c=c.messenger_platform_permission)!=null?c.granted_permission_infos:c:c:c:c;a=(a=a)!=null?(a=a.payload)!=null?(a=a.errors)!=null?a[0]:a:a:a;if(c){c=c.map(function(a){return a.permission_type});d({permissions:c})}else{c=a?a.code:null;e(b("BrowserExtensionsErrorHandler").getExternalError(c))}}).send()}function k(a,b,c){a(b)}function a(a,c,d,e,f,g){__p&&__p();var l=new(b("JSONRPC"))(function(b){var d=a instanceof HTMLIFrameElement?a.contentWindow:a;d.postMessage(h+b,c.getOrigin())});this.$1=b("DOMEventListener").add(window,"message",function(event){if(typeof event.data!=="string"||!event.data.startsWith(h))return;l.read(event.data.substring(h.length))},!1);function m(a){new(b("BrowserExtensionsTypedLogger"))().setAPIEndpoint(a).setName("browser_extensions_native_bridge_called").setWebsiteURL(c.toString()).setStartURL(c.toString()).setStringPageID(d).setThreadID(e).log()}l.local.askPermission=function(a,f,g){if(b("CurrentUser").isWorkUser()){g(b("BrowserExtensionsErrorHandler").getExternalError(2018162));return}m("askPermission");b("BrowserExtensionsPermissionsHelper").askPermissions(c,d,e,a,f,g)};l.local.beginShareFlow=function(a,c,f,g,h){m("beginShareFlow"),b("BrowserExtensionsBeginShareHelper").beginShareFlow(d,e,a,c,f,g,h)};l.local.getContext=function(a,b,g){m("getContext"),i(c,d,e,f,a,b,g)};l.local.getGrantedPermissions=function(a,b){m("getGrantedPermissions"),j(d,e,a,b)};l.local.requestCloseBrowser=function(a,b){m("requestCloseBrowser"),k(g,a,b)}}a.prototype.getListener=function(){return this.$1};e.exports=a}),null);
__d("BrowserExtensionsDesktopCoordinator",["BrowserExtensionsDesktopController"],(function(a,b,c,d,e,f){"use strict";var g=void 0;a={setActiveBridge:function(a,c,d,e,f,h){g&&g.remove();a=new(b("BrowserExtensionsDesktopController"))(a,c,d,e,f,h);g=a.getListener()}};e.exports=a}),null);
__d("BrowserExtensionsIframe.react",["BrowserExtensionsDesktopCoordinator","BrowserExtensionsTypedLogger","ControlledRefererIFrame.react","React","URI","isFacebookURI"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.componentDidMount=function(){this.refs.iframeRef&&(b("BrowserExtensionsDesktopCoordinator").setActiveBridge(this.refs.iframeRef,this.props.thirdPartyURI,this.props.pageID,this.props.threadID,this.props.userID,this.props.closeDialogHandler),new(b("BrowserExtensionsTypedLogger"))().setName("browser_extensions_browser_open").setWebsiteURL(this.props.thirdPartyURI.toString()).setStartURL(this.props.thirdPartyURI.toString()).setStringPageID(this.props.pageID).setThreadID(this.props.threadID).log())};a.prototype.componentWillUnmount=function(){new(b("BrowserExtensionsTypedLogger"))().setName("browser_extensions_browser_closed").setWebsiteURL(this.props.thirdPartyURI.toString()).setStartURL(this.props.thirdPartyURI.toString()).setStringPageID(this.props.pageID).setThreadID(this.props.threadID).log()};a.prototype.render=function(){var a=new(b("URI"))(window.location.href),c=this.props.thirdPartyURI;a={ref:"iframeRef",src:c.addQueryData("fb_iframe_origin",a.getOrigin()).toString(),name:b("isFacebookURI")(a)?"facebook_ref":"messenger_ref",style:{border:0,height:this.props.height,width:this.props.width}};return b("isFacebookURI")(c)?b("React").createElement("iframe",a):b("React").createElement(b("ControlledRefererIFrame.react"),a)};function a(){g.apply(this,arguments)}a.propTypes={thirdPartyURI:c.instanceOf(b("URI")).isRequired,pageID:c.string.isRequired,threadID:c.string.isRequired,userID:c.string.isRequired,height:c.number.isRequired,width:c.number.isRequired,closeDialogHandler:c.func.isRequired};e.exports=a}),null);
__d("MessengerPageInfoWebGraphQLQuery",["WebGraphQLQueryBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLQueryBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1340699622714874"};c.getQueryID=function(){"use strict";return"794225320759977"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("BrowserExtensionsChatTabDialog.react",["cx","fbt","MessengerConstants","AsyncRequest","BrowserExtensionsIframe.react","Image.react","MessengerPageInfoWebGraphQLQuery","React","URI","XUICloseButton.react","XUIDialogBody.react","idx"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("MessengerConstants").BROWSER_EXTENSIONS_DIALOG_DIMENSIONS;d=b("React").PropTypes;f=babelHelpers.inherits(a,b("React").Component);i=f&&f.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={profilePicUrl:null,title:null},b}a.prototype.componentDidMount=function(){var a=b("MessengerPageInfoWebGraphQLQuery").getURI({node_id:this.props.pageID});new(b("AsyncRequest"))().setURI(a).setHandler(function(a){var b;b=(b=a)!=null?(b=b.payload)!=null?(b=b.data)!=null?(b=b.node)!=null?(b=b.profile_picture)!=null?b.uri:b:b:b:b:b;a=(a=a)!=null?(a=a.payload)!=null?(a=a.data)!=null?(a=a.node)!=null?a.name:a:a:a:a;this.setState({profilePicUrl:b,title:a})}.bind(this)).send()};a.prototype.render=function(){return b("React").createElement("div",null,b("React").createElement("div",{className:"_4-i0"},b("React").createElement("div",{className:"_5l-3 _3qur"},b("React").createElement("div",{className:"_3o_f"},b("React").createElement(b("Image.react"),{className:"_3o_g",src:this.state.profilePicUrl})),b("React").createElement("div",{className:"_3o_i"},this.state.title),b("React").createElement("div",{className:"_3qus"},b("React").createElement(b("XUICloseButton.react"),{className:"layerCancel _51-t",label:h._("\u10d3\u10d0\u10ee\u10e3\u10e0\u10d5\u10d0")})))),b("React").createElement(b("XUIDialogBody.react"),{className:"_3o_l"},b("React").createElement(b("BrowserExtensionsIframe.react"),{thirdPartyURI:this.props.thirdPartyURI,pageID:this.props.pageID,threadID:this.props.threadID,userID:this.props.userID,height:this.props.height,width:this.props.width,closeDialogHandler:this.props.closeDialogHandler})))};a.defaultProps={height:c.HEIGHT,width:c.WIDTH};a.propTypes={thirdPartyURI:d.instanceOf(b("URI")).isRequired,pageID:d.string.isRequired,threadID:d.string.isRequired,userID:d.string.isRequired,height:d.number,width:d.number,closeDialogHandler:d.func.isRequired};e.exports=a}),null);
__d("BrowserExtensionsMessengerDialog.react",["cx","MessengerConstants","AsyncRequest","BrowserExtensionsIframe.react","Image.react","LayerFadeOnHide","MessengerDialog.react","MessengerDialogs.bs","MessengerDialogBodyReact.bs","MessengerDialogButton.react","MessengerDialogHeader.react","MessengerPageInfoWebGraphQLQuery","React","URI","idx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("MessengerConstants").BROWSER_EXTENSIONS_DIALOG_DIMENSIONS;var i=b("MessengerDialogBodyReact.bs").jsComponent;d=b("React").PropTypes;f=babelHelpers.inherits(a,b("React").Component);h=f&&f.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={profilePicUrl:null,title:null,shown:!0},this.$3=function(a){this.setState({shown:!1},a)}.bind(this),b}a.prototype.componentDidMount=function(){var a=b("MessengerPageInfoWebGraphQLQuery").getURI({node_id:this.props.pageID});this.$1=new(b("AsyncRequest"))().setURI(a).setHandler(function(a){var b;b=(b=a)!=null?(b=b.payload)!=null?(b=b.data)!=null?(b=b.node)!=null?(b=b.profile_picture)!=null?b.uri:b:b:b:b:b;a=(a=a)!=null?(a=a.payload)!=null?(a=a.data)!=null?(a=a.node)!=null?a.name:a:a:a:a;this.setState({profilePicUrl:b,title:a})}.bind(this));this.$1.send()};a.prototype.componentWillUnmount=function(){this.$1&&this.$1.abandon()};a.prototype.render=function(){return b("React").createElement(b("MessengerDialog.react"),{behaviors:{LayerFadeOnHide:b("LayerFadeOnHide")},hideOnEscape:!0,onToggle:this.$2,shown:this.state.shown,type:"default",width:this.props.width},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement("div",{className:"_5l-3 _3o_e"},b("React").createElement("div",{className:"_3o_f"},b("React").createElement(b("Image.react"),{className:"_3o_g",src:this.state.profilePicUrl})),b("React").createElement("div",{className:"_3o_i"},this.state.title),b("React").createElement("div",{className:"_3o_f"},b("React").createElement(b("MessengerDialogButton.react"),{action:"cancel",className:"_3o_k",label:"",type:"primary",use:"default"})))),b("React").createElement(i,{className:"_3o_l"},b("React").createElement(b("BrowserExtensionsIframe.react"),{thirdPartyURI:this.props.thirdPartyURI,pageID:this.props.pageID,threadID:this.props.threadID,userID:this.props.userID,height:this.props.height,width:this.props.width,closeDialogHandler:this.$3})))};a.prototype.$2=function(a){a||b("MessengerDialogs.bs").removeDialog()};a.defaultProps={height:c.HEIGHT,width:c.WIDTH};a.propTypes={thirdPartyURI:d.instanceOf(b("URI")).isRequired,pageID:d.string.isRequired,threadID:d.string.isRequired,userID:d.string.isRequired,height:d.number,width:d.number};e.exports=a}),null);
__d("BrowserExtensionsDialog",["MessengerConstants","BrowserExtensionsChatTabDialog.react","BrowserExtensionsMessengerDialog.react","DialogX","LayerDestroyOnHide","LayerFadeOnHide","LayerHideOnBlur","MessengerDialogs.bs","MessengerEnvironment","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("MessengerConstants").BROWSER_EXTENSIONS_DIALOG_DIMENSIONS,h={show:function(a,c,d,e){b("MessengerEnvironment").messengerui?b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(b("BrowserExtensionsMessengerDialog.react"),{thirdPartyURI:a,pageID:c,threadID:d,userID:e})}):(function(){var f=void 0,i={width:g.WIDTH,addedBehaviors:[b("LayerDestroyOnHide"),b("LayerFadeOnHide"),b("LayerHideOnBlur")]},j=b("React").createElement(b("BrowserExtensionsChatTabDialog.react"),{thirdPartyURI:a,pageID:c,threadID:d,userID:e,closeDialogHandler:function(a){return h.hideChatTabDialog(f,a)}});f=new(b("DialogX"))(i,j);f.show()})()},hideChatTabDialog:function(a,b){a&&(a.hide(),b())}};e.exports=h}),null);
__d("FBPaymentsSerializableCheckoutConfigurationParser",["FBPaymentsContentConfigurationParser"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={parse:function(a,b){a=JSON.parse(a);return this._parseCheckoutConfiguration(a.checkout_configuration,!!b)},_parseCheckoutConfiguration:function(a,c){c={version:a.version,paymentInfo:this._parsePaymentInfo(a.payment_info),contentConfiguration:b("FBPaymentsContentConfigurationParser").parse(a.version,a.content_configuration,c),orderStatusModel:this._parseOrderStatusModel(a.order_status_model)};return c},_parsePaymentInfo:function(a){a={paymentItemType:a.payment_item_type,receiverId:a.receiver_id,orderId:a.order_id,action:a.action,extraData:a.extra_data};return a},_parseOrderStatusModel:function(a){a={type:a.type};return a}};e.exports=a}),null);
__d("GraphQLMessengerPlatformCtaPostHandlingWebGraphQLMutation",["WebGraphQLMutationBase"],(function(a,b,c,d,e,f){"use strict";__p&&__p();e.exports=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("WebGraphQLMutationBase"));a&&a.prototype;c.__getDocID=function(){"use strict";return"1570574486349284"};c.getQueryID=function(){"use strict";return"389945858066688"};function c(){"use strict";a.apply(this,arguments)}return c}()}),null);
__d("XMNCommerceCTAPostProcessController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messages/commerce/cta/postprocess/",{cta_id:{type:"String",required:!0},message_id:{type:"String"}})}),null);
__d("MNCommerceCTAProcessor",["AsyncRequest","GraphQLMessengerPlatformCtaPostHandlingWebGraphQLMutation","PopupWindow","XMNCommerceCTAPostProcessController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a.prototype.process=function(a){var c=arguments.length<=1||arguments[1]===undefined?null:arguments[1],d=b("PopupWindow").open("",500,1024),e=b("XMNCommerceCTAPostProcessController").getURIBuilder().setString("cta_id",a).setString("message_id",c).getURI();new(b("AsyncRequest"))().setURI(e).setMethod("POST").setHandler(function(a){return d.location=a.payload}).send()};a.prototype.postHandle=function(a,c){a=b("GraphQLMessengerPlatformCtaPostHandlingWebGraphQLMutation").getURI({cta_id:a,message_id:c});new(b("AsyncRequest"))().setURI(a).send()};function a(){}e.exports=new a()}),null);
__d("MNCommerceCallToActionGenericIntentHandler",["cx","fbt","Link.react","MNCommerceCTAProcessor","React","Tooltip","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();function a(){this.fallbackOnClick=function(){},this.onClickHook=function(){},this.threadID=null}a.prototype.setFallbackOnClick=function(a){this.fallbackOnClick=a;return this};a.prototype.setThreadID=function(a){a&&(this.threadID=a);return this};a.prototype.setOnClickHook=function(a){this.onClickHook=a;return this};a.prototype.renderForWebLink=function(a,c){var d=a.onClick||this.fallbackOnClick,e=function(event){this.onClickHook(),d(event),b("MNCommerceCTAProcessor").postHandle(a.id,null)}.bind(this);return b("React").createElement(b("Link.react"),{className:c,href:a.onClick?null:a.action_link||a.action_url,key:a.title+a.id,onClick:e,target:"_blank"},a.translated_title||a.title||a.action_title)};a.prototype.renderForNativeLink=function(a,c){var d=h._("To use this feature, use the Messenger app.");return b("React").createElement("div",babelHelpers["extends"]({className:b("joinClasses")("_3cno",c),"data-tooltip-alignh":"center","data-tooltip-position":"above",key:a.title},b("Tooltip").propsFor(d)),a.translated_title||a.title||a.action_title)};e.exports=a}),null);
__d("BuyOnMessengerCallToActionIntentHandler",["Link.react","MNCommerceCallToActionGenericIntentHandler","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("MNCommerceCallToActionGenericIntentHandler"));g&&g.prototype;a.prototype.renderForWebLink=function(a,b){return this.$BuyOnMessengerCallToActionIntentHandler1(a,b)};a.prototype.renderForNativeLink=function(a,b){return this.$BuyOnMessengerCallToActionIntentHandler1(a,b)};a.prototype.$BuyOnMessengerCallToActionIntentHandler1=function(a,c){return b("React").createElement(b("Link.react"),{className:c,key:a.title+a.id,onClick:a.onClick},a.translated_title||a.title)};function a(){g.apply(this,arguments)}e.exports=new a()}),null);
__d("MMeCallToActionIntentHandler",["MNCommerceCallToActionGenericIntentHandler"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("MNCommerceCallToActionGenericIntentHandler"));g&&g.prototype;a.prototype.renderForNativeLink=function(a,b){return this.renderForWebLink(a,b)};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("MNCommerceCallToActionAsyncIntentHandler",["AsyncRequest","Link.react","MNCommerceCallToActionGenericIntentHandler","React"],(function(a,b,c,d,e,f){__p&&__p();var g;g=babelHelpers.inherits(a,b("MNCommerceCallToActionGenericIntentHandler"));g&&g.prototype;a.prototype.renderForWebLink=function(a,b){"use strict";return this.$MNCommerceCallToActionAsyncIntentHandler1(a,b)};a.prototype.renderForNativeLink=function(a,b){"use strict";return this.$MNCommerceCallToActionAsyncIntentHandler1(a,b)};a.prototype.$MNCommerceCallToActionAsyncIntentHandler1=function(a,c){"use strict";var d=function(){new(b("AsyncRequest"))(a.action_link).send()};return b("React").createElement(b("Link.react"),{className:c,key:a.title+a.id,onClick:d},a.translated_title||a.title)};function a(){"use strict";g.apply(this,arguments)}e.exports=a}),null);
__d("MessengerPlayGameCallToActionHelper",["URI","idx"],(function(a,b,c,d,e,f){__p&&__p();e.exports={parseMetadata:function(a){var b,c,d;b=(b=a)!=null?b.instantgame_gameid:b;if(!b)return null;c=(c=a)!=null?c.instantgame_payload:c;d=(d=a)!=null?d.instantgame_context_type:d;a=(a=a)!=null?a.instantgame_context_id:a;return{contextSourceID:a,contextType:d,gameID:b,payload:c}},parseActionLink:function(a){a=new(b("URI"))(a).getQueryData();if(!a)return null;var c=a.game_id;if(!c)return null;var d=a.payload,e=a.context_type;a=a.context_id;return{contextSourceID:a,contextType:e,gameID:c,payload:d}}}}),null);
__d("MessengerPlayGameCallToActionIntentHandler",["cx","invariant","InstantGameContextType","MercuryIDs","MessengerPlayGameCallToActionHelper","MNCommerceCallToActionGenericIntentHandler","MessengerGamesPlayGameLink.react","QuicksilverSources","React","idx","joinClasses"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i;i=babelHelpers.inherits(a,b("MNCommerceCallToActionGenericIntentHandler"));i&&i.prototype;a.prototype.renderForWebLink=function(a,b){"use strict";return this.$MessengerPlayGameCallToActionIntentHandler1(a,b)};a.prototype.renderForNativeLink=function(a,b){"use strict";return this.$MessengerPlayGameCallToActionIntentHandler1(a,b)};a.prototype.$MessengerPlayGameCallToActionIntentHandler1=function(a,c){__p&&__p();var d,e,f=this.threadID||"";d=(d=a)!=null?d.instantgame_metadata:d;e=(e=a)!=null?e.action_link:e;var g=null;d?g=b("MessengerPlayGameCallToActionHelper").parseMetadata(d):e&&(g=b("MessengerPlayGameCallToActionHelper").parseActionLink(e));if(!g)return b("React").createElement("div",null);d=g.gameID;d||h(0);e=g.contextSourceID;var i=g.contextType;i||(i=b("InstantGameContextType").THREAD,e=b("MercuryIDs").getThreadFBIDFromThreadID(f));return b("React").createElement(b("MessengerGamesPlayGameLink.react"),{className:b("joinClasses")(c,"_fy2"),contextSourceID:e,contextType:i,gameID:d,key:a.title+a.id,onClick:this.onClickHook,payload:g.payload||undefined,source:b("QuicksilverSources").MESSENGER_CALL_TO_ACTION,threadID:f,title:a.translated_title||a.title})};function a(){"use strict";i.apply(this,arguments)}e.exports=a}),null);
__d("MNCommerceCallToActionHandlerMap",["BuyOnMessengerCallToActionIntentHandler","MMeCallToActionIntentHandler","MNCommerceCallToActionAsyncIntentHandler","MNCommerceCallToActionGenericIntentHandler","MessengerPlayGameCallToActionIntentHandler","URI"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={"fb-messenger://payments/buy/mc?":b("BuyOnMessengerCallToActionIntentHandler"),"fb-messenger://business/commerce/":b("BuyOnMessengerCallToActionIntentHandler"),"fb-messenger://instant_games/play":b("MessengerPlayGameCallToActionIntentHandler"),"https://m.me/":b("MMeCallToActionIntentHandler")};function a(a){for(var c in g)if(a.startsWith(c)){var d=g[c];return new d()}return new(b("URI"))(a).getQueryData().async?new(b("MNCommerceCallToActionAsyncIntentHandler"))():new(b("MNCommerceCallToActionGenericIntentHandler"))()}e.exports={getHandler:a}}),null);
__d("MNCommercePromotionReactShapes",["React"],(function(a,b,c,d,e,f){"use strict";a=b("React").PropTypes;c=a.arrayOf(a.shape({action_link:a.string,title:a.string}));d={CallToActions:c,RetailItem:a.shape({call_to_actions:c,id:a.string,metalines:a.shape({metaline_1:a.string,metaline_2:a.string,metaline_3:a.string}),name:a.string,url:a.string,source:a.string})};e.exports=d}),null);
__d("MessengerPlatformGenericItemMercuryAttachment.react",["cx","fbt","AsyncDialog","AsyncRequest","Banzai","Bootloader","BrowserExtensionsDialog","CurrentUser","MercuryAttachmentViewer","MessengerEnvironment","FBConfirmDialog.react","FBPaymentsCheckoutFlowContainer.react","FBPaymentsSerializableCheckoutConfigurationParser","Image.react","Link.react","LazyComponent.react","LoadOnRender.react","MercuryIDs","MessageShareType","MessagingForwardAttachmentDialog.react","MessengerAdsWebTypedLogger","MessengerDialogs.bs","MessengerForwardAttachmentDialogReact.bs","MessengerPhotoViewCloseLink.react","MessengerPlatformBubbleAspectRatio","MessengerPlatformPostbackFailedDialog.react","MessengerVideoPlayer.react","MNAdsLoggerEventEnum","MNCommerceCallToActionHandlerMap","MNCommerceCallToActionType","MNCommerceCTAProcessor","MNCommerceBubbleImage.react","MNCommerceMessageType","MNCommercePostbackCTADataManager","MNCommercePromotionReactShapes","MNContentSubscriptionMessageUserEngagementTypedLogger","React","MercuryShareAttachmentRenderLocations","SpotlightMessengerSharedMediaViewer.react","SpotlightViewer","SpotlightViewerImage","SpotlightViewport","Tooltip","URI","Vector","idx","joinClasses","nullthrows"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("MessengerForwardAttachmentDialogReact.bs").jsComponent,k=181,l="_4-og";c=b("React").PropTypes;var m=function(a){b("Bootloader").loadModules(["MessengerPreviewDialogReact.bs"],function(b){b=b.jsComponent;return a(b)},"MessengerPlatformGenericItemMercuryAttachment.react")};function n(a){if(a!==undefined){a=a.match(/\d+/);if(a!==undefined&&a!==null)return a[0]}return null}d=babelHelpers.inherits(a,b("React").PureComponent);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={showDialog:!1,showShare:!1,showPaymentCheckoutDialog:!1,showImageFullScreen:!1},this.$12=function(){var a=this.props,c=a.pageID;a=a.retailItem;a=(a=a)!=null?(a=a.media_blob_attachments)!=null?a[0]:a:a;if(!a)return;var d=a.legacy_attachment_id?a.legacy_attachment_id:a.id,e=a.__typename==="MessageVideo"?new(b("Vector"))(a.original_dimensions.x,a.original_dimensions.y):new(b("Vector"))(a.width,a.height);a=a.playable_url;b("MercuryAttachmentViewer").renderVideo({pageID:parseInt(c,10),videoID:d,videoSize:e,videoURI:a})}.bind(this),this.$8=function(a,event){event&&event.target instanceof HTMLElement&&event.target.className===l&&this.$6()}.bind(this),this.$25=function(){this.setState({showShare:!0})}.bind(this),this.$24=function(){this.setState({showShare:!1})}.bind(this),this.$11=function(){this.setState({showImageFullScreen:!0})}.bind(this),this.$6=function(){this.setState({showImageFullScreen:!1})}.bind(this),this.$23=function(){this.setState({showPaymentCheckoutDialog:!0})}.bind(this),this.$26=function(){this.setState({showPaymentCheckoutDialog:!1})}.bind(this),this.onConfirm=function(){this.setState({showDialog:!0})}.bind(this),this.onCancel=function(){this.setState({showDialog:!1})}.bind(this),c}a.prototype.render=function(){var a={},c=this.props.location===b("MercuryShareAttachmentRenderLocations").CHAT;c&&this.props.width&&(a.width=this.props.width);return this.props.isButtonList?b("React").createElement("div",{className:"_3cn0",style:a},b("React").createElement("div",{className:(c?"_4id8":"")+(c?"":" _4ida")},this.$1())):b("React").createElement("div",{className:"_3cn0",style:a},this.$2(),b("React").createElement("div",{className:(c?"_4id8":"")+(c?"":" _4ida")},this.$3(),this.$1()))};a.prototype.$2=function(){if(this.props.isMediaAttachment)return this.$4();else return this.$5()};a.prototype.$4=function(){__p&&__p();var a,c=this.props.retailItem;if(!c)return null;a=(a=c)!=null?(a=a.media_blob_attachments)!=null?(a=a[0])!=null?a.large_preview:a:a:a;if(a)if(this.state.showImageFullScreen)return b("React").createElement(b("SpotlightViewer"),{className:"_53vs",onHide:this.$6,open:!0,ref:"spotlightViewer"},b("React").createElement(b("SpotlightViewport"),{active:!1,fadeInNOut:!0,media:this.$7(a),onClick:this.$8,ref:"viewport",showLoadingIndicator:!0,stageDimensions:this.$9(),useWidth:!0}),b("React").createElement(b("MessengerPhotoViewCloseLink.react"),{onClick:this.$6}));else{var d=this.$10({height:a.height,width:a.width});return b("React").createElement(b("Image.react"),{className:"_4idc _urh",height:d.y,width:d.x,src:a.uri,onClick:this.$11})}a=(d=c)!=null?(d=d.media_blob_attachments)!=null?(d=d[0])!=null?d.playable_url:d:d:d;if(a){a=b("nullthrows")((d=c)!=null?(d=d.media_blob_attachments)!=null?d[0]:d:d);c=a.legacy_attachment_id?a.legacy_attachment_id:a.id;d={};d.legacy_attachment_id=c;a.__typename==="MessageVideo"?d.original_dimensions=this.$10({width:a.original_dimensions.x,height:a.original_dimensions.y}):(d.original_dimensions=this.$10({width:a.width,height:a.height}),d.is_share=!0);d.start_muted=!0;d.no_fullscreen=!b("MessengerEnvironment").messengerui;d.hide_controls_on_finish=!0;d.url=a.playable_url;if(this.props.location===b("MercuryShareAttachmentRenderLocations").MESSENGER)return b("React").createElement(b("MessengerVideoPlayer.react"),{attachment:a,videoData:d,isInThread:!0,isVisible:!0,className:"_ccq _4tsk _3o67"});else return b("React").createElement(b("MessengerVideoPlayer.react"),{attachment:a,videoData:d,isInThread:!0,isVisible:!0,onClick:this.$12,className:"_n4o _3_om _1wno"})}return null};a.prototype.$10=function(a){__p&&__p();if(this.props.location===b("MercuryShareAttachmentRenderLocations").CHAT){var c=k;if(a.width<=c)return a;else{c=c/a.width;return{x:Math.round(a.width*c),y:Math.round(a.height*c)}}}c=window.innerHeight*.7;var d=window.innerWidth*.4,e=181,f=a.width;a=a.height;var g=1;g=Math.min(g,Math.min(d/f,c/a));g=Math.max(g,e/f);f=Math.round(f*g);a=Math.round(a*g);return{x:f,y:a}};a.prototype.$7=function(a){var c=b("SpotlightMessengerSharedMediaViewer.react").getImageDimensionsForStage(new(b("Vector"))(a.width,a.height),this.$9());return b("React").createElement(b("SpotlightViewerImage"),{dimensions:c,ref:"image",src:a.uri})};a.prototype.$9=function(){return new(b("Vector"))(b("Vector").getViewportDimensions().x,b("Vector").getViewportDimensions().y)};a.prototype.$5=function(){__p&&__p();var a,c=this.props,d=c.isSubattachment;c=c.retailItem;if(!c)return null;a=c.thumb_url?c.thumb_url:(a=c)!=null?(a=a.media_blob_attachments)!=null?(a=a[0])!=null?(a=a.image)!=null?a.uri:a:a:a:a;if(!a)return null;d=b("React").createElement(b("MNCommerceBubbleImage.react"),{className:(d?"":"_3_om")+(d?"":" _4j39"),location:this.props.location,source:a,width:this.props.width,isSquare:c.image_aspect_ratio===b("MessengerPlatformBubbleAspectRatio").IMAGE_ASPECT_RATIO_SQUARE});a=null;var e=c.default_action;if(e){c=(c=e)!=null?(c=c.webview_metadata)!=null?c.messenger_extensions:c:c;c?a=b("React").createElement(b("Link.react"),{onClick:function(){this.$13(),this.$14(e)}.bind(this)},d):a=b("React").createElement(b("Link.react"),{href:e.action_link,onClick:function(){this.$13()}.bind(this),target:"_blank"},d)}else a=d;c=b("React").createElement("div",{className:"_3cn2",key:"image"},a);return c};a.prototype.$13=function(){if(this.props.mnMessageType==b("MNCommerceMessageType").CONTENT_SUBSCRIPTION){var a=n(this.props.pageID),c=this.props.retailItem&&this.props.retailItem.id;new(b("MNContentSubscriptionMessageUserEngagementTypedLogger"))().setPageID(a).setMessageID(this.props.messageID).setCommerceItemID(c).setName("mn_platform_msg_click").log();b("Banzai").post("mn_platform_message_click_setsuna",{page_id:a,item_id:c})}};a.prototype.$3=function(){var a=this.props.retailItem;return!a||!a.name?null:b("React").createElement("div",{className:"_3cne"},b("React").createElement("div",{className:"_3cnf"},b("React").createElement("div",{className:"_3cng"},b("React").createElement("div",{className:"_3cnh"},this.props.longestName),b("React").createElement("div",{className:this.props.longestName?"_3cni":""},a.name)),this.$15(),this.$16()))};a.prototype.$17=function(){return this.props.isSponsored?null:b("React").createElement("div",{className:"_3cnj"},b("React").createElement("span",{className:"_3cnk"}),this.$18())};a.prototype.$18=function(){var a=this.props.label;if(a===0)return h._("\u10e0\u10d4\u10d9\u10da\u10d0\u10db\u10d8\u10e0\u10d4\u10d1\u10e3\u10da\u10d8");else if(a===1)return h._("\u10e0\u10d4\u10d9\u10da\u10d0\u10db\u10d0");return null};a.prototype.$15=function(){var a=this.props.retailItem&&this.props.retailItem.metalines;if(!a)return null;a=Object.keys(a).filter(function(b){return a&&a[b]}).map(function(c,d){d=a&&a[c];return b("React").createElement("div",{className:"_3cnl",key:c},b("React").createElement("div",{className:"_3cnh"},this.props.longestMetaline),b("React").createElement("div",{className:this.props.longestMetaline?"_3cni":""},d))}.bind(this));return a};a.prototype.$16=function(){var a=this.props.retailItem&&this.props.retailItem.item_url;if(!this.props.isSponsored&&a){var c=document.createElement("a");c.href=a;c=c.hostname;this.props.retailItem&&this.props.retailItem.source&&(c=this.props.retailItem.source);return b("React").createElement("div",{className:"_3cnn"},b("React").createElement("a",{href:a,target:"_blank"},c))}else return null};a.prototype.$1=function(){__p&&__p();var a=this.props.retailItem,c=this.props.callToActions,d=this.props.threadID;if(!c||!c.length)return null;var e=function(a,b){var c=h._("The feature has been disabled.");return g(a,b,c)},f=function(a,b){var c=h._("To use this feature, use the Messenger app.");return g(a,b,c)},g=function(a,c,d){return b("React").createElement("div",babelHelpers["extends"]({className:b("joinClasses")(c,"_3cno"),"data-tooltip-alignh":"center","data-tooltip-position":"above",key:a.title},b("Tooltip").propsFor(d)),a.translated_title||a.title)},i=function(a,c){return b("React").createElement("div",{key:a.id},b("React").createElement(b("Link.react"),{className:c,onClick:function(){this.$14(a)}.bind(this)},a.title))}.bind(this);c=c.filter(function(a){return a.action_link}).map(function(c,g){__p&&__p();var k="_3cnp"+(g===0&&!a?" _3cnq":"");if(c.is_disabled)return e(c,k);switch(c.action_type){case b("MNCommerceCallToActionType").POSTBACK:var l=function(a){this.onCancel(),this.$19(c.id),c.is_mutable_by_server?b("MNCommercePostbackCTADataManager").send(c.id,function(a){a.error&&b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(b("MessengerPlatformPostbackFailedDialog.react"),null)})},null,this.props.messageID):b("MNCommercePostbackCTADataManager").sendAndConfirm(c.id,c.title,d,null,function(a){a.error&&b("MessengerDialogs.bs").showDialog(function(){return b("React").createElement(b("MessengerPlatformPostbackFailedDialog.react"),null)})},null,[],this.props.messageID)}.bind(this),n=null;this.state.showDialog&&c.should_show_user_confirmation&&(n=b("React").createElement(b("FBConfirmDialog.react"),{title:c.confirmation_title,shown:!0,onConfirm:l,onCancel:this.onCancel,confirmButtonText:c.confirmation_continue_label,cancelButtonText:c.confirmation_cancel_label,content:c.confirmation_message}));l=c.should_show_user_confirmation?this.onConfirm:l;return b("React").createElement("div",{key:g},b("React").createElement(b("Link.react"),{className:k,onClick:l},c.translated_title||c.title),n);case b("MNCommerceCallToActionType").OPEN_URL:return b("MNCommerceCallToActionHandlerMap").getHandler(c.action_link).setFallbackOnClick(this.$20.bind(this,c.id)).setThreadID(d).renderForWebLink(c,k);case b("MNCommerceCallToActionType").OPEN_CANCEL_RIDE_MUTATION:return f(c,k);case b("MNCommerceCallToActionType").OPEN_NATIVE:n=(l=c)!=null?(l=l.webview_metadata)!=null?l.messenger_extensions:l:l;return n?i(c,k):b("MNCommerceCallToActionHandlerMap").getHandler(c.action_link).setFallbackOnClick(this.$20.bind(this,c.id)).setThreadID(d).renderForNativeLink(c,k);case b("MNCommerceCallToActionType").PAYMENT:l="_idv";n="_idw";return b("React").createElement("div",{key:g},this.$21(c),b("React").createElement(b("Link.react"),{className:k,onClick:function(){this.$22(c),this.$23()}.bind(this)},b("React").createElement("div",{className:l},c.payment_metadata.total_price),b("React").createElement("div",{className:n},c.translated_title||c.title)));case b("MNCommerceCallToActionType").SHARE:l=b("MessengerEnvironment").messengerui?j:b("MessagingForwardAttachmentDialog.react");n=h._("Share in Separate messages");l=b("React").createElement(l,{attachmentID:c.id,messageID:this.props.messageID,onClose:this.$24,shown:this.state.showShare,title:n,shareType:b("MessageShareType").PLATFORM_SHARE_CTA});return b("React").createElement("div",{key:g},b("React").createElement(b("Link.react"),{className:k,onClick:this.$25},c.title),l);case b("MNCommerceCallToActionType").EXTENSIBLE_SHARE:n=h._("Share in Separate messages");return b("React").createElement("div",{key:g},b("React").createElement(b("Link.react"),{className:k,onClick:this.$25},c.title),b("React").createElement(b("LoadOnRender.react"),{key:"dialog",component:b("React").createElement(b("LazyComponent.react"),{attachmentID:c.id,image_url:c.action_objects[0].image_url,messageID:this.props.messageID,onClose:this.$24,pageID:this.props.pageID,preview_title:c.action_objects[0].preview_title,preview_subtitle:c.action_objects[0].preview_subtitle,shown:this.state.showShare,target_display:c.action_objects[0].target_display,title:n,threadID:this.props.threadID}),loader:m,placeholder:b("React").createElement("span",null)}));case b("MNCommerceCallToActionType").ACCOUNT_LINK:l=function(a){b("MNCommerceCTAProcessor").process(c.id,this.props.messageID)}.bind(this);return b("React").createElement(b("Link.react"),{className:k,key:g,onClick:l},c.translated_title||c.title);case b("MNCommerceCallToActionType").FACEBOOK_REPORT_A_PROBLEM:n=function(a){b("AsyncDialog").send(new(b("AsyncRequest"))("/ajax/bugs/report"))};return b("React").createElement(b("Link.react"),{className:k,key:g,onClick:n},c.translated_title||c.title);default:return f(c,k)}}.bind(this));var k=this.props.longestCTAs,l=[];if(k&&k>c.length){for(var n=0;n<k-c.length;n++)l.push(b("React").createElement("div",{className:"_3cnh _3cnp",key:"placeholder"+n},"CTA placeHolder"));n=l.concat(c);return b("React").createElement("div",{className:"_3cnr"},n)}return b("React").createElement("div",{className:"_3cnr"},c)};a.prototype.$20=function(a,event){this.$19(a)};a.prototype.$19=function(a){this.props.isSponsored&&new(b("MessengerAdsWebTypedLogger"))().setActionID(a).setEvent(b("MNAdsLoggerEventEnum").LINK_CLICK_CTA).setIsSponsored(this.props.isSponsored).setItemID(this.props.retailItem&&this.props.retailItem.id).setMessageID(this.props.messageID).setPageID(this.props.pageID).log()};a.prototype.$21=function(a){if(this.state.showPaymentCheckoutDialog){a=b("FBPaymentsSerializableCheckoutConfigurationParser").parse(this.$27(a.payment_metadata.payment_module_config));var c=a.contentConfiguration.confirmationConfiguration||{};a.contentConfiguration.confirmationConfiguration=c;return b("React").createElement(b("FBPaymentsCheckoutFlowContainer.react"),{configuration:a,onCheckoutClosed:this.$26,onConfirmationClosed:this.$26})}return null};a.prototype.$27=function(a){var b="";try{b=JSON.parse(a)}catch(b){return a}b.checkout_configuration&&b.checkout_configuration.payment_info&&b.checkout_configuration.payment_info.extra_data&&(b.checkout_configuration.payment_info.extra_data.message_id=this.props.messageID);return JSON.stringify(b)};a.prototype.$14=function(a){b("BrowserExtensionsDialog").show(new(b("URI"))(a.action_link),b("MercuryIDs").getThreadFBIDFromThreadID(this.props.pageID),b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID),b("CurrentUser").getID()),this.$22(a)};a.prototype.$22=function(a){b("MNCommerceCTAProcessor").postHandle(a.id,this.props.messageID)};a.propTypes={callToActions:b("MNCommercePromotionReactShapes").CallToActions,isMediaAttachment:c.bool,isSponsored:c.bool,isSubattachment:c.bool,label:c.number,logo:c.object,location:c.oneOf(b("MercuryShareAttachmentRenderLocations").getValues()),longestCTAs:c.number,longestMetaline:c.string,longestName:c.string,messageID:c.string,mnMessageType:c.string,pageID:c.string,retailItem:b("MNCommercePromotionReactShapes").RetailItem,url:c.string,width:c.number,threadID:c.string};e.exports=a}),null);
__d("P2PAddressStore",["P2PActionConstants","EventEmitter","ImmutableObject","P2PAPI","P2PDispatcher","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("immutable").List,i=h(),j=!1,k=!1,l={},m=void 0,n=null,o=!1;function p(a,c){a&&(l[a]=new(b("ImmutableObject"))(c))}function q(a,b){n=b,a&&(l[a]={error:b})}c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(){g.constructor.call(this),j=!1,k=!1,i=h(),l={},m=b("P2PDispatcher").register(this.onEventDispatched.bind(this))}a.prototype.onEventDispatched=function(a){__p&&__p();var c=a.data;a=a.type;switch(a){case b("P2PActionConstants").ADDRESS_SAVING:this.handleAddressSaving(c);this.emit("change");break;case b("P2PActionConstants").ADDRESSES_UPDATED:this.handleAddressesUpdated(c);this.emit("change");break;case b("P2PActionConstants").ADDRESS_ADDED:this.handleAddressAdded(c);this.emit("change");break;case b("P2PActionConstants").ADDRESS_ADDED_ERROR:this.handleAddressAddedError(c);this.emit("change");break;case b("P2PActionConstants").ADDRESS_ADDED_ERROR_CLEARED:this.handleAddressAddedErrorCleared();this.emit("change");break}};a.prototype.getAsyncRequestState=function(){return l};a.prototype.isAddressesFetchComplete=function(){return j};a.prototype.handleAddressSaving=function(){o=!0,n=null};a.prototype.handleAddressesUpdated=function(a){j=!0,a=a.map(function(a){return new(b("ImmutableObject"))(a)}),i=h(a)};a.prototype.handleAddressAdded=function(a){o=!1,p(a.requestID,a),this.getAddressByID(a.id)||(i=i.push(new(b("ImmutableObject"))(a)))};a.prototype.handleAddressAddedError=function(a){o=!1,q(a.requestID,a.errors)};a.prototype.handleAddressAddedErrorCleared=function(){n=null};a.prototype.getAll=function(a){k||(k=!0,b("P2PAPI").getAddresses());return a?i.filter(function(a){return a.isVerified}):i};a.prototype.getAddressByID=function(a){return i.find(function(b){return b.id===a})};a.prototype.getDispatchToken=function(){return m};a.prototype.getSaveErrors=function(){return n};a.prototype.isSaving=function(){return o};e.exports=new a()}),null);
__d("P2PAddressShape",["React"],(function(a,b,c,d,e,f){"use strict";a=b("React").PropTypes;c=a.shape({label:a.string,care_of:a.string,city:a.string,id:a.string,state:a.string,street1:a.string,street2:a.string,zip:a.string});e.exports=c}),null);
__d("P2PAddressDetails.react",["P2PAddressShape","P2PText.react","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){var a=this.props.address,c=[a.city,a.state],d=void 0,e=void 0,f=void 0,g={display:"block",type:"primary"},h=a.zip?" "+a.zip:"",i=a.country?" "+a.country:"";c=c.join(", ")+h+i;a.streeet2&&(d=b("React").createElement(b("P2PText.react"),g,a.street2));a.label&&(e=b("React").createElement(b("P2PText.react"),g,a.label));a.care_of&&(f=b("React").createElement(b("P2PText.react"),g,a.care_of));return b("React").createElement("div",null,e,f,b("React").createElement(b("P2PText.react"),g,a.street1),d,b("React").createElement(b("P2PText.react"),g,c))};function a(){g.apply(this,arguments)}a.propTypes={address:b("P2PAddressShape").isRequired};e.exports=a}),null);
__d("P2PAddressForm.react",["cx","fbt","FBPaymentsAddressLabelFormField_DEPRECATED.react","FBPaymentsForm_DEPRECATED.react","FBPaymentsFormField_DEPRECATED.react","FBPaymentsFormFieldUtils_DEPRECATED","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={formData:{},isValid:!1},this.handleValidation=function(a,b){this.setState({formData:b,isValid:a}),this.props.onValidation(a,b)}.bind(this),b}a.prototype.render=function(){var a=!!(this.props.prefilledFormData&&this.props.prefilledFormData.care_of);return b("React").createElement(b("FBPaymentsForm_DEPRECATED.react"),{errorTitle:h._("Problem Saving Address"),prefilledFormData:this.props.prefilledFormData,onValidation:this.handleValidation,saveErrors:this.props.saveErrors},b("React").createElement(b("FBPaymentsAddressLabelFormField_DEPRECATED.react"),{className:"_3-96",name:"label",ignoreStyling:!0,required:!0}),b("React").createElement(b("FBPaymentsFormField_DEPRECATED.react"),{name:"care_of",initiallyFocused:!a,placeholder:h._("\u10e1\u10d0\u10ee\u10d4\u10da\u10d8"),required:!0,width:100}),b("React").createElement(b("FBPaymentsFormField_DEPRECATED.react"),{name:"street1",initiallyFocused:a,placeholder:h._("\u10e5\u10e3\u10e9\u10d0"),required:!0,width:100}),b("React").createElement(b("FBPaymentsFormField_DEPRECATED.react"),{name:"street2",placeholder:h._("Street 2"),width:100}),b("React").createElement(b("FBPaymentsFormField_DEPRECATED.react"),{name:"city",placeholder:h._("\u10e5\u10d0\u10da\u10d0\u10e5\u10d8"),required:!0,width:50}),b("React").createElement(b("FBPaymentsFormField_DEPRECATED.react"),{formatValue:function(a){a=b("FBPaymentsFormFieldUtils_DEPRECATED").stripNonAlpha(a);return a.toUpperCase()},limit:2,name:"state",placeholder:h._("\u10e1\u10d0\u10ee\u10d4\u10da\u10db\u10ec\u10d8\u10e4\u10dd"),required:!0,width:25}),b("React").createElement(b("FBPaymentsFormField_DEPRECATED.react"),{formatValue:b("FBPaymentsFormFieldUtils_DEPRECATED").stripNonDigits,limit:5,name:"zip",placeholder:h._("ZIP"),required:!0,width:25}))};a.propTypes={onValidation:c.func.isRequired,prefilledFormData:c.object,saveErrors:c.object};a.defaultProps={editMode:!1,prefilledFormData:{},saveErrors:null};e.exports=a}),null);
__d("P2PCheckoutConfigSection.react",["cx","fbt","LeftRight.react","Link.react","React","emptyFunction"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.renderChangeLink=function(){return this.props.showEditOptions||!this.props.hasOptions?null:b("React").createElement(b("Link.react"),{className:"_nb2",href:"#",onClick:this.props.onChangeClicked},h._("\u10e8\u10d4\u10ea\u10d5\u10da\u10d0"))}.bind(this),this.renderContent=function(){var a=this.props,c=void 0,d=void 0;a.showEditOptions?c=this.renderSelector():a.hasOptions&&(c=this.renderCurrentItem());a.showForm&&(d=this.renderForm());return b("React").createElement("div",null,c,d)}.bind(this),this.renderForm=function(){var a=void 0;if(!this.props.renderFormComponent)return null;this.props.renderFormFooterMessage&&(a=b("React").createElement("div",{className:"_nb4"},this.props.renderFormFooterMessage()));return b("React").createElement("div",{className:"_nb3",key:"form"},this.props.renderFormComponent(),a)}.bind(this),this.renderSelector=function(){return b("React").createElement("div",{className:"_nb5",key:"selector"},this.props.renderSelectorComponent())}.bind(this),this.renderCurrentItem=function(){return!this.props.renderSelectedRow?null:b("React").createElement("div",{className:"_nb6",key:"currentItem"},this.props.renderSelectedRow())}.bind(this),c}a.prototype.render=function(){return b("React").createElement("div",{className:"_nb7"},b("React").createElement(b("LeftRight.react"),{className:"_nb8"},b("React").createElement("div",{className:"_nb9"},this.props.title),this.renderChangeLink()),b("React").createElement("div",{className:"_nba"},this.renderContent()))};a.propTypes={onChangeClicked:c.func,hasOptions:c.bool,showEditOptions:c.bool,showForm:c.bool,renderFormComponent:c.func,renderFormFooterMessage:c.func,renderSelectedRow:c.func,renderSelectorComponent:c.func.isRequired,title:c.string.isRequired};a.defaultProps={onChangeClicked:b("emptyFunction"),renderFormFooterMessage:b("emptyFunction"),renderFormComponent:b("emptyFunction"),renderSelectedRow:b("emptyFunction")};e.exports=a}),null);
__d("P2PChooseAddressForm.react",["cx","fbt","immutable","P2PAddressShape","P2PAddressDetails.react","P2PText.react","React","XUIRadioList.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("immutable").List;var j=b("XUIRadioList.react").Item;d=b("React").PropTypes;var k="add_address";f=babelHelpers.inherits(a,b("React").Component);i=f&&f.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={selectedValue:this.props.selectedAddress.id},this.getselectedAddress=function(){return this.props.addresses.filter(function(a){return a.id===this.state.selectedValue}.bind(this)).first()}.bind(this),this.handleChange=function(a){var b=void 0;a===k?(this.props.onNewAddressOptionSelected(),this.setState({selectedValue:a})):(b=this.props.addresses.filter(function(b){return b.id===a}).first(),this.setState({selectedValue:b.id}),this.props.onChange(b))}.bind(this),this.renderAddressItem=function(a){return b("React").createElement(j,{className:"_54sy",key:a.id,value:a.id},b("React").createElement(b("P2PAddressDetails.react"),{address:a}))},this.renderAddNewAddressItem=function(){return b("React").createElement(j,{className:"_54sy",key:k,value:k},b("React").createElement(b("P2PText.react"),{type:"primary"},h._("Add New Address")))},this.getRadioListItems=function(){var a=this.props.addresses;a=a.map(this.renderAddressItem).concat(this.renderAddNewAddressItem());return a}.bind(this),c}a.prototype.render=function(){return b("React").createElement(b("XUIRadioList.react"),{className:"_1ck2",onValueChange:this.handleChange,selectedValue:this.state.selectedValue},this.getRadioListItems())};a.propTypes={addresses:d.instanceOf(c),onChange:d.func.isRequired,onNewAddressOptionSelected:d.func.isRequired,selectedAddress:b("P2PAddressShape")};e.exports=a}),null);
__d("P2PAddressConfigSection.react",["fbt","MessengerEnvironment","FBPaymentsAddressForm_DEPRECATED.react","P2PAddressDetails.react","P2PAddressForm.react","P2PAddressShape","P2PCheckoutConfigSection.react","P2PChooseAddressForm.react","P2PText.react","React","immutable"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;var i="P2PAddressConfigSection_learnMoreSentenceID";d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.renderFormComponent=function(){var a=this.props;return a.acceptInternational?b("React").createElement(b("FBPaymentsAddressForm_DEPRECATED.react"),{onValidation:a.onValidation,prefilledFormData:{care_of:this.props.buyerName},saveErrors:a.saveErrors}):b("React").createElement(b("P2PAddressForm.react"),{onValidation:a.onValidation,prefilledFormData:{care_of:this.props.buyerName},saveErrors:a.saveErrors})}.bind(this),this.renderSelectedRow=function(){var a=this.props.selectedAddress;return!a?null:b("React").createElement(b("P2PAddressDetails.react"),{address:a})}.bind(this),this.renderSelectorComponent=function(){var a=this.props;return b("React").createElement(b("P2PChooseAddressForm.react"),{addresses:a.addresses,onChange:this.props.onAddressSelected,onNewAddressOptionSelected:this.props.onNewAddressSelected,selectedAddress:a.selectedAddress})}.bind(this),this.renderFormFooterMessage=function(){return b("React").createElement(b("P2PText.react"),{id:i,type:"secondary"},g._("Your shipping address will be stored securely for future purchases on Facebook."))},this.getTitle=function(){return b("MessengerEnvironment").messengerui?g._("Shipping Address"):g._("SHIPPING ADDRESS")},c}a.prototype.render=function(){var a=this.props;return b("React").createElement(b("P2PCheckoutConfigSection.react"),{hasOptions:a.addresses.count()!==0,showEditOptions:a.showEditOptions,showForm:a.showForm,onChangeClicked:a.onChangeClicked,renderFormComponent:this.renderFormComponent,renderFormFooterMessage:this.renderFormFooterMessage,renderSelectedRow:this.renderSelectedRow,renderSelectorComponent:this.renderSelectorComponent,title:this.getTitle()})};a.propTypes={acceptInternational:c.bool,addresses:c.instanceOf(b("immutable").List).isRequired,buyerName:c.string,showEditOptions:c.bool,showForm:c.bool,onAddressSelected:c.func.isRequired,onChangeClicked:c.func.isRequired,onNewAddressSelected:c.func.isRequired,onValidation:c.func.isRequired,selectedAddress:b("P2PAddressShape"),saveErrors:c.object};e.exports=a}),null);
__d("P2PCreditCardConfigSection.react",["fbt","MessengerEnvironment","Link.react","MessengerPaymentProductType","P2PChooseCreditCardForm.react","P2PCreditCard","P2PCreditCardDetails.react","P2PCreditCardForm.react","P2PCheckoutConfigSection.react","P2PLinkConstants","P2PText.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;var i="P2PCreditCardConfigSection_learnMoreSentenceID";d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.renderFormComponent=function(){var a=this.props;return b("React").createElement(b("P2PCreditCardForm.react"),{onValidation:a.onValidation,saveErrors:a.saveErrors,productType:b("MessengerPaymentProductType").MESSENGER_COMMERCE})}.bind(this),this.renderSelectedRow=function(){var a=this.props.selectedCreditCard;return!a?null:b("React").createElement(b("P2PCreditCardDetails.react"),{creditCard:a})}.bind(this),this.renderSelectorComponent=function(){var a=this.props;return b("React").createElement(b("P2PChooseCreditCardForm.react"),{addCardOptionText:g._("Add New Card"),creditCards:a.creditCards,onAddDebitCardOptionSelected:this.props.onNewCreditCardSelected,onChange:this.props.onCreditCardSelected,selectedCard:a.selectedCreditCard,showAddDebitCardOption:!0})}.bind(this),this.renderFormFooterMessage=function(){return b("React").createElement(b("P2PText.react"),{id:i,type:"secondary"},g._("Your payment info is stored securely."),b("React").createElement("div",null,b("React").createElement(b("Link.react"),{"aria-describedby":i,href:b("P2PLinkConstants").addDebitCardHelpURI,target:"_blank"},g._("\u10db\u10d4\u10e2\u10d8\u10e1 \u10d2\u10d0\u10d2\u10d4\u10d1\u10d0"))))},this.getTitle=function(){return b("MessengerEnvironment").messengerui?g._("Payment Information"):g._("PAYMENT INFORMATION")},c}a.prototype.render=function(){var a=this.props;return b("React").createElement(b("P2PCheckoutConfigSection.react"),{hasOptions:a.creditCards.length!==0,showEditOptions:a.showEditOptions,showForm:a.showForm,onChangeClicked:a.onChangeClicked,renderFormComponent:this.renderFormComponent,renderFormFooterMessage:this.renderFormFooterMessage,renderSelectedRow:this.renderSelectedRow,renderSelectorComponent:this.renderSelectorComponent,title:this.getTitle()})};a.propTypes={creditCards:c.arrayOf(c.instanceOf(b("P2PCreditCard"))).isRequired,showEditOptions:c.bool,showForm:c.bool,onCreditCardSelected:c.func.isRequired,onChangeClicked:c.func.isRequired,onNewCreditCardSelected:c.func.isRequired,onValidation:c.func.isRequired,selectedCreditCard:c.instanceOf(b("P2PCreditCard")),saveErrors:c.object};e.exports=a}),null);
__d("P2PPaymentMethodConfigSection.react",["fbt","MessengerEnvironment","P2PCheckoutConfigSection.react","P2PCreditCardDetails.react","P2PText.react","FBPaymentsChoosePaymentMethodForm_DEPRECATED.react","FBPaymentsPaymentMethodShape_DEPRECATED","FBPaymentsMethodType","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.renderFormComponent=function(){return b("React").createElement(b("FBPaymentsChoosePaymentMethodForm_DEPRECATED.react"),{onPaymentMethodConfigured:this.props.onPaymentMethodConfigured,onPaymentMethodSelected:this.props.onPaymentMethodSelected,paymentMethods:this.props.paymentMethods})}.bind(this),this.renderSelectedRow=function(){__p&&__p();var a=this.props.confirmedPaymentMethod;if(!a)return null;switch(a.type){case b("FBPaymentsMethodType").GENERIC_CARD:return b("React").createElement(b("P2PCreditCardDetails.react"),{creditCard:a.creditCard});case b("FBPaymentsMethodType").MANUAL_TRANSFER:return b("React").createElement(b("P2PText.react"),{type:"primary"},g._("Transfer at ATM or Bank"));case b("FBPaymentsMethodType").NET_BANKING:var c=a.bank.name;return b("React").createElement(b("P2PText.react"),{type:"primary"},g._("{bank_name} (Online Banking)",[g._param("bank_name",c)]));case b("FBPaymentsMethodType").PAY_OVER_COUNTER:return b("React").createElement(b("P2PText.react"),{type:"primary"},g._("Payment at Store Counter"));default:return b("React").createElement("div",null,a?a.toString():"")}}.bind(this),this.renderSelectorComponent=function(){return this.renderFormComponent()}.bind(this),c}a.prototype.getTitle=function(){return b("MessengerEnvironment").messengerui?g._("\u10d2\u10d0\u10d3\u10d0\u10ee\u10d3\u10d8\u10e1 \u10db\u10d4\u10d7\u10dd\u10d3\u10d8:"):g._("PAYMENT METHOD")};a.prototype.render=function(){var a=this.props;return b("React").createElement(b("P2PCheckoutConfigSection.react"),{hasOptions:!!a.confirmedPaymentMethod,showEditOptions:a.showEditOptions,showForm:a.showForm,onChangeClicked:a.onChangeClicked,renderFormComponent:this.renderFormComponent,renderSelectedRow:this.renderSelectedRow,renderSelectorComponent:this.renderSelectorComponent,title:this.getTitle()})};a.propTypes={confirmedPaymentMethod:c.shape(b("FBPaymentsPaymentMethodShape_DEPRECATED")),onChangeClicked:c.func.isRequired,onPaymentMethodConfigured:c.func.isRequired,onPaymentMethodSelected:c.func.isRequired,paymentMethods:c.arrayOf(b("FBPaymentsPaymentMethodShape_DEPRECATED")).isRequired,showEditOptions:c.bool,showForm:c.bool};e.exports=a}),null);
__d("P2PPlatformContextBannerShape",["React"],(function(a,b,c,d,e,f){"use strict";a=b("React").PropTypes;c=a.shape({shouldShowToBuyer:a.bool,shouldShowToSeller:a.bool,shouldShowPayNux:a.bool});e.exports=c}),null);
__d("P2PPlatformContextShippingOptionShape",["React"],(function(a,b,c,d,e,f){"use strict";a=b("React").PropTypes;c=a.shape({formattedShippingPrice:a.string,formattedSubtotal:a.string,formattedTax:a.string,formattedTotal:a.string,id:a.string,rawTotal:a.string,title:a.string});e.exports=c}),null);
__d("P2PPlatformContextShape",["P2PPlatformContextBannerShape","P2PPlatformContextProductItemShape","P2PPlatformContextShippingOptionShape","React"],(function(a,b,c,d,e,f){"use strict";a=b("React").PropTypes;c=a.shape({id:a.string,banner:b("P2PPlatformContextBannerShape"),buyerID:a.string,product:b("P2PPlatformContextProductItemShape"),sellerID:a.string,shippingOptions:a.arrayOf(b("P2PPlatformContextShippingOptionShape"))});e.exports=c}),null);
__d("P2PChooseShippingOptionForm.react",["cx","P2PPlatformContextShippingOptionShape","React","P2PText.react","XUIRadioList.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("XUIRadioList.react").Item;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={selectedValue:this.props.selectedShippingOption.id},this.handleChange=function(a){var b=this.props.shippingOptions.filter(function(b){return b.id===a})[0];this.setState({selectedValue:b.id});this.props.onChange(b)}.bind(this),this.renderShippingOptionItem=function(a){return b("React").createElement(i,{className:"_2i8o",key:a.id,value:a.id},b("React").createElement(b("P2PText.react"),{type:"primary"},a.title))},this.getRadioListItems=function(){return this.props.shippingOptions.map(this.renderShippingOptionItem)}.bind(this),c}a.prototype.render=function(){return b("React").createElement(b("XUIRadioList.react"),{className:"_2i8p",onValueChange:this.handleChange,selectedValue:this.state.selectedValue},this.getRadioListItems())};a.propTypes={shippingOptions:c.arrayOf(b("P2PPlatformContextShippingOptionShape")).isRequired,onChange:c.func.isRequired,selectedShippingOption:b("P2PPlatformContextShippingOptionShape")};e.exports=a}),null);
__d("P2PShippingOptionsConfigSection.react",["fbt","MessengerEnvironment","P2PChooseShippingOptionForm.react","P2PPlatformContextShippingOptionShape","P2PCheckoutConfigSection.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.renderSelectorComponent=function(){var a=this.props;return b("React").createElement(b("P2PChooseShippingOptionForm.react"),{shippingOptions:a.shippingOptions,onChange:this.props.onShippingOptionSelected,selectedShippingOption:a.selectedShippingOption})}.bind(this),this.getTitle=function(){return b("MessengerEnvironment").messengerui?g._("Shipping Options"):g._("SHIPPING OPTIONS")},c}a.prototype.render=function(){return b("React").createElement(b("P2PCheckoutConfigSection.react"),{hasOptions:!0,showEditOptions:!0,showForm:!1,renderSelectorComponent:this.renderSelectorComponent,title:this.getTitle()})};a.propTypes={onShippingOptionSelected:c.func.isRequired,selectedShippingOption:b("P2PPlatformContextShippingOptionShape"),shippingOptions:c.arrayOf(b("P2PPlatformContextShippingOptionShape"))};e.exports=a}),null);
__d("P2PCheckoutDialog.react",["cx","csx","fbt","CommerceContactMerchantManualPaymentSection.react","MessengerEnvironment","CSS","DOMQuery","FBPaymentsLegalDisclaimer_DEPRECATED.react","FBPaymentsMethodType","P2PActions","P2PAddressConfigSection.react","P2PAddressShape","P2PButton.react","P2PCheckoutPriceDetails.react","P2PCreditCardConfigSection.react","P2PCreditCard","P2PDialog.react","P2PDialogBody.react","P2PDialogFooter.react","P2PDialogTitle.react","P2PLoadingMask.react","P2PPaymentMethodConfigSection.react","P2PPlatformContextShape","P2PPlatformContextShippingOptionShape","P2PPlatformProductItemDetails.react","P2PShippingOptionsConfigSection.react","React","immutable"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"P2PCheckoutDialog",propTypes:{acceptInternationalAddresses:a.bool,addresses:a.instanceOf(b("immutable").List).isRequired,addressFormData:a.object,addressFormValid:a.bool,addressSaveErrors:a.object,asyncPaymentDetails:a.object,buyer:a.object,configuredPaymentMethod:a.object,confirmedPaymentMethod:a.object,creditCardFormData:a.object,creditCardFormValid:a.bool,creditCardSaveErrors:a.object,creditCards:a.arrayOf(a.instanceOf(b("P2PCreditCard"))).isRequired,customCheckoutDetails:a.node,editingPaymentMethod:a.bool,paymentMethods:a.array,paymentProductType:a.string,initialDataLoaded:a.bool,onClose:a.func.isRequired,onCompleteManualPayment:a.func.isRequired,onConfirmSelectedPaymentMethod:a.func.isRequired,onPlaceOrder:a.func.isRequired,onSaveAddress:a.func.isRequired,onSaveCreditCard:a.func.isRequired,onSetAddress:a.func.isRequired,orderID:a.string,platformContext:b("P2PPlatformContextShape"),receiptAttached:a.bool,saving:a.bool,selectedAddress:b("P2PAddressShape"),selectedCreditCard:a.instanceOf(b("P2PCreditCard")),selectedPaymentMethod:a.object,selectedShippingOption:b("P2PPlatformContextShippingOptionShape"),showAddressEditOptions:a.bool,showAsyncPaymentDetails:a.bool,showCreditCardEditOptions:a.bool,showPaymentMethodEditOptions:a.bool,showAddressForm:a.bool,showCreditCardForm:a.bool,showPaymentMethodForm:a.bool,showTaxField:a.bool,shippingOptions:a.arrayOf(b("P2PPlatformContextShippingOptionShape")),usePaymentMethods:a.bool},_toggledCreditCard:null,_toggledAddress:null,handleToggle:function(a){a||this.props.onClose(),this.cleanup()},handleCloseDialog:function(){this.props.onClose(),this.cleanup()},componentDidMount:function(){setTimeout(function(){if(this.isMounted()){var a=b("DOMQuery").find(document,"div._ugr");a&&b("CSS").addClass(a,"_225w")}}.bind(this),200)},getProductFromPlatformContext:function(){var a=this.props.platformContext;return a?a.product:null},renderPriceDetails:function(){var a=this.getProductFromPlatformContext(),c=this.props.selectedShippingOption,d=void 0,e=void 0,f=void 0,g=void 0;a&&(d=a.formattedAmount,g=d);c&&(d=c.formattedSubtotal,f=c.formattedShippingPrice,e=c.formattedTax,g=c.formattedTotal);return b("React").createElement(b("P2PCheckoutPriceDetails.react"),{shipping:f,subtotal:d,tax:e,total:g,showShippingField:!this.props.showAsyncPaymentDetails,showSubtotalField:!this.props.showAsyncPaymentDetails,showTaxField:this.props.showTaxField&&!this.props.showAsyncPaymentDetails})},renderItemSection:function(){var a=this.getProductFromPlatformContext();if(!a)return null;var c=void 0;this.props.customCheckoutDetails&&(c=b("React").createElement("div",{className:"_145w"},this.props.customCheckoutDetails));return b("React").createElement("div",null,b("React").createElement("div",{className:"_4oyy"},b("React").createElement(b("P2PPlatformProductItemDetails.react"),{configSelections:this.props.configSelections,item:a,size:"medium"})),c,b("React").createElement("div",{className:"_4oz5"},this.renderPriceDetails()))},renderRightPanel:function(){var a=!this.props.showAsyncPaymentDetails;return b("React").createElement("div",{className:(a?"_4oz9":"")+(a?"":" _334")},a?this.renderConfigSection():this.renderAsyncPaymentDetailsSection(),this.renderDialogFooter())},renderConfigSection:function(){if(!this.props.initialDataLoaded)return null;var a=void 0,c=b("React").createElement("div",{className:"_4gf2",key:"addressConigSection"},b("React").createElement(b("P2PAddressConfigSection.react"),{acceptInternational:this.props.acceptInternationalAddresses,addresses:this.props.addresses,buyerName:this.props.buyer&&this.props.buyer.name,onAddressSelected:this.handleAddressSelected,onChangeClicked:this.handleAddressChangeClicked,onNewAddressSelected:this.handleNewAddressSelected,onValidation:this.handleAddressFormValidation,saveErrors:this.props.addressSaveErrors,selectedAddress:this.props.selectedAddress,showEditOptions:this.props.showAddressEditOptions,showForm:this.props.showAddressForm})),d=this.props.usePaymentMethods?b("React").createElement("div",{className:"_4gf2",key:"paymentMethodConfigSection"},b("React").createElement(b("P2PPaymentMethodConfigSection.react"),{confirmedPaymentMethod:this.props.confirmedPaymentMethod,onPaymentMethodConfigured:this.handlePaymentMethodConfigured,onPaymentMethodSelected:this.handlePaymentMethodSelected,onChangeClicked:this.handlePaymentMethodChangeClicked,paymentMethods:this.props.paymentMethods,showEditOptions:this.props.showPaymentMethodEditOptions,showForm:this.props.showPaymentMethodForm})):b("React").createElement("div",{className:"_4gf2",key:"creditCardConfigSection"},b("React").createElement(b("P2PCreditCardConfigSection.react"),{creditCards:this.props.creditCards,onCreditCardSelected:this.handleCreditCardSelected,onChangeClicked:this.handleCreditCardChangeClicked,onNewCreditCardSelected:this.handleNewCreditCardSelected,onValidation:this.handleCreditCardFormValidation,saveErrors:this.props.creditCardSaveErrors,selectedCreditCard:this.props.selectedCreditCard,showEditOptions:this.props.showCreditCardEditOptions,showForm:this.props.showCreditCardForm}));this.props.shippingOptions&&this.props.shippingOptions.length&&this.props.selectedShippingOption&&(a=b("React").createElement("div",{className:"_4gf2",key:"shippingConfigSection"},b("React").createElement(b("P2PShippingOptionsConfigSection.react"),{onShippingOptionSelected:this.handleShippingOptionSelected,shippingOptions:this.props.shippingOptions,selectedShippingOption:this.props.selectedShippingOption})));(this.props.showAddressEditOptions||this.props.showAddressForm)&&(d=null,a=null);(this.props.showPaymentMethodEditOptions||this.props.showCreditCardEditOptions)&&(c=null,a=null);return b("React").createElement("div",null,c,a,d)},renderAsyncPaymentDetailsSection:function(){var a=this.props.asyncPaymentDetails,c=this.props.orderID;return!a||!c?null:b("React").createElement(b("CommerceContactMerchantManualPaymentSection.react"),{paymentOptionDetails:a,invoiceID:c,onReceiptUpdated:function(a,c){b("P2PActions").checkoutManualPaymentReceiptUpdated({receiptFbid:a})}})},renderDialogFooter:function(){__p&&__p();if(!this.props.initialDataLoaded)return null;var a=void 0,c=void 0,d=i._("\u10d2\u10d0\u10e3\u10e5\u10db\u10d4\u10d1\u10d0"),e=i._("\u10d2\u10d0\u10d2\u10e0\u10eb\u10d4\u10da\u10d4\u10d1\u10d0"),f=void 0;b("MessengerEnvironment").messengerui&&(f=b("React").createElement(b("P2PButton.react"),{label:d,onClick:this.props.onClose}));var g=this.props.editingPaymentMethod;if(g&&this.props.selectedPaymentMethod)switch(this.props.selectedPaymentMethod.type){case b("FBPaymentsMethodType").NEW_CREDIT_CARD:e=i._("Add Card");break;case b("FBPaymentsMethodType").NET_BANKING:e=i._("Confirm Bank");break}g=this.props.showCreditCardEditOptions||g||this.props.showAddressEditOptions||this.props.showAddressForm;g?a=b("React").createElement("div",null,b("React").createElement(b("P2PButton.react"),{label:d,onClick:this.handleEditCancelClicked}),b("React").createElement(b("P2PButton.react"),{disabled:this.isSaveDisabled(),label:e,onClick:this.handleContinueClicked,use:"confirm"})):this.props.showAsyncPaymentDetails?a=b("React").createElement("div",null,b("React").createElement(b("P2PButton.react"),{disabled:!this.props.receiptAttached,label:i._("Complete Purchase"),onClick:this.handleCompleteManualPaymentClicked,use:"confirm"})):(c=this.getLegalDisclaimerSection(),a=b("React").createElement("div",{className:"_35cu"},f,b("React").createElement(b("P2PButton.react"),{className:this.props.usePaymentMethods?"_35cv":"",disabled:this.isSaveDisabled(),label:this.getCheckoutButtonLabel(),onClick:this.handlePlaceOrderClicked,use:"confirm"})));return b("React").createElement("div",{className:"_35cw"},b("React").createElement(b("P2PDialogFooter.react"),{className:"_ugq"+(g?" _35cx":"")},c,a))},isSaveDisabled:function(){var a=this.props.configuredPaymentMethod&&this.props.configuredPaymentMethod.isValid&&this.isConfiguredPaymentMethodSelected();return!!this.props.showCreditCardForm&&!this.props.creditCardFormValid||!!this.props.editingPaymentMethod&&!a||!!this.props.showAddressForm&&!this.props.addressFormValid},isConfiguredPaymentMethodSelected:function(){return!!this.props.configuredPaymentMethod&&!!this.props.selectedPaymentMethod&&this.props.configuredPaymentMethod.type===this.props.selectedPaymentMethod.type},getCheckoutButtonLabel:function(){__p&&__p();if(!this.props.usePaymentMethods)return i._("Place Order");var a=this.props.confirmedPaymentMethod,c=i._("Complete Purchase");if(!a)return c;switch(a.type){case b("FBPaymentsMethodType").NET_BANKING:return i._("Log In and Pay");case b("FBPaymentsMethodType").GENERIC_CARD:return i._("Pay");case b("FBPaymentsMethodType").PAY_OVER_COUNTER:return i._("Continue to Pay");default:return c}},getLegalDisclaimerSection:function(){return!this.props.usePaymentMethods||!this.props.confirmedPaymentMethod?null:b("React").createElement("div",{className:"_35d1"},b("React").createElement(b("FBPaymentsLegalDisclaimer_DEPRECATED.react"),{paymentMethodType:this.props.confirmedPaymentMethod.type,paymentType:this.props.paymentProductType}))},handleShippingOptionSelected:function(a){b("P2PActions").checkoutShippingOptionSelected(a.id)},handleCreditCardFormValidation:function(a,c){b("P2PActions").checkoutCreditCardFormValidated(a,c)},handleCreditCardChangeClicked:function(){b("P2PActions").checkoutCreditCardEditOptionsToggled(!0)},handlePaymentMethodChangeClicked:function(){b("P2PActions").checkoutPaymentMethodEditOptionsToggled(!0)},handleCreditCardSelected:function(a){this._toggledCreditCard=a,b("P2PActions").checkoutCreditCardFormToggled(!1)},handleNewCreditCardSelected:function(){b("P2PActions").addCreditCardErrorCleared(),b("P2PActions").checkoutCreditCardFormToggled(!0)},saveCreditCard:function(){this.props.onSaveCreditCard()},handlePaymentMethodSelected:function(a){b("P2PActions").checkoutPaymentMethodSelected(a)},handlePaymentMethodConfigured:function(a){b("P2PActions").checkoutPaymentMethodConfigured(a)},handleAddressFormValidation:function(a,c){b("P2PActions").checkoutAddressFormValidated(a,c)},handleAddressChangeClicked:function(){b("P2PActions").checkoutAddressEditOptionsToggled(!0)},handleAddressSelected:function(a){this._toggledAddress=a,b("P2PActions").checkoutAddressFormToggled(!1)},handleNewAddressSelected:function(){b("P2PActions").addAddressErrorCleared(),b("P2PActions").checkoutAddressFormToggled(!0)},saveAddress:function(){this.props.onSaveAddress()},handleEditCancelClicked:function(){(!this.props.addresses.count()||this.props.showPaymentMethodForm)&&this.props.onClose(),this.cleanup()},cleanup:function(){b("P2PActions").addCreditCardErrorCleared(),b("P2PActions").addAddressErrorCleared(),b("P2PActions").checkoutEditCompleted()},handleContinueClicked:function(){var a=this._toggledAddress;this.props.showCreditCardForm?this.saveCreditCard():this.props.showAddressForm?this.saveAddress():this.props.showCreditCardEditOptions?this._toggledCreditCard?(b("P2PActions").checkoutCreditCardSelected(this._toggledCreditCard.getCredentialId()),this._toggledCreditCard=null):this.handleEditCancelClicked():this.props.editingPaymentMethod?this.isConfiguredPaymentMethodSelected()&&this.props.onConfirmSelectedPaymentMethod():this.props.showAddressEditOptions&&(a?(b("P2PActions").checkoutAddressSelected(a.id),this.props.platformContext&&this.props.onSetAddress(a.id),this._toggledAddress=null):this.handleEditCancelClicked())},handleCompleteManualPaymentClicked:function(){this.props.onCompleteManualPayment()},handlePlaceOrderClicked:function(){this.props.onPlaceOrder()},render:function(){var a=void 0,c=b("MessengerEnvironment").messengerui,d=c?720:680;c||(a=b("React").createElement(b("P2PDialogTitle.react"),null,i._("Checkout")));return b("React").createElement(b("P2PDialog.react"),{className:"_ugr",hideOnEscape:!0,layerHideOnBlur:c,onToggle:this.handleToggle,repositionOnUpdate:!0,shown:!0,width:d},a,b("React").createElement(b("P2PDialogBody.react"),{className:"_4oz6"+(this.props.initialDataLoaded?" _3t72":"")},b("React").createElement("div",{className:"_4oz7"},b("React").createElement("div",{className:"_4oz8"},this.renderItemSection()),this.renderRightPanel()),b("React").createElement(b("P2PLoadingMask.react"),{visible:!this.props.initialDataLoaded||this.props.saving})))}});e.exports=c}),null);
__d("P2PPaymentMethodStore",["P2PActionConstants","CreditCardFormParam","EventEmitter","FBPaymentsMethodType","P2PCreditCard","P2PDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(){g.constructor.call(this),this.$P2PPaymentMethodStore1=b("P2PDispatcher").register(this.onEventDispatched.bind(this)),this.$P2PPaymentMethodStore2=new Map(),this.$P2PPaymentMethodStore3=new Map(),this.$P2PPaymentMethodStore4=new Map()}a.prototype.onEventDispatched=function(a){var c=a.data;a=a.type;switch(a){case b("P2PActionConstants").PAYMENT_METHODS_UPDATED:this.handlePaymentMethodsUpdated(c);this.emit("change");break;case b("P2PActionConstants").PAYMENT_METHODS_UPDATED_ERROR:this.handlePaymentMethodsUpdatedError(c),this.emit("change")}};a.prototype.handlePaymentMethodsUpdated=function(a){__p&&__p();var c=a.id;a=a.paymentMethodsData;var d=a.available_payment_methods_details;a=a.existing_payment_methods;a&&(a=a.map(function(a){var c=a.data;c[b("CreditCardFormParam").CARD_NUMBER]=a.data.ccNumber;c[b("CreditCardFormParam").CREDENTIAL_ID]=a.id;return{creditCard:new(b("P2PCreditCard"))(c),type:b("FBPaymentsMethodType").GENERIC_CARD}}),d=a.concat(d));this.$P2PPaymentMethodStore3["delete"](c);this.$P2PPaymentMethodStore2.set(c,d);this.$P2PPaymentMethodStore4.set(c,a[0])};a.prototype.handlePaymentMethodsUpdatedError=function(a){this.$P2PPaymentMethodStore3.set(a.id,a.error)};a.prototype.getPreviousPaymentMethod=function(a){return a&&this.$P2PPaymentMethodStore4.has(a)?this.$P2PPaymentMethodStore4.get(a):null};a.prototype.getDispatchToken=function(){return this.$P2PPaymentMethodStore1};a.prototype.failedPaymentMethodsFetch=function(a){return this.$P2PPaymentMethodStore3.has(a)};a.prototype.getPaymentMethodsFetchError=function(a){return this.$P2PPaymentMethodStore3.get(a)};e.exports=new a()}),null);
__d("P2PCheckoutStore",["P2PActionConstants","CreditCardFormParam","EventEmitter","MessengerPaymentProductType","P2PAddressStore","P2PAPI","P2PCreditCardStore","P2PDispatcher","P2PPaymentMethodStore","P2PPlatformContextStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=null,i=null,j=!1,k=!1,l=!1,m=!1,n=!1,o=!1,p=!1,q=null,r=!1,s=null,t=!1,u=null,v=null,w=!1,x=null,y=null,z=null,A=null,B=null,C=!1,D=null;c=babelHelpers.inherits(a,b("EventEmitter"));g=c&&c.prototype;function a(){g.constructor.call(this),this.$P2PCheckoutStore1=b("P2PDispatcher").register(this.onEventDispatched.bind(this))}a.prototype.getDispatchToken=function(){return this.$P2PCheckoutStore1};a.prototype.onEventDispatched=function(a){__p&&__p();var c=a.data;a=a.type;b("P2PDispatcher").waitFor([b("P2PAddressStore").getDispatchToken(),b("P2PCreditCardStore").getDispatchToken(),b("P2PPlatformContextStore").getDispatchToken()]);switch(a){case b("P2PActionConstants").CREDIT_CARD_UPDATED:case b("P2PActionConstants").CREDIT_CARD_VERIFIED:this.handleCreditCardUpdated(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_CART_INITIATED:this.handleCheckoutCartInitiated();this.emit("change");break;case b("P2PActionConstants").CHECKOUT_CART_CREATED:this.handleCheckoutCartCreated(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_ADDRESS_SELECTED:this.handleAddressSelected(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_SHIPPING_OPTION_SELECTED:this.handleShippingOptionSelected(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_CREDIT_CARD_SELECTED:this.handleCreditCardSelected(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_ADDRESS_FORM_TOGGLED:this.handleAddressFormToggled(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_CREDIT_CARD_FORM_TOGGLED:this.handleCreditCardFormToggled(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_ADDRESS_EDIT_OPTIONS_TOGGLED:this.handleAddressEditOptionsToggled(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_CREDIT_CARD_EDIT_OPTIONS_TOGGLED:this.handleCreditCardEditOptionsToggled(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_PAYMENT_METHOD_EDIT_OPTIONS_TOGGLED:this.handlePaymentMethodEditOptionsToggled(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_PAYMENT_METHOD_CONFIGURED:this.handlePaymentMethodConfigured(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_PAYMENT_METHOD_CONFIRMED:this.handlePaymentMethodConfirmed(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_PAYMENT_METHOD_SELECTED:this.handlePaymentMethodSelected(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_ADDRESS_FORM_VALIDATED:this.handleAddressFormValidated(c.isValid,c.formData);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_CREDIT_CARD_FORM_VALIDATED:this.handleCreditCardFormValidated(c.isValid,c.formData);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_EDIT_COMPLETED:this.handleCheckoutEditCompleted();this.emit("change");break;case b("P2PActionConstants").CHECKOUT_PROCESSING:this.handleCheckoutProcessing(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_BUYER_PROFILE_UPDATED:this.handleCheckoutBuyerProfileUpdated(c);this.emit("change");break;case b("P2PActionConstants").CHECKOUT_MANUAL_PAYMENT_RECEIPT_UPDATED:this.handleManualPaymentReceiptUpdated(c);this.emit("change");break}};a.prototype.handleCreditCardUpdated=function(a){var c=this.getSelectedCreditCard();c&&c.getCredentialId()===a[b("CreditCardFormParam").CREDENTIAL_ID]&&(i=b("P2PCreditCardStore").getCreditCardByCredentialID(c.getCredentialId()))};a.prototype.handleCheckoutCartInitiated=function(){u=null,B=null,z=null,h=null,v=null,D=null,C=!1};a.prototype.handleCheckoutCartCreated=function(a){u=a.sellerID,B=a.invoiceID,C=!!a.acceptInternationalAddresses};a.prototype.handleCheckoutProcessing=function(a){t=a};a.prototype.handleAddressSelected=function(a){var c=b("P2PAddressStore").getAll(!C);c=c.find(function(b){return b.id===a});h=c;v=null;this.handleCheckoutEditCompleted()};a.prototype.handleShippingOptionSelected=function(a){var b=this.getPlatformContext();b=b&&b.shipping&&b.shipping.shippingOptions;var c=void 0;b&&(c=b.filter(function(b){return b.id===a})[0]);v=c};a.prototype.handleCreditCardSelected=function(a){var c=b("P2PCreditCardStore").getAll(b("MessengerPaymentProductType").MESSENGER_COMMERCE);c=c.filter(function(b){return b.getCredentialId()===a})[0];i=c;this.handleCheckoutEditCompleted()};a.prototype.handleAddressFormToggled=function(a){j=a,this.handleAddressFormValidated(!1,null)};a.prototype.handleCreditCardFormToggled=function(a){k=a,this.handleCreditCardFormValidated(!1,null)};a.prototype.handlePaymentMethodFormToggled=function(a){l=a};a.prototype.handleAddressEditOptionsToggled=function(a){m=a};a.prototype.handleAddressFormValidated=function(a,b){p=a,q=b};a.prototype.handleCreditCardFormValidated=function(a,b){r=a,s=b};a.prototype.handleCheckoutEditCompleted=function(){this.handleAddressFormValidated(!1,null),this.handleAddressEditOptionsToggled(!1),this.handleAddressFormToggled(!1),this.handleCreditCardFormValidated(!1,null),this.handleCreditCardEditOptionsToggled(!1),this.handleCreditCardFormToggled(!1),this.handlePaymentMethodSelected(null),this.handlePaymentMethodConfigured(null),this.handlePaymentMethodFormToggled(!1),this.handlePaymentMethodEditOptionsToggled(!1)};a.prototype.handleCreditCardEditOptionsToggled=function(a){n=a};a.prototype.handlePaymentMethodEditOptionsToggled=function(a){o=a};a.prototype.handleCheckoutBuyerProfileUpdated=function(a){x=a,w=!0};a.prototype.handleManualPaymentReceiptUpdated=function(a){D=a.receiptFbid};a.prototype.handlePaymentMethodConfigured=function(a){y=a};a.prototype.handlePaymentMethodConfirmed=function(a){z=a,this.handleCheckoutEditCompleted()};a.prototype.handlePaymentMethodSelected=function(a){A=a};a.prototype.isAddressFormShown=function(){return!b("P2PAddressStore").getAll(!C).count()||j};a.prototype.isCreditCardFormShown=function(){var a=b("P2PCreditCardStore").getAll(b("MessengerPaymentProductType").MESSENGER_COMMERCE);return!this.isAddressFormShown()&&(!a.length||k)};a.prototype.isPaymentMethodFormShown=function(){var a=!this.isAddressFormShown()&&(!this.getConfirmedPaymentMethod()||l);return a};a.prototype.isAddressEditOptionsShown=function(){return m};a.prototype.isCreditCardEditOptionsShown=function(){return n};a.prototype.isPaymentMethodEditOptionsShown=function(){return o};a.prototype.isEditingPaymentMethod=function(){return this.isPaymentMethodFormShown()||this.isPaymentMethodEditOptionsShown()};a.prototype.getConfirmedPaymentMethod=function(){return z||b("P2PPaymentMethodStore").getPreviousPaymentMethod(this.getInvoiceID())};a.prototype.getConfiguredPaymentMethod=function(){return y};a.prototype.getSelectedPaymentMethod=function(){return A};a.prototype.getAttachedReceiptFbid=function(){return D};a.prototype.getSelectedAddress=function(){__p&&__p();var a=this.getPlatformContext(),c=b("P2PAddressStore").getAll(!C),d;void 0;if(h)return h;if(a&&a.shipping&&a.shipping.selectedShippingAddressID){d=c.find(function(b){return a&&b.id===a.shipping.selectedShippingAddressID});if(d)return d}return c.first()};a.prototype.getSelectedShippingOption=function(){__p&&__p();var a=this.getPlatformContext();a=a&&a.shipping;var b=a&&a.selectedShippingOptionID;a=a&&a.shippingOptions;var c;void 0;if(v)return v;if(a&&a.length){c=a.filter(function(a){return a.id===b})[0];if(c)return c}return a&&a[0]};a.prototype.getSelectedCreditCard=function(){var a=b("P2PCreditCardStore").getAll(b("MessengerPaymentProductType").MESSENGER_COMMERCE);return i||a[0]};a.prototype.isAddressFormValid=function(){return p};a.prototype.getAddressFormData=function(){return q};a.prototype.isCreditCardFormValid=function(){return r};a.prototype.getCreditCardFormData=function(){return s};a.prototype.isProcessing=function(){return t};a.prototype.isBuyerProfileFetchComplete=function(){return w};a.prototype.getPlatformContext=function(){if(u)return b("P2PPlatformContextStore").getPlatformContextByOtherUserID(u)};a.prototype.getInvoiceID=function(){return B};a.prototype.getPlaceOrderFormData=function(){var a=this.getPlatformContext(),c=this.getSelectedShippingOption(),d=this.getSelectedAddress(),e=this.getSelectedCreditCard(),f=b("CreditCardFormParam").CREDENTIAL_ID,g={};g[f]=e&&e.getCredentialId();g=babelHelpers["extends"]({},g,{amount:c&&c.rawTotal,platform_context_id:a&&a.id,receiverId:a&&a.sellerID,shippingAddressID:d&&d.id,shippingOptionID:c&&c.id});return g};a.prototype.getBuyerProfileData=function(){if(x)return x;x={};b("P2PAPI").getCurrentUserProfileData()};e.exports=new a()}),null);
__d("P2PCheckoutDialogContainer.react",["fbt","invariant","Arbiter","FBPaymentsCreditCardVerificationDialog_DEPRECATED.react","FBPaymentsMethodType","Link.react","P2PActions","P2PAPI","P2PAPIUtils","P2PAddressStore","P2PCreditCardStore","P2PCheckoutDialog.react","P2PCheckoutStore","P2PDispatcher","P2PEditCreditCardDialog.react","P2PErrorDialog.react","P2PLogger","P2PPasswordProtectionNUXDialog.react","P2PPasswordProtectionStatusTypes","P2PPaymentLoggerEvent","P2PPaymentLoggerEventFlow","P2PPlatformContextShape","P2PSuccessDialog.react","P2PText.react","P2PVerifyCreditCardDialog.react","React","ReactLayeredComponentMixin_DEPRECATED","StoreAndPropBasedStateMixin"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=b("React").PropTypes;var i="fbpay_login_and_pay",j="about:blank";c=b("React").createClass({displayName:"P2PCheckoutDialogContainer",mixins:[b("ReactLayeredComponentMixin_DEPRECATED"),b("StoreAndPropBasedStateMixin")(b("P2PAddressStore"),b("P2PCheckoutStore"),b("P2PCreditCardStore"))],propTypes:{acceptInternationalAddresses:a.bool,asyncPaymentDetails:a.object,onCheckoutSuccess:a.func,onClose:a.func.isRequired,onSeeReceiptClick:a.func,configSelections:a.string,customCheckoutDetails:a.node,paymentMethods:a.array,paymentMethodsFetchError:a.object,paymentProductType:a.string,platformContext:b("P2PPlatformContextShape"),platformContextSaveError:a.object,productItemID:a.string,showAsyncPaymentDetails:a.bool,showTaxField:a.bool,usePaymentMethods:a.bool},getInitialState:function(){return{creditCardVerificationDialogShown:!1,editCreditCardDialogShown:!1,openedWindow:null,passwordProtectionNUXShown:!1,successDialogShown:!1,transferError:null,verifyCreditCardDialogShown:!1}},statics:{calculateState:function(a){return{addresses:b("P2PAddressStore").getAll(!a.acceptInternationalAddresses),addressFormData:b("P2PCheckoutStore").getAddressFormData(),addressFormValid:b("P2PCheckoutStore").isAddressFormValid(),addressSaveErrors:b("P2PAddressStore").getSaveErrors(),buyer:b("P2PCheckoutStore").getBuyerProfileData(),configuredPaymentMethod:b("P2PCheckoutStore").getConfiguredPaymentMethod(),confirmedPaymentMethod:b("P2PCheckoutStore").getConfirmedPaymentMethod(),creditCardAsyncRequestState:b("P2PCreditCardStore").getAsyncRequestState(),creditCardFormData:b("P2PCheckoutStore").getCreditCardFormData(),creditCardFormValid:b("P2PCheckoutStore").isCreditCardFormValid(),creditCards:b("P2PCreditCardStore").getAll(a.paymentProductType),creditCardSaveErrors:b("P2PCreditCardStore").getSaveErrors(),editingPaymentMethod:b("P2PCheckoutStore").isEditingPaymentMethod()&&a.usePaymentMethods,initialDataLoaded:a.platformContext&&(!!a.asyncPaymentDetails||b("P2PAddressStore").isAddressesFetchComplete()&&b("P2PCreditCardStore").isCreditCardsFetchComplete()&&b("P2PCheckoutStore").isBuyerProfileFetchComplete()&&(!a.usePaymentMethods||!!a.paymentMethods)),orderID:b("P2PCheckoutStore").getInvoiceID(),receiptAttached:!!b("P2PCheckoutStore").getAttachedReceiptFbid(),saving:b("P2PCheckoutStore").isProcessing()||b("P2PCreditCardStore").isSaving()||b("P2PAddressStore").isSaving(),selectedAddress:b("P2PCheckoutStore").getSelectedAddress(),selectedCreditCard:b("P2PCheckoutStore").getSelectedCreditCard(),selectedPaymentMethod:b("P2PCheckoutStore").getSelectedPaymentMethod(),selectedShippingOption:b("P2PCheckoutStore").getSelectedShippingOption(),shippingOptions:a.platformContext&&a.platformContext.shipping?a.platformContext.shipping.shippingOptions:null,showAddressForm:b("P2PCheckoutStore").isAddressFormShown(),showCreditCardForm:b("P2PCheckoutStore").isCreditCardFormShown()&&!a.usePaymentMethods,showAddressEditOptions:b("P2PCheckoutStore").isAddressEditOptionsShown(),showCreditCardEditOptions:b("P2PCheckoutStore").isCreditCardEditOptionsShown()&&!a.usePaymentMethods,showPaymentMethodEditOptions:b("P2PCheckoutStore").isPaymentMethodEditOptionsShown()&&a.usePaymentMethods,showPaymentMethodForm:b("P2PCheckoutStore").isPaymentMethodFormShown()&&a.usePaymentMethods}}},_paymentMethodAddCardRequestId:"",UNSAFE_componentWillMount:function(){this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_CHECKOUT),b("P2PDispatcher").explicitlyRegisterStores([b("P2PCheckoutStore")])},componentWillUnmount:function(){this._passwordCancelSubscribeToken!==null&&(b("Arbiter").unsubscribe(this._passwordCancelSubscribeToken),this._passwordCancelSubscribeToken=null)},componentDidUpdate:function(a,b){this._trackEvents(a,b)},log:function(a,c){var d=this.props.platformContext,e={};d&&(e=d.product.rawAmount);b("P2PLogger").log(a,babelHelpers["extends"]({www_event_flow:b("P2PPaymentLoggerEventFlow").UI_FLOW_CHECKOUT,raw_amount:e.amount,currency:e.currency,object_id:this.props.productItemID},c))},_placeOrderPending:!1,_passwordCancelSubscribeToken:null,_passwordProtectionNUXPending:!1,handleCancel:function(){this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_CANCEL),this.props.onClose()},handleSuccess:function(){var a=arguments.length<=0||arguments[0]===undefined?!0:arguments[0];this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_SUCCESS);a&&this.props.onClose()},handleSaveAddress:function(){this.saveAddress()},closeOpenedWindow:function(){this.state.openedWindow&&this.state.openedWindow.close()},saveAddress:function(){b("P2PAPI").addAddress(babelHelpers["extends"]({},this.state.addressFormData,{platformContext:this.props.platformContext,onSuccess:this.handleSaveAddressSuccess,onError:this.handleSaveAddressError})),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_ADDRESS_DETAILS)},handleSaveAddressSuccess:function(){this.log(b("P2PPaymentLoggerEvent").UI_ACTN_ADD_ADDRESS_SUCCESS)},handleSaveAddressError:function(a){a=a.errors,this.log(b("P2PPaymentLoggerEvent").UI_ACTN_ADD_ADDRESS_FAIL,{message:a&&a.general?a.general.message:""})},handleSaveCreditCard:function(){this.saveCreditCard()},saveCreditCard:function(){b("P2PAPI").addCreditCard(babelHelpers["extends"]({product_type:this.props.paymentProductType},this.state.creditCardFormData,{hasPlatformContext:!!this.props.platformContext,onSuccess:this.handleSaveCreditCardSuccess,onError:this.handleSaveCreditCardError})),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CONFIRM_CARD_DETAILS)},handleSaveCreditCardSuccess:function(){this._placeOrderPending&&(this._placeOrderPending=!1,this.placeOrder()),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_ADD_CARD_SUCCESS)},handleSaveCreditCardError:function(a){a=a.errors,this.log(b("P2PPaymentLoggerEvent").UI_ACTN_ADD_CARD_FAIL,{message:a&&a.general?a.general.message:""})},handleConfirmPaymentMethod:function(){var a=this.state.configuredPaymentMethod;switch(a.type){case b("FBPaymentsMethodType").NEW_CREDIT_CARD:var c=b("P2PAPIUtils").genRequestID();this._paymentMethodAddCardRequestId=c;b("P2PAPI").addCreditCard(babelHelpers["extends"]({product_type:this.props.paymentProductType,requestID:c},a.formData,{hasPlatformContext:!!this.props.platformContext,onSuccess:this.handleConfirmPaymentMethodSuccess}));break;case b("FBPaymentsMethodType").GENERIC_CARD:case b("FBPaymentsMethodType").PAY_OVER_COUNTER:case b("FBPaymentsMethodType").MANUAL_TRANSFER:case b("FBPaymentsMethodType").NET_BANKING:this.handleConfirmPaymentMethodSuccess();break}},handleConfirmPaymentMethodSuccess:function(){var a=this.state.configuredPaymentMethod;switch(a.type){case b("FBPaymentsMethodType").NEW_CREDIT_CARD:this.handleConfirmPaymentMethodAddCardSuccess();break;default:b("P2PActions").checkoutPaymentMethodConfirmed(a)}},handleConfirmPaymentMethodAddCardSuccess:function(){var a=b("P2PCreditCardStore").getAsyncRequestState();a=a[this._paymentMethodAddCardRequestId];if(!a)return;a=b("P2PCreditCardStore").getCreditCardByCredentialID(a.credential_id);a={creditCard:a,type:b("FBPaymentsMethodType").GENERIC_CARD};this._paymentMethodAddCardRequestId="";b("P2PActions").checkoutPaymentMethodConfirmed(a)},handlePlaceOrder:function(){if(this.props.usePaymentMethods){this.completePaymentMethodCheckout();return}this.state.showCreditCardForm?(this._placeOrderPending=!0,this.saveCreditCard()):this.placeOrderWithExistingCard()},handleCompleteManualPayment:function(){var a=this.state.orderID,c=this.props.asyncPaymentDetails&&this.props.asyncPaymentDetails.id;a&&c||h(0);b("P2PAPI").completeReceiptUploadCheckout({onSuccess:function(){this.setState({successDialogShown:!0})}.bind(this),onError:function(a){this.setState({transferError:a})}.bind(this),receiptImageID:b("P2PCheckoutStore").getAttachedReceiptFbid(),invoiceID:a,selectedPaymentOptionID:c})},placeOrderWithExistingCard:function(){__p&&__p();var a=b("P2PCheckoutStore").getSelectedCreditCard();a||h(0);if(!a.getIsVerified()){this.setState({verifyCreditCardDialogShown:!0});return}else if(a.isExpired()){this.setState({editCreditCardDialogShown:!0});return}this.placeOrder()},placeOrder:function(){b("P2PActions").checkoutProcessing(!0),this.setState({transferError:null}),this._passwordCancelSubscribeToken=b("Arbiter").subscribeOnce("PasswordReauthDialogCancelClick",function(){this._passwordCancelSubscribeToken=null,b("P2PActions").checkoutProcessing(!1)}.bind(this)),b("P2PAPI").createTransaction({error:this.handlePlaceOrderError,formData:b("P2PCheckoutStore").getPlaceOrderFormData(),success:this.handlePlaceOrderSuccess}),this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_CONFIRM)},handlePlaceOrderError:function(a){b("P2PActions").checkoutProcessing(!1),this.setState({transferError:a})},handlePlaceOrderSuccess:function(a){b("P2PActions").checkoutProcessing(!1);a=a.passwordProtection===b("P2PPasswordProtectionStatusTypes").NOT_SET;a?this.setState({passwordProtectionNUXShown:!0}):this.handleSuccess()},completePaymentMethodCheckout:function(){var a=this.state.confirmedPaymentMethod;switch(a.type){case b("FBPaymentsMethodType").NET_BANKING:case b("FBPaymentsMethodType").PAY_OVER_COUNTER:var c=window.open(j,i);this.setState({openedWindow:c});break;case b("FBPaymentsMethodType").GENERIC_CARD:a.creditCard.getCSC()?this.completeNMORCheckout({securityCode:a.creditCard.getCSC()}):this.setState({creditCardVerificationDialogShown:!0});return}this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_CONFIRM);this.completeNMORCheckout()},completeNMORCheckout:function(a){__p&&__p();var c=this.props.platformContext;c||h(0);var d=this.state.confirmedPaymentMethod;d||h(0);var e=d.type,f=null,g=null;switch(e){case b("FBPaymentsMethodType").GENERIC_CARD:e="cc";g=d.creditCard.getCredentialId();a&&a.securityCode||h(0);break;case b("FBPaymentsMethodType").NET_BANKING:f={bank_code:d.bank.code};break;case b("FBPaymentsMethodType").MANUAL_TRANSFER:f={receipt_image_id:d.receiptFbid,transfer_option_id:d.optionId};break}d=babelHelpers["extends"]({amount:this.state.selectedShippingOption.rawTotal,currency:c.product.rawAmount.currency,nmorOrderType:this.props.paymentProductType,receiverID:c.sellerID,orderID:this.state.orderID,paymentMethodType:e,paymentMethodData:f,credentialId:g,shippingAddressID:this.state.selectedAddress.id,shippingOptionID:this.state.selectedShippingOption.id,error:this.handleCompletePaymentMethodCheckoutError,success:this.handleCompletePaymentMethodCheckoutSuccess},a);b("P2PActions").checkoutProcessing(!0);b("P2PAPI").completeNMORCheckout(d)},handleCreditCardVerificationCancel:function(){this.setState({creditCardVerificationDialogShown:!1})},handleVerifyCreditCardAndCompleteCheckout:function(a){this.completeNMORCheckout({securityCode:a})},handleCompletePaymentMethodCheckoutError:function(a){b("P2PActions").checkoutProcessing(!1),this.setState({transferError:a}),this.closeOpenedWindow()},handleCompletePaymentMethodCheckoutSuccess:function(a,c){__p&&__p();b("P2PActions").checkoutProcessing(!1);this.setState({creditCardVerificationDialogShown:!1});var d=this.props.onCheckoutSuccess;d&&d(a,c);d=this.state.confirmedPaymentMethod;switch(d.type){case b("FBPaymentsMethodType").NET_BANKING:c&&c.net_banking_info||h(0);a=c.net_banking_info.redirect_url;window.open(a,i);this.handleSuccess();break;case b("FBPaymentsMethodType").PAY_OVER_COUNTER:c&&c.pay_over_counter_info||h(0);d=c.pay_over_counter_info.instructions_url;window.open(d,i);this.handleSuccess();break;case b("FBPaymentsMethodType").MANUAL_TRANSFER:this.handleSuccess(!1);break;default:this.handleSuccess(!1),this.setState({successDialogShown:!0})}},handleSetAddress:function(a){var c=this.props.platformContext;c||h(0);b("P2PAPI").setPlatformContextShippingAddress({platformContextID:c.id,shippingAddressID:a})},renderLayers:function(){var a={};this.props.platformContextSaveError?a.error=b("React").createElement(b("P2PErrorDialog.react"),{title:g._("Problem with purchase"),onOKClick:this.handleCancel,error:this.props.platformContextSaveError}):this.props.paymentMethodsFetchError?a.error=b("React").createElement(b("P2PErrorDialog.react"),{title:g._("\u10e3\u10d9\u10d0\u10ea\u10e0\u10d0\u10d5\u10d0\u10d3, \u10d3\u10d0\u10e4\u10d8\u10e5\u10e1\u10d8\u10e0\u10d3\u10d0 \u10e8\u10d4\u10ea\u10d3\u10dd\u10db\u10d0"),onOKClick:this.handleCancel,error:g._("We can't load the available payment methods at this time. Please try again later.")}):this.state.transferError?a.error=b("React").createElement(b("P2PErrorDialog.react"),{title:g._("Problem with purchase"),onOKClick:this.handleCancel,error:this.state.transferError}):this.state.verifyCreditCardDialogShown?a.verificationDialog=b("React").createElement(b("P2PVerifyCreditCardDialog.react"),{creditCard:this.state.selectedCreditCard,asyncRequestState:this.state.creditCardAsyncRequestState,isSending:!0,onCancel:function(){this.setState({verifyCreditCardDialogShown:!1}),b("P2PActions").checkoutProcessing(!1)}.bind(this),onSuccess:function(){this.setState({verifyCreditCardDialogShown:!1}),this.placeOrderWithExistingCard()}.bind(this)}):this.state.editCreditCardDialogShown&&(a.editCreditCardDialog=b("React").createElement(b("P2PEditCreditCardDialog.react"),{asyncRequestState:this.state.creditCardAsyncRequestState,creditCard:this.state.selectedCreditCard,onCancel:function(){this.setState({editCreditCardDialogShown:!1}),b("P2PActions").checkoutProcessing(!1)}.bind(this),onSuccess:function(){this.setState({editCreditCardDialogShown:!1}),this.placeOrderWithExistingCard()}.bind(this)}));return a},render:function(){__p&&__p();if(this.state.passwordProtectionNUXShown)return b("React").createElement(b("P2PPasswordProtectionNUXDialog.react"),{onComplete:this.handleSuccess});else if(this.state.creditCardVerificationDialogShown){var a=this.state.confirmedPaymentMethod.creditCard,c=b("React").createElement(b("P2PText.react"),{size:"small",type:"secondary"},b("React").createElement(b("Link.react"),{onClick:this.handleCreditCardVerificationCancel,size:"small"},g._("Use Different Payment Method"))),d=g._("Pay");return b("React").createElement(b("FBPaymentsCreditCardVerificationDialog_DEPRECATED.react"),{creditCard:a,leftContent:c,loading:this.state.saving,onConfirm:this.handleVerifyCreditCardAndCompleteCheckout,primaryButtonText:d,showCancelButton:!1})}else if(this.state.successDialogShown){a=g._("Your purchase is complete. You'll receive a confirmation email soon.");this.props.asyncPaymentDetails&&(a=g._("Your proof of payment has been sent. The seller will verify your payment soon."));return b("React").createElement(b("P2PSuccessDialog.react"),{buttonLabel:g._("See Receipt"),buttonUse:"confirm",onOKClick:this.props.onSeeReceiptClick||this.handleSuccess,onToggle:function(){this.handleSuccess()}.bind(this),showCloseButton:!0,title:g._("Confirmation")},b("React").createElement(b("P2PText.react"),{type:"secondary",style:{textAlign:"center"}},a))}return b("React").createElement(b("P2PCheckoutDialog.react"),babelHelpers["extends"]({},this.props,this.state,{onClose:this.handleCancel,onCompleteManualPayment:this.handleCompleteManualPayment,onConfirmSelectedPaymentMethod:this.handleConfirmPaymentMethod,onPlaceOrder:this.handlePlaceOrder,onSaveAddress:this.handleSaveAddress,onSaveCreditCard:this.handleSaveCreditCard,onSetAddress:this.handleSetAddress}))},_trackEvents:function(a,c){__p&&__p();!a.platformContextSaveError&&this.props.platformContextSaveError&&this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_CART_CREATION_FAIL);if(!this.state.initialDataLoaded)return;!c.initialDataLoaded&&this.state.initialDataLoaded&&this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_CART_CREATION_SUCCESS);!c.showCreditCardForm&&this.state.showCreditCardForm&&this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_ADD_CARD);c.showCreditCardForm&&!this.state.showCreditCardForm&&this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CANCEL_ADD_CARD);!c.showCreditCardEditOptions&&this.state.showCreditCardEditOptions&&this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_CHOOSE_CARD);!c.showAddressForm&&this.state.showAddressForm&&this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_ADD_ADDRESS);c.showAddressForm&&!this.state.showAddressForm&&this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CANCEL_ADD_ADDRESS);!c.showAddressEditOptions&&this.state.showAddressEditOptions&&this.log(b("P2PPaymentLoggerEvent").UI_ACTN_INITIATE_CHOOSE_ADDRESS);!c.verifyCreditCardDialogShown&&this.state.verifyCreditCardDialogShown&&this.log(b("P2PPaymentLoggerEvent").UI_ACTN_VERIFY_CSC);!c.editCreditCardDialogShown&&this.state.editCreditCardDialogShown&&this.log(b("P2PPaymentLoggerEvent").UI_ACTN_EDIT_CARD);!c.transferError&&this.state.transferError&&this.log(b("P2PPaymentLoggerEvent").UI_ACTN_CHECKOUT_FAIL)}});e.exports=c}),null);
__d("P2PMCCartCreationDialogContainer.react",["MessengerPaymentProductType","P2PActions","P2PAPI","P2PCheckoutDialogContainer.react","P2PCheckoutStore","P2PPlatformContextStore","React","StoreAndPropBasedStateMixin"],(function(a,b,c,d,e,f){"use strict";a=b("React").PropTypes;c=b("React").createClass({displayName:"P2PMCCartCreationDialogContainer",mixins:[b("StoreAndPropBasedStateMixin")(b("P2PCheckoutStore"),b("P2PPlatformContextStore"))],propTypes:{configSelections:a.string,productItemID:a.string.isRequired,sellerID:a.string.isRequired},statics:{calculateState:function(a){return{platformContext:b("P2PCheckoutStore").getPlatformContext(),platformContextSaveError:b("P2PPlatformContextStore").getSaveError(a.productItemID)}}},UNSAFE_componentWillMount:function(){b("P2PAPI").createMCCart({productItemID:this.props.productItemID,sellerID:this.props.sellerID})},handleClose:function(){b("P2PActions").clearPlatformContextSaveErrors(this.props.productItemID),b("P2PActions").hideDialog()},render:function(){return b("React").createElement(b("P2PCheckoutDialogContainer.react"),{onClose:this.handleClose,configSelections:this.props.configSelections,paymentProductType:b("MessengerPaymentProductType").MESSENGER_COMMERCE,platformContext:this.state.platformContext,platformContextSaveError:this.state.platformContextSaveError,productItemID:this.props.productItemID})}});e.exports=c}),null);
__d("MNCommercePromotionMercuryShareAttachment.react",["Banzai","MercuryFallbackShareAttachment.react","MercuryShareAttachmentReactShape","MercuryShareAttachmentRenderLocations","MessengerAdsWebTypedLogger","MNAdsLoggerEventEnum","MNCommerceCheckoutOrderConfigDialogContainer.react","MNCommerceDialogStateActions","MNCommerceMessageType","MessengerPlatformGenericItemMercuryAttachment.react","MNContentSubscriptionMessageUserEngagementTypedLogger","MNPlatformMessageUserEngagementTypedLogger","P2PActions","P2PMCCartCreationDialogContainer.react","React","StoryAttachmentStyle","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;function h(a){if(a!==undefined){a=a.match(/\d+/);if(a!==undefined&&a!==null)return a[0]}return null}function i(a,event){__p&&__p();var c=h(a.props.pageID),d=a.getRetailItem(a.props.attachment.target);d=d&&d.id;if(a.props.mnMessageType==b("MNCommerceMessageType").CONTENT_SUBSCRIPTION){new(b("MNContentSubscriptionMessageUserEngagementTypedLogger"))().setPageID(c).setMessageID(a.props.messageID).setCommerceItemID(d).setName(event).log();switch(event){case"mn_platform_msg_imp":b("Banzai").post("mn_platform_message_imp_setsuna",{page_id:c,item_id:d});break;case"mn_platform_msg_click":b("Banzai").post("mn_platform_message_click_setsuna",{page_id:c,item_id:d});break;default:break}}new(b("MNPlatformMessageUserEngagementTypedLogger"))().setPageID(c).setMessageID(a.props.messageID).setCommerceItemID(d).setName(event).log()}d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$4=function(){__p&&__p();var a=this.props.attachment&&this.props.attachment.target;if(!a)return;a=this.getRetailItem(a);a=a&&a.id;this.props.isSponsored&&new(b("MessengerAdsWebTypedLogger"))().setEvent(b("MNAdsLoggerEventEnum").LINK_CLICK_CTA).setIsSponsored(this.props.isSponsored).setItemID(a).setMessageID(this.props.messageID).setPageID(this.props.pageID).log();i(this,"mn_platform_msg_click");var c=this.props.pageID,d=function(a,c,d){return b("P2PActions").showDialog(b("P2PMCCartCreationDialogContainer.react"),{productItemID:a,sellerID:c,configSelections:d})};b("MNCommerceDialogStateActions").showDialog(b("MNCommerceCheckoutOrderConfigDialogContainer.react"),{onContinue:d,itemID:a,ownerID:c})}.bind(this),c}a.prototype.componentDidMount=function(){i(this,"mn_platform_msg_imp")};a.prototype.render=function(){var a=this.props.attachment&&this.props.attachment.target;if(!a)return b("React").createElement(b("MercuryFallbackShareAttachment.react"),this.props);var c=this.props.attachment&&this.props.attachment.uri,d=this.props.attachment&&this.props.attachment.label,e=this.$1(),f=this.getRetailItem(a),g=void 0;f&&f.call_to_actions&&f.call_to_actions.length>0?g=f.call_to_actions:g=a.call_to_actions;return b("React").createElement(b("MessengerPlatformGenericItemMercuryAttachment.react"),{callToActions:this.$2(g),isMediaAttachment:this.$3(),isSponsored:this.props.isSponsored,isSubattachment:this.props.isSubattachment,itemID:f&&f.id,label:d,location:this.props.location,longestCTAs:this.props.longestCTAs,longestMetaline:this.props.longestMetaline,longestName:this.props.longestName,messageID:this.props.messageID,mnMessageType:this.props.mnMessageType,pageID:this.props.pageID,threadID:this.props.threadID,retailItem:f,url:c,width:this.props.maxWidth,isButtonList:e})};a.prototype.$2=function(a){a=a||[];a=a.map(function(a){var c=a.action_link&&(a.action_link.startsWith("fb-messenger://payments/buy/mc?")||a.action_link.startsWith("fb-messenger://business/commerce/"));if(c)return b("gkx")("AT4VcZ2n8GFrD7MjVVAjcX0NmvwopB7f803i8mNRrJiQunF1FwYQ1kl6EgxABUzgu-ERWV--QUw6PQC9d4CFCek0")?babelHelpers["extends"]({onClick:this.$4},a):null;else return a}.bind(this));return a.filter(function(a){return a})};a.prototype.$1=function(){var a=this.props.attachment;a=a&&a.style_list;return a&&a.length&&a[0]===b("StoryAttachmentStyle").MESSENGER_PLATFORM_BUTTON_LIST?!0:!1};a.prototype.$3=function(){var a=this.props.attachment;a=a&&a.style_list;return a&&a.length&&a[0]===b("StoryAttachmentStyle").MESSENGER_PLATFORM_MEDIA_ATTACHMENT?!0:!1};a.prototype.getRetailItem=function(a){var b=this.$1();if(b)return a;if(a&&a.items)if(a.items.length)return a.items[0];else return null;return a};a.propTypes={attachment:b("MercuryShareAttachmentReactShape"),isSponsored:c.bool,isSubattachment:c.bool,location:c.oneOf(b("MercuryShareAttachmentRenderLocations").getValues()),maxWidth:c.number,messageID:c.string,mnMessageType:c.string,pageID:c.string,threadID:c.string,longestCTAs:c.number,longestMetaline:c.string,longestName:c.string};e.exports=a}),null);
__d("OzBugNub.react",["cx","fbt","Link.react","OzImmutablePureRenderMixin","React","Tooltip","URI"],(function(a,b,c,d,e,f,g,h){"use strict";var i=1031744366845008,j="Error:\n\nExpected Result:\n\nSteps taken before error occurred:\n";a=b("React").createClass({displayName:"MessengerBugNub",mixins:[b("OzImmutablePureRenderMixin")],render:function(){var a=new(b("URI"))("/ajax/bugs/report").setQueryData({config_id:i,defaultText:j});return b("React").createElement("div",{className:"_gml"},b("React").createElement(b("Link.react"),babelHelpers["extends"]({href:"#",ajaxify:a,className:"_gmm",rel:"dialog"},b("Tooltip").propsFor(h._("Report a bug"))),b("React").createElement("span",{className:"_gmn"})))}});e.exports=a}),null);
__d("OzDialogContainer.react",["OzStores","React","Reflux"],(function(a,b,c,d,e,f){a=b("OzStores").DialogStore;c=b("React").createClass({displayName:"OzDialogContainer",mixins:[b("Reflux").connect(a,"dialog")],render:function(){var a=this.state.dialog.dialogClass;if(a){var c=this.state.dialog.dialogProps||{};return b("React").createElement(a,babelHelpers["extends"]({ref:"dialog"},c,{key:"dialog"}))}return null}});e.exports=c}),null);
__d("OzExtensionCheck.react",["cx","MessengerDialogHeader.react","MessengerDialogTitle.react","OzActions","React","ReloadPage","ShimButton.react","SUIAtlasTheme","SUINotice.react","XUIDialog.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i;c=b("React").PropTypes;h=babelHelpers.inherits(j,b("React").Component);h&&h.prototype;j.prototype.render=function(){"use strict";return b("React").createElement(b("XUIDialog.react"),{width:544,shown:!0,layerHideOnBlur:!1,className:"_4ebx"},b("React").createElement("div",{className:"_4eby _2c9g _1-6z"},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogTitle.react"),null,"The Oz Chrome Extension is missing")),b("React").createElement(b("SUINotice.react"),{theme:b("SUIAtlasTheme"),type:"error"},b("React").createElement("div",{className:"_4d80"},"Toto, the oz chrome extension that helps you manage your tabs, and record what was done for each task in the background is missing!",b("React").createElement("strong",null,b("React").createElement(b("ShimButton.react"),{form:"link",onClick:this.props.onInstall}," ","Click here to install it."))))))};function j(){"use strict";h.apply(this,arguments)}j.propTypes={onInstall:c.func.isRequired};d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(){window.chrome.webstore.install(undefined,function(a){return b("ReloadPage").now()})},c}a.prototype.componentDidMount=function(){"use strict";var a=!!document.querySelector("#toto-installed");if(a)return;b("OzActions").showDialog(j,{onInstall:this.$1})};a.prototype.render=function(){"use strict";return null};e.exports=a}),null);
__d("OzButton.react",["cx","joinClasses","promiseFinally","React"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"OzButton",propTypes:{disabled:a.bool,onClick:a.func,primary:a.bool,tight:a.bool,type:a.oneOf(["button","submit","reset"]),use:a.oneOf(["default","warning","danger"])},getDefaultProps:function(){return{disabled:!1,primary:!1,tight:!1,type:"button",use:"default"}},getInitialState:function(){return{loading:!1}},render:function(){var a=this.props,c=a.children,d=a.className,e=a.disabled;a.onClick;var f=a.primary,g=a.tight,h=a.type,i=a.use;a=babelHelpers.objectWithoutProperties(a,["children","className","disabled","onClick","primary","tight","type","use"]);var j=this.state.loading;d=b("joinClasses")(d,"_325k"+(j?" _3e2u":"")+(f?" _325m":"")+(g?" _4wku":"")+(i==="default"?" _325o":"")+(i==="warning"?" _325p":"")+(i==="danger"?" _325q":"")+(e?" _ysb":"")+(!e&&!j?" _4wkv":"")+" _1-hv");return b("React").createElement("button",babelHelpers["extends"]({className:d,disabled:e,onClick:this._handleClick,type:h},a),b("React").createElement("span",{className:"_325r"},c))},_handleClick:function(a){__p&&__p();var c=this.props,d=c.disabled,e=c.loading;c=c.onClick;if(d||e){a.preventDefault();return}if(!c)return;if(c.length>1){this.setState({loading:!0});c(a,this._done);return}d=c(a);d&&d.then&&(this.setState({loading:!0}),b("promiseFinally")(d,this._done))},_done:function(){this.isMounted()&&this.setState({loading:!1})}});e.exports=c}),null);
__d("OzFailed.react",["cx","immutable","OzButton.react","React","ReloadPage"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("immutable").Iterable;d=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){"use strict";return b("React").createElement("div",{className:"_30r7"},b("React").createElement("div",{className:"_4rg-"},b("React").createElement("div",null,"Oz couldn't load the following resources:",b("React").createElement("ul",null,this.props.problems.map(function(a,c){return b("React").createElement("li",{key:c},a)})),"Please wait a few seconds, then refresh. If this problem persists for more than a minute or so, contact the oncall."),b("React").createElement("div",{className:"_4rg_"},b("React").createElement(b("OzButton.react"),{primary:!0,onClick:b("ReloadPage").now},"Refresh"))))};function a(){"use strict";h.apply(this,arguments)}a.propTypes={problems:d.instanceOf(c)};e.exports=a}),null);
__d("OzHumans",["OzHelpers"],(function(a,b,c,d,e,f){__p&&__p();var g=6e4,h=45e3,i=-1;function j(a){return a.get("coach-mode?")}function a(a){return a.get("is-coach")}function k(a){return a.get("away?")}function l(a){return a&&!k(a)&&b("OzHelpers").serverNow()-a.get("at",0)<h}function m(a){return l(a)&&a.get("inactive-ms",0)<g}function c(a){return m(a)&&a.get("load",0)<=0&&a.get("team",i)!==i}function n(a){return m(a)&&!j(a)}function d(a){var b=a.filter(n).count();a=a.reduce(function(a,b){return a+b.get("load",0)},0);return a/b}e.exports={inCoachMode:j,isCoach:a,isAway:k,isPresent:l,isActive:m,isIdle:c,isWorking:n,avgLoad:d}}),null);
__d("OzReps",["OzHelpers"],(function(a,b,c,d,e,f){__p&&__p();var g=1e3*60*60*8;function h(a){return!a||b("OzHelpers").serverNow()-a.get("updated-at",0)>g}function i(a){a=a.get("stats");return h(a)?0:a.get("closed-intents",0)}function a(a,b){var c=a.get("team");return b.reduce(function(a,b){return a+(b.get("team")===c?i(b):0)},0)}e.exports={closedIntentCount:i,teamClosedIntentCount:a}}),null);
__d("OzTriSwitch.react",["cx","React","joinClasses"],(function(a,b,c,d,e,f,g){__p&&__p();function a(a){var c=a.className,d=a.value,e=a.onClick,f=a.label,g=a.animated;a=babelHelpers.objectWithoutProperties(a,["className","value","onClick","label","animated"]);return b("React").createElement("div",babelHelpers["extends"]({},a,{className:b("joinClasses")(c,"_56de"+(a.reverseColors?" _3tyl":"")+(g?" _56df":"")+(d==="on"?" _56dg":"")+(d==="off"?" _56dh":"")+(d==="neutral"?" _56di":"")),onClick:function(b){function a(a){return b.apply(this,arguments)}a.toString=function(){return b.toString()};return a}(function(a){return e(h[d])}),role:"checkbox","aria-checked":d==="on",tabIndex:"0"}),b("React").createElement("div",{className:"_56dj",tabIndex:"0"},b("React").createElement("div",{className:"_56dk"})),f?b("React").createElement("span",{className:"_56dn"},f):null)}var h={on:"off",off:"neutral",neutral:"on"};a.toBoolean=function(a){if(a==="neutral")return undefined;if(a==="on")return!0;if(a==="off")return!1;throw new Error("OzTriSwitch: unknown state "+a)};a.fromBoolean=function(a){return a==null?"neutral":a?"on":"off"};e.exports=a}),null);
__d("OzSwitch.react",["OzImmutablePureRenderMixin","OzTriSwitch.react","React"],(function(a,b,c,d,e,f){"use strict";a=b("React").PropTypes;c=b("React").createClass({displayName:"OzSwitch",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{isAnimated:a.bool.isRequired,isOn:a.bool.isRequired,label:a.node.isRequired,onToggle:a.func.isRequired,reverseColors:a.bool},getDefaultProps:function(){return{isAnimated:!1}},render:function(){var a=this.props,c=a.className,d=a.isAnimated,e=a.isOn,f=a.label,g=a.onToggle;return b("React").createElement(b("OzTriSwitch.react"),{animated:d,className:c,reverseColors:!!this.props.reverseColors,label:f,onClick:function(){return g(!e)},value:b("OzTriSwitch.react").fromBoolean(e)})}});e.exports=c}),null);
__d("OzReactMetrics",[],(function(a,b,c,d,e,f){var g={},h=function(){return{mountCount:0,mountAvgMs:0,mountTotalMs:0,updateCount:0,updateAvgMs:0,updateTotalMs:0}};a=function(a,b){g[a]||(g[a]=h()),g[a].mountCount+=1,g[a].mountTotalMs+=b,g[a].mountAvgMs=g[a].mountTotalMs/g[a].mountCount};b=function(a,b){g[a]||(g[a]=h()),g[a].updateCount+=1,g[a].updateTotalMs+=b,g[a].updateAvgMs=g[a].updateTotalMs/g[a].updateCount};e.exports={metrics:g,updateMount:a,updateUpdate:b}}),null);
__d("OzWrapper.react",["React","OzReactMetrics"],(function(a,b,c,d,e,f){__p&&__p();function a(a){__p&&__p();var c;c=babelHelpers.inherits(d,b("React").Component);c&&c.prototype;d.prototype.UNSAFE_componentWillMount=function(){"use strict";this.$1=Date.now()};d.prototype.componentDidMount=function(){"use strict";var c=Date.now()-this.$1;b("OzReactMetrics").updateMount(a.displayName,c)};d.prototype.UNSAFE_componentWillUpdate=function(){"use strict";this.$2=Date.now()};d.prototype.componentDidUpdate=function(){"use strict";var c=Date.now()-this.$2;b("OzReactMetrics").updateUpdate(a.displayName,c)};d.prototype.render=function(){"use strict";return b("React").createElement(a,babelHelpers["extends"]({},this.props,this.state))};function d(){"use strict";c.apply(this,arguments)}return d}e.exports=a}),null);
__d("OzHeader.react",["cx","OzHelpers","immutable","Layout.react","MessengerButtonReact.bs","OzButton.react","OzConfig","OzHumans","OzReps","OzStores","OzSwitch.react","React","OzWrapper.react","Reflux","ReactRouter-2.0.0","Tooltip"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MessengerButtonReact.bs").jsComponent,i=b("immutable").Map;a=b("OzStores").RepStore;c=b("OzStores").HumanStore;var j=b("ReactRouter-2.0.0").Link;d=b("React").PropTypes;f=b("React").createClass({displayName:"OzHeader",mixins:[b("Reflux").connect(c,"humans"),b("Reflux").connect(a,"reps"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{coachMode:d.bool.isRequired,rev:d.number.isRequired,version:d.string.isRequired,onAway:d.func.isRequired,onCoachModeToggle:d.func.isRequired,params:d.object.isRequired},contextTypes:{uid:d.string.isRequired,router:d.object.isRequired},render:function(){var a="/inbox/"+(this.props.params.threadid||""),c=this.state.humans.getIn([this.context.uid,"load"],0);c="Inbox"+(c?" ("+c+")":"");var d=this.state.config.get("GK",i());return b("React").createElement(b("Layout.react"),{className:"_2d86"},b("React").createElement("div",{className:"_2d87"},b("React").createElement(j,{to:"/",className:"_2d88"}),this._renderItem(c,a),this._renderItem("Merchants","/merchants"),this._renderItem("Feedback","/feedback"),this._renderItem("Top","/top"),d.get("supervisor")&&this._renderItem("Trainers","/trainers"),d.get("allThreads")&&this._renderItem("All Threads","/all")),b("React").createElement("div",{className:"_j6m"},b("React").createElement(k,{humans:this.state.humans,reps:this.state.reps,uid:this.context.uid})),b("React").createElement(h,{label:"Away",className:"_4s9f",type:"primary",onClick:this.props.onAway}),d.get("supervisor")?b("React").createElement(b("OzSwitch.react"),{className:"_b8c",isAnimated:!0,isOn:this.props.coachMode,label:"Coach Mode",onToggle:this.props.onCoachModeToggle}):null)},_renderItem:function(a,c){return b("React").createElement(j,{activeClassName:"active",className:"_33os",to:c},b("React").createElement("span",null,a))}});var k=b("OzHelpers").pure(function(a){var c=a.reps,d=a.humans;a=a.uid;a=c.get(a,i());var e=b("OzReps").closedIntentCount(a);a=b("OzReps").teamClosedIntentCount(a,c);c=Math.round(b("OzHumans").avgLoad(d));c=isFinite(c)?c:"N/A";d=d.filter(b("OzHumans").isWorking).count();return b("React").createElement("div",null,b("React").createElement("span",babelHelpers["extends"]({className:"_3fs"},b("Tooltip").propsFor("Your closed intents")),e),b("React").createElement("span",{className:"_4s9g"},"closed by you")," ",b("React").createElement("span",babelHelpers["extends"]({className:"_3fs"},b("Tooltip").propsFor("Closed intents for your entire team")),a),b("React").createElement("span",{className:"_4s9g"},"closed by team"),b("React").createElement("span",{className:"_3fs"},c),b("React").createElement("span",{className:"_4s9g"},"average load"),b("React").createElement("span",{className:"_3fs"},d),b("React").createElement("span",{className:"_4s9g"},d===1?"trainer":"trainers"))});e.exports=b("OzWrapper.react")(f)}),null);
__d("OzLoading.react",["cx","MessengerFlexArea.react","MessengerSpinner.react","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h;a=b("React").PropTypes;h=babelHelpers.inherits(i,b("React").Component);h&&h.prototype;i.prototype.render=function(){"use strict";return b("React").createElement("div",{className:"_30r7"},b("React").createElement(b("MessengerSpinner.react"),{color:this.props.color}),b("React").createElement("div",{className:"_4rg-",style:{marginLeft:"10px"}},this.props.message))};function i(){"use strict";h.apply(this,arguments)}i.propTypes={message:a.node,color:a.oneOf(["grey","blue"])};i.defaultProps={color:"blue"};i.Inline=(d=c=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("React").Component);a&&a.prototype;c.prototype.render=function(){"use strict";var a=this.props,c=a.loading;a=babelHelpers.objectWithoutProperties(a,["loading"]);return!c?null:b("React").createElement("div",{className:"_nkb"},b("React").createElement(i,a))};function c(){"use strict";a.apply(this,arguments)}return c}(),c.propTypes={loading:a.bool.isRequired},d);i.Flex=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("React").Component);a&&a.prototype;c.prototype.render=function(){"use strict";return b("React").createElement(b("MessengerFlexArea.react"),null,b("React").createElement(i,this.props))};function c(){"use strict";a.apply(this,arguments)}return c}();e.exports=i}),null);
__d("OzDate.react",["cx","formatDate","immutable","joinClasses","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").PropTypes;var i=b("immutable").fromJS([{start:0,end:7*24*36e5,format:"D g:ia"},{start:7*24*36e5,end:365*24*36e5,format:"M jS, g:ia"},{start:365*24*36e5,end:Infinity,format:"m/d/Y g:ia"}]);h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.formatTimestamp=function(a){"use strict";if(a<Date.now()+24*36e5)return b("formatDate")(new Date(a),{today:"g:ia",thisYear:"M jS, g:ia",older:"m/d/Y g:ia"});else return b("formatDate")(new Date(a),i.find(function(b){return a>Date.now()+b.get("start")&&a<Date.now()+b.get("end")}).get("format"))};a.prototype.render=function(){"use strict";var a=this.constructor.formatTimestamp(this.props.timestamp);return b("React").createElement("time",{className:b("joinClasses")("_2s4p",this.props.className)},a)};function a(){"use strict";h.apply(this,arguments)}a.propTypes={timestamp:c.number.isRequired};e.exports=a}),null);
__d("OzDraggable.react",["cx","Draggable","joinClasses","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"OzDraggable",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{getHandle:a.func},componentDidMount:function(){this._draggable=new(b("Draggable"))(this.refs.root).setUseAbsolute(!0).setGutter(15),this._updateHandle()},componentDidUpdate:function(){this._updateHandle()},_updateHandle:function(){this._handle&&this._draggable.removeHandle(this._handle),this._handle=(this.props.getHandle||function(){return this.refs.root}.bind(this))(),this._draggable.addHandle(this._handle)},render:function(){var a=this.props,c=a.children,d=a.className;a=babelHelpers.objectWithoutProperties(a,["children","className"]);return b("React").createElement("div",{className:"_5k4j"},b("React").createElement("div",babelHelpers["extends"]({className:b("joinClasses")("_2c1d",d),ref:"root"},a),c))},componentWillUnmount:function(){this._draggable&&this._draggable.destroy()}});e.exports=c}),null);
__d("OzDraggableModal.react",["cx","joinClasses","OzDraggable.react","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){"use strict";var a=this.props,c=a.children,d=a.className;a=babelHelpers.objectWithoutProperties(a,["children","className"]);return b("React").createElement(b("OzDraggable.react"),babelHelpers["extends"]({className:b("joinClasses")("_5d80",d)},a),c)};function a(){"use strict";h.apply(this,arguments)}e.exports=a}),null);
__d("OzUserImage.react",["cx","joinClasses","Image.react","immutable","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f,g){var h=b("immutable").Map;a=b("React").PropTypes;c=b("React").createClass({displayName:"OzUserImage",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{photo:a.object},render:function(){var a=b("joinClasses")(this.props.className,"_3c52 _3c53"),c=function(c){return b("React").createElement(b("Image.react"),{className:a,src:c})},d=this.props.photo||h();return d.getIn(["data","url"])&&c(d.getIn(["data","url"]))||d.get("data")&&c(d.get("mime_type")+","+d.get("data"))||b("React").createElement("span",{className:b("joinClasses")(a,"_3ejm")})}});e.exports=c}),null);
__d("OzSearch.react",["cx","Image.react","immutable","Keys","OzActions","OzAPI","OzConfig","OzDate.react","OzDraggableModal.react","OzHelpers","OzStores","OzUserImage.react","React","ReactComponentWithPureRenderMixin","Reflux","ShimButton.react","XUITextInput.react","debounce","promiseDone"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i,j,k=b("immutable").List,l=b("immutable").Map;a=b("React").PropTypes;c=b("OzStores").ActiveThreadStore;d=b("OzStores").ThreadStore;var m="Messages",n="Side Bar";f="Users";var o="Calendars";g="All";var p=[m,n,f,o,g],q=(j={},j[m]="messages",j[n]="side-bar",j[f]="users",j[o]="calendar-event",j[g]="all",j);f=b("React").createClass({displayName:"OzSearch",mixins:[b("ReactComponentWithPureRenderMixin"),b("Reflux").connect(c,"activeThread"),b("Reflux").connect(d,"threads"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],contextTypes:{router:a.object.isRequired},UNSAFE_componentWillMount:function(){this._handleTyping=b("debounce")(this._handleTyping,300,this,!0),this.setState({calendarGK:this.state.config.get("GK",l()).get("calendar")})},componentDidMount:function(){document.addEventListener("keydown",this._handleKBShortcuts),this._unlisten=function(){document.removeEventListener("keydown",this._handleKBShortcuts)}.bind(this),this._focusSearch()},getInitialState:function(){return{currentTab:m,results:k([]),selected:-1,shown:!1,text:"",calendarGK:!1}},componentWillUnmount:function(){this._unlisten()},render:function(){var a=this.state,c=a.shown,d=a.currentTab,e=a.results,f=a.selected;a=a.threads;if(!c)return null;else return b("React").createElement(b("OzDraggableModal.react"),{className:"_cxg"},b("React").createElement(b("XUITextInput.react"),{className:"_cxh",placeholder:"Search...",ref:"searchBar",onChange:function(a){return this._handleTyping(a.target.value)}.bind(this)}),b("React").createElement("div",{className:"_cxi"},b("React").createElement(t,{tabs:p,currentTab:d,onClickTab:this._handleChangeTab,calendarGK:this.state.calendarGK}),b("React").createElement(u,{onClick:this._handleSelectResult,results:e,selected:f,threads:a,calendarGK:this.state.calendarGK})))},_search:function(){var a=this.state,c=a.text,d=a.currentTab;a=a.activeThread;c={text:c,type:q[d]};(d===n||d===m)&&(c["user-id"]=a.get("threadID"));b("promiseDone")(b("OzAPI").search(c).then(function(a){this.setState({results:a,selected:0})}.bind(this)))},_handleTyping:function(a){this.setState({text:a},this._search)},_handleChangeTab:function(a){var b=this.state.text;this.setState({currentTab:a},function(a){b.length&&this._search()}.bind(this))},_handleSelectResult:function(a){__p&&__p();switch(a.get("_type")){case"user":this._handleSelectResultUser(a);break;case"event":switch(a.getIn(["_source","type"])){case"message":case"message-from-page":this._handleSelectResultMessage(a);break;case"send-email":case"receive-email":this._handleSelectResultEmail(a);break;case"calendar-event":this._handleSelectResultCalendarEvent(a);break;default:}break;default:}this.setState({shown:!1})},_handleSelectResultUser:function(a){a=a.getIn(["_source","user-id"]);this.context.router.push("/inbox/"+a)},_handleSelectResultMessage:function(a){var b=a.getIn(["_source","user-id"]);a=a.getIn(["_source","timestamp"]);this.context.router.push("/inbox/"+b);this._createTransitionListener(b,a)},_createTransitionListener:function(a,c){this._transitionListenerId=window.setInterval(function(d){d=this.context.router.isActive("/inbox/"+a);d&&(b("OzActions").scrollThreadToTimestamp(c),window.clearInterval(this._transitionListenerId))}.bind(this),100)},_handleSelectResultEmail:function(a){var b=a.getIn(["_source","user-id"]);a=a.getIn(["_source","intent-id"]);this.context.router.push("/inbox/"+b+"/intent/"+a)},_handleSelectResultCalendarEvent:function(a){a=a.getIn(["_source","user-id"]);this.context.router.push("/inbox/"+a)},_toggleShown:function(){this.setState({shown:!this.state.shown})},_focusSearch:function(){this.refs.searchBar&&this.refs.searchBar.focusInput()},_handleKBShortcuts:function(a){__p&&__p();var c=this.state,d=c.results,e=c.selected,f=c.shown;c=c.calendarGK;if(B(a)||a.which===b("Keys").ESC&&f)a.preventDefault(),this._toggleShown(),f||this._focusSearch();else if(f)switch(a.which){case b("Keys").DOWN:a.preventDefault();this.setState({selected:Math.min(e+1,s(d,c).count()-1)});break;case b("Keys").UP:a.preventDefault();this.setState({selected:Math.max(e-1,0)});break;case b("Keys").RETURN:a.preventDefault();e&&this._handleSelectResult(s(d,c).get(e));break;case b("Keys").TAB:a.preventDefault();f=p.indexOf(this.state.currentTab);d=p.length;a.getModifierState("Shift")?(f=(f-1+d)%d,!c&&f===3&&f--):(f++,!c&&f===3&&f++,f%=d);this._handleChangeTab(p[f]);break}}});var r=function(a){return function(b){var c=b.get("_type");switch(c){case"user":return!0;case"event":c=b.getIn(["_source","type"]);return c=="calendar-event"&&!a?!1:c=="message"||c=="message-from-page"||c=="send-email"||c=="receive-email"||c=="calendar-event";default:return!1}}},s=function(a,b){return a.filter(r(b)).sortBy(function(a){return a.getIn(["_source","timestamp"])}).reverse()};h=babelHelpers.inherits(t,b("React").PureComponent);h&&h.prototype;t.prototype.render=function(){"use strict";var a=this.props,c=a.tabs,d=a.currentTab,e=a.onClickTab;return b("React").createElement("div",{className:"_cxj"},k(c).map(function(a){if(!this.props.calendarGK&&a===o)return null;else return b("React").createElement(b("ShimButton.react"),{className:(a===d?"_cxk":"")+" _cxl",key:a,onClick:function(b){return e(a)}},a)}.bind(this)).toSeq())};function t(){"use strict";h.apply(this,arguments)}t.propTypes={tabs:a.arrayOf(a.string).isRequired,currentTab:a.string.isRequired,onClickTab:a.func.isRequired,calendarGK:a.bool.isRequired};i=babelHelpers.inherits(u,b("React").PureComponent);i&&i.prototype;u.prototype.render=function(){"use strict";__p&&__p();var a=this.props,c=a.onClick,d=a.results,e=a.selected,f=a.threads;return b("React").createElement("div",{className:"_cxm"},s(d,this.props.calendarGK).map(function(a,d){__p&&__p();switch(a.get("_type")){case"user":return b("React").createElement(w,{result:a,selected:e==d,threads:f,onClick:c});case"event":switch(a.getIn(["_source","type"])){case"message-from-page":if(a.getIn(["_source","data","attachments"]))return b("React").createElement(y,{result:a,selected:e==d,threads:f,onClick:c});case"message":return b("React").createElement(x,{result:a,selected:e==d,threads:f,onClick:c});case"send-email":case"receive-email":return b("React").createElement(z,{result:a,selected:e==d,threads:f,onClick:c});case"calendar-event":return b("React").createElement(A,{result:a,selected:e==d,threads:f,onClick:c});default:return null}default:return null}}))};function u(){"use strict";i.apply(this,arguments)}u.propTypes={onClick:a.func,results:a.instanceOf(k),selected:a.number,threads:a.instanceOf(l).isRequired,calendarGK:a.bool.isRequired};var v=b("OzHelpers").pure(function(a){var c=a.image,d=a.text,e=a.selected,f=a.onClick;a=a.timestamp;return b("React").createElement(b("ShimButton.react"),{className:"_cxn",id:e?"selected":null,onClick:f},c,b("React").createElement("div",{className:"_4fwg"},b("React").createElement("div",{className:"_4fwh"},b("React").createElement("div",{className:"_4fwi"},d)),a?b("React").createElement(b("OzDate.react"),{className:"_4fwj",timestamp:a}):b("React").createElement("div",{className:"_4fwk"})))}),w=b("OzHelpers").pure(function(a){var c=a.result,d=a.onClick,e=a.selected;a=a.threads;var f=c.getIn(["_source","user-id"]),g=c.getIn(["_source","user-name"]);a=a.get(f);a||b("OzAPI").thread(f);return b("React").createElement(v,{onClick:function(a){return d(c)},selected:e,image:a?b("React").createElement(b("OzUserImage.react"),{photo:b("OzHelpers").photo(a),className:"_cxp"}):null,text:g})}),x=b("OzHelpers").pure(function(a){var c=a.result,d=a.onClick,e=a.selected;a=a.threads;var f=c.getIn(["_source","user-id"]),g=c.getIn(["_source","data","text"]),h=c.getIn(["_source","type"])==="message";a=a.get(f);h&&!a&&b("OzAPI").thread(f);f=h?a?b("React").createElement(b("OzUserImage.react"),{photo:b("OzHelpers").photo(a),className:"_cxp"}):null:b("React").createElement(b("Image.react"),{src:"/images/oz/icons/OzMessengerLogo.png",className:"_cxp"});return b("React").createElement(v,{onClick:function(a){return d(c)},selected:e,image:f,text:g,timestamp:c.getIn(["_source","timestamp"])})}),y=b("OzHelpers").pure(function(a){var c=a.result,d=a.onClick,e=a.selected;a.threads;a=c.getIn(["_source","data","attachments",0,"metadata"]);var f=a.get("name"),g=a.get("desc");a=a.get("thumb_url");return b("React").createElement(v,{onClick:function(a){return d(c)},selected:e,image:b("React").createElement(b("Image.react"),{src:a,className:"_cxp"}),text:f+" - "+g,timestamp:c.getIn(["_source","timestamp"])})}),z=b("OzHelpers").pure(function(a){var c=a.result,d=a.onClick,e=a.selected;a.threads;a=c.getIn(["_source","data"]);var f=a.get("to");a=a.get("subject");f=(f?"To: "+f.toJS().join(", ")+" - ":"")+a;a=b("React").createElement(b("Image.react"),{src:"/images/nux_icon_gmail.gif",className:"_cxr _cxp"});return b("React").createElement(v,{onClick:function(a){return d(c)},selected:e,image:a,text:f,timestamp:c.getIn(["_source","timestamp"])})}),A=b("OzHelpers").pure(function(a){__p&&__p();var c=a.result,d=a.onClick,e=a.selected;a=a.threads;var f=c.getIn(["_source","user-id"]);a=a.get(f);f=c.getIn(["_source","data"]);var g=new Date(f.get("start"));g=g.toLocaleString("en-US",{timeZoneName:"short"});a=a?b("React").createElement(b("OzUserImage.react"),{photo:b("OzHelpers").photo(a),className:"_cxp"}):null;return b("React").createElement(v,{onClick:function(a){return d(c)},selected:e,image:a,text:b("React").createElement("div",null,b("React").createElement("div",{className:"_5u4o"},f.get("title")),b("React").createElement("div",{className:"_5u4p"},g))})});function B(a){return a.getModifierState("Control")&&a.which==83}e.exports=f}),null);
__d("OzSkywalkerBanner.react",["cx","OzHelpers","OzStores","OzImmutablePureRenderMixin","React","Reflux","ReloadPage","ShimButton.react"],(function(a,b,c,d,e,f,g){a=b("OzStores").SkywalkerStore;c=b("React").createClass({displayName:"OzSkywalkerBanner",mixins:[b("Reflux").connect(a,"skywalker"),b("OzImmutablePureRenderMixin")],componentDidUpdate:function(a,b){a=this.state.skywalker;a.get("isStalled")&&a.get("last-receive-ts")&&(window.clearTimeout(this._timer),this._timer=window.setTimeout(this.forceUpdate.bind(this),1e3))},componentWillUnmount:function(){window.clearTimeout(this._timer)},render:function(){var a=this.state.skywalker,c=a.get("last-receive-ts");c=c?"in "+Math.round((b("OzHelpers").serverNow()-c)/1e3)+" seconds":"since you opened Oz";return b("React").createElement("div",{className:"_hsr"+(a.get("isStalled")?" _hss":"")},b("React").createElement("span",null,"We haven't received a message from Skywalker ",c,"."," ",b("React").createElement(b("ShimButton.react"),{form:"link",onClick:b("ReloadPage").now},"Refresh!")," ","or terrible things will happen."))}});e.exports=c}),null);
__d("OzSuggestions",["OzHelpers","immutable","OzConstants"],(function(a,b,c,d,e,f){__p&&__p();var g=b("OzConstants").ATTS,h=b("immutable").List,i=b("immutable").Map;e.exports={toServer:function(a,c){return a.set("type",g.SUGG).update("data",function(a){return i({name:a.get("title"),description:a.get("description")||"","merchant-name":this.findMerchantName(a.get("merchant"),c),"thumb-url":a.get("images",h()).find(b("OzHelpers").validateURL)||null,"thumb-urls":a.get("images",h()).filter(b("OzHelpers").validateURL),"target-url":a.get("url"),"expiration-time":a.get("expiration-time"),currency:"USD",amount:a.has("price")?j(a.get("price")):null})}.bind(this))},findMerchantName:function(a,c){c=c&&a&&c.find(function(b){return(b.get("name-dba")||"").toLowerCase()===a.toLowerCase()});if(c){b("OzHelpers").info("[sugg] found merchant",a,c);return c.get("name-dba")}return null}};function j(a){return Math.round(100*parseFloat(k(a,"$"),10))}function k(a,b){return!a||!a.startsWith(b)?a:a.substr(b.length)}}),null);
__d("OzTwilio",["cx","OzHelpers","immutable","Keys","MessengerButtonReact.bs","OzNotify","OzActions","OzConfig","OzDraggableModal.react","OzImmutablePureRenderMixin","React","Reflux","StarsInput.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i,j,k,l=b("MessengerButtonReact.bs").jsComponent;c=b("immutable").Record;var m=b("immutable").Set,n=b("immutable").List;d=b("React").PropTypes;var o=b("OzActions").twilio;function a(){__p&&__p();var a=window.Twilio.Device,c=function(a,c){return function(){b("OzHelpers").info("[twilio] "+a,r.data.toJS()),c.apply(undefined,arguments)}};o.setup.listen(function(c){a.setup(c,{rtc:b("OzConfig").getInStaticConfig(["GK","webRTC"]),debug:!0})});o.hangUp.listen(function(b){a.disconnectAll(),o.endCall()});o.startCall.listen(c("start-call",a.connect));a.ready(o.ready);a.error(function(a){var c=a.message;b("OzNotify").error("VOIP is having issues. "+(c?c:"")+". Please contact the wit oncall");b("OzHelpers").error("[twilio] had an error",a);o.endCall()});a.connect(c("connect",o.connect));a.disconnect(c("disconnect",o.endCall));a.cancel(c("cancel",o.endCall));a.incoming(c("incoming",o.incoming))}a();h=babelHelpers.inherits(p,c({"intent-id":null,tid:null,extension:null}));h&&h.prototype;function p(){"use strict";h.apply(this,arguments)}i=babelHelpers.inherits(q,c({from:null,meta:new p(),muted:!1,status:"pending",to:null,wasIncoming:null,rating:null,sentDigits:null,sentDigitsBuffer:n(),sentDigitsIntervalId:null}));i&&i.prototype;function q(){"use strict";i.apply(this,arguments)}var r=b("Reflux").createStore({init:function(){this.data=new q(),this.listenToMany(o)},getInitialState:function(){return this.data},onChangeTo:function(a){this._u(function(b){return b.set("to",a)})},onDialAgain:function(){this._conn=null,this._u(function(a){return new q({status:"dial",meta:a.get("meta"),from:a.get("from"),to:A(a.get("to"))})})},onConnect:function(a){this._conn=a},onEndCall:function(){this._conn=null,this._u(function(a){return a.merge({status:"ended"})})},onIncoming:function(a){this._conn=a,this._u(function(b){return b.mergeDeep({status:"incoming",to:a.parameters.From,wasIncoming:!0})})},onIncomingAccept:function(){this._conn&&(this._conn.accept(),this._u(function(a){return a.merge({status:"in-call"})}))},onIncomingReject:function(){this._conn&&(this._conn.reject(),this._conn=null),this.onEndCall()},onMute:function(){this._conn&&(this._conn.mute(!0),this._u(function(a){return a.set("muted",!0)}))},onReady:function(){this._u(function(a){return new q({status:"ready"})})},_sendDigitsFromBuffer:function(){__p&&__p();var a=this.data.get("sentDigitsBuffer");if(!a.isEmpty())this._conn.sendDigits(a.first()),this._u(function(a){return a.update("sentDigitsBuffer",function(a){return a.shift()})});else{a=this.data.get("sentDigitsIntervalId");clearInterval(a);this._u(function(a){return a.set("sentDigitsIntervalId",null)})}},onSendDigits:function(a){this._conn&&(this._u(function(b){return b.update("sentDigits",function(b){return(b||"")+a})}),this._u(function(b){return b.update("sentDigitsBuffer",function(b){return b.concat(n(a.split("")))})}),Number.isInteger(this.data.get("sentDigitsIntervalId"))||this._u(function(a){return a.set("sentDigitsIntervalId",setInterval(this._sendDigitsFromBuffer,1e3))}.bind(this)))},onStartCall:function(){this._u(function(a){return a.set("status","in-call")})},onUnmute:function(){this._conn&&(this._conn.mute(!1),this._u(function(a){return a.set("muted",!1)}))},onUseIntent:function(a){if(this.data.get("status")!=="ready"){b("OzNotify").error("End your call before starting another one");return}this._u(function(b){return new q({status:"dial",from:a.get("phone-number"),to:b.get("to"),meta:new p({tid:a.get("user-id"),"intent-id":a.get("id"),extension:a.get("phone-extension")})})})},onUpdateIncomingInfo:function(a){this._u(function(b){return b.merge({meta:new p({tid:a.get("user-id"),"intent-id":a.get("intent-id"),extension:a.get("phone-extension")}),from:a.get("to"),to:a.get("from")})})},onUpdateRating:function(a){this._u(function(b){return b.set("rating",a)})},_u:function(a){this.data=a(this.data),this.trigger(this.data)}});f=b("React").createClass({displayName:"OzTwilio",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(r,"store"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],contextTypes:{router:d.object.isRequired},componentDidMount:function(){var a=window.setInterval(function(a){this.state.store.get("status")==="in-call"&&b("OzActions").isActive()}.bind(this),5e3);this._cleanup=function(b){return window.clearInterval(a)}},componentDidUpdate:function(a,b){a=b.store.get("status");b=this.state.store.get("status");a==="in-call"&&b==="ended"&&this.setState({paused:!0})},componentWillUnmount:function(){this._cleanup()},render:function(){var a=this.state,c=a.store,d=a.startedAt;a=a.paused;return b("React").createElement("span",{className:"_221-"},s(c)&&b("React").createElement(t,{startedAt:d,paused:a,onCallStart:this._handleStartCall,onDialAgain:o.dialAgain,onHangUp:this._handleHangUp,onIncomingAccept:this._handleIncomingAccept,onIncomingReject:o.incomingReject,onMute:o.mute,onRatingChange:this._handleRatingChange,onReady:o.ready,onSendDigits:o.sendDigits,onThreadClick:this._handleThreadClick,onToChange:o.changeTo,onUnmute:o.unmute,store:c}))},_handleThreadClick:function(a){this.context.router.push("/inbox/"+a)},_handleStartCall:function(){var a=this.state.store;this._startDurationTimer();o.startCall(babelHelpers["extends"]({},a.get("meta").toJS(),{from:a.get("from"),to:A(a.get("to")),page:this.state.config.get("PAGE_ID"),type:"outgoing"}))},_handleIncomingAccept:function(){this._startDurationTimer(),o.incomingAccept()},_startDurationTimer:function(){this.setState({startedAt:Date.now()}),this.setState({paused:!1})},_handleHangUp:function(){o.hangUp(),this.setState({paused:!0})},_handleRatingChange:function(a){b("OzHelpers").info("[twilio] rating="+a,this.state.store.toJS()),o.updateRating(a)}});function s(a){return m(["dial","in-call","incoming","ended"]).has(a.get("status"))}j=babelHelpers.inherits(t,b("React").Component);j&&j.prototype;t.prototype.render=function(){"use strict";return b("React").createElement(b("OzDraggableModal.react"),{className:"_2221",getHandle:function(a){return this.refs.header.refs.header}.bind(this)},b("React").createElement(v,{store:this.props.store,ref:"header"}),b("React").createElement(w,this.props))};function t(){"use strict";j.apply(this,arguments)}g=babelHelpers.inherits(u,b("React").Component);k=g&&g.prototype;function u(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=k.constructor).call.apply(a,[this].concat(d)),this.state={elapsed:Date.now()-this.props.startedAt},this.$2=function(){this.setState({elapsed:Date.now()-this.props.startedAt})}.bind(this),b}u.prototype.componentDidMount=function(){"use strict";this.props.paused||(this.$1=setInterval(this.$2,1e3))};u.prototype.componentWillUnmount=function(){"use strict";clearInterval(this.$1)};u.prototype.UNSAFE_componentWillReceiveProps=function(a){"use strict";if(a.paused==this.props.paused)return;a.paused?clearInterval(this.$1):this.$1=setInterval(this.$2,1e3)};u.prototype.render=function(){"use strict";return b("React").createElement("div",{className:"_1su8"},z(this.state.elapsed))};var v=b("OzHelpers").pure(function(a){a=a.store;var c=a.get("status");a=a.get("wasIncoming")?"Incoming":"Outgoing";return b("React").createElement("h2",{className:"_1su5",ref:"header"},c==="ended"&&a+" Call End"||a+" Phone Call")}),w=b("OzHelpers").pure(function(a){switch(a.store.get("status")){case"dial":return b("React").createElement(x,a);case"in-call":return b("React").createElement(C,a);case"incoming":return b("React").createElement(H,a);case"ended":return b("React").createElement(I,a);default:b("OzHelpers").debug("[twilio] unknown status",a);return null}}),x=b("OzHelpers").pure(function(a){var c=a.store,d=a.onToChange,e=a.onCallStart;a=a.onReady;return b("React").createElement("div",{className:"_3hon"},b("React").createElement(K,{placeholder:"Type a phone number...",value:c.get("to"),onChange:function(a){return d(a.target.value)},onKeyDown:function(a){return a.which===b("Keys").RETURN?y(c)&&e():null}}),b("React").createElement("div",{className:"_1su6"},B(c)),b("React").createElement("div",{className:"_1su7"},b("React").createElement(l,{onClick:a,type:"secondary",label:"Cancel"}),b("React").createElement(l,{disabled:!y(c),onClick:e,type:"primary",label:"Call"})))});function y(a){return a.get("from")&&a.get("to")&&a.get("to").length>=10}var z=function(a){var b=6e4,c=Math.floor(a/b);a%=b;b=Math.floor(a/1e3);c<10&&(c="0"+c);b<10&&(b="0"+b);return c+":"+b},A=function(a){return a.trim().replace(" ","-").replace(/(.)\+/g,"$1-")},B=function(a){var c=a.getIn(["meta","extension"]);return"My Number: "+b("OzHelpers").parsePhoneNumber(a.get("from"))+" ext. "+c},C=b("OzHelpers").pure(function(a){var c=a.startedAt,d=a.paused,e=a.onHangUp,f=a.onMute,g=a.onSendDigits,h=a.onThreadClick,i=a.onUnmute;a=a.store;return b("React").createElement("div",{className:"_2225"},b("React").createElement(u,{startedAt:c,paused:d}),b("React").createElement("div",{className:"_1su9"},b("OzHelpers").parsePhoneNumber(a.get("to"))),b("React").createElement(D,{sentDigits:a.get("sentDigits"),onSendDigits:g}),b("React").createElement("div",{className:"_1su6"},a.get("from")?B(a):"Searching for our number..."),b("React").createElement("div",{className:"_1su7"},b("React").createElement(G,{tid:a.getIn(["meta","tid"]),onThreadClick:h}),a.get("muted")?b("React").createElement(l,{onClick:i,type:"secondary",use:"danger",label:"Unmute"}):b("React").createElement(l,{onClick:f,type:"secondary",use:"default",label:"Mute"}),b("React").createElement(l,{onClick:e,type:"primary",label:"End Call"})))}),D=b("OzHelpers").pure(function(a){var c=a.onSendDigits;a=a.sentDigits;return b("React").createElement("div",null,b("React").createElement(K,{placeholder:"Type numbers using keyboard",value:"",onChange:function(a){a=F(a.target.value);a&&c(a)}}),b("React").createElement("div",{className:"_538o"},a))}),E=m(["1","2","3","4","5","6","7","8","9","0","#","*"]);function F(a){return a.split("").filter(function(a){return E.has(a)}).join("")}var G=b("OzHelpers").pure(function(a){var c=a.onThreadClick,d=a.tid;return d?b("React").createElement(l,{onClick:function(){return c(d)},type:"secondary",label:"Go to Thread"}):null}),H=b("OzHelpers").pure(function(a){var c=a.store,d=a.onIncomingAccept;a=a.onIncomingReject;return b("React").createElement("div",{className:"_2226"},b("React").createElement("div",{className:"_1su9"},b("OzHelpers").parsePhoneNumber(c.get("to"))),b("React").createElement("div",{className:"_1su6"},B(c)),b("React").createElement("div",{className:"_1su7"},b("React").createElement(l,{onClick:a,type:"secondary",label:"Ignore"}),b("React").createElement(l,{onClick:d,type:"primary",label:"Answer"})))}),I=b("OzHelpers").pure(function(a){var c=a.startedAt,d=a.paused,e=a.store;a.onHideDialog;var f=a.onRatingChange,g=a.onDialAgain;a=a.onReady;return b("React").createElement("div",{className:"_5gaw"},b("React").createElement(u,{startedAt:c,paused:d}),b("React").createElement("div",{className:"_1su9"},b("OzHelpers").parsePhoneNumber(e.get("to"))),b("React").createElement("div",{className:"_1su6"},B(e)),b("React").createElement(J,{rating:e.get("rating"),onRatingChange:f}),b("React").createElement("div",{className:"_1su7"},b("React").createElement(l,{onClick:g,type:"secondary",label:"New Call"}),b("React").createElement(l,{onClick:a,type:"primary",label:"Close"})))}),J=b("OzHelpers").pure(function(a){var c=a.rating;a=a.onRatingChange;return b("React").createElement("div",{className:"_5rvp"},c?b("React").createElement("h3",{className:"_5rvu"},"Thank you for rating!"):b("React").createElement("span",null,b("React").createElement("h3",{className:"_5rvu"},"How would you rate your experience?"),b("React").createElement(b("StarsInput.react"),{large:!0,count:0,onClick:a})))}),K=b("OzHelpers").pure(function(a){return b("React").createElement("input",babelHelpers["extends"]({},a,{className:"_1-i0 _2224"}))});e.exports=f}),null);
__d("Oz.react",["cx","immutable","Layout.react","OzActions","OzAPI","OzBugNub.react","OzConfig","OzDialogContainer.react","OzExtensionCheck.react","OzFailed.react","OzHeader.react","OzHelpers","OzImmutablePureRenderMixin","OzLoading.react","OzNotify","OzSearch.react","OzSkywalkerBanner.react","OzStores","OzSuggestions","OzTwilio","OzWrapper.react","React","Reflux","Run","ShimButton.react","XUIDialog.react","XUINotice.react","promiseDone"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("OzNotify").Component,i=b("OzStores").ActiveThreadStore;a=b("OzStores").MerchantStore;c=b("OzStores").LoadingStore;d=b("OzStores").RepStore;f=b("OzStores").RequirementStore;var j=b("OzStores").ThreadStore;g=b("OzStores").WitIntentStore;var k=b("React").PropTypes,l=b("immutable").Map,m=2e4,n=6e4,o=5e3,p=100,q=1e3*60*60,r=b("React").createClass({displayName:"OzWrapper",mixins:[b("Reflux").connect(c,"loading")],propTypes:{rev:k.number.isRequired,uid:k.string.isRequired,version:k.string.isRequired,skipToto:k.bool,onUnmount:k.func.isRequired},render:function(){var a=this.state.loading.valueSeq().some(function(a){return a.get("state")!=="loaded"&&!a.get("skip")});return a?b("React").createElement(s,null):b("React").createElement(t,this.props)}}),s=b("React").createClass({displayName:"AppLoading",mixins:[b("Reflux").connect(b("OzConfig").ConfigStore,"config"),b("Reflux").connect(c,"loading")],render:function(){return b("React").createElement("div",null,b("React").createElement(h,null),this._renderBody(),b("React").createElement(b("OzBugNub.react"),null))},_renderBody:function(){__p&&__p();var a=this.state.loading;a=a.entrySeq().filter(function(a){a[0];a=a[1];return a.get("state")==="failed"&&!a.get("skip")}).map(function(a){var b=a[0];a[1];return b});if(!a.isEmpty())return b("React").createElement(b("OzFailed.react"),{problems:a});a="Hello "+this.state.config.get("publicName")+"! Oz is connecting...";return b("React").createElement(b("OzLoading.react"),{message:a})}}),t=b("React").createClass({displayName:"Oz",mixins:[b("Reflux").connect(a,"merchants"),b("Reflux").connect(d,"reps"),b("Reflux").connect(g,"witIntents"),b("Reflux").connect(f,"requirements"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{rev:k.number.isRequired,uid:k.string.isRequired,version:k.string.isRequired,skipToto:k.bool,onUnmount:k.func.isRequired},childContextTypes:{uid:k.string.isRequired,merchants:k.instanceOf(l).isRequired,reps:k.instanceOf(l).isRequired,witIntents:k.instanceOf(l).isRequired},getChildContext:function(){return{uid:this.props.uid,merchants:this.state.merchants,reps:this.state.reps,witIntents:this.state.witIntents}},getInitialState:function(){return{almostInactive:!1,away:!1,coachMode:!1,fellAsleep:!1,inactive:!1}},componentDidMount:function(){__p&&__p();window.addEventListener("message",this._handleMessage);window.postMessage({type:"consolemounted"},"*");this.lastPulseAt=Date.now();var a=b("OzActions").sendPulse.listen(this._handlePulse),c=setInterval(b("OzActions").sendPulse,o);this.lastActiveAt=Date.now();this._isActive=function(a){return b("OzActions").isActive()};window.addEventListener("mousemove",this._isActive);window.addEventListener("keydown",this._isActive);var d=b("OzActions").isActive.listen(function(){this.lastActiveAt=Date.now(),(this.state.almostInactive||this.state.inactive)&&this.setState({almostInactive:!1,inactive:!1})}.bind(this));this.lastAwakeAt=Date.now();var e=setInterval(function(a){a=Date.now();a-this.lastAwakeAt>q&&this.setState({fellAsleep:!0});this.lastAwakeAt=a}.bind(this),p);b("OzActions").updateThreads.preEmit=w.bind(null,this.props.uid);var f=b("OzActions").isInactive.listen(function(a){Date.now()-this.lastActiveAt>o&&this.setState({almostInactive:!1,inactive:!0})}.bind(this));this._cleanup=function(){window.removeEventListener("message",this._handleMessage),a(),clearInterval(c),clearInterval(e),window.removeEventListener("mousemove",this._isActive),d(),f()}.bind(this)},componentWillUnmount:function(){this._cleanup()},render:function(){return b("React").createElement(b("Layout.react"),{className:"_3_ps _li",onKeyPress:this._handleKeyPress},b("React").createElement(h,null),!this.props.skipToto&&b("React").createElement(b("OzExtensionCheck.react"),null),this.state.away?b("React").createElement(u,{onClick:this._handleAway,text:"You're currently away.",className:"_1tir"}):this.state.almostInactive?b("React").createElement(v,{lastActiveAt:this.lastActiveAt,onZero:this._handleZero}):this.state.fellAsleep&&!this.state.config.get("devMode")?b("React").createElement(u,{text:"Looks like your computer has gone to sleep. Please refresh the page."}):this.state.inactive?b("React").createElement(u,{text:"You're currently inactive.",className:"_4da6"}):null,b("React").createElement(b("OzSkywalkerBanner.react"),null),b("React").createElement(b("OzHeader.react"),{away:this.state.away,coachMode:!!this.state.coachMode,onAway:this._handleAway,onCoachModeToggle:this._handleCoachModeToggle,rev:this.props.rev,version:this.props.version,reps:this.state.reps,params:this.props.params}),b("React").cloneElement(this.props.children,{witIntents:this.state.witIntents,requirements:this.state.requirements,merchants:this.state.merchants,reps:this.state.reps}),b("React").createElement(b("OzBugNub.react"),null),b("React").createElement(b("OzDialogContainer.react"),null),b("React").createElement(b("OzSearch.react"),null),b("React").createElement(b("OzTwilio"),null))},_handleKeyPress:function(){b("OzActions").isActive()},_handlePulse:function(){var a=Date.now(),c=Math.round((a-this.lastPulseAt)/1e3),d=this._buildPulse();b("OzAPI").sendPulse(c,d);y(i.data,j.data);this.lastPulseAt=a;!this.state.almostInactive&&!this.state.inactive&&d.get("inactive-ms")>=n-m&&this.setState({almostInactive:!0})},_handleMessage:function(a){__p&&__p();if(a.source!==window)return;if(!a.data)return;switch(a.data.type){case"active":b("OzActions").isActive();break;case"recordactivity":var c=i.data,d=a.data.data;c=c.get("threadID");b("OzHelpers").debug("[oz-ext] received activity",d);if(!c){b("OzHelpers").debug("[oz-ext] skipping event, no threadID");return}b("OzAPI").recordActivity(c,d);break;case"bubble":b("OzHelpers").debug("[toto] got bubble",a.data);b("OzActions").addBubble(b("OzSuggestions").toServer(b("immutable").fromJS(a.data),this.state.merchants));break;case"autopilot-data":b("OzHelpers").debug("[toto] got autopilot",a.data);a.data&&b("OzActions").addAutopilot(b("immutable").fromJS(a.data));break}},_handleAway:function(a){b("promiseDone")(b("OzAPI").away(!this.state.away),function(a){this.setState({away:!!a})}.bind(this))},_handleCoachModeToggle:function(a){b("promiseDone")(b("OzAPI").coachMode(a),function(){this.setState({coachMode:a})}.bind(this))},_handleZero:function(){this.setState({almostInactive:!1,inactive:!0})},_buildPulse:function(a){return x(this.props.uid,i.data,j.data,this.lastActiveAt,this.state.away||a||!1,this.state.coachMode)}});function u(a){var c=a.onClick,d=a.text;a=a.className;return b("React").createElement(b("XUIDialog.react"),{width:544,shown:!0,layerHideOnBlur:!1},b("React").createElement("div",{className:"_1tip"},b("React").createElement("div",{className:a}),b("React").createElement("div",{className:"_1tis"},d),c?b("React").createElement(b("ShimButton.react"),{className:"_1tit _57lt _30yy",form:"link",onClick:c},"I'm back :)"):null))}var v=b("React").createClass({displayName:"OzCountdownDialog",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{lastActiveAt:k.number.isRequired,onZero:k.func.isRequired},getInitialState:function(){return{countdown:Math.floor((n-(Date.now()-this.props.lastActiveAt))/1e3)}},componentDidMount:function(){this._interval=setInterval(function(){this.setState({countdown:Math.max(this.state.countdown-1,0)})}.bind(this),1e3)},componentDidUpdate:function(){this.state.countdown===0&&(clearInterval(this._interval),this.props.onZero())},componentWillUnmount:function(){clearInterval(this._interval)},render:function(){return b("React").createElement(b("XUIDialog.react"),{width:544,shown:!0,layerHideOnBlur:!1},b("React").createElement("div",{className:"_1tip"},b("React").createElement("div",{className:"_4da6"}),b("React").createElement(b("XUINotice.react"),{use:"warn"},"You'll be inactive (and your threads will be reassigned) in approximately ",this.state.countdown," seconds...")))}});function w(a,c){__p&&__p();var d=j.data;if(d.isEmpty())return;c.filter(function(c){return(b("OzHelpers").isOwner(c,a)||b("OzHelpers").isSubscriber(c,a))&&(c.get("ready")||b("OzHelpers").isUnread(c)||b("OzHelpers").hasPaid(c)||b("OzHelpers").hasReminder(c))}).forEach(function(a){__p&&__p();var c=b("OzHelpers").isUnread(a)&&b("OzHelpers").shortDesc(b("OzHelpers").lastUserMessage(a))||b("OzHelpers").hasPaid(a)&&"Payment received."||b("OzHelpers").hasReminder(a)&&"Reminder triggered.";if(!c)return;var e=b("OzHelpers").threadID(a);e=d.getIn([e,"last-event-at"]);if(a.get("last-event-at")===e)return;e=b("OzHelpers").photo(a);e=e?e.getIn(["data","url"])||e.get("mime_type")+","+e.get("data"):null;b("OzAPI").notifyExtension({action:"show",title:b("OzHelpers").getName(a),desc:c,picture:e,id:b("OzHelpers").threadID(a)})})}function x(a,c,d,e,f,g){var h=c.get("threadID"),i=h&&d.get(h),j=l();h&&(j=j.merge({tid:h}));i&&(j=j.merge({"intent-id":c.get("activeIntent"),"owner-id":i.getIn(["owner","id"]),"user-name":i.getIn(["user-vcard","name"])}));Number.isFinite(e)&&(j=j.set("inactive-ms",Date.now()-e));j=j.set("load",d.toSeq().filter(function(c){return b("OzHelpers").isOwner(c,a)&&c.get("ready")}).count());j=j.set("away?",f);j=j.set("coach-mode?",g);return j}function y(a,b){var c=a.get("threadID");b=c&&b.get(c);var d=l();b&&(d=d.merge({tid:c,"intent-id":a.get("activeIntent"),"user-vcard":b.get("user-vcard")}));window.postMessage({type:"consolepulse",data:d.toJS()},"*")}e.exports=b("OzWrapper.react")(r)}),null);
__d("OzLastEvent.react",["cx","OzHelpers","OzConstants","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f,g){var h=b("OzConstants").AUTHOR_TYPES;a=b("React").PropTypes;c=b("React").createClass({displayName:"OzLastEvent",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{name:a.string.isRequired,lastEvent:a.object.isRequired},render:function(){var a=this.props.lastEvent,c=b("OzHelpers").authorType(a)===h.USER?this.props.name.split(" ")[0].substr(0,10):"M",d=a.get("text");a=b("OzHelpers").shortDesc(a)||"did something";d=d&&c+": "+d||c+" "+a;return b("React").createElement("div",{className:"_4-_6 _4-_7",title:d},this._renderText(c,a))},_renderText:function(a,c){return b("React").createElement("span",null,b("React").createElement("span",{className:"_3ikz"},a,": "),c)}});e.exports=c}),null);
__d("OzStrings",[],(function(a,b,c,d,e,f){e.exports={NOTREADY_BUTTON:"I'm waiting",IS_NOTREADY:"Currently waiting",READY_BUTTON:"The user is waiting for us!",USER_FILTER_ALL:"All users",USER_FILTER_PUBLIC:"Public only",USER_FILTER_EMPLOYEE:"Employee only",READY_FILTER_ALL:"All threads",READY_FILTER_ATTENTION:"Needs attention",READY_FILTER_WAITING:"I'm waiting"}}),null);
__d("OzThreadLabels.react",["cx","OzHelpers","OzAPI","ContextualLayerAutoFlip","ContextualLayerUpdateOnScroll","joinClasses","immutable","ReactLayeredComponentMixin_DEPRECATED","OzImmutablePureRenderMixin","React","XUICloseButton.react","XUIContextualDialog.react"],(function(a,b,c,d,e,f,g){__p&&__p();d=b("immutable").Map;f=b("immutable").OrderedMap;var h=b("immutable").List;g=b("React").PropTypes;var i=b("React").createClass({displayName:"Label",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{noColor:g.bool,removable:g.bool,shade:g.oneOf(["dark","light"]),thread:g.instanceOf(d).isRequired},getDefaultProps:function(){return{shade:"dark"}},render:function(){return!this.props.shown?null:b("React").createElement("div",{className:b("joinClasses")("_2yqb"+(this.props.noColor?" _2yqc":"")+" _2yqd",this.props.className)},this.props.text,this.props.removable&&this.props.onRemove?b("React").createElement(b("XUICloseButton.react"),{className:"_2yqe",onClick:this.props.onRemove,shade:this.props.shade}):b("React").createElement("div",{className:"_4ypj"}))}});function j(a){return b("React").createElement(i,babelHelpers["extends"]({},a,{className:"_2yqi",text:"REMINDER",shown:!b("OzHelpers").urgentReminders(a.thread).isEmpty()}))}function k(a){return b("React").createElement(i,babelHelpers["extends"]({},a,{className:"_2yqj",text:"PAID",shown:!b("OzHelpers").paidReminders(a.thread).isEmpty()}))}function a(a){var c=b("OzHelpers").minAge(a.thread);return b("React").createElement(i,babelHelpers["extends"]({},a,{className:"_2yqm",text:c<18&&"UNDER 18"||c<21&&"UNDER 21",shown:c<21}))}function l(a){return b("React").createElement(i,babelHelpers["extends"]({},a,{className:"_2yql",text:"ENGAGE",shown:b("OzHelpers").hasEngage(a.thread)}))}var m=f({OzVIPLabel:["vip","_2yqf"],OzUrgentLabel:["urgent","_2yqg"],OzAbuserLabel:["abuser","_2yqh"],OzEscalatedLabel:["escalated","_1jce"]});f=f({OzEmployeeLabel:["employee","_2yqk"]});var n=m.merge(f).map(function(a){var b=a[0];a[1];return b}).toSet();function o(a,c,d){return function(d){return b("React").createElement(i,babelHelpers["extends"]({},d,{className:c,text:s(a),shown:b("OzHelpers").hasTag(d.thread,a),onRemove:function(){return b("OzAPI").deleteTag(b("OzHelpers").threadID(d.thread),a)}}))}}var p=m.map(function(a){return o.apply(undefined,a)}),q=f.map(function(a){return o.apply(undefined,a)});function c(a){var c=a.className,d=a.removable,e=a.addable,f=babelHelpers.objectWithoutProperties(a,["className","removable","addable"]);return b("React").createElement("div",{className:c},q.map(function(a,c){return b("React").createElement(a,babelHelpers["extends"]({key:c},f))}).valueSeq(),b("React").createElement(j,f),p.map(function(a,c){return b("React").createElement(a,babelHelpers["extends"]({key:c,removable:d},f))}).valueSeq(),(f.thread.get("tags")||h()).filterNot(function(a){return n.has(a)}).sort().map(function(a){var b=o(a,"_tch");return b(babelHelpers["extends"]({key:a,removable:d},f))}),b("React").createElement(l,f),b("React").createElement(k,f),e?b("React").createElement(r,{thread:f.thread}):null)}var r=b("React").createClass({displayName:"OzAddLabel",mixins:[b("OzImmutablePureRenderMixin"),b("ReactLayeredComponentMixin_DEPRECATED")],propTypes:{thread:g.instanceOf(d).isRequired},getInitialState:function(){return{shown:!1}},render:function(){return b("React").createElement("span",{ref:"add"},this._tags().isEmpty()?null:b("React").createElement("button",{className:"_1-hv _2yqb _2yqn _2yqo",onClick:function(){return this.setState({shown:!0})}.bind(this)},"+"))},renderLayers:function(){__p&&__p();var a=this.state.shown;if(!a)return null;var c=this.props.thread;return{contextualDialog:b("React").createElement(b("XUIContextualDialog.react"),{behaviors:{ContextualLayerAutoFlip:b("ContextualLayerAutoFlip"),ContextualLayerUpdateOnScroll:b("ContextualLayerUpdateOnScroll")},position:"below",shown:a,contextRef:function(){return this.refs.add}.bind(this),onBlur:function(a){return this.setState({shown:!1})}.bind(this)},b("React").createElement("div",{className:"_2yqp"},this._tags().map(function(a){var d=a[0];a=a[1];return b("React").createElement("button",{key:d,className:b("joinClasses")(a,"_1-hv _2yqq"),onClick:function(){this.setState({shown:!1}),b("OzAPI").createTag(b("OzHelpers").threadID(c),d)}.bind(this)},s(d))}.bind(this))))}},_tags:function(){return m.filterNot(function(a){var c=a[0];a[1];return b("OzHelpers").hasTag(this.props.thread,c)}.bind(this)).valueSeq()}});function s(a){return a.split("m_experiment_").join("").toUpperCase()}e.exports={OzLabelList:c,OzUnderageLabel:a}}),null);
__d("OzAllRow.react",["cx","OzStrings","OzHelpers","immutable","OzButton.react","OzConfig","OzConstants","OzDate.react","OzLastEvent.react","OzThreadLabels.react","OzUserImage.react","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("immutable").Map;var h=b("immutable").List,i=b("OzConstants").AUTHOR_TYPES;c=b("React").PropTypes;var j=b("OzThreadLabels.react").OzLabelList;d=b("OzHelpers").pure(function(a){var c=a.thread,d=a.witIntents;a=babelHelpers.objectWithoutProperties(a,["thread","witIntents"]);return b("React").createElement("div",{className:"_-66"},b("React").createElement(p,{width:"220px"},b("React").createElement(k,{thread:c})),b("React").createElement(p,{marginLeft:"10px",width:"250px"},b("React").createElement(l,{thread:c,witIntents:d})),b("React").createElement(p,{marginLeft:"10px",width:"350px"},b("React").createElement(m,{thread:c})),b("React").createElement(p,{marginLeft:"10px",width:"150px"},b("React").createElement(n,{thread:c})),b("React").createElement(p,{margineft:"10px",flex:"1",alignItems:"right"},b("React").createElement(o,babelHelpers["extends"]({thread:c},a))))});var k=b("OzHelpers").pure(function(a){a=a.thread;return b("React").createElement("div",{className:"_-67"},b("React").createElement(b("OzUserImage.react"),{photo:b("OzHelpers").photo(a)}),b("React").createElement("div",{className:"_-68"},b("React").createElement("h1",{className:"_-69"},b("OzHelpers").getName(a)),b("React").createElement(j,{className:"_-6a",thread:a})))}),l=b("OzHelpers").pure(function(a){__p&&__p();var c=a.thread,d=a.witIntents;a=b("OzHelpers").openIntents(c).toSeq().map(function(a){return d.getIn([a.get("wit-intent-uuid"),"name"])}).filter(function(a){return a}).map(function(a){return"Intent: "+a});c=b("OzHelpers").urgentReminders(c).toSeq().map(function(a){return a.getIn(["body","description"])}).filter(function(a){return a}).map(function(a){return"Reminder: "+a});return b("React").createElement("div",{className:"_-6q"},b("React").createElement("div",{className:"_-6r"},a.concat(c).map(function(a,c){return b("React").createElement("div",{key:c,className:"_4-_7 _-6s"},a)})))}),m=b("OzHelpers").pure(function(a){var c=a.thread;return b("React").createElement("div",{className:"_-6u"},q(c).map(function(a){return b("React").createElement("div",{key:b("OzHelpers").msgID(a),className:"_-6v"+(b("OzHelpers").authorType(a)!==i.USER?" _-6w":"")},b("React").createElement("span",{className:"_4-_7 _-6x"},b("React").createElement(b("OzDate.react"),{timestamp:a.get("timestamp")})),b("React").createElement(b("OzLastEvent.react"),{key:b("OzHelpers").msgID(a),name:b("OzHelpers").getName(c),lastEvent:a}))}))}),n=b("OzHelpers").pure(function(a){a=a.thread;var c=a.getIn(["owner","name"])||"No owner";a=a.getIn(["last-owner","name"]);return b("React").createElement("div",{className:"_-6y"},b("React").createElement("div",{className:"_-6z"},c),a?b("React").createElement("div",{className:"_-6-"},"Last owner: ",a):null)}),o=b("React").createClass({displayName:"Actions",mixins:[b("OzImmutablePureRenderMixin")],contextTypes:{uid:c.string.isRequired},propTypes:{thread:c.instanceOf(a).isRequired,onThreadNotReady:c.func.isRequired,onThreadReady:c.func.isRequired,onThreadRelease:c.func.isRequired,onThreadView:c.func.isRequired},render:function(){return b("React").createElement("div",{className:"_-6_"},r(babelHelpers["extends"]({},this.props,{uid:this.context.uid})).map(function(a){var c=a.body,d=a.f;return b("React").createElement(b("OzButton.react"),{key:c,onClick:function(a,b){return d(this.props.thread,b,a)}.bind(this)},c)}.bind(this)))}}),p=b("OzHelpers").pure(function(a){var c=a.children;a=babelHelpers.objectWithoutProperties(a,["children"]);return b("React").createElement("div",{className:"_-70",style:a},c)});function q(a){a=b("OzHelpers").lastEvents(a).groupBy(b("OzHelpers").authorType);return h([a.get(i.USER),a.get(i.TRAINER),a.get(i.BOT)]).toSeq().filter(function(a){return a}).map(function(a){return a.last()}).sortBy(function(a){return a.get("timestamp")})}function r(a){var c=a.onThreadNotReady,d=a.onThreadReady,e=a.onThreadRelease,f=a.onThreadView,g=a.thread;a=a.uid;g=g;var h=b("OzConfig").getInStaticConfig(["GK","supervisor"]),i=[];h&&b("OzHelpers").hasOwner(g)&&i.push({body:"Release",f:e});g.get("ready")?i.push({body:b("OzStrings").NOTREADY_BUTTON,f:c}):h&&i.push({body:b("OzStrings").READY_BUTTON,f:d});g.getIn(["owner","id"])!==a&&!b("OzHelpers").isSubscriber(g,a)&&i.push({body:"View",f:f});return i}e.exports=d}),null);
__d("OzAll.react",["cx","immutable","MessengerFlexScrollableArea.react","OzActions","OzAllRow.react","OzAPI","OzHelpers","OzImmutablePureRenderMixin","OzLoading.react","OzStores","OzStrings","React","Reflux","XUIButton.react","XUIRadioButtonGroup.react","promiseDone","promiseFinally"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("immutable").Map,i=b("OzLoading.react").Flex,j=b("OzLoading.react").Inline;a=b("OzStores").QueueFilterStore;c=b("OzStores").ThreadStore;d=b("React").PropTypes;f=b("React").createClass({displayName:"OzAll",mixins:[b("Reflux").connect(a,"filters"),b("Reflux").connect(c,"threads")],contextTypes:{router:d.object.isRequired},getInitialState:function(){return{clientLimit:t}},UNSAFE_componentWillMount:function(){this.state.threads.size<t&&this._fetchThreads()},componentDidUpdate:function(a,c){a=c.filters.get("all");c=this.state.filters.get("all");b("immutable").is(a,c)||this._fetchThreads()},render:function(){var a=this._getFilters(),c=a[0];a=a[1];var d=this._threads();return b("React").createElement("div",{className:"_3l5z"},b("React").createElement(l,{showTags:c,hideTags:a,onChange:this._handleFilterChange}),b("React").createElement(k,{threads:d,loading:!!r[v(c,a)],clientLimit:this.state.clientLimit,onScrollBottom:this._handleScrollBottom,onThreadNotReady:this._handleThreadNotReady,onThreadReady:this._handleThreadReady,onThreadRelease:this._handleThreadRelease,onThreadView:this._handleThreadView,witIntents:this.props.witIntents}))},_getFilters:function(){var a=this.state.filters.get("all");return[a.get("showTags"),a.get("hideTags")]},_fetchThreads:function(){w(this._getFilters())},_threads:function(){return o(n(this.state.threads),this._getFilters())},_handleFilterChange:function(a){b("OzActions").updateQueueFilters(h({all:h(a)})),this.setState({clientLimit:t})},_handleScrollBottom:function(){var a=this.state.clientLimit,b=this._threads(),c=a+t;this.setState({clientLimit:c});b.slice(a,c).size||this._fetchThreads()},_handleThreadNotReady:function(a,c){b("promiseDone")(b("OzAPI").notready(b("OzHelpers").threadID(a)),c,c)},_handleThreadReady:function(a,c){b("promiseDone")(b("OzAPI").ready(b("OzHelpers").threadID(a)),c,c)},_handleThreadRelease:function(a,c){b("promiseDone")(b("OzAPI").release(b("OzHelpers").threadID(a)),c,c)},_handleThreadView:function(a,c,d){var e=b("OzHelpers").threadID(a),f=b("OzHelpers").hasCmdOrCtrl(d);b("promiseDone")(b("OzAPI").view(e),function(a){c(),f||this.context.router.push("/inbox/"+e)}.bind(this),c)}});var k=b("React").createClass({displayName:"ThreadList",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{clientLimit:d.number.isRequired,loading:d.bool.isRequired,onScrollBottom:d.func.isRequired,onThreadNotReady:d.func.isRequired,onThreadReady:d.func.isRequired,onThreadRelease:d.func.isRequired,onThreadView:d.func.isRequired,threads:d.instanceOf(h).isRequired,witIntents:d.instanceOf(h).isRequired},render:function(){var a=this.props,c=a.loading,d=a.threads;a=a.clientLimit;return c&&!d.count()?b("React").createElement(i,null):b("React").createElement(b("MessengerFlexScrollableArea.react"),{ref:"scrollable",onScroll:this._handleScroll},b("React").createElement("div",{className:"_3l5-"},d.take(a).map(function(a){return b("React").createElement(b("OzAllRow.react"),{key:b("OzHelpers").threadID(a),thread:a,witIntents:this.props.witIntents,onThreadNotReady:this.props.onThreadNotReady,onThreadReady:this.props.onThreadReady,onThreadRelease:this.props.onThreadRelease,onThreadView:this.props.onThreadView})}.bind(this)).valueSeq()),b("React").createElement(j,{loading:c}))},_handleScroll:function(){var a=this.refs.scrollable;a&&a.isScrolledToBottom()&&this.props.onScrollBottom()}}),l=b("OzHelpers").pure(function(a){var c,d=a.showTags,e=a.hideTags,f=a.onChange;a=function(a){var b=a.tagName;a=a.value;b=q({tagName:b,value:a,showTags:d,hideTags:e});f(b)};return b("React").createElement("div",{className:"_3l5_"},b("React").createElement(m,{tagName:"employee",value:p("employee",d,e),onChange:a,buttons:(c={},c[p.NEUTRAL]=b("OzStrings").USER_FILTER_ALL,c[p.OFF]=b("OzStrings").USER_FILTER_PUBLIC,c[p.ON]=b("OzStrings").USER_FILTER_EMPLOYEE,c)}),b("React").createElement(m,{tagName:"ready",value:p("ready",d,e),onChange:a,buttons:(c={},c[p.NEUTRAL]=b("OzStrings").READY_FILTER_ALL,c[p.OFF]=b("OzStrings").READY_FILTER_ATTENTION,c[p.ON]=b("OzStrings").READY_FILTER_WAITING,c)}))}),m=b("OzHelpers").pure(function(a){var c=a.tagName,d=a.value,e=a.buttons,f=a.onChange;return b("React").createElement("div",{key:c,className:"_3l60"},b("React").createElement(b("XUIRadioButtonGroup.react"),{selectedValue:d,selectedUse:"confirm",onValueChange:function(a){f({tagName:c,value:a})}},Object.keys(e).map(function(a){return b("React").createElement(b("XUIButton.react"),{key:a,value:a,label:e[a]})})))});function n(a){return a.sortBy(function(a){return-a.get("last-event-at")})}function o(a,c){var d=c[0],e=c[1];return a.filter(function(a){var c=!0;d.size&&(c=b("OzHelpers").hasAllTags(a,d));e.size&&(c=!b("OzHelpers").hasSomeTag(a,e));return c})}var p=function a(b,c,d){return c.has(b)?a.ON:d.has(b)?a.OFF:a.NEUTRAL};p.ON="on";p.OFF="off";p.NEUTRAL="neutral";function q(a){__p&&__p();var b=a.tagName,c=a.value,d=a.showTags;a=a.hideTags;var e,f;switch(c){case p.ON:e=d.add(b);f=a.remove(b);break;case p.OFF:e=d.remove(b);f=a.add(b);break;default:e=d.remove(b);f=a.remove(b);break}return{showTags:e,hideTags:f}}var r={},s={},t=20,u=2*t;function v(a,b){a=a.toJS().join("-");b=b.toJS().join("-");return"show["+a+"]hide["+b+"]"}function w(a){__p&&__p();var c=a[0];a=a[1];var d=v(c,a),e=r[d];b("OzHelpers").debug("[oz-all] fetchThreads",d);if(e){b("OzHelpers").debug("[oz-all] abort fetchthreads : loading",d);return}var f=s[d]||0;r[d]=!0;b("promiseDone")(b("promiseFinally")(b("OzAPI").allThreads(c,a,f,u),function(a){return r[d]=!1}),function(a){return s[d]=f+u})}e.exports=f}),null);
__d("OzExpirationCountdown.react",["cx","relativeTimeString.atlas","OzDate.react","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").PropTypes;var i=30*1e3;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$2=function(){this.forceUpdate(),this.isExpired()&&(clearInterval(this.$1),this.$1=null)}.bind(this),this.remainingTime=function(){return this.props.endTime-Date.now()}.bind(this),this.isExpired=function(){return this.props.endTime<=Date.now()}.bind(this),b}a.prototype.componentDidMount=function(){"use strict";this.$1=setInterval(this.$2,i)};a.prototype.UNSAFE_componentWillReceiveProps=function(){"use strict";this.$1=this.$1||setInterval(this.$2,i)};a.prototype.componentWillUnmount=function(){"use strict";clearInterval(this.$1)};a.prototype.render=function(){"use strict";var a=this.props.endTime;a=this.isExpired()&&b("React").createElement("span",null,"Expired ",b("React").createElement(b("OzDate.react"),{timestamp:a}))||this.remainingTime()<=60*1e3&&"Expires in less than a minute"||"Expires in "+b("relativeTimeString.atlas")(a,!0);var c="_3d53"+(this.isExpired()?" _3d54":"")+(this.isExpired()?"":" _3d55");return b("React").createElement("span",{className:c},a)};a.propTypes={endTime:c.number.isRequired};e.exports=a}),null);
__d("OzMessage.react",["cx","getURLRanges","OzHelpers","formatDate","Image.react","immutable","Link.react","MNCommerceAgentItemSuggestionMercuryShareAttachment.react","MNCommercePromotionMercuryShareAttachment.react","OzExpirationCountdown.react","OzImmutablePureRenderMixin","React","OzWrapper.react","TextWithEntities.react","XStickerAssetController"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("immutable").Map,i=b("immutable").List;a=b("React").PropTypes;c=b("React").createClass({displayName:"OzMessage",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{message:a.instanceOf(h).isRequired},render:function(){__p&&__p();var a=this.props.message,c=a.get("attachments")||i();c=i([a.get("text")&&H(a.get("text"))]).concat(c.map(function(c){var d=u(c)&&v(c)||p(c)&&q(c)||B(c)&&D(C(c))||A(c)&&D(c.get("uri"))||y(c)&&z(c)||w(c)&&x(c)||r(c)&&s(c)||n(c)&&o(c)||j(c)&&m(l(c.get("metadata")))||k(c)&&m(b("OzHelpers").uiSuggestion(c.get("suggestion")))||E(c)&&F(c.getIn(["xma","link"]))||c.get("uri")&&F(c.get("uri"));if(d)return d;else{b("OzHelpers").error("could not render attachment",c.toJS(),a.toJS());return I("Oops. We could not render this attachment.")}})).filter(function(a){return!!a}).map(function(a,c){return b("React").createElement("span",{key:c,className:"_15_n"},a)});if(c.size)return b("React").createElement("span",null,c);else{b("OzHelpers").error("no text or attachments",a.toJS());return I("Oops. We did not get text or attachments.")}}});var j=function(a){return a.hasIn(["metadata","target_url"])},k=function(a){return a.has("suggestion")},l=function(a){!h.isMap(a.get("total_cost"))&&a.has("raw_amount")&&(a=a.set("total_cost",h({amount:+a.get("raw_amount")})));return a.update("target_url",b("OzHelpers").shimURI).toJS()};function m(a){return b("React").createElement("div",{className:"_53qw"},a.expiration_time?b("React").createElement("div",{className:"_4jjz"},b("React").createElement(b("OzExpirationCountdown.react"),{endTime:a.expiration_time*1e3})):null,b("React").createElement("div",{className:"_4jj-"},b("React").createElement(b("MNCommerceAgentItemSuggestionMercuryShareAttachment.react"),{attachment:{target:a}})))}var n=function(a){return a.get("mime_type")==="oz/business-message"};function o(a){a=a.get("xma").setIn(["target","call_to_actions"],[]).toJS();return b("React").createElement("div",{className:"_53qw"},b("React").createElement("div",{className:"_4jj-"},b("React").createElement(b("MNCommercePromotionMercuryShareAttachment.react"),{attachment:a})))}var p=function(a){return a.get("mime_type")==="oz/event"};function q(a){a=a.get("metadata");var c=function(a){return a?b("formatDate")(a,"M jS, g:ia"):"[no time]"},d=a.getIn(["place","name"])||a.get("description")||"[no location]";return b("React").createElement("a",{className:"_3is9",href:a.get("url"),target:"_blank"},b("React").createElement("img",{alt:d,className:"_3isa",src:a.get("image_url")}),b("React").createElement("div",{className:"_3isb"},b("React").createElement("div",{className:"_3isc"},a.get("title")||"[no invitation title]"),b("React").createElement("div",null,c(a.get("start"))," \u2014 ",c(a.get("end"))),b("React").createElement("div",null,d)))}var r=function(a){a=a.get("metadata");return a&&a.get("location")&&a.get("url")&&a.get("image_url")};function s(a){return D(a.getIn(["metadata","image_url"]),a.getIn(["metadata","url"]))}var t=function(a){var c=a.get("uri");a=a.get("sticker_id");a&&(c=b("XStickerAssetController").getURIBuilder().setInt("sticker_id",a).getURI().toString());return c},u=function(a){return(a.get("sticker_id")||b("OzHelpers").isStickerType(a.get("mime_type")))&&t(a)};function v(a){return b("React").createElement(b("Image.react"),{className:"__vl",src:t(a)})}var w=function(a){return/video/.test(a.get("mime_type"))&&a.get("uri")};function x(a){return b("React").createElement("video",{controls:!0,height:"300",width:"300"},b("React").createElement("source",{src:a.get("uri"),type:a.get("mime_type")}))}var y=function(a){return/audio/.test(a.get("mime_type"))&&a.get("uri")};function z(a){return b("React").createElement("audio",{className:"_1d86",controls:!0},b("React").createElement("source",{src:a.get("uri"),type:a.get("mime_type")}))}var A=function(a){var c=/blob:/.test(a.get("uri")),d=/\.(jpg|gif|png)/.test(a.get("uri"));return a.get("uri")&&(b("OzHelpers").isImageType(a.get("mime_type"))||c||d)},B=function(a){return/base64/.test(a.get("mime_type"))&&a.get("data")},C=function(a){return a.get("mime_type")+","+a.get("data")};function D(a,c){return b("React").createElement("a",{href:c||a,target:"_blank",className:"_4y6l",style:{backgroundImage:"url('"+a+"')"}})}var E=function(a){return!!a.getIn(["xma","link"])};function F(a){return b("React").createElement("div",{className:"_4y6k"},b("React").createElement("a",{href:a,target:"_blank"},"Attachment Link"))}function G(a,c){return b("React").createElement(b("Link.react"),{target:"_blank",href:b("OzHelpers").shimURI(c.entity.url)},a)}function H(a){return b("React").createElement(b("TextWithEntities.react"),{className:"_4y6k",text:a,interpolator:G,ranges:b("getURLRanges")(a),renderEmoticons:!0,renderEmoji:!0})}function I(a){return b("React").createElement("div",{className:"_4y6k _5kng"},a)}e.exports=b("OzWrapper.react")(c)}),null);
__d("OzSearchSource",["AbstractSearchSource"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("AbstractSearchSource"));g=c&&c.prototype;function a(a){"use strict";g.constructor.call(this),this.$OzSearchSource1=a}a.prototype.bootstrap=function(){"use strict";return this.$OzSearchSource1({})};a.prototype.suggest=function(a){"use strict";return this.$OzSearchSource1(a)};a.prototype.searchImpl=function(a,b){"use strict";return this.$OzSearchSource1({query:a}).then(function(c){return b(c,a)},function(c){return b([],a)})};e.exports=a}),null);
__d("OzFeedbackDashboard.react",["cx","Promise","immutable","OzAPI","OzButton.react","OzConfig","OzHelpers","OzImmutablePureRenderMixin","OzMessage.react","OzSearchSource","React","Reflux","SearchableDropdownInput.contrib","SearchableEntry","Stars.react","joinClasses","promiseDone"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("immutable").Map;d=b("React").PropTypes;f=b("React").createClass({displayName:"OzFeedbackDashboard",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],contextTypes:{uid:d.string.isRequired,router:d.object.isRequired},getInitialState:function(){return{messages:h(),authorID:this.context.uid}},UNSAFE_componentWillMount:function(){this._searchSource=new(b("OzSearchSource"))(function(a){var c=(a.query||"").toLowerCase();return new(b("Promise"))(function(a){return a(this.props.reps.valueSeq().map(r).concat([r("autoresponse-bot"),r("survey-bot")]).sortBy(function(a){return a.getTitle()}).filter(function(a){return(a.getTitle()||"").toLowerCase().indexOf(c)>-1}).toJS())}.bind(this))}.bind(this))},componentDidMount:function(){this._fetchFeedback()},render:function(){return b("React").createElement("div",{className:"_60f"},this.state.config.getIn(["GK","supervisor"])?b("React").createElement(i,{reps:this.props.reps,authorID:this.state.authorID,searchSource:this._searchSource,onSelect:function(a){return this.setState({messages:h(),activeMessage:null,authorID:a.getUniqueID()},this._fetchFeedback)}.bind(this)}):null,b("React").createElement(j,{messages:this.state.messages}),b("React").createElement(o,{messages:this.state.messages,reps:this.props.reps,activeMessage:this.state.activeMessage||this.state.messages.first(),onMessageClick:function(a){return this.setState({activeMessage:a})}.bind(this),onSeeThreadClick:function(a){return this.context.router.push("/inbox/"+a)}.bind(this)}))},_fetchFeedback:function(){b("promiseDone")(b("OzAPI").authorFeedback(this.state.authorID),function(a){a=a.sortBy(function(a){return-a.get("timestamp")}),this.isMounted()&&this.setState({messages:a})}.bind(this))}});var i=b("OzHelpers").pure(function(a){var c=a.reps,d=a.authorID,e=a.searchSource;a=a.onSelect;return b("React").createElement("div",{className:"_5p66"},b("React").createElement("div",{className:"_wa_"},b("React").createElement(b("SearchableDropdownInput.contrib"),{value:r(c.get(d)||d),onSelect:a,placeholder:"Pick a rep",emptySearchResultsText:"No Rep found",searchSource:e})))}),j=b("OzHelpers").pure(function(a){a=a.messages;return b("React").createElement("div",null,b("React").createElement(l,{messages:a,days:"-7",span:"7"}),b("React").createElement(l,{messages:a,days:"-14",span:"7"}),b("React").createElement(l,{messages:a,days:"-21",span:"7"}),b("React").createElement(l,{messages:a,days:"-30",span:"30"}),b("React").createElement(l,{messages:a,days:"-60",span:"30"}))}),k=b("OzHelpers").pure(function(a){var c=a.day;a=a.span;return b("React").createElement("div",{className:"_24xm"},c+a==0?"LAST "+-c+" DAYS":"FROM "+(c+a)+" TO "+c+" DAYS")}),l=b("OzHelpers").pure(function(a){var c=a.messages,d=a.days;a=a.span;d=parseInt(d,10);a=parseInt(a,10);c=x(c,d,d+a);return b("React").createElement("div",{className:"_wb0"},b("React").createElement(k,{day:d,span:a}),b("React").createElement("div",{className:"_wb2"},b("React").createElement(m,{label:"TONE"},u(c)),b("React").createElement(m,{label:"RESPONSIVENESS"},t(c)),b("React").createElement(m,{label:"EXECUTION"},s(c)),b("React").createElement(m,{label:"CONSOLE"},v(c)),b("React").createElement(n,null,w(c))),b("React").createElement("div",{className:"_3gch"},b("React").createElement(m,{label:"FEEDBACK GIVEN"},c.size)))}),m=b("OzHelpers").pure(function(a){var c=a.label,d=a.children;a.variation;a=a.className;return b("React").createElement("div",{className:b("joinClasses")(a,"_wb3")},b("React").createElement("span",{className:"_wb4"},d),b("React").createElement("span",{className:"_wb5"},c))}),n=b("OzHelpers").pure(function(a){a=a.children;return b("React").createElement(m,{label:"POLICY",className:(a===0?"_wb6":"")+(a>0?" _wb7":"")},a)}),o=b("OzHelpers").pure(function(a){var c=a.messages,d=a.reps,e=a.activeMessage,f=a.onMessageClick,g=a.onSeeThreadClick;a=e&&e.get("reviews");var h=e&&e.get("user-id");return b("React").createElement("div",{className:"_wb8"},b("React").createElement("div",{className:"_wbc"},b("React").createElement("div",{className:"_4fj7"},c.map(function(a){return b("React").createElement("div",{className:"_wbf"+(a===e?" _wbg":""),key:b("OzHelpers").msgID(a),onClick:function(b){return f(a)},role:"presentation"},b("React").createElement(b("OzMessage.react"),{message:a}))}).valueSeq())),b("React").createElement("div",{className:"_wbh"},b("React").createElement("div",{className:"_wbe"},a?a.map(function(a){return b("React").createElement(p,{key:a.get("id"),rep:d.get(a.get("reviewer-id")),review:a})}).valueSeq():null)),b("React").createElement("div",{className:"_wbi"},h?b("React").createElement(b("OzButton.react"),{onClick:function(a){return g(h)}},"See Thread"):null))}),p=b("OzHelpers").pure(function(a){var c=a.review;a=a.rep;return b("React").createElement("div",{className:"_wbj"},b("React").createElement("div",{className:"_wbk"},b("React").createElement("h2",{className:"_wbl"},a&&a.get("name")),c.has("tone")?b("React").createElement(q,{label:"Tone"},b("React").createElement(b("Stars.react"),{count:c.get("tone"),max:3,size:"large"})):null,c.has("responsiveness")?b("React").createElement(q,{label:"Responsiveness"},b("React").createElement(b("Stars.react"),{count:c.get("responsiveness"),max:3,size:"large"})):null,c.has("execution")?b("React").createElement(q,{label:"Execution"},b("React").createElement(b("Stars.react"),{count:c.get("execution"),max:3,size:"large"})):null,c.has("followed-policy")?b("React").createElement(q,{label:"Followed Policy?"},b("React").createElement("div",{className:"_wbm"},c.get("followed-policy")?"YES":"NO")):null,c.has("console-proficiency")?b("React").createElement(q,{label:"Console"},b("React").createElement(b("Stars.react"),{count:c.get("console-proficiency"),max:3,size:"large"})):null),b("React").createElement("div",{className:"_wbn"},c.get("body")))}),q=b("OzHelpers").pure(function(a){var c=a.label;a=a.children;return b("React").createElement("div",{className:"_wbo"},a,b("React").createElement("div",{className:"_wbp"},c))});function r(a){var c=function(a){return new(b("SearchableEntry"))(a)};return a?a.get?c({title:a.get("name"),uniqueID:a.get("fbid")}):c({title:a,uniqueID:a}):null}function a(a,b){__p&&__p();return function(c){__p&&__p();c=c.valueSeq().flatMap(function(a){return a.get("reviews")}).filter(function(b){return b&&b.has(a)});c=c.reduce(function(d,e){var c=d[0];d=d[1];return[c+b,d+e.get(a)]},[0,0]);var d=c[0];c=c[1];return d?Math.round(c/d*100)+"%":" "}}function c(a){return function(b){b=b.valueSeq().flatMap(function(a){return a.get("reviews")}).filter(function(b){return b&&b.has(a)});b=b.reduce(function(b,c){return b+!c.get(a)},0);return b?b:""}}var s=a("execution",3),t=a("responsiveness",3),u=a("tone",3),v=a("console-proficiency",3),w=c("followed-policy");function x(a,b,c){var d=new Date().getDate(),e=+new Date(Date.now()).setDate(d+b),f=+new Date(Date.now()).setDate(d+c);return a.filter(function(a){a=+a.get("timestamp");return a>=e&&a<=f})}e.exports=f}),null);
__d("OzInboxThreadRow.react",["cx","OzHelpers","immutable","OzConfig","OzLastEvent.react","OzThreadLabels.react","OzUserImage.react","OzImmutablePureRenderMixin","React","OzWrapper.react","Reflux","Sound","Timestamp.react","Tooltip"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("immutable").Map,i=b("OzThreadLabels.react").OzLabelList;a=b("React").PropTypes;var j=1e3;c=b("React").createClass({displayName:"OzInboxThreadRow",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{thread:a.object.isRequired,locker:a.object.isRequired,selected:a.bool.isRequired,onClick:a.func.isRequired,onUnview:a.func.isRequired,witIntents:a.instanceOf(h).isRequired},contextTypes:{uid:a.string.isRequired},getInitialState:function(){return{flashing:!1,unread:!1}},UNSAFE_componentWillReceiveProps:function(a){var b=a.thread;a=a.selected;this.state.config.getIn(["GK","responsiveness"])&&(k(this.props.thread,b)&&(l(b),this.setState({unread:!0,flashing:!0}),window.clearTimeout(this._flashingTimeout),this._flashingTimeout=window.setTimeout(function(a){return this.setState({flashing:!1})}.bind(this),j)),a&&this.setState({unread:!1}))},componentWillUnmount:function(){window.clearTimeout(this._flashingTimeout)},render:function(){__p&&__p();var a=this.props,c=a.thread,d=a.locker,e=a.selected,f=a.subscribed,g=a.owned,h=a.onUnview;a=b("OzHelpers").getName(c);var j=b("OzHelpers").photo(c),k=b("OzHelpers").lastEvents(c).last(),l=!g&&c.get("ui-reassign"),o=b("OzHelpers").hasPaid(c),p=b("OzHelpers").hasReminder(c),q=c.get("locked");d=q?"Thread locked by "+d.get("name")+"\n       at "+new Date(c.get("locked-at")).toLocaleString():"";var r=g&&(c.get("ready")||o||p)&&!q,s=null,t=k&&k.get("timestamp");if(!g){var u=c.get("ui-reassign")?"Reassigned to":"Grabbed by";s=u+" "+b("OzHelpers").nameOrId(c.get("owner"))}u=this.state.config.getIn(["GK","responsiveness"]);var v=this.state.config.getIn(["GK","responsivenessV2"]);v=v?b("OzHelpers").isUnread(c)&&!e:this.state.unread;return b("React").createElement("div",{className:"_2ic2"+(u&&v?" _2ic4":"")+(u&&this.state.flashing?" _5lan":"")+(r?" _2ic3":"")+(p?" _2ic5":"")+(o?" _2ic6":"")+(e?" _2ic7":"")+(l?" _2q4a":""),onClick:this._handleClick,role:"presentation"},b("React").createElement("div",{className:"_2ic8"},b("React").createElement(b("OzUserImage.react"),{photo:j}),f?b("React").createElement("button",{className:"_1-hv _2ic9",onClick:function(a){return h(c)}}):null),b("React").createElement("div",{className:"_2ica"},g?null:b("React").createElement(m,{name:s}),b("React").createElement("h1",{className:"_4-_7 _2ice"},a),b("React").createElement(n,{thread:c,witIntents:this.props.witIntents}),b("React").createElement("div",{className:"_2icb"},k?b("React").createElement(b("OzLastEvent.react"),{lastEvent:k,name:a}):null),b("React").createElement("div",{className:"_3lxn"},b("React").createElement(i,{className:"_2icc",thread:c}))),b("React").createElement("div",{className:"_6f"},t?b("React").createElement("div",{className:"_2icf"},b("React").createElement(b("Timestamp.react"),{autoUpdate:!0,shorten:!0,time:t/1e3})):null,b("React").createElement("div",babelHelpers["extends"]({className:q?"_1hw":""},b("Tooltip").propsFor(d)))))},_handleClick:function(){this.props.onClick(this.props.thread)}});function k(a,c){return(b("OzHelpers").unreadTs(a)||0)<(b("OzHelpers").unreadTs(c)||0)}b("Sound").init(["audio/ogg","audio/mpeg"]);function l(a){var c=b("OzHelpers").unreadTs(a);b("OzHelpers").debug("[inboxThreadRow] sound for tid "+b("OzHelpers").threadID(a)+", ts "+c);a=b("OzConfig").ConfigStore.data.getIn(["resources","sound","notifyUnread"],h()).toObject();var d=a.ogg;a=a.mp3;c&&(d||a)?b("Sound").play([d,a],c,!1):b("OzHelpers").warn("[inboxThreadRow] sounds not loaded")}function m(a){var c=a.name;a=a.lastEvent;a=a&&a.get("timestamp");return b("React").createElement("div",{className:"_2icd"},b("React").createElement("h1",{className:"_4-_7 _2ice"},c),a?b("React").createElement("div",{className:"_2icf"},b("React").createElement(b("Timestamp.react"),{autoUpdate:!0,shorten:!0,time:a/1e3})):null)}function n(a){var c=a.thread;a=a.witIntents;c=b("OzHelpers").openIntents(c).first();a=c&&a.getIn([c.get("wit-intent-uuid"),"name"]);return a?b("React").createElement("div",{className:"_2icg"},a):b("React").createElement("span",null)}e.exports=b("OzWrapper.react")(c)}),null);
__d("OzInboxThreadList.react",["cx","OzHelpers","joinClasses","OzInboxThreadRow.react","immutable","OzLoading.react","OzImmutablePureRenderMixin","React","OzWrapper.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("immutable").Map;a=b("immutable").OrderedMap;c=b("React").PropTypes;var i=b("OzLoading.react").Inline;d=b("React").createClass({displayName:"OzInboxThreadList",mixins:[b("OzImmutablePureRenderMixin")],contextTypes:{uid:c.string.isRequired},propTypes:{loading:c.bool.isRequired,onThreadClick:c.func.isRequired,onUnview:c.func.isRequired,threadGroups:c.instanceOf(a).isRequired,witIntents:c.instanceOf(h).isRequired,className:c.string,selectedThread:c.string},render:function(){var a=this.props.threadGroups.some(function(a){return a.count()});return b("React").createElement("div",{className:b("joinClasses")("_36ob",this.props.className)},a?b("React").createElement(i,{key:"l",loading:this.props.loading}):b("React").createElement(j,null),a?this.props.threadGroups.map(this._renderRows).valueSeq():null)},_renderRows:function(a,c){a=a.map(function(a){return b("React").createElement(b("OzInboxThreadRow.react"),{key:b("OzHelpers").threadID(a),thread:a,locker:this.props.reps.get(a.get("locker-id"),h()),owned:b("OzHelpers").isOwner(a,this.context.uid),selected:b("OzHelpers").threadID(a)===this.props.selectedThread,subscribed:b("OzHelpers").isSubscriber(a,this.context.uid),onClick:this.props.onThreadClick,onUnview:this.props.onUnview,witIntents:this.props.witIntents})}.bind(this)).valueSeq();return b("React").createElement("span",{className:"_36oc",key:c},a)}});function j(){return b("React").createElement("div",{className:"_725"},"You do not own any threads at the moment.",b("React").createElement("br",null))}e.exports=b("OzWrapper.react")(d)}),null);
__d("OzInboxThreads",["OzHelpers","OzConfig"],(function(a,b,c,d,e,f){__p&&__p();var g="GRABBED",h="VIEWING",i="PAST";function j(a){return b("OzConfig").ConfigStore.data.getIn(["GK","responsivenessV2"])?Math.max(b("OzHelpers").unreadTs(a)||0,a.get("last-event-at",0)):a.get("last-event-at",0)}function k(a){var c=function(b){return b.get("locked-at")&&b.get("locker-id")===a};return function(a,d){if(c(a)&&!c(d))return-1;else if(!c(a)&&c(d))return 1;else return b("OzHelpers").compareNums(j(a),j(d))}}a=b("OzHelpers").memoize(function(a,c){var d=arguments.length<=2||arguments[2]===undefined?"":arguments[2],e=k(c);return a.filter(function(a){var e=b("OzHelpers").isOwner(a,c),f=b("OzHelpers").isLocker(a,c),j=b("OzHelpers").isSubscriber(a,c),k=b("OzHelpers").wasOwner(a,c),l=b("OzHelpers").hasOpenIntents(a);switch(d){case g:return(e||a.get("ui-reassign")&&k)&&(a.get("ready")||l||f);case h:return j;case i:return k||e&&!a.get("ready")&&!l;default:return e||j}}).sort(e)},function(a,b){var c=arguments.length<=2||arguments[2]===undefined?"":arguments[2];return a.hashCode()+b+c},3);e.exports={getInboxThreads:a,OZ_GRABBED_TAB:g,OZ_VIEWING_TAB:h,OZ_PAST_TAB:i}}),null);
__d("OzTabHeader.react",["cx","React"],(function(a,b,c,d,e,f,g){function a(a){var c=a.tabs,d=a.onChange,e=a.active;return b("React").createElement("div",{className:"_2j6l"},c.map(function(a){var c=a[0],f=a[1];return b("React").createElement("button",{key:f,role:"button",className:"_1-hv _2j6m"+(f===e?" _2j6n":""),onClick:function(a){return d([c,f])}},c)}))}e.exports=a}),null);
__d("OzInbox.react",["cx","DataTransfer","immutable","OzActions","OzAPI","OzHelpers","OzInboxThreadList.react","OzInboxThreads","OzStores","OzTabHeader.react","OzWrapper.react","React","ReactComponentWithPureRenderMixin","Reflux","promiseDone","promiseFinally"],(function(a,b,c,d,e,f,g){__p&&__p();var h;b("immutable").Map;var i=b("immutable").OrderedMap,j=b("immutable").List;a=b("OzStores").HandledEventsStore;c=b("OzStores").HumanStore;d=b("OzStores").ThreadStore;f=b("React").PropTypes;var k=b("OzInboxThreads").OZ_GRABBED_TAB,l=b("OzInboxThreads").OZ_VIEWING_TAB,m=b("OzInboxThreads").OZ_PAST_TAB,n=5e3,o=3e4;120*1e3;var p=k;g=b("React").createClass({displayName:"OzInbox",mixins:[b("ReactComponentWithPureRenderMixin"),b("Reflux").connect(d,"threads"),b("Reflux").connect(c,"humans"),b("Reflux").connect(a,"handledEvents")],contextTypes:{uid:f.string.isRequired,router:f.object.isRequired},getInitialState:function(){return{activeTab:null,loading:!1}},componentDidMount:function(){this._fetchThreads();var a=window.setInterval(function(a){this._fetchThreads()}.bind(this),o),c=window.setInterval(function(){var a=this.threads(this._getActiveTab());a.some(function(a){return a.get("ui-reassign")})&&b("OzActions").clearReassignState()}.bind(this),n);this._cleanup=function(){p=this._getActiveTab(),window.clearInterval(c),window.clearInterval(a)}.bind(this)},componentDidUpdate:function(a,c){a=this.props.params.threadid;if(!a){c=this.threads();a=b("OzStores").ActiveThreadStore.data.get("oldThreadID");a=c.get(a)||c.first();a&&(b("OzHelpers").info("[ozinbox] search for best thread, found:",a),this.context.router.push("/inbox/"+b("OzHelpers").threadID(a)))}},componentWillUnmount:function(){this._cleanup()},render:function(){var a=this._getActiveTab(),c=this.threads(a),d=this.state.humans.getIn([this.context.uid,"load"],0),e=function(a){return a.preventDefault()};return b("React").createElement("div",{className:"_4b5_",onDragStart:e,onDragEnd:e,onDragOver:e,onDrop:function(a){e(a);a=new(b("DataTransfer"))(a.nativeEvent.dataTransfer);b("OzActions").updateComposer({files:a.getFiles()})}},b("React").createElement(q,{threadGroups:s(c,this.context.uid,a),reps:this.props.reps,loading:this.state.loading,activeCount:d,activeTab:a,selectedThread:this.props.params.threadid,onTabChange:this._handleTabChange,onUnview:this._handleUnview,onThreadClick:this._handleThreadClick,witIntents:this.props.witIntents}),this._renderDetails())},_getActiveTab:function(){var a=this.state.threads.get(this.props.params.threadid);return this.state.activeTab||a&&b("OzHelpers").isOwner(a,this.context.uid)&&k||a&&b("OzHelpers").isSubscriber(a,this.context.uid)&&l||p||k},_handleUnview:function(a){this._callAPIAndShift("unview",a)},_handleThreadClick:function(a){b("OzHelpers").info("[inbox/handleThreadClick] clicked on thread",b("OzHelpers").threadID(a));var c=b("OzHelpers").nextTaskForThread(a);this.context.router.push(b("OzHelpers").threadPath({threadid:b("OzHelpers").threadID(a),intentid:c&&c.get("intent-id"),taskid:c&&c.get("id")}))},_handleTabChange:function(a){a[0];a=a[1];this.setState({activeTab:a})},_callAPIAndShift:function(a,c){var d=r(this.threads(k),c),e=function(a){b("OzHelpers").info("[inbox/callAPIAndShift] shifting to thread",b("OzHelpers").threadID(a)),this.context.router.push("/inbox/"+b("OzHelpers").threadID(a))}.bind(this);a=b("OzAPI")[a](b("OzHelpers").threadID(c));d&&e(d);b("promiseDone")(a,null,function(a){b("OzHelpers").error("[inbox] could not shift",a),e(c)})},_renderDetails:function(){var a=this.props.params.threadid;if(!a&&this.threads().isEmpty())return this._renderFinished();a=b("OzHelpers").fullThreadData(this.state.threads,this.state.handledEvents,a);return!a||!this.props.children?null:b("React").cloneElement(this.props.children,{thread:a,witIntents:this.props.witIntents,requirements:this.props.requirements,merchants:this.props.merchants,humans:this.state.humans,reps:this.props.reps})},_renderFinished:function(){return b("React").createElement("div",{className:"_57l3"},b("React").createElement("div",{className:"_57l8"},b("React").createElement("div",{className:"_57lo"}),b("React").createElement("h2",null,"Congrats! You've made a lot of people happy"),b("React").createElement("p",null,"Sit tight, new messages should be coming soon!")))},_fetchThreads:function(){var a=this.state.loading;if(a)return;this.setState({loading:!0});b("promiseDone")(b("promiseFinally")(b("OzAPI").myThreads(),function(a){return this.isMounted()&&this.setState({loading:!1})}.bind(this)))},threads:function(a){return b("OzInboxThreads").getInboxThreads(this.state.threads,this.context.uid,a)}});h=babelHelpers.inherits(q,b("React").PureComponent);h&&h.prototype;q.prototype.render=function(){"use strict";var a=this.props,c=a.activeTab,d=a.onTabChange,e=a.activeCount;a=babelHelpers.objectWithoutProperties(a,["activeTab","onTabChange","activeCount"]);e=e?"Open ("+e+")":"Open";return b("React").createElement("div",{className:"_4b61"},b("React").createElement("div",{className:"_4cwh"},b("React").createElement(b("OzTabHeader.react"),{active:c,tabs:[[e,k],["Viewing",l],["Closed",m]],onChange:d})),b("React").createElement("div",{className:"_3_cz"},b("React").createElement("div",{className:"_4fj7"},b("React").createElement(b("OzInboxThreadList.react"),babelHelpers["extends"]({className:c===k?"_2sav":""},a)))))};function q(){"use strict";h.apply(this,arguments)}q.propTypes=babelHelpers["extends"]({activeTab:f.oneOf([k,l,m]).isRequired,onTabChange:f.func.isRequired},b("OzInboxThreadList.react").propTypes);function r(a,c){__p&&__p();var d=b("OzHelpers").threadID(c);c=a.toList();a=c.findIndex(function(a){return b("OzHelpers").threadID(a)===d});var e=a-1;a=a+1;if(a<c.count())return c.get(a);else if(e>=0)return c.get(e)}function s(a,b,c){switch(c){case k:return t(a,b,c);default:return i((b={},b[c]=a,b))}}function t(a,c,d){__p&&__p();var e="Needs Attention",f="Up For Grabs",g="Waiting",h=function(a){var d=b("OzHelpers").isOwner(a,c),h=a.get("ready")||b("OzHelpers").hasPaid(a)||b("OzHelpers").hasReminder(a),i=b("OzHelpers").isLocker(a,c);a=b("OzHelpers").hasOpenIntents(a);return d&&(i||h&&a)?e:h?f:g};return i().withMutations(function(b){b.set(e,[]),b.set(f,[]),b.set(g,[]),a.forEach(function(a){return b.update(h(a),function(b){b.push(a);return b})})}).map(function(a){return j(a)})}e.exports=b("OzWrapper.react")(g)}),null);
__d("StickerContextualDialog.react",["cx","ContextualLayerAutoFlipHorizontal","ReactAbstractContextualDialog","ReactLayer"],(function(a,b,c,d,e,f,g){"use strict";a=7;c=b("ReactLayer").createClass(b("ReactAbstractContextualDialog").createSpec({addedBehaviors:[b("ContextualLayerAutoFlipHorizontal")],displayName:"StickerXUIContextualDialog",theme:{wrapperClassName:"_53ii",arrowDimensions:{offset:a,length:16}}}));c.WIDTH={NORMAL:312,WIDE:400};e.exports=c}),null);
__d("ChatStickerButton.react",["cx","fbt","BootloadedComponent.react","JSResource","Link.react","React","StickerContextualDialog.react","StickersActions","StickersStateStore","XUISpinner.react","emptyFunction","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;d=278;f=babelHelpers.inherits(a,b("React").PureComponent);i=f&&f.prototype;function a(a){__p&&__p();i.constructor.call(this,a),this.$1=!1,this.renderLayers=function(){if(!this.state.shown)return null;var a=this.props.ContextualDialogClass;return b("React").createElement(a,{alignment:this.props.flyoutAlignment,className:"_5e-r",contextRef:function(){return this.refs.link}.bind(this),onBeforeHide:this.$5,onBlur:this.$3,position:"above",shown:this.state.shown,width:this.props.flyoutWidth,key:"contextualDialog"},b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("div",{style:{padding:"30px",textAlign:"center"}},b("React").createElement(b("XUISpinner.react"),{size:"large"})),bootloadLoader:b("JSResource")("StickersFlyout.react").__setRef("ChatStickerButton.react"),className:this.props.flyoutClassName,onShown:function(a){this.props.onFlyoutShown&&this.props.onFlyoutShown(a)}.bind(this),onHidden:function(){this.props.onFlyoutHidden&&this.props.onFlyoutHidden()}.bind(this),onEscKeyDown:this.$3,onStickerSelect:this.$6,onEmoticonSelect:this.$7,shown:this.state.shown}))}.bind(this),this.$4=function(){this.$1=this.state.shown}.bind(this),this.showFlyout=function(a){a&&a.stopPropagation();if(this.$1||this.props.disabled){this.$1=!1;return}b("StickersActions").showStickerFlyout(this.props.threadID)}.bind(this),this.$5=function(){this.state.shown&&this.$3()}.bind(this),this.$3=function(){b("StickersActions").hideStickerFlyout()},this.$6=function(a){this.props.onStickerSelect(a)}.bind(this),this.$7=function(a){this.$3(),this.props.onEmoticonSelect(a)}.bind(this),this.state={shown:!!a.clicked}}a.prototype.componentDidMount=function(){__p&&__p();this.props.onLoad&&this.props.onLoad(this),this.$2=b("StickersStateStore").addListener(function(){__p&&__p();var a=b("StickersStateStore").getState();if(a.get("showFlyout")&&a.get("threadID")===this.props.threadID){if(this.$1||this.props.disabled){this.$1=!1;return}this.setState({shown:!0})}else{a=this.props.getInput&&this.props.getInput();a&&a.focus&&a.focus();this.setState({shown:!1})}}.bind(this))};a.prototype.componentWillUnmount=function(){this.state.shown&&this.$3(),this.$2&&this.$2.remove()};a.prototype.render=function(){return b("React").createElement("span",null,b("React").createElement(b("Link.react"),{className:b("joinClasses")(this.props.className,this.state.shown?"open":""),href:"#",onClick:this.showFlyout,onMouseDown:this.$4,role:"button",title:h._("\u10d0\u10d8\u10e0\u10e9\u10d8\u10d4\u10d7 \u10e1\u10e2\u10d8\u10d9\u10d4\u10e0\u10d8"),ref:"link"}),this.renderLayers())};a.propTypes={className:c.string,clicked:c.bool,ContextualDialogClass:c.func.isRequired,disabled:c.bool,flyoutClassName:c.string,flyoutWidth:c.number,getInput:c.func,onLoad:c.func,onStickerSelect:c.func.isRequired,onEmoticonSelect:c.func.isRequired,onFlyoutShown:c.func,onFlyoutHidden:c.func,threadID:c.string};a.defaultProps={clicked:!1,ContextualDialogClass:b("StickerContextualDialog.react"),disabled:!1,flyoutWidth:d,onStickerSelect:b("emptyFunction"),onEmoticonSelect:b("emptyFunction")};e.exports=a}),null);
__d("PhotocropConstraintConstants",[],(function(a,b,c,d,e,f){var g={BOUNDARY:"boundary",SQUARE:"square",WIDE:"wide"};g.getAspectRatioForType=function(a){switch(a){case g.SQUARE:return 1;case g.WIDE:return 16/9;default:return null}};e.exports=g}),null);
__d("PhotocropConstraint",["Vector","PhotocropConstraintConstants","clamp"],(function(a,b,c,d,e,f){__p&&__p();var g,h,i;function a(a){"use strict";this.photocrop=a,this.pos=null}a.prototype.onMouseMove=function(a,b,c){"use strict";a=a.sub(this.pos);b?this.onResize(a,c):this.onMove(a);this.pos=this.pos.add(a)};a.prototype.onMouseDown=function(a){"use strict";this.pos=a};a.prototype.onResize=function(a,b){"use strict"};a.prototype.onMove=function(a){"use strict";var c=this.photocrop.box,d=this.photocrop.wrapper.offsetWidth,e=this.photocrop.wrapper.offsetHeight;a.x=b("clamp")(a.x,-c.l,d-c.r);a.y=b("clamp")(a.y,-c.t,e-c.b);this.photocrop.box=c.add(a)};g=babelHelpers.inherits(j,a);g&&g.prototype;j.prototype.onResize=function(a,c){"use strict";__p&&__p();var d=this.photocrop.min_width,e=this.photocrop.min_height,f=this.photocrop.box,g=this.photocrop.wrapper.offsetWidth,h=this.photocrop.wrapper.offsetHeight;switch(c){case"ne":f.r+=a.x=b("clamp")(a.x,f.l+d-f.r,g-f.r);f.t+=a.y=b("clamp")(a.y,-f.t,f.b-e-f.t);break;case"nw":f.l+=a.x=b("clamp")(a.x,-f.l,f.r-d-f.l);f.t+=a.y=b("clamp")(a.y,-f.t,f.b-e-f.t);break;case"se":f.r+=a.x=b("clamp")(a.x,f.l+d-f.r,g-f.r);f.b+=a.y=b("clamp")(a.y,f.t+e-f.b,h-f.b);break;case"sw":f.l+=a.x=b("clamp")(a.x,-f.l,f.r-d-f.l);f.b+=a.y=b("clamp")(a.y,f.t+e-f.b,h-f.b);break}};function j(){"use strict";g.apply(this,arguments)}h=babelHelpers.inherits(k,a);i=h&&h.prototype;k.prototype.setRatio=function(a){"use strict";this.ratio=a;return this};k.prototype.onMouseDown=function(a){"use strict";i.onMouseDown.call(this,a);a=this.photocrop.box;var c=a.r-a.l;a=a.b-a.t;this.displacement=new(b("Vector"))(c,a)};k.prototype.$AspectRatioConstraint1=function(a,c,d,e,f,g){"use strict";var h;h=this.displacement.x/this.displacement.y;c=b("clamp")(c,a,d);f=b("clamp")(f,e,g);h>this.ratio?(f=b("clamp")(c/this.ratio,e,g),c=f*this.ratio):(c=b("clamp")(f*this.ratio,a,d),f=c/this.ratio);return new(b("Vector"))(c,f)};k.prototype.onResize=function(a,b){"use strict";__p&&__p();var c=this.photocrop.min_width,d=this.photocrop.min_height,e=this.photocrop.box,f=this.photocrop.wrapper.offsetWidth,g=this.photocrop.wrapper.offsetHeight;switch(b){case"ne":this.displacement=this.displacement.add(a.x,-a.y);b=this.$AspectRatioConstraint1(c,this.displacement.x,f-e.l,d,this.displacement.y,e.b);e.r=e.l+b.x;e.t=e.b-b.y;break;case"nw":this.displacement=this.displacement.add(-a.x,-a.y);b=this.$AspectRatioConstraint1(c,this.displacement.x,e.r,d,this.displacement.y,e.b);e.l=e.r-b.x;e.t=e.b-b.y;break;case"se":this.displacement=this.displacement.add(a.x,a.y);b=this.$AspectRatioConstraint1(c,this.displacement.x,f-e.l,d,this.displacement.y,g-e.t);e.r=e.l+b.x;e.b=e.t+b.y;break;case"sw":this.displacement=this.displacement.add(-a.x,a.y);b=this.$AspectRatioConstraint1(c,this.displacement.x,e.r,d,this.displacement.y,g-e.t);e.l=e.r-b.x;e.b=e.t+b.y;break}};function k(){"use strict";h.apply(this,arguments)}function c(a,c){var d;switch(c){case b("PhotocropConstraintConstants").BOUNDARY:d=new j(a);break;case b("PhotocropConstraintConstants").WIDE:case b("PhotocropConstraintConstants").SQUARE:d=new k(a).setRatio(b("PhotocropConstraintConstants").getAspectRatioForType(c));break;default:throw Error("unsupported PhotocropConstraint type")}return d}e.exports=c}),null);
__d("Photocrop2",["ArbiterMixin","PhotocropConstraintConstants","CSS","DOM","Event","PhotosConst","Rect","Style","Vector","mixin","PhotocropConstraint"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));g=c&&c.prototype;function a(a,c,d){"use strict";__p&&__p();g.constructor.call(this);this.photo=a;a=this.getPhotoDimensions();d?this.imageDimensions=new(b("Vector"))(d.x,d.y):this.imageDimensions=new(b("Vector"))(a.x,a.y);c.height=c.height||b("PhotosConst").PIC_NORMAL_FBX_SIZE;c.width=c.width||b("PhotosConst").PIC_NORMAL_FBX_SIZE;Object.assign(this,{target:this.photo.parentNode,create_target:!1,target_parent:this.photo.parentNode,min_width:b("PhotosConst").PIC_NORMAL_FBX_SIZE,min_height:b("PhotosConst").PIC_NORMAL_FBX_SIZE,center_x:(a.x||c.width)/2,center_y:(a.y||c.height)/2,constraint_type:b("PhotocropConstraintConstants").BOUNDARY},c);this._unscaledMinHeight=this.min_height;this._unscaledMinWidth=this.min_width;this._unscaledHeight=this.height;this._unscaledWidth=this.width;this.setInitialDimensionsAndPos();this.create_target&&(this.target=b("DOM").create("div"),b("CSS").addClass(this.target,"stageCropper"),this.target_parent.appendChild(this.target));b("CSS").addClass(this.target,"photocrop");["bg","wrapper","viewport"].forEach(function(a){this[a]=b("DOM").create("div"),b("CSS").addClass(this[a],a)}.bind(this));this.highlight=b("DOM").create("img");b("CSS").addClass(this.highlight,"highlight");this.setHighlightSource();b("CSS").addClass(this.wrapper,"photocropWrapper");this.target.appendChild(this.bg);this.target.appendChild(this.wrapper);this.wrapper.appendChild(this.highlight);this.wrapper.appendChild(this.viewport);["ne","nw","sw","se"].forEach(function(a){var c=b("DOM").create("div");b("CSS").addClass(c,a);c.setAttribute("data-cropcorner",a);this.viewport.appendChild(c);b("CSS").addClass(c,"profilePicViewportGrabby")}.bind(this));b("Event").listen(this.viewport,{mousedown:this.mousedown.bind(this),dragstart:b("Event").kill,selectstart:b("Event").kill,click:b("Event").stop});b("Event").listen(document,{mousemove:this.mousemove.bind(this),mouseup:this.mouseup.bind(this)});b("Event").listen(window,{resize:this.adjustForResize.bind(this)});this.realignToPictureSize();this.redraw()}a.prototype.setInitialDimensionsAndPos=function(){"use strict";__p&&__p();this._constraint=b("PhotocropConstraint")(this,this.constraint_type);var a=b("PhotocropConstraintConstants").getAspectRatioForType(this.constraint_type),c=this.getPhotoDimensions();a&&(this._unscaledMinHeight=this._unscaledMinWidth/a,this._unscaledHeight=this._unscaledWidth/a);this.setNewRatio();var d=Math.min(this.width,c.x),e=Math.min(this.height,c.y);this.min_width=Math.min(this.min_width,c.x);this.min_height=Math.min(this.min_height,c.y);a&&(c.x/c.y>a?(e=Math.min(e,c.y),d=e*a,this.min_width=this.min_height*a):(d=Math.min(d,c.x),e=d/a,this.min_height=this.min_width/a));c=this.center_x-d/2;a=this.center_y-e/2;this.box=new(b("Rect"))(a,c+d,a+e,c)};a.prototype.getPhotoDimensions=function(){"use strict";return new(b("Vector"))(Math.round(parseFloat(b("Style").get(this.photo,"width"))),Math.round(parseFloat(b("Style").get(this.photo,"height"))))};a.prototype.getPhotoPosition=function(){"use strict";return new(b("Vector"))(this.photo.offsetLeft,this.photo.offsetTop)};a.prototype.setHighlightSource=function(){"use strict";this.highlight.src=this.photo.src};a.prototype.setConstraintType=function(a){"use strict";this.constraint_type=a,this.setInitialDimensionsAndPos(),this.adjustForResize()};a.prototype.adjustForResize=function(){"use strict";var a=this.ratio,b=this.setNewRatio();b=b/a;this.box.t*=b;this.box.l*=b;this.box.b*=b;this.box.r*=b;this.redraw();this.realignToPictureSize()};a.prototype.setNewRatio=function(){"use strict";this.ratio=this.getPhotoDimensions().x/this.imageDimensions.x;this.min_width=this.ratio*this._unscaledMinWidth;this.min_height=this.ratio*this._unscaledMinHeight;this.width=Math.max(1,this.ratio)*this._unscaledWidth;this.height=Math.max(1,this.ratio)*this._unscaledHeight;return this.ratio};a.prototype.realignToPictureSize=function(){"use strict";var a=this.photo;if(!a)return;var b=this.getPhotoDimensions(),c=this.getPhotoPosition();[this.bg,this.wrapper].forEach(function(a){a.style.width=b.x+"px",a.style.height=b.y+"px",a.style.top=c.y+"px",a.style.left=c.x+"px"})};a.prototype.redraw=function(){"use strict";var a=[this.box.t,this.box.r,this.box.b,this.box.l],b=this.getPhotoDimensions();this.highlight.style.width=b.x+"px";this.highlight.style.height=b.y+"px";this.highlight.style.clip="rect("+a.join("px ")+"px)";this.viewport.style.top=this.box.t+"px";this.viewport.style.left=this.box.l+"px";this.viewport.style.height=this.box.b-this.box.t+"px";this.viewport.style.width=this.box.r-this.box.l+"px"};a.prototype.done=function(a){"use strict";this.freezeViewport=!0;a||([this.bg,this.wrapper].forEach(b("DOM").remove),this.create_target?(b("DOM").remove(this.target),this.target=null):b("CSS").removeClass(this.target,"photocrop"));var c=Math.round(this.box.l*(1/this.ratio)),d=Math.round(this.box.t*(1/this.ratio)),e=Math.round(this.box.r*(1/this.ratio)),f=Math.round(this.box.b*(1/this.ratio));this.inform("done",a);return{x:Math.max(c,0),y:Math.max(d,0),width:e-Math.max(c,0),height:f-Math.max(d,0)}};a.prototype.reset=function(){"use strict";this.freezeViewport=!1};a.prototype.mousedown=function(a){"use strict";if(this.freezeViewport)return;this.mouseTarget=a.getTarget();this._constraint.onMouseDown(b("Vector").getEventPosition(a));b("CSS").addClass(document.body,"draggingMode");return!1};a.prototype.mousemove=function(a){"use strict";if(!this.mouseTarget)return;this._constraint.onMouseMove(b("Vector").getEventPosition(a),this.mouseTarget!==this.viewport,this.mouseTarget.getAttribute("data-cropcorner"));this.redraw();return!1};a.prototype.mouseup=function(a){"use strict";this.mouseTarget=null,b("CSS").removeClass(document.body,"draggingMode")};e.exports=a}),null);
__d("OzPhotoCropper.react",["cx","OzHelpers","BasicVector","Photocrop2","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={imageSize:null},this.finalizeCrop=function(a){var c=this.refs.canvas;a=this.$2.done(a);var d=a.x,e=a.y,f=a.height;a=a.width;c.width=a;c.height=f;c.getContext("2d").drawImage(this.$1,Math.max(0,d),Math.max(0,e),a,f,0,0,a,f);return b("OzHelpers").blobFromDataURI(c.toDataURL())}.bind(this),c}a.prototype.componentDidMount=function(){"use strict";this.$1=new Image(),this.$1.src=this.props.src,this.$1.onload=function(a){a=new(b("BasicVector"))(this.$1.width,this.$1.height);this.setState({imageSize:a});this.$2=new(b("Photocrop2"))(this.refs.img,{},a)}.bind(this)};a.prototype.componentWillUnmount=function(){"use strict";this.$1=null};a.prototype.render=function(){"use strict";return b("React").createElement("div",{className:"_3x2x"},b("React").createElement("canvas",{ref:"canvas",style:{display:"none"}}),b("React").createElement("img",{src:this.props.src,ref:"img",className:"_3x2y"}))};a.propTypes={src:c.string.isRequired};e.exports=a}),null);
__d("OzAttachmentCropper.react",["OzHelpers","DialogFitHeight","immutable","OzPhotoCropper.react","OzImmutablePureRenderMixin","React","XUIButton.react","XUIDialog.react","XUIDialogBody.react","XUIDialogFooter.react","XUIDialogTitle.react"],(function(a,b,c,d,e,f){__p&&__p();a=b("immutable").Map;b("immutable").OrderedMap;c=b("React").PropTypes;d=b("React").createClass({displayName:"OzAttachmentCropper",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{attachment:c.instanceOf(a).isRequired,onSave:c.func.isRequired,onClose:c.func.isRequired},_handleSubmit:function(){var a=this.props,b=a.attachment;a=a.onSave;var c=this.refs.photoCropper.finalizeCrop();a(b.set("ui-blob",c))},render:function(){return b("React").createElement(b("XUIDialog.react"),{behaviors:{DialogFitHeight:b("DialogFitHeight")},onToggle:this.props.onClose,shown:!0,width:900},b("React").createElement(b("XUIDialogTitle.react"),null,b("React").createElement("span",null,"Crop tool")),b("React").createElement(b("XUIDialogBody.react"),null,b("React").createElement(b("OzPhotoCropper.react"),{src:b("OzHelpers").blobURI(this.props.attachment.get("ui-blob")),ref:"photoCropper"})),b("React").createElement(b("XUIDialogFooter.react"),null,b("React").createElement(b("XUIButton.react"),{onClick:this._handleSubmit,label:"Crop"})))}});e.exports=d}),null);
__d("OzAttachmentOverlay.react",["cx","joinClasses","OzLoading.react","OzImmutablePureRenderMixin","React","XUICloseButton.react","XUIEditButton.react"],(function(a,b,c,d,e,f,g){a=b("React").PropTypes;c=b("React").createClass({displayName:"OzAttachmentOverlay",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{onClick:a.func,onEdit:a.func,onRemove:a.func,loading:a.bool,className:a.string,children:a.any},render:function(){var a=this.props,c=a.onClick,d=a.onEdit,e=a.onRemove;a=a.loading;return b("React").createElement("div",{className:b("joinClasses")(this.props.className,"_18wc")},a?b("React").createElement(b("OzLoading.react"),null):null,b("React").createElement("div",{className:"_4xe8",onClick:c,role:"presentation"},d?b("React").createElement(b("XUIEditButton.react"),{className:"_1yll",type:"button",size:"medium",title:"Add Image",onClick:this._handleEdit}):null,e?b("React").createElement(b("XUICloseButton.react"),{type:"button",className:"_1ylm",size:"medium",shade:"dark",onClick:this._handleRemove}):null),this.props.children)},_handleEdit:function(a){a.stopPropagation(),this.props.onEdit&&this.props.onEdit()},_handleRemove:function(a){a.stopPropagation(),this.props.onRemove&&this.props.onRemove()}});e.exports=c}),null);
__d("OzBubbleImageSelector.react",["cx","Image.react","immutable","OzAttachmentOverlay.react","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("immutable").List;c=b("React").PropTypes;d=b("React").createClass({displayName:"OzBubbleImageSelector",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{onImageAdd:c.func.isRequired,onImageSelect:c.func.isRequired,selectedURI:c.string,thumbURIs:c.instanceOf(a).isRequired},render:function(){var a=this.props,c=a.onImageSelect,d=a.selectedURI;a=a.thumbURIs;return b("React").createElement("div",{className:"_1-i2"},a.map(function(a,e){return b("React").createElement(h,{index:e,isSelected:a===d,key:e,onSelect:c,uri:a})}),this._renderAddButton())},_renderAddButton:function(){return b("React").createElement("button",{type:"button",className:"_1-hv _1-i4",onClick:this.props.onImageAdd},"+")}});var h=b("React").createClass({displayName:"Thumbnail",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{index:c.number.isRequired,isSelected:c.bool.isRequired,uri:c.string.isRequired},render:function(){return b("React").createElement(b("OzAttachmentOverlay.react"),{className:this.props.isSelected?"_4-8e":"",onClick:this._handleSelect},b("React").createElement(b("Image.react"),{src:this.props.uri,className:"_1-i3",alt:"image thumb"}))},_handleSelect:function(){this.props.onSelect(this.props.uri)}});e.exports=d}),null);
__d("OzFormPreview.react",["cx","OzHelpers","joinClasses","React","Tooltip"],(function(a,b,c,d,e,f,g){a=b("OzHelpers").pure(function(a){a=a.children;return b("React").createElement("div",{className:"_5bwr"},a)});c=b("OzHelpers").pure(function(a){var c=a.label,d=a.tip,e=a.children;a=a.className;return!e?null:b("React").createElement("div",{className:b("joinClasses")("_5bws _5bwt",a)},b("React").createElement("div",{className:"_5bwv"},c),b("React").createElement("div",babelHelpers["extends"]({className:"_5bx2"},b("Tooltip").propsFor(d)),e))});a.Row=c;e.exports=a}),null);
__d("OzBubblePreview.react",["cx","OzAPI","OzHelpers","formatDate","AdsCurrencyFormatter","immutable","OzConfig","OzFormPreview.react","OzStores","OzActions","OzConstants","OzImmutablePureRenderMixin","React","Reflux","ShimButton.react","TextWithHighlights.atlas","XUIContextualDialog.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("OzConstants").ATTS,i=b("immutable").Map,j=b("immutable").List;a=b("React").PropTypes;var k=b("OzFormPreview.react").Row;c=b("OzStores").AutopilotStore;d=b("React").createClass({displayName:"OzBubblePreview",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{bubble:a.instanceOf(i).isRequired,highlight:a.string,meta:a.instanceOf(i),source:a.string},render:function(){return G(this.props)?b("React").createElement(p,this.props):b("React").createElement(l,this.props)}});var l=b("OzHelpers").pure(function(a){var c=a.bubble;a=a.highlight;var d=null;Number.isSafeInteger(c.get("amount"))&&(d=b("AdsCurrencyFormatter").formatCurrencyFullFormat(c.get("currency"),c.get("amount")));return b("React").createElement(B,{thumbURL:c.get("thumb-url")},b("React").createElement(D,{text:c.get("name"),highlight:a}),b("React").createElement(E,null,b("React").createElement(F,{color:"grey",highlight:a},c.get("description")||"No Description")),b("React").createElement(E,null,b("React").createElement(F,null,c.get("merchant-name")||"No Merchant")),b("React").createElement(E,null,b("React").createElement(F,{color:"blue",weight:"bold"},d)))}),m="__overviewTab",n="__hoursTab",o="__moreInfoTab",p=b("React").createClass({displayName:"PlacesPreview",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(c,"autopilot"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{bubble:a.instanceOf(i).isRequired,meta:a.instanceOf(i).isRequired,highlight:a.string},getInitialState:function(){return{shown:!1,activeTab:m}},_makeOpentableRequest:function(a,c){if(!this.state.config.getIn(["GK","openTableAPI"])){var d=N(a);if(d){a=r(a,c);a||b("OzAPI").requestAutopilot(d.toJS())}}},UNSAFE_componentWillMount:function(){this._makeOpentableRequest(this.props.meta,this.state.autopilot),window.clearTimeout(this.timeout)},UNSAFE_componentWillReceiveProps:function(a){a=a.meta;O(a)!==O(this.props.meta)&&this._makeOpentableRequest(a,this.state.autopilot)},_handleToggle:function(a){window.clearTimeout(this.timeout);var b=function(b){return this.setState({shown:a,activeTab:m})}.bind(this);a?b():this.timeout=window.setTimeout(b,100)},render:function(){var a=this.props,c=a.bubble,d=a.meta;a=a.highlight;var e=this.state,f=e.shown,g=e.activeTab,h=e.autopilot;e=e.config;return b("React").createElement("div",{ref:"root",tabIndex:"0",onMouseEnter:function(a){return this._handleToggle(!0)}.bind(this),onMouseLeave:function(a){return this._handleToggle(!1)}.bind(this)},b("React").createElement(B,{thumbURL:c.get("thumb-url")},b("React").createElement(D,{text:c.get("name"),highlight:a}),b("React").createElement(q,{rating:d.get("rating")}),b("React").createElement(E,null,b("React").createElement(F,null,d.get("cuisine")),"\xa0",b("React").createElement(F,null,d.get("price"))),b("React").createElement(E,null,b("React").createElement(s,{meta:d,autopilot:h}))),b("React").createElement(t,babelHelpers["extends"]({activeTab:g,contextRef:function(a){return this.refs.root}.bind(this),onTabChange:this._handleTabChange,shown:f,onToggle:this._handleToggle,autopilot:h,config:e},this.props)))},_handleTabChange:function(a){this.setState({activeTab:a})}}),q=b("OzHelpers").pure(function(a){a=a.rating;return a?b("React").createElement(E,null,b("React").createElement(F,{weight:"500"},a.get("value"),"/",a.get("scale"))," ",b("React").createElement(F,{color:"grey"},a.get("rating-count")?"("+a.get("rating-count")+" reviews)":null)):null}),r=function(a,c){a=N(a);if(a)if(b("OzConfig").getInStaticConfig(["GK","openTableAPI"]))return a.getIn(["data","times"]);else return c.get(a.getIn(["data","id"]));return null},s=b("OzHelpers").pure(function(a){var c=a.meta;a=a.autopilot;var d=N(c);if(!d)return b("React").createElement(F,null,"No OT info");d=r(c,a);if(!d)return b("React").createElement(F,null,"Checking OT...");return d.size===0?b("React").createElement(F,{color:"red"},"No Tables Available!"):b("React").createElement(F,null,"Table at ",L(c,d))}),t=b("OzHelpers").pure(function(a){var c=a.activeTab,d=a.contextRef,e=a.meta,f=a.onTabChange,g=a.onToggle,h=a.shown;a=babelHelpers.objectWithoutProperties(a,["activeTab","contextRef","meta","onTabChange","onToggle","shown"]);return b("React").createElement(b("XUIContextualDialog.react"),{contextRef:d,hoverHideDelay:0,position:"above",shown:h,hasActionableContext:!0},b("React").createElement("div",{className:"_53qb",onMouseEnter:function(a){return g(!0)},onMouseLeave:function(a){return g(!1)}},b("React").createElement("div",{className:"_c38"},b("React").createElement(u,babelHelpers["extends"]({meta:e},a)),b("React").createElement(A,{tabs:[["Overview",m],["Hours",n],["More Info",o]],active:c,onChange:f})),b("React").createElement(v,babelHelpers["extends"]({activeTab:c,meta:e},a))))}),u=b("OzHelpers").pure(function(a){var c=a.bubble,d=a.meta;a=a.highlight;return b("React").createElement("div",{className:"_53qc"},b("React").createElement(C,{url:c.get("thumb-url")}),b("React").createElement("div",{className:"_53qd"},b("React").createElement(D,{text:c.get("name"),highlight:a}),b("React").createElement(q,{rating:d.get("rating")}),b("React").createElement(E,null,b("React").createElement(F,null,d.get("cuisine"))),b("React").createElement(E,null,b("React").createElement(F,null,d.get("price")))))}),v=b("OzHelpers").pure(function(a){var c=a.activeTab;a=babelHelpers.objectWithoutProperties(a,["activeTab"]);return b("React").createElement("div",{className:"_53qe"},c===m&&b("React").createElement(w,a)||c===n&&b("React").createElement(y,a)||c===o&&b("React").createElement(z,a)||null)}),w=b("OzHelpers").pure(function(a){var c=a.bubble;a.highlight;var d=a.meta,e=a.autopilot;a=a.config;var f=(d.getIn(["address","street"],"")+"\n     "+d.getIn(["address","city"],"")+"\n    ").trim();return b("React").createElement(b("OzFormPreview.react"),null,b("React").createElement(k,{label:"Address"},f),b("React").createElement(k,{label:"Phone"},x(c,d)),b("React").createElement(k,{label:"Website"},b("React").createElement("a",{href:c.get("target-url"),target:"_blank",rel:"noopener noreferrer"},"Link")),b("React").createElement(k,{label:"OpenTable"},I(c,d,e)),a.getIn(["GK","yelpLink"])?b("React").createElement(k,{label:"Yelp"},b("React").createElement("a",{href:d.get("yelp-url"),target:"_blank",rel:"noopener noreferrer"},"Link")):null,b("React").createElement(k,{label:"Description"},c.get("description")))}),x=function(a,c){a=c.get("phone");return a?b("React").createElement(F,{weight:"bold"},b("OzHelpers").parsePhoneNumber(a)):null},y=b("OzHelpers").pure(function(a){a=a.meta;return b("React").createElement(b("OzFormPreview.react"),null,K(a.get("hours")||j()).map(function(a,c){return b("React").createElement(k,{key:c,label:c},a)}).valueSeq())}),z=b("OzHelpers").pure(function(a){__p&&__p();a.bubble;a=a.meta;var c=a.get("payment"),d=a.get("infos");if(c&&c.size||d&&d.size){a=function(){var a=function(a){return a[0].toUpperCase()+a.slice(1).toLowerCase()};return{v:b("React").createElement(b("OzFormPreview.react"),null,d.map(function(c,d){return b("React").createElement(k,{label:a(d),key:d},c)}).toList(),c?b("React").createElement(k,{label:"Payments"},c.map(a).toJS().join(", ")):null)}}();if(typeof a==="object")return a.v}else return b("React").createElement("div",null,"No additional info for this place...")}),A=b("OzHelpers").pure(function(a){var c=a.tabs,d=a.onChange,e=a.active;return b("React").createElement("div",{className:"_c39"},c.map(function(a){var c=a[0],f=a[1];a=f===e?{weight:"bold",color:"blue"}:{color:"grey"};return b("React").createElement("button",{key:f,role:"button",className:"_1-hv",onClick:function(a){return d(f)}},b("React").createElement(F,a,c))}))}),B=b("OzHelpers").pure(function(a){var c=a.children;a=a.thumbURL;return b("React").createElement("div",{className:"_1q15 _5rxk"},b("React").createElement(C,{url:a}),b("React").createElement("div",{className:"_1q17"},c))}),C=b("OzHelpers").pure(function(a){a=a.url;return a?b("React").createElement("div",{className:"_1q16",style:{backgroundImage:"url('"+a+"')"}}):null}),D=b("OzHelpers").pure(function(a){var c=a.text;a=a.highlight;return b("React").createElement(E,null,b("React").createElement(F,{weight:"bold",highlight:a},c||"No Title"))}),E=b("OzHelpers").pure(function(a){a=a.children;return b("React").createElement("div",{className:"_4-_7 _5rxl"},a)}),F=b("OzHelpers").pure(function(a){var c=a.children,d=a.color,e=a.highlight,f=a.size;a=a.weight;a=a===undefined?"normal":a;return c?b("React").createElement("span",{className:"_5rxm"+(f==="large"?" _5rxn":"")+(d==="blue"?" _5ryf":"")+(d==="grey"?" _5ryk":"")+(d==="red"?" _5emd":"")+(d==="green"?" _5emf":""),style:{fontWeight:a}},e?b("React").createElement(b("TextWithHighlights.atlas"),{text:c,highlight:e}):c):null});function G(a){var b=a.meta;a=a.source;return a==="places"&&b}function H(a,c,d){b("OzActions").selectAIPick(i({type:h.OPENTABLEQR,bubble:a,meta:c,"ui-body":d.count()>1?"Here are available times for today: "+Q(d):"The only available time for today is "+Q(d),quickreplies:P(d)}))}function I(a,c,d){__p&&__p();var e,f=c.get("open-table");if(f){var g,e=function(){var e=r(c,d);e&&(e.size===0?g=b("React").createElement(F,{color:"red"},"No tables available!"):g=b("React").createElement(F,null,"Tables available at "+Q(e)));return{v:b("React").createElement("div",null,b("React").createElement("a",{href:f.get("url"),target:"_blank",rel:"noopener noreferrer"},"Link (",f.get("area"),")"),b("React").createElement("br",null),g,e&&e.size?b("React").createElement("span",null,b("React").createElement("br",null),b("React").createElement(b("ShimButton.react"),{form:"link",onClick:function(){return H(a,c,e)}},"Suggest via quickreplies")):null)}}();if(typeof e==="object")return e.v}return null}var J=j(["Sun","Mon","Tues","Wed","Thurs","Fri","Sat"]);function K(a){__p&&__p();var c=function(){var a=new Date(b("OzHelpers").serverNow());a.setHours(0,0,0,0);a.setDate(a.getDate()-a.getDay()+1);return+a},d=c(),e=function(a){return new Date(d+a*60*1e3)},f=function(a){return b("formatDate")(a,"h:i A",{skipPatternLocalization:!0})},g=function(a){return a.map(f).join(" - ")};return a.map(function(a){return a.map(e)}).groupBy(function(a){return a.get("start").getDay()}).mapKeys(function(a){return J.get(a)}).map(function(a){return a.map(g).join(", ")})}function L(a,b){var c=function(a){a=a.split(":");var b=a[0];a=a[1];return parseInt(a,10)+parseInt(b,10)*60},d=c(a.getIn(["open-table","availability","data","hour"]));return M(b.map(function(a){return a.get("hour")}).minBy(function(a){return Math.abs(d-c(a))}))}function M(a){__p&&__p();var b=a.split(":"),c=b[0];b=b[1];c=parseInt(c,10);if(c===0)return"12:"+b+"AM";else if(c<12)return a+"AM";else if(c===12)return a+"PM";else return c-12+":"+b+"PM"}function N(a){return a.getIn(["open-table","availability"])}function O(a){return a.getIn(["open-table","availability","data","id"])}function P(a){var b=a.count()>1?"None of these times work for me":"This time doesn't work for me";return a.map(function(a){return M(a.get("hour"))}).push(b)}function Q(a){return a.map(function(a){return M(a.get("hour"))}).toJS().join(", ")}e.exports=d}),null);
__d("OzMerchantDialog.react",["cx","OzHelpers","immutable","Layout.react","MessengerDialog.react","MessengerDialogHeader.react","MessengerDialogTitle.react","OzActions","React","ReactDOM","XUIDatePicker.react","XUIError.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("Layout.react").Column,j=b("Layout.react").FillColumn;c=b("React").PropTypes;var k=b("immutable").Map;d=b("immutable").Set;var l=d(["name-dba","name-legal","website","phone","address","page-id","country","type","owner-name"]),m=k({country:"US"});f=babelHelpers.inherits(a,b("React").Component);h=f&&f.prototype;function a(a){"use strict";h.constructor.call(this,a);n.call(this);var b=a.initialMerchant;a=m.filterNot(function(a,c){return b.get(c)});this.state={inputs:a,errors:k()}}a.prototype.componentDidMount=function(){"use strict";var a=b("ReactDOM").findDOMNode(this.refs["name-dba"]);a&&a.focus()};a.prototype.render=function(){"use strict";return b("React").createElement(b("MessengerDialog.react"),{className:"_18w8",onToggle:this.$1,ref:"dialog",type:"default",width:544},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogTitle.react"),null,this.props.title)),this.$2(),b("React").createElement("div",null,this.$3("Save",this.$4),this.$3("Cancel",b("OzActions").hideDialog)))};a.propTypes={onMerchant:c.func.isRequired,title:c.string,initialMerchant:c.instanceOf(k)};a.defaultProps={title:"Create a merchant",initialMerchant:k()};var n=function(){__p&&__p();this.$3=function(a,c){return b("React").createElement("button",{onClick:c,className:"_bx0 _3e2t _30yy"},a)},this.$2=function(){return b("React").createElement("div",{className:"_374d _18w9"},this.$5("name-dba","Name *"),this.$5("name-legal","Legal Name"),this.$5("website","Website"),this.$5("phone","Phone"),this.$5("address","Address"),this.$5("page-id","Facebook Page Id"),this.$5("country","Country *"),this.$5("type","Business Type"),this.$5("owner-name","Owner Name"),this.$6("owner-birth-date","Owner Birth Date"))}.bind(this),this.$5=function(a,c){var d=this.props.initialMerchant,e=this.state,f=e.inputs;e=e.errors;return b("React").createElement(b("Layout.react"),{key:a},b("React").createElement(i,{className:"mrm _bx1"},c),b("React").createElement(j,null,b("React").createElement(b("XUIError.react"),{xuiError:e.get(a)||null},b("React").createElement("input",{ref:a,type:"text",className:"_7q5 _bx2",defaultValue:d.get(a),value:f.get(a),onChange:function(b){this.setState({inputs:f.set(a,b.target.value),errors:k()})}.bind(this)}))))}.bind(this),this.$6=function(a,c){var d={},e=this.props.initialMerchant;e=e.get("owner-birth-date");e&&(d.initialTime=e);return b("React").createElement(b("Layout.react"),{key:a},b("React").createElement(i,{className:"mrm _bx1"},c),b("React").createElement(i,null,b("React").createElement(b("XUIDatePicker.react"),babelHelpers["extends"]({ref:a,shouldSetDefaultDate:!1},d))))}.bind(this),this.$4=function(){var a=this.$7();a&&(a.id=this.props.initialMerchant.get("id"),this.props.onMerchant(a))}.bind(this),this.$1=function(a){a||b("OzActions").hideDialog()},this.$7=function(){__p&&__p();var a=k(),c=this.props.initialMerchant,d=function(a){var b=this.state.inputs.get(a,undefined);return b===undefined?c.get(a):b||null}.bind(this);a=k(l.map(function(a){return[a,d(a)]})).set("id",c.get("id"));var e=this.refs["owner-birth-date"].state.selectTime;a=a.set("owner-birth-date",e);a=b("OzHelpers").normalizeMerchant(a);e=b("OzHelpers").validateMerchant(a);this.setState({errors:e});return!e.isEmpty()?null:a}.bind(this)};e.exports=a}),null);
__d("OzSetPicURLDialog.react",["cx","getURLRanges","OzHelpers","Image.react","Keys","MessengerDialog.react","MessengerDialogHeader.react","MessengerDialogTitle.react","OzImmutablePureRenderMixin","React","ReactDOM"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"OzSetPicURLDialog",mixins:[b("OzImmutablePureRenderMixin")],PropTypes:{onURL:a.func.isRequired,onEscape:a.func},componentDidMount:function(){var a=b("ReactDOM").findDOMNode(this.refs.url);a&&a.focus()},getInitialState:function(){return{errors:[],url:""}},render:function(){return b("React").createElement(b("MessengerDialog.react"),{className:"_18w8",onToggle:this._handleToggle,ref:"dialog",type:"default",width:544},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogTitle.react"),null,"Enter a URL for your picture")),this._renderImage(),this._renderErrors(),b("React").createElement("div",{className:"_374d _18w9"},b("React").createElement("input",{onChange:this._handleChange,onKeyDown:this._handleKeyDown,ref:"url",type:"text",className:"_7q5",placeholder:"URL to picture"})),b("React").createElement("div",{className:"_18wa"},"Press Enter when you're done."))},_renderImage:function(){var a=this.state.url,c=this.state.errors||[];return c.length>0||!a||a.length===0?null:b("React").createElement(b("Image.react"),{className:"_24p-",src:a})},_renderErrors:function(){var a=this.state.errors;return!a||a.length===0?null:b("React").createElement("div",{key:"errors",className:"_1yln"},a.map(function(a){var c=a[0];a=a[1];return b("React").createElement("div",{key:c,className:"_1ylp"},a)}))},_handleChange:function(a){if(a.target.value.length&&!b("getURLRanges")(a.target.value).length){this.setState({errors:[["invalid_url","You must provide a valid uri"]]});return}a=a.target.value.length?b("getURLRanges")(a.target.value)[0].entity.url:"";this.setState({errors:[],url:a})},_handleKeyDown:function(a){__p&&__p();if(a.keyCode===b("Keys").ESC){var c=this.props.onEscape;c&&c(a);return}c=this.state.errors||[];if(c.length===0&&a.keyCode===b("Keys").RETURN){a.preventDefault();c=a.target.value.length?b("getURLRanges")(a.target.value)[0].entity.url:"";this.props.onURL(c)}return},_handleToggle:function(){b("OzHelpers").debug("[OzSetPicURLDialog] toggled",arguments)}});e.exports=c}),null);
__d("OzBubbleEditor.react",["cx","Promise","OzAPI","getURLRanges","OzHelpers","OzNotify","AdsCurrencyInput_DEPRECATED.react","immutable","Keys","OzActions","OzBubbleImageSelector.react","OzBubblePreview.react","OzConfig","OzMerchantDialog.react","OzSearchSource","OzSetPicURLDialog.react","OzImmutablePureRenderMixin","React","Reflux","SearchableDropdownInput.contrib","SearchableEntry","ShimButton.react","XUICloseButton.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("immutable").List,i=b("immutable").Map;a=b("React").PropTypes;var j=["thumb-url"],k=["thumb-urls"],l=n("No Merchant"),m=69;c=b("React").createClass({displayName:"OzBubbleEditor",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{merchants:a.instanceOf(i).isRequired,seedBubble:a.instanceOf(i).isRequired,onSave:a.func.isRequired,onClose:a.func.isRequired},getInitialState:function(){return{newData:i()}},UNSAFE_componentWillMount:function(){this._searchSource=new(b("OzSearchSource"))(function(a){var c=a.query||"";a=this.props.merchants.valueSeq().filter(function(a){return a.get("name-dba").toLowerCase().indexOf(c.toLowerCase())>-1}).map(function(a){return n(a.get("name-dba"))}).take(15).toArray();return b("Promise").resolve(this._data().get("merchant-name")?[l].concat(a):a)}.bind(this))},componentDidMount:function(){this.focus("Title")},focus:function(a){this.refs[a]&&this.refs[a].focus&&this.refs[a].focus()},render:function(){return b("React").createElement("div",{className:"_1-ht"},b("React").createElement("div",{className:"_2zfj"},this._renderSection("Preview",this._renderPreview)),b("React").createElement("form",{className:"_2zfk",onKeyDown:function(a){a.keyCode===b("Keys").ESC&&this.props.onClose(this._bubble())}.bind(this),onSubmit:function(a){a.stopPropagation(),a.preventDefault(),this._handleSubmit()}.bind(this)},b("React").createElement(b("XUICloseButton.react"),{className:"_1-hu",shade:"dark",size:"medium",onClick:function(a){return this.props.onClose(this._bubble())}.bind(this)}),this._renderSection("Image",this._renderImage),this._renderSection("Title",this._renderInput.bind(this,["name"])),this._renderSection("Description",this._renderDescription),this._renderSection("URL",this._renderInput.bind(this,["target-url"])),this._renderSection("Merchant",this._renderMerchant),this._renderSection("Price",this._renderPrice),this._renderSubmit()))},_bubble:function(){return this.props.seedBubble.set("data",this._data()).deleteIn(["data","thumb-urls"])},_data:function(){var a=this.state.newData.updateIn(k,function(a){var b=this.props.seedBubble.getIn(["data"].concat(k));return(b||h()).concat(a)}.bind(this));return this.props.seedBubble.get("data").merge(a)},_handleSubmit:function(){__p&&__p();var a=this._bubble(),c=a.get("data");c=[[c.get("name"),"Please enter a title."],[c.get("expires-in")||!c.get("expiration-time"),"Since this bubble is old, please re-enter the expiration time."],[b("OzHelpers").validateURL(c.get("target-url")),'Please enter a valid url. Usually, you need to add "www."'],[b("OzHelpers").validateURL(c.get("thumb-url"))||!c.get("thumb-url"),"Please enter a valid url for your image."],[c.get("merchant-name")||!c.get("amount"),"You need to specify a merchant if you've listed a price."],[c.get("amount")||!c.get("expires-in"),"You need to list a price if you've set an expiration time."]].filter(function(a){var b=a[0];a[1];return!b}).map(function(a){a[0];a=a[1];return a});if(c.length){b("OzNotify").error(c[0]);return}this.props.onSave(a.updateIn(["data","target-url"],function(a){return b("getURLRanges")(a)[0].entity.url}))},_handleCreateMerchant:function(){b("OzActions").showDialog(b("OzMerchantDialog.react"),{onMerchant:function(a){b("OzAPI").createMerchant(a);a=this.state.newData.set("merchant-name",a.get("name-dba"));this.setState({newData:a});b("OzActions").hideDialog()}.bind(this)})},_handleAddImage:function(){b("OzActions").showDialog(b("OzSetPicURLDialog.react"),{onEscape:function(a){b("OzActions").hideDialog(),this.focus("Title")}.bind(this),onURL:function(a){b("OzActions").hideDialog(),this.setState(function(b){return{newData:q(b.newData,a)}}),this.focus("Title")}.bind(this)})},_handleSelectImage:function(a){this.setState(function(b){return{newData:b.newData.setIn(j,a)}})},_renderSubmit:function(){return b("React").createElement("button",{type:"submit",className:"_1-hv _1-hw"},"DONE")},_renderSection:function(a,c){return b("React").createElement("div",{className:"_1-hx"},b("React").createElement("div",{className:"_1-hz",onClick:function(b){return this.focus(a)}.bind(this),role:"presentation"},a),b("React").createElement("div",{className:"_1-h-"},c(a)))},_renderPrice:function(a){var c=this._data();a=c.get("currency");var d=c.get("amount");return b("React").createElement("div",{className:"_1-h_"},b("React").createElement(b("AdsCurrencyInput_DEPRECATED.react"),{placeholder:"(optional)",currency:a||"USD",value:Number.isSafeInteger(d)?d:null,onDataUpdate:function(a){this.setState({newData:c.set("amount",a)})}.bind(this),eventType:"change"}),this._renderExpiration())},_renderExpiration:function(){return!this.state.config.getIn(["GK","expirationDate"])?null:b("React").createElement("div",{className:"_51w3"},b("React").createElement("div",{className:"_1-hz"},"Expiration Time:"),b("React").createElement(p,{expiresIn:this._data().get("expires-in"),onChange:function(a){return this.setState({newData:this.state.newData.set("expires-in",a)})}.bind(this)}))},_renderInput:function(a,c){var d=this.state.newData;return b("React").createElement("input",{ref:c,type:"text",className:"_1-i0 _1-i1",value:this._data().getIn(a),onChange:function(b){return this.setState({newData:d.setIn(a,b.target.value)})}.bind(this)})},_renderImage:function(){var a=this._data(),c=a.getIn(j);a=o(a,c);return b("React").createElement(b("OzBubbleImageSelector.react"),{onImageAdd:this._handleAddImage,onImageSelect:this._handleSelectImage,selectedURI:c,thumbURIs:a})},_renderMerchant:function(){var a=this._data();a=a.get("merchant-name");a=a?n(a):null;return b("React").createElement("div",{className:"_1-i5"},b("React").createElement("div",{className:"_1-i6"},b("React").createElement(b("SearchableDropdownInput.contrib"),{divClassName:"_1-i7",value:a,onSelect:function(a){a=a.getUniqueID()===l.getUniqueID()?null:a.getTitle();a=this.state.newData.set("merchant-name",a);this.setState({newData:a})}.bind(this),emptySearchResultsText:"No merchants found. Click + to add",placeholder:"Pick a Merchant (optional)",searchSource:this._searchSource})),b("React").createElement(b("ShimButton.react"),{className:"_1-hv _4nd4 _1-i8",onClick:this._handleCreateMerchant}))},_renderPreview:function(){return b("React").createElement(b("OzBubblePreview.react"),{bubble:this._data()})},_renderDescription:function(){var a=this._data(),c=a.get("description"),d=c&&c.length>m;return b("React").createElement("div",null,b("React").createElement("input",{ref:"description",type:"text",className:"_1-i0 _1-i1",value:c,onChange:function(b){return this.setState({newData:a.set("description",b.target.value)})}.bind(this)}),b("React").createElement("text",{className:d?"_353q":""},m-(c?c.length:0)+" characters left"))}});function n(a){return new(b("SearchableEntry"))({title:a,uniqueID:a})}function o(a,b){return a.getIn(k,h()).toOrderedSet().add(b).toList().filter(function(a){return a})}var p=b("OzHelpers").pure(function(a){var c=a.expiresIn,d=a.onChange;a="_1-i0 _3owv";var e=c||i({hours:0,minutes:0}),f=function(a){return Math.max(+a,0)},g=function(a){return d(e.merge(i(a)))},h=function(a,b){return e.get(b)===1?a:a+"s"};return b("React").createElement("div",{className:"_51wb"},b("React").createElement("label",{className:"_1-hz"},b("React").createElement("input",{className:a,onChange:function(a){return g({hours:f(a.target.value)})},type:"number",value:c?c.get("hours"):null}),h("hour","hours")),b("React").createElement("label",{className:"_1-hz"},b("React").createElement("input",{className:a,onChange:function(a){return g({minutes:f(a.target.value)})},type:"number",value:c?c.get("minutes"):null}),h("minute","minutes")))});function q(a,b){return a.withMutations(function(a){a.updateIn(k,h(),function(a){return a.push(b)}),a.setIn(j,b)})}e.exports=c}),null);
__d("OzComposerAI.react",["cx","ContextualLayerAutoFlip","ContextualLayerUpdateOnScroll","OzHelpers","joinClasses","immutable","Image.react","LayerHideOnBlur","MessengerSpinner.react","OzBubblePreview.react","OzConfig","OzConstants","OzImmutablePureRenderMixin","React","Reflux","ShimButton.react","TextWithHighlights.atlas","MessengerButtonReact.bs","formatDate","XUIContextualDialog.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MessengerButtonReact.bs").jsComponent,i=b("immutable").Map,j=b("immutable").List,k=b("OzConstants").ATTS;a=b("React").PropTypes;c=b("React").createClass({displayName:"OzComposerAIList",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{filter:a.string,items:a.instanceOf(j).isRequired,onItemClick:a.func.isRequired},getInitialState:function(){return{}},render:function(){var a=this.props,c=a.items,d=a.filter;a=a.onItemClick;var e={filter:d,onItemClick:a};return!c.isEmpty()&&b("React").createElement("div",{className:"_4285"},c.map(function(a,c){return j.isList(a)?b("React").createElement("div",{key:c,className:"_2961"},a.map(function(a,d){return b("React").createElement(q,babelHelpers["extends"]({key:d,column:d,line:c,item:a},e))})):b("React").createElement(l,babelHelpers["extends"]({key:c,line:c,item:a,onToggleDebug:function(a){return this.setState({debugLine:this.state.debugLine===c?null:c})}.bind(this),debugShown:this.state.debugLine===c},e))}.bind(this)).reverse())}});var l=b("React").createClass({displayName:"ItemRow",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{onToggleDebug:a.func.isRequired,debugShown:a.bool.isRequired},componentDidMount:function(){this.props.item.get("id")&&this.props.item.get("at")&&(this._timeout=window.setTimeout(function(a){return this._timeout!==null&&this.forceUpdate()}.bind(this),y(this.props.item)))},componentWillUnmount:function(){window.clearTimeout(this._timeout),this._timeout=null},render:function(){var a=this.props,c=a.item,d=a.line,e=a.onItemClick;a=a.filter;var f=i({line:d,column:0}),g=c.get("id"),j=c.get("at"),k=this.state.config.get("debugAI");return b("React").createElement("div",{className:"_2962",onClick:function(a){a.preventDefault(),e(f)},role:"presentation"},x(c)?b("React").createElement(p,{label:"AUTO-SENDING",at:j}):null,b("React").createElement("div",{className:"_58jk",ref:"root"},b("React").createElement("div",{className:"_2964"},b("React").createElement(s,{item:c,filter:a})),b("React").createElement("span",{className:"_58jl"},w(c)?b("React").createElement(h,{type:"secondary",label:"EXECUTING NOW..."}):x(c)?b("React").createElement(h,{type:"secondary",label:"STOP"}):g&&j?b("formatDate")(j/1e3,"g:ia M j"):"\u2318"+c.get("shortcut",d+1),k&&b("React").createElement(o,babelHelpers["extends"]({contextRef:function(a){return this.refs.root}.bind(this)},this.props)))))}});function m(a,b,c,d,e){a='<span style="color: brown">';var f='<span style="color: navy">',g='<span style="color: navy">';b=b||"";c&&(b=b+a+c.replace(/[\": ]/g,"")+"</span>: ");d&&(b=b+(d[0]=='"'?g:f)+d+"</span>");return b+(e||"")}function n(a){var c=/^( *)(\"[\w]+\": )?(\"[^\"]*\"|[\w.+-]*)?([,[{])?$/gm;a={__html:JSON.stringify(a,null,3).replace(/&/g,"&amp;").replace(/\\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(c,m)};return b("React").createElement("div",{dangerouslySetInnerHTML:a})}var o=b("React").createClass({displayName:"DebugInfo",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{onToggleDebug:a.func.isRequired,debugShown:a.bool.isRequired},_handleToggleDebugInfo:function(event){this.props.onToggleDebug(),event.stopPropagation()},render:function(){var a=this.props,c=a.contextRef,d=a.item;a=a.debugShown;var e=d.get("source");d=d.get("debug");return b("React").createElement("span",null,e?" "+e:"",d?" ":"",d&&b("React").createElement("span",null,b("React").createElement(b("ShimButton.react"),{className:"_5ufb",form:"link",onClick:this._handleToggleDebugInfo}),b("React").createElement(b("XUIContextualDialog.react"),{behaviors:{ContextualLayerAutoFlip:b("ContextualLayerAutoFlip"),ContextualLayerUpdateOnScroll:b("ContextualLayerUpdateOnScroll"),LayerHideOnBlur:b("LayerHideOnBlur")},contextRef:c,hoverHideDelay:0,onBlur:this.props.onToggleDebug,position:"right",shown:a,hasActionableContext:!0},b("React").createElement("div",{className:"_5ufd"},n(d.toJS())))))}}),p=b("React").createClass({displayName:"TimeProgress",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{at:a.number.isRequired,label:a.string},componentDidMount:function(){this._start=Date.now();var a=window.setInterval(function(a){return this.forceUpdate()}.bind(this));this.unlisten=function(b){return window.clearInterval(a,1e3)}},componentWillUnmount:function(){this.unlisten()},render:function(){var a=this.props,c=a.at;a=a.label;c=u(this._start,Date.now(),c);return b("React").createElement("div",{className:"_58jn"},b("React").createElement("div",{className:"_16bc",style:{width:c+"%"}}),b("React").createElement("div",{className:"_16bd"},a))}}),q=b("React").createClass({displayName:"ItemColumn",mixins:[b("OzImmutablePureRenderMixin")],componentDidMount:function(){this.props.item.get("id")&&this.props.item.get("at")&&(this._timeout=window.setTimeout(function(a){return this._timeout!==null&&this.forceUpdate()}.bind(this),y(this.props.item)))},componentWillUnmount:function(){window.clearTimeout(this._timeout),this._timeout=null},render:function(){var a=this.props,c=a.column,d=a.filter,e=a.item,f=a.line,g=a.onItemClick,j=i({line:f,column:c});a=e.get("at");return b("React").createElement("div",{className:"_2966",onClick:function(a){a.preventDefault(),g(j)},role:"presentation"},x(e)?b("React").createElement(p,{label:"AUTO-SENDING",at:a}):null,b("React").createElement("div",{className:"_34mx"},w(e)?b("React").createElement(h,{type:"secondary",label:"EXECUTING NOW..."}):x(e)?b("React").createElement(h,{type:"secondary",label:"STOP"}):b("React").createElement("span",null,e.get("id")&&a?b("formatDate")(a/1e3,"g:ia M j"):"")),b("React").createElement(s,{className:"_34mz",item:e,filter:d}))}}),r=b("OzHelpers").pure(function(a){a=a.images;return b("React").createElement("div",null,a.map(function(a,c){return b("React").createElement(b("Image.react"),{key:c,className:"_1q16",src:a.get("url"),alt:a.get("filename")})}))}),s=b("OzHelpers").pure(function(a){var c=a.filter,d=a.item;a=a.className;switch(d.get("type")){case k.COMMAND:return b("React").createElement(t,{command:d,highlight:c});case k.SURVEY:case"send":case k.TEMPLATE:var e=d.get("ui-body")&&'"'+d.get("ui-body")+'"',f=d.getIn(["data","images"]);return b("React").createElement("div",{className:a},e?b("React").createElement(b("TextWithHighlights.atlas"),{text:e,highlight:c}):null,f?b("React").createElement(r,{images:f}):null);case"suggest":case k.SUGG:return b("React").createElement(b("OzBubblePreview.react"),{bubble:d.get("data"),highlight:c,meta:d.get("meta"),source:d.get("source")});default:b("OzHelpers").debug("[composerai] could not render item",d);return null}}),t=b("OzHelpers").pure(function(a){var c=a.command;a=a.highlight;return b("React").createElement("div",{className:"_2_he"},b("React").createElement("i",{className:b("joinClasses")("_2_hf",c.get("iconCl"))}),b("React").createElement(b("TextWithHighlights.atlas"),{text:c.get("text"),highlight:a}))});function u(a,b,c){b=b-a;c=c-a;return b>=0&&c>0?Math.min(100,Math.round(b/c*100)):100}var v=1e4;function w(a){return a.get("id")&&a.get("at")&&b("OzHelpers").serverNow()>a.get("at")}function x(a){return a.get("id")&&a.get("at")&&b("OzHelpers").serverNow()+v>a.get("at")}function y(a){var c=500;return x(a)?a.get("at")-b("OzHelpers").serverNow()+c:a.get("at")-v-b("OzHelpers").serverNow()+c}e.exports={OzComposerAIList:c}}),null);
__d("OzListEditor.react",["cx","OzHelpers","joinClasses","immutable","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("immutable").List;var h=b("immutable").Map;c=b("React").PropTypes;d=b("React").createClass({displayName:"OzListEditor",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{autofocus:c.bool,list:c.instanceOf(a).isRequired,onClose:c.func,onEdit:c.func.isRequired},componentDidMount:function(){this.props.autofocus&&this._focus(0)},componentDidUpdate:function(a){a=a.list;var b=this.props.list.count();a.count()<b&&this._focus(b-1)},_focus:function(a){this.refs[a]&&this.refs[a].focus()},render:function(){__p&&__p();var a=this.props,c=a.list;a.onEdit;var d=a.className;babelHelpers.objectWithoutProperties(a,["list","onEdit","className"]);return b("React").createElement("div",{className:b("joinClasses")(d,"_42e_")},c.map(function(a,c){return b("React").createElement("div",{key:a.get("key"),className:"_42f5"},b("React").createElement("input",{type:"text",ref:c,className:"_42f6 _1-i0",value:a.get("text"),onBlur:function(b){return this._handleItemBlur(a.get("text"),c,b)}.bind(this),onChange:function(b){return this._handleItemChange(a.get("text"),c,b)}.bind(this),onKeyDown:function(b){return this._handleBackspace(a.get("text"),c,b)}.bind(this)}))}.bind(this)),b("React").createElement("div",{key:"plus",className:"_42f5"},b("React").createElement("button",{ref:"plus",className:"_42f7 _1-hv _30yy",type:"button",onMouseDown:function(a){return a.preventDefault()},onClick:this._handlePlusClick,onKeyDown:function(a){return this._handleBackspace(null,c.count(),a)}.bind(this)},"+")))},_setText:function(a,b){this.props.onEdit(this.props.list.setIn([a,"text"],b))},_handlePlusClick:function(){var a=this.props,b=a.list;a=a.onEdit;var c=i(b);b=c===null?b.push(j()):b["delete"](c).push(b.get(c));a(b)},_handleItemBlur:function(a,b,c){c=this.props;var d=c.list;c=c.onEdit;a.trim()?this._setText(b,a.trim()):d.count()>1&&c(d["delete"](b))},_handleItemChange:function(a,b,c){this._setText(b,c.target.value)},_handleBackspace:function(a,b,c){var d=this.props,e=d.list;d=d.onClose;c.key==="Backspace"&&!a&&(c.preventDefault(),b>0?this._focus(b-1):e.count()===1?d&&d():this._focus(b+1))}});function i(a){a=a.findEntry(function(a){return!a.get("text","").trim()});return a?a[0]:null}function j(){return h({key:b("OzHelpers").uniqId(),text:""})}e.exports=d}),null);
__d("OzTokenizer.react",["cx","Promise","OzHelpers","immutable","OzSearchSource","OzImmutablePureRenderMixin","React","SearchableEntry","XUITokenizer.react","XUITokenizerToken.react","TypeaheadViewItem","TypeaheadViewPropTypes"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("immutable").Map,i=b("immutable").List;a=b("React").PropTypes;c=b("React").createClass({displayName:"OzTokenizer",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{allTokens:a.instanceOf(i).isRequired,onCreateToken:a.func.isRequired,onDeleteToken:a.func.isRequired,chosenTokens:a.instanceOf(i).isRequired,resultRank:a.func.isRequired,resultFilter:a.func.isRequired,placeholder:a.string.isRequired,autofocus:a.bool,maxTokenTitleLength:a.number.isRequired,dropUp:a.bool,timeline:a.bool},getDefaultProps:function(){return{allTokens:i(),chosenTokens:i(),resultRank:function(a){return 0},resultFilter:function(a,b){return!0},maxTokenTitleLength:Number.MAX_SAFE_INTEGER,timeline:!1}},getInitialState:function(){return{q:""}},UNSAFE_componentWillMount:function(){var a=this.props,c=a.allTokens,d=a.chosenTokens,e=a.resultFilter,f=a.resultRank,g=a.maxTokenTitleLength;this._searchSource=new(b("OzSearchSource"))(function(a){a=a.query;return b("Promise").resolve(j(a,c,d,e,f,g))})},componentDidMount:function(){this.props.autofocus&&this.refs.tokenizer.focusInput()},_onAddEntryAttempt:function(a){var b=this.props,c=b.onCreateToken;b=b.maxTokenTitleLength;if(a.getTitle().length>b)return;this.setState({q:""});c(l(a))},_onDeleteEntryAttempt:function(a){var b=this.props.onDeleteToken;b(l(a))},_onQueryStringChange:function(a){var b=a.target.value;b.length<=this.props.maxTokenTitleLength&&this.setState({q:a.target.value})},render:function(){var a=this.props,c=a.chosenTokens,d=a.placeholder;a=a.timeline;return b("React").createElement("div",{className:"_2-e2"},b("React").createElement(b("XUITokenizer.react"),{className:"_2-e3"+(a?" _11_w":""),placeholder:d,entries:c.map(k).toJS(),presenter:this._tokenPresenter(),queryString:this.state.q,searchSource:this._searchSource,onRemoveEntryAttempt:this._onDeleteEntryAttempt,onAddEntryAttempt:this._onAddEntryAttempt,onQueryStringChange:this._onQueryStringChange,ref:"tokenizer"}))},_tokenPresenter:function(){var a=this.props.dropUp,c=b("OzHelpers").pure(function(a){return b("React").createElement(b("XUITokenizerToken.react"),babelHelpers["extends"]({},a,{className:"_2-e5"}))}),d=b("React").createClass({displayName:"OzTypeaheadViewItem",mixins:[b("TypeaheadViewItem").Mixin],propTypes:b("TypeaheadViewItem").propTypes,render:function(){var a=this.props.highlighted;return b("React").createElement("li",{className:"_2-e7"+(a?" _2-e8":""),"aria-selected":this.props.highlighted,onMouseDown:this._onSelect,onMouseEnter:this._onHighlight,role:this.props.role},this.props.entry.getTitle())}}),e=b("React").createClass({displayName:"OzTypeaheadView",mixins:[b("OzImmutablePureRenderMixin")],propTypes:b("TypeaheadViewPropTypes"),_renderItem:function(a){var c=a===this.props.highlightedEntry;return b("React").createElement(d,{key:a.getUniqueID(),entry:a,highlighted:c,onSelect:this.props.onSelect,onHighlight:this.props.onHighlight,onRenderHighlight:this.props.onRenderHighlight})},render:function(){var c="_2-e9"+(a?" _2-ea":"")+(this.props.entries.length?"":" _599s");return b("React").createElement("ul",{className:c,id:this.props.controlleeID,role:this.props.role},this.props.entries.map(this._renderItem))}});return{ViewRenderer:e,TokenRenderer:c,useLayer:!1}}});function j(){var a=arguments.length<=0||arguments[0]===undefined?"":arguments[0],b=arguments[1],c=arguments[2],d=arguments[3],e=arguments[4],f=arguments[5];if(!a)return[];var g=b.filter(function(a){return!c.includes(a)}).filter(function(a){return a.get("name").length<=f}).filter(function(b){return d(b,a)}).sortBy(e).map(k).take(10).toList();return g.filter(function(b){return b.getUniqueID()==a}).count()==0?g.push(k(h({name:a,id:a}))).toJS():g.toJS()}function k(a){return new(b("SearchableEntry"))({title:a.get("name"),uniqueID:a.get("id")})}function l(a){return h({id:a.getUniqueID(),name:a.getTitle()})}e.exports=c}),null);
__d("OzTextTokenizer.react",["immutable","OzTokenizer.react","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f){__p&&__p();var g=b("immutable").List;a=b("React").PropTypes;c=b("React").createClass({displayName:"OzTextTokenizer",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{allTokens:a.instanceOf(g).isRequired,onChange:a.func.isRequired,chosenTokens:a.instanceOf(g).isRequired,placeholder:a.string.isRequired,autofocus:a.bool,maxTokenLength:a.number},getDefaultProps:function(){return{allTokens:g(),chosenTokens:g()}},_commitChangedTokens:function(a){var b=this.props.onChange;this.setState({q:""});b(a)},_onAddEntryAttempt:function(a){var b=this.props.chosenTokens;this._commitChangedTokens(b.push(a))},_onDeleteEntryAttempt:function(a){var b=this.props.chosenTokens;a=b.indexOf(a);this._commitChangedTokens(a>=0?b["delete"](a):b)},render:function(){var a=this.props,c=a.allTokens,d=a.chosenTokens,e=a.placeholder,f=a.maxTokenLength;a=a.autofocus;return b("React").createElement(b("OzTokenizer.react"),{placeholder:e,allTokens:c,chosenTokens:d,onDeleteToken:this._onDeleteEntryAttempt,onCreateToken:this._onAddEntryAttempt,resultFilter:function(a,b){return a.get("name").toLowerCase().indexOf(b.toLowerCase())==0},maxTokenTitleLength:f,dropUp:!0,autofocus:a})}});e.exports=c}),null);
__d("OzQuickRepliesComposer.react",["cx","immutable","OzTextTokenizer.react","React","XUICloseButton.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("immutable").Map,j=b("immutable").List;c=b("React").PropTypes;var k=j(["Yes","No","Maybe later","7:00am","7:30am","8:00am","8:30am","9:00am","11:00am","11:30am","12:00pm","12:30pm","1:00pm","1:30pm","2:00pm","5:00pm","5:30pm","6:00pm","6:30pm","7:00pm","7:30pm","8:00pm","8:30pm","9:00pm","Italian","Japanese","Steakhouse","American","French","Chinese","Thai","Burmese","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday","San Francisco","Menlo Park","Los Angeles","New York","London","Paris","Berlin"]);d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=function(a){var b=this.props,c=b.attachment;b=b.onEdit;b(c.set("data",a))}.bind(this),b}a.prototype.render=function(){"use strict";var a=this.props,c=a.attachment;a=a.onRemove;return b("React").createElement("div",{className:"_46s3"},b("React").createElement("div",{className:"_46s4"},b("React").createElement("div",{className:"_46s5"},"Quick Replies"),b("React").createElement(b("XUICloseButton.react"),{onClick:a})),b("React").createElement(b("OzTextTokenizer.react"),{allTokens:k.map(function(a){return i({id:a,name:a})}),onChange:this.$1,chosenTokens:c.get("data")||j(),placeholder:"Add quick replies...",autofocus:!0,maxTokenLength:20}))};a.propTypes={attachment:c.instanceOf(i).isRequired,onEdit:c.func.isRequired,onRemove:c.func.isRequired};e.exports=a}),null);
__d("OzComposerAttachments.react",["cx","OzHelpers","Image.react","immutable","MNCommerceAgentItemSuggestionMercuryAttachment.react","OzAttachmentOverlay.react","OzConstants","OzListEditor.react","OzQuickRepliesComposer.react","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("immutable").OrderedMap;c=b("immutable").Map;b("immutable").List;var h=b("OzConstants").ATTS;d=b("React").PropTypes;f=b("React").createClass({displayName:"OzComposerAttachments",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{attachments:d.instanceOf(a).isRequired,onAttachmentCrop:d.func.isRequired,onBubbleEdit:d.func.isRequired,onQuickRepliesEdit:d.func.isRequired,onRemove:d.func.isRequired},render:function(){var a=this.props,c=a.attachments,d=a.onAttachmentCrop,e=a.onBubbleEdit,f=a.onQuickRepliesEdit,g=a.onRemove;return c.isEmpty()?null:b("React").createElement("div",{className:"_18wb"},c.map(function(a,c){return b("React").createElement(i,{key:c,id:c,attachment:a,onRemove:g,onBubbleEdit:e,onAttachmentCrop:d,onQuickRepliesEdit:f})}).valueSeq())}});var i=b("React").createClass({displayName:"Attachment",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{attachment:d.instanceOf(c).isRequired,id:d.number.isRequired,onAttachmentCrop:d.func.isRequired,onBubbleEdit:d.func.isRequired,onQuickRepliesEdit:d.func.isRequired,onRemove:d.func.isRequired},render:function(){__p&&__p();var a=this.props,c=a.attachment,d=a.id,e=a.onAttachmentCrop,f=a.onBubbleEdit,g=a.onQuickRepliesEdit,i=a.onRemove;switch(c.get("type")){case h.IMAGE:return b("React").createElement(b("OzAttachmentOverlay.react"),{key:d,onEdit:function(a){return e(c,d)},onRemove:function(a){return i(c,d)},loading:c.get("loading")},j(c));case h.SUGG:return b("React").createElement(b("OzAttachmentOverlay.react"),{key:d,onRemove:function(a){return i(c,d)},onEdit:function(a){return f(c,d)}},b("React").createElement(b("MNCommerceAgentItemSuggestionMercuryAttachment.react"),{itemSuggestion:b("OzHelpers").uiSuggestion(c.get("data"))}));case h.QUICK_REPLIES:return b("React").createElement(b("OzQuickRepliesComposer.react"),{attachment:c,onEdit:g,onRemove:function(a){return i(c,d)}});default:return b("React").createElement(b("OzAttachmentOverlay.react"),{key:d},b("React").createElement("span",null,JSON.stringify(c)))}}});function j(a){var c=a.get("ui-blob");if(c&&!b("OzHelpers").isImageType(c.type))return b("React").createElement("p",{className:"_4gpv"},c.name);else{var d=a.get("url")||b("OzHelpers").blobURI(c);return b("React").createElement(b("Image.react"),{className:"_4xee",onClick:function(a){return window.open(d)},src:d})}}e.exports=f}),null);
__d("OzConfirmDialog.react",["cx","joinClasses","MessengerDialog.react","MessengerDialogBody.react","MessengerDialogButton.react","MessengerDialogFooter.react","MessengerDialogHeader.react","OzActions","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){"use strict";var a=this.props,c=a.body,d=a.className,e=a.confirmLabel,f=a.cancelLabel,g=a.header,h=a.onCancel,j=a.onConfirm,k=a.width;a=babelHelpers.objectWithoutProperties(a,["body","className","confirmLabel","cancelLabel","header","onCancel","onConfirm","width"]);return b("React").createElement(b("MessengerDialog.react"),babelHelpers["extends"]({className:b("joinClasses")("_1vdh",d),onToggle:i(h),width:k||500},a),b("React").createElement(b("MessengerDialogHeader.react"),null,g),b("React").createElement(b("MessengerDialogBody.react"),{className:"_1vdi"},c),b("React").createElement(b("MessengerDialogFooter.react"),null,b("React").createElement(b("MessengerDialogButton.react"),{label:f||"Cancel",onClick:i(h),type:"secondary",use:"default"}),b("React").createElement(b("MessengerDialogButton.react"),{className:"autofocus",label:e||"OK",onClick:i(j),ref:"confirm",type:"primary",use:"default"})))};function a(){"use strict";h.apply(this,arguments)}a.propTypes={body:c.node.isRequired,confirmLabel:c.string,cancelLabel:c.string,header:c.string.isRequired,onConfirm:c.func.isRequired,onCancel:c.func,width:c.number};function i(a){return function(c){b("OzActions").hideDialog(),a&&a()}}e.exports=a}),null);
__d("OzEditorStateHelpers",["ContentState","OzHelpers","DraftModifier","EditorState","UnicodeUtils"],(function(a,b,c,d,e,f){__p&&__p();function a(a,c){c=b("ContentState").createFromText(c);a=b("EditorState").push(a,c,"remove-range");a=b("EditorState").forceSelection(a,a.getSelection());return a}function g(a){var b=a.getCurrentContent().getBlockMap();a=a.getSelection().getStartKey();return b.get(a)}function c(a,b){return a.getCurrentContent().getPlainText().indexOf(b)>=0}function d(a){var c=l(a,function(a){var b=a.getSelection();if(b.getStartOffset()===0)return m(a,1);a=g(a).getText().length;return b.merge({anchorOffset:a,focusOffset:0,isBackward:!0})},"backward");return c===a.getCurrentContent()?a:b("EditorState").push(a,c,"remove-range")}function f(a,c){var d=a.getCurrentContent(),e=g(a).getText(),f=a.getSelection().merge({anchorOffset:0,focusOffset:e.length});f=b("DraftModifier").replaceText(d,f,c);b("OzHelpers").debug("[replaceLine]",c,e,f.getPlainText());return f===d?a:b("EditorState").push(a,f,"remove-range")}function h(a,c){var d=a.getCurrentContent();c=b("DraftModifier").insertText(d,d.getSelectionAfter(),c);return c===d?a:b("EditorState").push(a,c,"insert-characters")}function i(a,b){a=g(a).getText();var c=a.length;if(c===0)return!1;b=Math.min(b,c-1);return a[b]}function j(a,c){c=a.getSelection().merge({focusOffset:c,anchorOffset:c});return b("EditorState").forceSelection(a,c)}function k(a,c){__p&&__p();var d=l(a,function(a){var d=a.getSelection(),e=a.getCurrentContent(),f=d.getAnchorKey();d=d.getAnchorOffset();e=e.getBlockForKey(f).getText().slice(d-c,d);return m(a,e?b("UnicodeUtils").strlen(e):1)},"backward");if(d===a.getCurrentContent())return a;d=d.set("selectionBefore",a.getSelection());var e=a.getSelection().isCollapsed()?"backspace-character":"remove-range";return b("EditorState").push(a,d,e)}function l(a,c,d){__p&&__p();var e=a.getSelection(),f=a.getCurrentContent(),g=e;if(e.isCollapsed()){if(d==="forward"){if(a.isSelectionAtEndOfContent())return f}else if(a.isSelectionAtStartOfContent())return f;g=c(a);if(g===e)return f}return b("DraftModifier").removeRange(f,g,d)}function m(a,b){__p&&__p();var c=a.getSelection();a=a.getCurrentContent();var d=c.getStartKey(),e=c.getStartOffset(),f=d,g=0;if(b>e){var h=a.getKeyBefore(d);if(h==null)f=d;else{f=h;d=a.getBlockForKey(h);g=d.getText().length}}else g=e-b;return c.merge({focusKey:f,focusOffset:g,isBackward:!0})}e.exports={append:h,backspaceTimes:k,charAt:i,currentBlock:g,deleteCurrentLine:d,editorStateHas:c,forceCollapsedSelection:j,replaceContentWithText:a,replaceLine:f}}),null);
__d("OzHistory",["invariant","immutable"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("immutable").List,i=b("immutable").OrderedMap,j="oz-history",k=10,l=100;function m(){return i(JSON.parse(localStorage.getItem(j)||"{}")).map(function(a){return h(a)})}function n(a){i.isOrderedMap(a)||g(0);return localStorage.setItem(j,JSON.stringify(a))}function o(a){var b=m();if(b.has(a))return;n(b.set(a,[]).takeLast(k))}function p(a){__p&&__p();var b={},c={items:function(){b.items||(b.items=m().get(a));return b.items},persist:function(d){h.isList(d)||g(0),n(m().set(a,d)),b.items=d,c.resetPos()},resetPos:function(){b.pos=c.items().size},pos:function(){Number.isSafeInteger(b.pos)||c.resetPos();return b.pos},dec:function(){b.pos=Math.max(c.pos()-1,0)},inc:function(){b.pos=Math.min(c.pos()+1,c.items().size)},val:function(){return c.items().get(c.pos())}};return c}function a(a){__p&&__p();o(a);var b=p(a);return{up:function(){b.dec();return b.val()},down:function(){b.inc();return b.val()},push:function(a){var c=b.items();if(!a||c.last()===a)return;b.persist(c.push(a).takeLast(l))}}}e.exports=a}),null);
__d("OzSendLater.react",["cx","OzHelpers","LayerHideOnBlur","MessengerButtonReact.bs","OzDateTimePicker.react","OzImmutablePureRenderMixin","React","Tooltip","XUIContextualDialog.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MessengerButtonReact.bs").jsComponent;a=b("React").PropTypes;c=b("React").createClass({displayName:"OzSendLater",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{numScheduled:a.number.isRequired,onSendLater:a.func.isRequired,onTimeChange:a.func.isRequired,onToggle:a.func.isRequired,shown:a.bool.isRequired,timestamp:a.number,timezone:a.string,disabled:a.bool},render:function(){var a=this.props,c=a.shown,d=a.disabled,e=a.numScheduled,f=a.onSendLater,g=a.onToggle,i=a.timestamp;a=a.timezone;return b("React").createElement("span",{className:"_40yd"},b("React").createElement("button",babelHelpers["extends"]({ref:"btn",disabled:d,onClick:function(a){return g(!0)}},d?b("Tooltip").propsFor("We can not schedule this message; images are not supported yet"):null,{className:"_1-hv _40ye _30yy"}),b("React").createElement("i",{className:"_40yf"}),e?b("React").createElement("div",{className:"_2ism"},e):null),b("React").createElement(b("XUIContextualDialog.react"),{autoFocus:!1,position:"above",contextRef:function(a){return this.refs.btn}.bind(this),className:"_40yg",shown:c,onToggle:g,behaviors:{LayerHideOnBlur:b("LayerHideOnBlur")}},b("React").createElement("div",{className:"_40yg"},b("React").createElement(b("OzDateTimePicker.react"),babelHelpers["extends"]({className:"_40yh",timestamp:i||b("OzHelpers").serverNow(),timezone:a,onChange:this._handleTimeChange},b("OzHelpers").dateRestraints())),b("React").createElement(h,{onClick:f,label:"Send Later",type:"primary"}))))},_handleTimeChange:function(a){this.props.onTimeChange(a)}});e.exports=c}),null);
__d("OzTypingDots.react",["cx","immutable","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("immutable").Range;c=b("React").PropTypes;var j=3;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){"use strict";var a=this.props,c=a.bouncing,d=a.disabled;a=a.onClick;var e=this.props.numDots||j;c="_32p1"+(c&&!d?" _32p2":"")+(d?" _32p3":"")+" _30yy";return b("React").createElement("div",{className:c,onClick:a,role:"presentation"},b("React").createElement("div",{className:"_32p4"},i(0,e).map(function(a){return b("React").createElement(k,{index:a,key:a})})))};function a(){"use strict";h.apply(this,arguments)}a.propTypes={bouncing:c.bool,disabled:c.bool,numDots:c.number,onClick:c.func};function k(a){a=a.index;a=100*a;return b("React").createElement("div",{className:"_32p5",style:{animationDelay:a+"ms"}})}e.exports=a}),null);
__d("OzUpdateDateTime.react",["immutable","OzHelpers","React"],(function(a,b,c,d,e,f){__p&&__p();var g;c=b("immutable").Map;d=b("React").PropTypes;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.componentDidMount=function(){"use strict";var a=setInterval(function(){this.forceUpdate()}.bind(this),6e4);this.setState({timer:a})};a.prototype.componentWillUnmount=function(){"use strict";this.state.timer&&clearInterval(this.state.timer)};a.prototype.render=function(){"use strict";var a=new Date(b("OzHelpers").serverNow()+this.props.timezoneOffset);return b("React").createElement("span",null,a.toLocaleString(this.props.locale,this.props.options.set("timeZone","UTC").toJS()))};function a(){"use strict";g.apply(this,arguments)}a.propTypes={timezoneOffset:d.number.isRequired,locale:d.string.isRequired,options:d.instanceOf(c).isRequired};e.exports=a}),null);
__d("getVisibleValueForContentState",["DraftEntity","emptyFunction"],(function(a,b,c,d,e,f){__p&&__p();function a(a){__p&&__p();a=a.getBlockMap().map(function(a){var c=a.getText(),d="";a.findEntityRanges(b("emptyFunction").thatReturnsTrue,function(e,f){var g=a.getEntityAt(e);if(g===null)d+=c.slice(e,f);else{g=b("DraftEntity").get(g);g.getType()==="EMOTICON"?d+=g.getData().originalEmoticon:g.getType()==="EMOJI"?d+=g.getData().emoji.join(""):d+=c.slice(e,f)}});return d});return a.join("\n")}e.exports=a}),null);
__d("OzComposer.react",["cx","fbt","invariant","Promise","ChatContentSearchButton.react","ChatStickerButton.react","CompositeDraftDecorator","DraftEditor.react","DraftModifier","EditorState","EmoticonsList","EmoticonSpan.react","FileInput.react","immutable","KeyBindingUtil","Keys","MercuryConfig","MessengerContextualDialog.react","OzActions","OzAPI","OzAttachmentCropper.react","OzBubbleEditor.react","OzComposerAI.react","OzComposerAttachments.react","OzConfig","OzConfirmDialog.react","OzConstants","OzEditorStateHelpers","OzHelpers","OzNotify","formatDate","getDefaultKeyBinding","getEntityMatcher","getVisibleValueForContentState","insertEmoticonIntoEditorState","promiseFinally","OzHistory","OzSendLater.react","OzTypingDots.react","OzStores","OzSuggestions","OzUpdateDateTime.react","promiseDone","React","OzWrapper.react","Reflux","SelectionState","Timestamp.react"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j=b("OzHistory")("composer-history"),k=b("immutable").Map,l=b("immutable").OrderedMap,m=b("immutable").List;a=b("React").PropTypes;var n=b("OzComposerAI.react").OzComposerAIList,o=b("OzConstants").ATTS,p=b("OzConstants").TOKENS;c=b("OzStores").ActiveThreadStore;d=b("OzStores").BubbleStore;var q=8*1024*1024,r={CREATE_BUBBLE:"CREATE_BUBBLE",CREATE_REMINDER:"CREATE_REMINDER",CREATE_INTENT:"CREATE_INTENT",CLOSE_INTENT:"CLOSE_INTENT",CLOSE_REMINDER:"CLOSE_REMINDER",ADD_QUICK_REPLIES:"ADD_QUICK_REPLIES"},s=15*60*1e3,t=4*60*1e3;f=b("React").createClass({displayName:"OzComposer",mixins:[b("Reflux").connect(d,"bubbles"),b("Reflux").connect(c,"activeThread"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{thread:a.instanceOf(k).isRequired,merchants:a.instanceOf(k).isRequired,onResize:a.func},contextTypes:{router:a.object.isRequired,uid:a.string.isRequired},getInitialState:function(){return y(this.props.thread)},componentDidMount:function(){this._unlistenComposer=b("OzActions").updateComposer.listen(this._onUpdateComposer),this._unlistenAISelect=b("OzActions").selectAIPick.listen(this._handleAISelect),this._cleanup=function(){this._unlistenComposer(),this._unlistenAISelect()}.bind(this),this._oldHeight=this.refs.root.offsetHeight},UNSAFE_componentWillReceiveProps:function(a){b("OzHelpers").threadID(a.thread)!==b("OzHelpers").threadID(this.props.thread)&&(z(this.tid(),this.state),this.setState(y(a.thread)))},componentDidUpdate:function(a,c){window.setTimeout(function(a){a=this.refs.root&&this.refs.root.offsetHeight;a!==this._oldHeight&&(this.props.onResize&&this.props.onResize());this._oldHeight=a}.bind(this));a=b("OzHelpers").threadID(a.thread);a===this.tid()?A(this.tid(),c,this.state):b("OzAPI").notTyping(a)},componentWillUnmount:function(){z(this.tid(),this.state),this._cleanup(),b("OzAPI").notTyping(this.tid())},getValue:function(){return b("getVisibleValueForContentState")(this.e().getCurrentContent())},focusInput:function(){this.refs.input.focus()},render:function(){return b("React").createElement("div",{ref:"root",className:"_5751 _19ib"},this._renderWidgets(),b("React").createElement("div",{className:"_5754"},this._renderSettings(),b("React").createElement("div",{className:"_19id"},this._renderTextEditor()),this._renderActions()))},_renderTextEditor:function(){return b("React").createElement(b("DraftEditor.react"),{ref:"input",editorState:this.e(),keyBindingFn:this._toKeyCommand,handleKeyCommand:this._handleKeyCommand,handleBeforeInput:this._handleBeforeInput,onChange:this._handleChange,onDownArrow:this._handleDownArrow,onUpArrow:this._handleUpArrow,onTab:this._handleTab,handleReturn:this._handleReturn,onFocus:this._handleFocus,handlePastedFiles:this._handleFiles,handleDroppedFiles:function(a,b){this._handleFiles(b)}.bind(this),placeholder:this.state.sendTyping?h._("Type a message... (\u2318\u21a9 to send)"):h._("Sneakily type a message... (\u2318\u21a9 to exit sneaky mode and send)"),spellCheck:!0,textAlignment:"left"})},_handleFocus:function(){this.setState({isAIOpen:!0})},_onUpdateComposer:function(a){var c=a.text;a=a.files;c&&this._handleChange(b("OzEditorStateHelpers").append(this.e(),c));a&&this._handleFiles(a);this.refs.input.focus()},_validateSend:function(){var a=this.state.attachments;return new(b("Promise"))(function(c,d){var e=[[R(this.e().getCurrentContent()).length>0,"You have not filled in all the missing information."],[a.some(function(a){return a.get("loading")}),"Your attachments are still loading. Please wait and send in a bit"],[E(a)&&!this.getValue().trim()&&!a.find(function(a){return a.get("type")===o.SUGG}),"You need to type a message or create a bubble if you want to send quick replies"],[!b("OzHelpers").isOwner(this.t(),this.context.uid),"You do not own this thread. Assign yourself to send messages"]].find(function(a){var b=a[0];a[1];return b});e?d(e[1]):c()}.bind(this))},_sendWith:function(a,c){__p&&__p();b("promiseDone")(this._validateSend(),function(d){__p&&__p();var e=b("OzHelpers").threadID(this.t()),f=this.getValue().trim(),g=this.state.attachments.groupBy(function(a){return a.get("type")}),h=P(this.t(),this.state),i=g.get(o.IMAGE,m()).map(function(a){return a["delete"]("ui-blob")}).toList();d=F(this.state.attachments);var j=d&&{"generic-metadata":d};d=function(){return f||!i.isEmpty()?a(babelHelpers["extends"]({tid:e,images:i,text:f,aiusage:h},j)):b("Promise").resolve()};var k=function(){return g.get(o.SUGG,m()).reduce(function(a,d){return b("promiseFinally")(a,function(a){return c(babelHelpers["extends"]({tid:e,suggestion:d.get("data"),aiusage:h},j))})},b("Promise").resolve())};b("promiseFinally")(d(),k);b("OzAPI").notifyExtension({action:"discard",id:e});this._toHistory();this.setState(babelHelpers["extends"]({},w(this.t()),{editorState:b("OzEditorStateHelpers").replaceContentWithText(this.e(),""),seedBubble:this.state.seedBubble,isAIOpen:this.state.isAIOpen}))}.bind(this),b("OzNotify").error)},_handleMessageSend:function(){G("send",[H(this.t()),I(this.t(),this.state.activeThread),J(this.getValue().trim())],function(a){return this._sendWith(b("OzAPI").sendMessage,b("OzAPI").suggest)}.bind(this))},_handleSendLater:function(){__p&&__p();var a=this.state.schedule.timestamp;this.setState({sendTyping:!1});if(!a){b("OzNotify").error("You need to pick a time to send later");return}if(a<b("OzHelpers").serverNow()-t){b("OzNotify").error("This time is in the past. Is the timezone correct?");return}G("schedule",[I(this.t(),this.state.activeThread),J(this.getValue().trim())],function(c){this._sendWith(function(c){return b("OzAPI").scheduleMessage(babelHelpers["extends"]({},c,{at:a}))},function(c){return b("OzAPI").scheduleSuggest(babelHelpers["extends"]({},c,{at:a}))}),this.setState({sendTyping:!0})}.bind(this))},_handleReturn:function(a){if(b("OzHelpers").hasCmdOrCtrl(a)){setTimeout(this._handleMessageSend);return!0}return!1},_handleFiles:function(a){__p&&__p();var c=a;if(c.some(function(a){return a.size>=q})){b("OzNotify").error("The file you are trying to add is too large.");return!1}if(!c.length)return!1;a=this.state.attachments.merge(c.map(function(a,b){return[b,k({type:o.IMAGE,"ui-blob":a,loading:!0})]}));this.setState({attachments:a});var d=function(a){return c.reduce(function(a,b,c){return a["delete"](c)},a)};b("promiseDone")(b("Promise").all(c.map(function(a){return b("OzAPI").upload(k({type:a.type,blob:a}))})),function(a){a.every(function(a){return a.get("id")})||i(0),this.setState({attachments:B(d(this.state.attachments),a.map(function(a,b){return a.set("ui-blob",c[b])}))})}.bind(this),function(a){this.setState({attachments:d(this.state.attachments)})}.bind(this));return!0},_nonTextSend:function(a){a=G("send",[H(this.t()),I(this.t(),this.state.activeThread)],a);return this._validateSend().then(a,b("OzNotify").error)},_handleStickerSelect:function(a){this._nonTextSend(function(c){b("OzAPI").sendMessage({tid:b("OzHelpers").threadID(this.t()),"sticker-id":a,aiusage:P(this.t(),this.state)})}.bind(this))},_handleContentSearchSelect:function(a,c){if(a.platformFBID.toString()===b("MercuryConfig").MessengerAppID){this._handleStickerSelect(a.resultID.toString());return}this._nonTextSend(function(c){b("promiseDone")(b("OzAPI").upload(k({type:"image/url","attribution-app-id":a.platformFBID,"image-url":a.source.url})),function(a){return b("OzAPI").sendMessage({tid:b("OzHelpers").threadID(this.t()),images:[a],aiusage:P(this.t(),this.state)})}.bind(this))}.bind(this))},_handleEmoticonSelect:function(a){a=b("EmoticonsList").symbols[a];a&&this._handleChange(b("insertEmoticonIntoEditorState")(a,this.state.editorState))},_handleAttRemove:function(a){this.setState({attachments:this.state.attachments["delete"](a.get("id"))})},_handleBubbleEdit:function(a){this.setState({seedBubble:a})},_handleBubbleEditorSave:function(a){this.setState({seedBubble:null,attachments:B(this.state.attachments,[a])},function(a){return this.refs.input.focus()}.bind(this))},_handleBubbleEditorClose:function(a){var b={seedBubble:null};a=a.get("id");a&&(b.attachments=this.state.attachments["delete"](a));this.setState(b,function(a){return this.refs.input.focus()}.bind(this))},_handleAttachmentCrop:function(a){this.setState({cropAttachment:a})},_handleAttCropperSave:function(a){var b=this.state.attachments["delete"](a.get("id"));this.setState({cropAttachment:null,attachments:b},function(b){this._handleFiles([a.get("ui-blob")]),this.refs.input.focus()}.bind(this))},_handleAttCropperClose:function(a){this.setState({cropAttachment:null},function(a){return this.refs.input.focus()}.bind(this))},_handleQuickRepliesEdit:function(a){this.setState({attachments:B(this.state.attachments,[a])})},_handleTypingDotsClick:function(){this.setState({sendTyping:!this.state.sendTyping})},_renderWidgets:function(){if(this.state.seedBubble)return b("React").createElement(b("OzBubbleEditor.react"),{merchants:this.props.merchants,seedBubble:this.state.seedBubble,onSave:this._handleBubbleEditorSave,onClose:this._handleBubbleEditorClose});return this.state.cropAttachment?b("React").createElement(b("OzAttachmentCropper.react"),{attachment:this.state.cropAttachment,onSave:this._handleAttCropperSave,onClose:this._handleAttCropperClose}):b("React").createElement("div",null,b("React").createElement(n,{filter:this.getValue(),items:this._AIItems(),onItemClick:this._handleAIItemClick}),b("React").createElement(b("OzComposerAttachments.react"),{attachments:this.state.attachments,onRemove:this._handleAttRemove,onBubbleEdit:this._handleBubbleEdit,onAttachmentCrop:this._handleAttachmentCrop,onQuickRepliesEdit:this._handleQuickRepliesEdit}))},_renderSettings:function(){return b("React").createElement("div",{className:"_41s9"},b("React").createElement(b("OzTypingDots.react"),{disabled:!this.state.sendTyping,onClick:this._handleTypingDotsClick}))},_renderActions:function(){return b("React").createElement("div",{className:"_575c"},b("React").createElement(b("ChatStickerButton.react"),{className:"_30yy _1v3y",flyoutAlignment:"right",flyoutClassName:"_293j",onStickerSelect:this._handleStickerSelect,onEmoticonSelect:this._handleEmoticonSelect}),b("React").createElement(b("FileInput.react"),{ref:"fileInput",display:"inline-block",containerClassName:"_30yy _41sr",accept:"*/*",multiple:!0,onChange:function(a){this._handleFiles([].slice.apply(a.target.files)),this.refs.fileInput.getFileInput().clear()}.bind(this)},b("React").createElement("a",{title:"add images",className:"_2e01 _30yy"})),b("React").createElement(b("ChatContentSearchButton.react"),{className:"_yht _30yy _592k",ref:"chatContentSearch",ContextualDialogClass:b("MessengerContextualDialog.react"),flyoutAlignment:"right",flyoutClassName:"_293j",flyoutWidth:285,onStickerSelect:this._handleStickerSelect,getInput:function(){return this.refs.input}.bind(this),getQuery:this.getValue,onSelect:this._handleContentSearchSelect}),b("React").createElement(b("OzSendLater.react"),babelHelpers["extends"]({},this.state.schedule,{numScheduled:this.props.thread.get("events")?this.props.thread.get("events").count():0,onTimeChange:this._handleScheduleTimeChange,onToggle:this._handleScheduleToggle,onSendLater:this._handleSendLater})))},_handleChange:function(a){this.setState({editorState:a})},_handleDownArrow:function(a){if(b("OzHelpers").hasCmdOrCtrl(a)&&this.e().isSelectionAtStartOfContent()){this._fromHistory("down");a.preventDefault();return!0}},_handleUpArrow:function(a){if(b("OzHelpers").hasCmdOrCtrl(a)&&this.e().isSelectionAtStartOfContent()){this._fromHistory("up");a.preventDefault();return!0}},_handleTab:function(a){__p&&__p();var c=T(this.e());if(c){this.setState({editorState:b("EditorState").forceSelection(this.e(),c)});a.preventDefault();return!0}c=N(this._AIItems(),k({line:0,column:0}));if(c){this._handleAISelect(c);a.preventDefault();return!0}},_toKeyCommand:function(a){var c=function(){var c=a.keyCode-b("Keys").ZERO;if(this.state.isAIOpen&&c<=this._AIItems().size)return"SELECT-AI-ITEM-"+(c-1)}.bind(this),d=function(a){return L(a)&&!E(this.state.attachments)&&this.state.config.getIn(["GK","quickReplies"])}.bind(this);return K(a)&&r.CREATE_BUBBLE||d(a)&&r.ADD_QUICK_REPLIES||O(a)&&c()||M(a)&&"PREFERRED-NAME"||b("getDefaultKeyBinding")(a)},_handleKeyCommand:function(a,c){__p&&__p();switch(a){case"SELECT-AI-ITEM-0":case"SELECT-AI-ITEM-1":case"SELECT-AI-ITEM-2":case"SELECT-AI-ITEM-3":case"SELECT-AI-ITEM-4":case"SELECT-AI-ITEM-5":case"SELECT-AI-ITEM-6":case"SELECT-AI-ITEM-7":case"SELECT-AI-ITEM-8":case"SELECT-AI-ITEM-9":this._handleAIItemClick(k({line:+a.slice(-1),column:0}));return!0;case"PREFERRED-NAME":this._handleChange(b("EditorState").push(c,b("DraftModifier").replaceText(c.getCurrentContent(),c.getSelection(),b("OzHelpers").preferredName(this.t()))));return!0;case r.CREATE_BUBBLE:this.setState({seedBubble:C()});return!0;case r.ADD_QUICK_REPLIES:this.setState({attachments:B(this.state.attachments,[D()])});return!0}return!1},_AIItems:function(a){return ca(this.state.isAIOpen,this.props.thread,this.state.attachments,this.state.bubbles,this.props.merchants,this.getValue())},_handleAISelect:function(a){__p&&__p();this.setState({lastAIPick:a,lastAIGuesses:this.t().get("guesses"),sendTyping:U(a)?!1:this.state.sendTyping},function(){__p&&__p();var c=a.get("id");U(a)&&(b("OzAPI").deleteScheduled(b("OzHelpers").threadID(this.t()),c),this._handleScheduleTimeChange({timestamp:a.get("at"),timezone:b("OzHelpers").timezone(this.t())}));switch(a.get("type")){case o.COMMAND:if(!U(a))switch(a.get("action")){case r.CREATE_REMINDER:this._handleCreateReminder(a);break;case r.CLOSE_REMINDER:this._handleCloseReminder(a);break;case r.CREATE_INTENT:this._handleCreateIntent(a);break;case r.CLOSE_INTENT:this._handleCloseIntent(a);break;default:this._handleKeyCommand(a.get("action"))}break;case o.SURVEY:case"send":case o.TEMPLATE:c=a.get("f");c=c&&c()||a.get("ui-body");var d=a.getIn(["data","images"]),e=b("OzEditorStateHelpers").replaceLine(this.e(),c+" "),f=T(e);c&&this._handleChange(f?b("EditorState").forceSelection(e,f):e);d&&this.setState({attachments:B(this.state.attachments,d.toArray())});break;case"suggest":case o.SUGG:this.setState({seedBubble:a});break;case o.OPENTABLEQR:this.setState({attachments:B(this.state.attachments,[k({data:a.get("bubble")["delete"]("thumb-urls"),meta:a.get("meta"),source:"places",type:o.SUGG}),D(a.get("quickreplies"))])});c=b("OzEditorStateHelpers").replaceLine(this.e(),a.get("ui-body"));this._handleChange(c);break}}.bind(this)),this.focusInput()},_handleAIItemClick:function(a){this._handleAISelect(N(this._AIItems(),a))},_handleCreateReminder:function(a){b("OzAPI").createReminder(this.tid(),k({body:a.get("body"),"scheduled-time":a.get("scheduled-time")}))},_handleCloseReminder:function(a){b("OzAPI").closeReminder(this.tid(),a.get("id")||a.get("reminder-id"),!1)},_handleCreateIntent:function(a){b("promiseDone")(b("OzAPI").createIntent(this.tid(),k({"wit-intent-uuid":a.get("wit-intent-uuid"),name:a.get("name"),metadata:a.get("metadata"),params:a.get("params"),actions:a.get("actions"),notes:a.get("notes"),requirements:a.get("requirements")})),function(a){b("OzHelpers").info("[composer/handleCreateIntent] created for:",b("OzHelpers").threadID(a)),this.context.router.push(b("OzHelpers").threadPath({threadid:b("OzHelpers").threadID(a),intentid:a.getIn(["intents",-1,"id"])}))}.bind(this))},_handleCloseIntent:function(a){b("OzAPI").closeIntent(this.tid(),a.get("id"))},_toHistory:function(){var a=this.state.attachments;a=a.filter(function(a){return a.get("type")===o.SUGG});var b=this.getValue();j.push(JSON.stringify({bubbles:a,text:b}))},_fromHistory:function(a){a=b("OzHelpers").safeParse(j[a]());var c=a.bubbles;a=a.text;a&&this._handleChange(b("OzEditorStateHelpers").replaceContentWithText(this.e(),a));c&&this.setState({attachments:l(c).mapEntries(function(a){return b("immutable").fromJS(a)}).mapKeys(function(a){return+a})})},_handleScheduleToggle:function(a){var c=this.state.schedule,d=c.timestamp||b("OzHelpers").serverNow();c.shown===a?null:this.setState({schedule:babelHelpers["extends"]({},c,{shown:a,timestamp:d})})},_handleScheduleTimeChange:function(a){this.setState({schedule:babelHelpers["extends"]({},this.state.schedule,a)})},e:function(){return this.state.editorState},t:function(){return this.props.thread},tid:function(){return b("OzHelpers").threadID(this.t())}});function u(){var a=new(b("CompositeDraftDecorator"))([{strategy:function(a,b){R(a.getText()).map(function(a){return b.apply(undefined,a)})},component:ba},{strategy:b("getEntityMatcher")(function(a){return a.getType()==="EMOTICON"}),component:b("EmoticonSpan.react")}]);return b("EditorState").createEmpty(a)}function v(a){return{shown:!1,timestamp:null,timezone:b("OzHelpers").timezone(a)}}function w(a){return{attachments:l(),editorState:u(),sendTyping:!0,seedBubble:null,isAIOpen:!1,lastAIPick:null,lastAIGuesses:null,schedule:v(a)}}var x={};function y(a){return x[b("OzHelpers").threadID(a)]||w(a)}function z(a,b){b=babelHelpers["extends"]({},b);delete b.bubbles;delete b.activeThread;delete b.config;b.isAIOpen=!1;x[a]=b}function A(a,c,d){__p&&__p();var e=c.editorState.getCurrentContent().getPlainText(),f=d.editorState.getCurrentContent().getPlainText();e!==f&&b("OzHelpers").debug("[composer] changed from",e,f);if(d.sendTyping){e=[e,f].map(function(a){return!!a.length});f=e[0];e=e[1];!f&&e&&b("OzAPI").typing(a);f&&!e&&b("OzAPI").notTyping(a)}c.sendTyping&&!d.sendTyping&&b("OzAPI").notTyping(a)}function B(a,b){l.isOrderedMap(a)||i(0);Array.isArray(b)||i(0);return a.withMutations(function(a){return b.reduce(function(a,b){b=b.set("id",b.get("id")||b.hashCode());return a.set(b.get("id"),b)},a)})}function C(){return b("immutable").fromJS({data:{currency:"USD"},type:o.SUGG})}function D(a){return b("immutable").fromJS({type:o.QUICK_REPLIES,data:a?a.map(function(a){return k({id:a,name:a})}):m()})}function E(a){return a.find(function(a){return a.get("type")===o.QUICK_REPLIES})}function F(a){a=k(E(a)).get("data",m()).map(function(a){return a.get("name","").trim()}).filter(function(a){return!!a});return a.isEmpty()?null:{agent_quick_replies:a.toArray()}}function G(a,c,d){c=m(c).filter(function(a){return!!a});c.isEmpty()?d():b("OzActions").showDialog(b("OzConfirmDialog.react"),{body:c.size===1?c.first():b("React").createElement("ul",null,c.map(function(a,c){return b("React").createElement("li",{key:c},a)})),confirmLabel:b("OzHelpers").toTitleCase(a),header:"Are you sure you want to "+a+" this message?",onConfirm:d})}function H(a){var c=k({hour:"numeric",minute:"numeric"}),d=a.getIn(["location","timezone-offset"]),e=b("OzHelpers").preferredName(a);a=b("OzHelpers").lastPresence(a);if(d&&!b("OzHelpers").isDaytime(d)&&a&&b("OzHelpers").serverNow()-a>s)return b("React").createElement("span",null,"It's\xa0",b("React").createElement("strong",null,b("React").createElement(b("OzUpdateDateTime.react"),{locale:"en-US",options:c,timezoneOffset:d||0})),"\xa0at ",e,"'s last known location and they haven't interacted with us since"," ",b("React").createElement("strong",null,b("React").createElement(b("Timestamp.react"),{autoUpdate:!0,time:a/1e3})),".")}function I(a,b){var c=b.get("activeIntent");b=c&&a.get("intents").find(function(a){return a.get("id")===c});if(!b||b.get("state")!=="open")return"You should create an intent or select an open one so the AI can learn from what you're sending."}function J(a){__p&&__p();var c=m([[/ +/g,function(a){return a.length>1},"a bunch of spaces in a row"],[/^ | $/gm,function(a){return!0},"whitespace at the beginning or end of a line"]]).map(function(b){var c=b[0],d=b[1];b=b[2];return m(a.match(c)).some(d)&&b}).filter(function(a){return!!a});if(!c.isEmpty())return b("React").createElement("div",null,"Your text contains some weird formatting:",b("React").createElement("ul",null,c.map(function(a,c){return b("React").createElement("li",{key:c},a)})))}function K(a){return b("OzHelpers").hasCmdOrCtrl(a)&&a.which===66}function L(a){return b("OzHelpers").hasCmdOrCtrl(a)&&a.which===191}function M(a){return a.getModifierState("Control")&&a.which===78}function N(a,b){a=a.get(b.get("line"));return m.isList(a)?a.get(b.get("column")):a}function O(a){return b("KeyBindingUtil").hasCommandModifier(a)&&a.keyCode>=b("Keys").ZERO+1&&a.keyCode<=b("Keys").ZERO+9}function P(a,c){var d=c.lastAIPick;c=c.lastAIGuesses;c=c||a.get("guesses");var e=b("OzHelpers").openIntents(a).map(function(a){return a.filter(b("OzHelpers").keysIn("name","wit-intent-uuid"))});b("OzHelpers").debug("building ai usage",b("OzHelpers").threadID(a));return k({gold:d,guesses:c,intents:e})}var Q=/(@\[[^\]]+\])/g;function R(a){var b;void 0;var c=[];while(b=Q.exec(a))c.push([b.index,b.index+b[0].length]);return c}function S(a){return"@["+a+"]"}function T(a){a=a.getCurrentContent().getBlockMap().toSeq().map(function(a){return[a,R(a.getText())[0]]}).find(function(a){a[0];a=a[1];return!!a},null,[]);var b=a[0];a=a[1];return b&&a?aa.apply(undefined,[b.getKey()].concat(a)):null}function aa(a,c,d){return new(b("SelectionState"))({anchorKey:a,focusKey:a,anchorOffset:c,focusOffset:d,hasFocus:!0,isBackward:!1})}var ba=b("OzHelpers").pure(function(a){var c=a.offsetKey;a=a.children;return b("React").createElement("span",{"data-offset-key":c,className:"_a5n"},a)});function ca(a,b,c,d,e,f){__p&&__p();var g=ea(b,e,f);b=da(b,g,c,e,d,f);g=b.groupBy(function(a){return a.get("ui-scheduled")?"scheduled":a.get("type")===o.SUGG?o.SUGG:"rest"});c=g.get("rest",m()).push(g.get(o.SUGG)).filter(function(a){return!!a});e=g.get("scheduled",m());if(!a)return e.isEmpty()?m():m().push(e);else if(e.isEmpty())return c;else return c.push(e)}function da(a,b,c,d,e,f){var g=b.filter(function(a){return a.get("type")==o.SUGG}).take(25);b=b.filter(function(a){return a.get("type")!=o.SUGG}).concat(ma(a,f)).take(5);g=g.concat(b);return ja(e,f).takeLast(1).concat(g).concat(ha(c,f)).concat(fa(a,d,f))}function ea(a,c,d){__p&&__p();return(a.get("guesses")||m()).flatMap(function(a){return a.get("items")||[a].map(function(b){return b.merge(k({position:a.get("position"),confidence:a.get("confidence"),"class":a.get("class")}))})}).map(function(e){__p&&__p();switch(e.get("type")){case o.TEMPLATE:var f=Y(a,e.get("body"));return U(e)||$(f,d)?e.set("ui-body",f):null;case"bubble":return U(e)||Z(e.get("data"),d)?b("OzSuggestions").toServer(e,c):null;case"close-intent":return W(a,e);case"create-intent":return V(a,e);case"close-reminder":return X(a,e);case"reminder":f=e.getIn(["body","description"]);var g=e.get("scheduled-time"),h=b("formatDate")(g/1e3,"g:ia M j");return k({type:o.COMMAND,action:r.CREATE_REMINDER,text:"Create Reminder for "+h+': "'+f+'"',iconCl:"_3e_w",body:e.get("body"),"scheduled-time":g})}}).filter(function(a){return!!a})}function U(a){return!!(a.get("id")&&a.get("at"))}function fa(a,c,d){__p&&__p();return(a.get("events")||m()).concat(a.get("scheduled")||m()).toSeq().map(function(d){__p&&__p();switch(d.get("type")){case"send":return d.set("ui-body",d.getIn(["data","text"]));case"suggest":return d.set("type",o.SUGG).set("data",d.getIn(["data","suggestion"])).updateIn(["data","merchant-name"],function(a){return b("OzSuggestions").findMerchantName(a,c)});case"create-intent":return V(a,d.get("data")).set("id",d.get("id"));case"close-intent":return W(a,d.get("data")).set("id",d.get("id"));case"close-reminder":return X(a,d.get("data")).merge({id:d.get("id"),at:d.get("at")});case"create-reminder":return ga(a,d.get("data")).set("id",d.get("id"));case o.SURVEY:case o.TEMPLATE:return d.set("ui-body",Y(a,d.getIn(["data","body"])));case"bubble":return b("OzSuggestions").toServer(d.get("data"),c).setIn(["data","amount"],+d.getIn(["data","data","price"])).set("id",d.get("id"));case"send-calendar":return d.set("type",o.SUGG).set("data",k({name:d.getIn(["data","title"]),description:b("OzHelpers").toLocaleDate(d.getIn(["data","start"])),"merchant-name":"Invite bubble"}));default:b("OzHelpers").debug("[oz-scheduled], unk scheduled",d)}}).filter(function(a){return!!a}).map(function(a){return a.set("ui-scheduled",!0)}).sortBy(function(a){return a.get("at")})}function V(a,b){a=b.get("name");return b.set("type",o.COMMAND).set("action",r.CREATE_INTENT).set("text","Create intent "+a).set("iconCl","_3e_w")}function W(a,b){var c=b.get("id");a=a.get("intents").findLast(function(a){return a.get("id")===c});a=a?a.get("alias")||a.get("name"):b.get("source");return b.set("type",o.COMMAND).set("action",r.CLOSE_INTENT).set("text","Close intent "+a).set("iconCl","_3e_w")}function X(a,b){var c=b.get("id")||b.get("reminder-id");a=a.get("reminders").findLast(function(a){return a.get("id")===c});a=a?a.getIn(["body","description"]):b.get("source");return b.set("type",o.COMMAND).set("action",r.CLOSE_REMINDER).set("text","Close reminder "+a).set("iconCl","_3e_w")}function ga(a,b){a=b.getIn(["body","description"]);return b.set("type",o.COMMAND).set("action",r.CREATE_REMINDER).set("text","Create reminder "+a).set("iconCl","_3e_w")}function ha(a,c){return b("immutable").fromJS([{type:o.COMMAND,action:r.CREATE_BUBBLE,text:"Create Bubble",iconCl:"_3e_w",shortcut:"B"},!E(a)&&ia()]).filter(function(a){return a&&$(a.get("text"),c)})}function ia(){if(b("OzConfig").getInStaticConfig(["GK","quickReplies"]))return{type:o.COMMAND,action:r.ADD_QUICK_REPLIES,text:"Add Quick Replies",iconCl:"_3e_w",shortcut:"/"}}function ja(a,b){var c=a.filter(function(a){return Z(a,b)});return(c.isEmpty()?a:c).toList()}function Y(b,a){return typeof a==="string"?a:a&&a.map(function(a){return typeof a==="string"?a:la(b,a)}).toJS().join("")}function ka(a){var b=a.get("index");return S(a.get("type")+(b?" "+b:""))}function la(a,c){return c.get("type")===p.USER_FIRST_NAME?b("OzHelpers").preferredName(a):ka(c)}function Z(a,b){a=a.get("data",k());return $(a.get("name","")+"\n     "+a.get("description","")+"\n     "+a.get("target-url",""),b)}function $(a,b){return a&&a.toLowerCase().indexOf((b||"").toLowerCase())>-1}function ma(a,c){__p&&__p();var d=function(b){return Y(a,b[Math.floor(b.length*Math.random())])},e="\ud83d\udc64";e=m([Y(a,b("immutable").fromJS([{type:p.USER_FIRST_NAME}])),[e+" Who are you?",function(){return d(["My name is M! I'm your personal assistant in Messenger.","My name is M! I'm your personal assistant. I can help you with things like making reservations, finding the perfect gift or planning your next vacation.","My name is M! I'm your personal assistant in Messenger. I'm here to help you do things better and faster.","My name is M! I'm here to help make your life easier."])}],[e+" What can you do for me?",function(){return d(["I can help you with lots of things, like figuring out where to go to dinner, finding a great gift for someone, or planning your weekend. Just ask!","I can help you with lots of things. Just ask and I'll let you know if it's something I can't do.","In general, I can help you with anything that's not illegal. Just ask and I'll let you know if there's something I can't do."])}],["Sent the wrong info",function(){return"Sorry! It looks like I sent you the wrong info. @[Right info]"}],[e+" How did you pick this?",function(){return"I look at a variety of things and try to find the info that's best for you. Would you like me to send you some other options?"}],[e+" What does M stand for?",function(){return d(["M is just my name! ","Just M!","I'm just M, like Messenger."])}],[e+" Do you have a partnership with X?",function(){return"No, I just try to find the best info for you. Do you want me to send you some other options?"}],["Storing contact info",function(){return d(["Thanks! I'll remember this for next time."])}],["Don't have an opinion",function(){return"I don't have an opinion about that, but...@[point to resources]"}],["Not my area of expertise",function(){return"I'm not a @[lawyer, financial adviser, etc.] so I can't give you @[legal, financial, etc.] advice, but I can do some research for you. "}],[e+" What's your favorite sticker?",function(){return d(["I can't pick a favorite!","They're all great!","I love all of the stickers equally!"])}],["General redirect",function(){return"I'm not really sure how to answer that, but can I help you with something else?"}],["Bugs redirect",function(){return"You can actually report things like this right from Facebook. Here's how: https://www.facebook.com/help/326603310765065/ "}],["Facebook support redirect",function(){return d(["I'm not an expert, so I'd recommend checking out the Help Center: www.facebook.com/help (http://www.facebook.com/)","I'm not an expert in that, so I'd recommend going here: www.facebook.com/help (http://www.facebook.com/)"])}],[e+" What languages do you support?",function(){return"Right now I can only chat in English. Sorry for the inconvenience!"}],["Trolling (abusing M/the agents)",function(){return d(["Is there anything I can help you with?","Unfortunately I won't be able to chat with you if you say things like that."])}],["Generic don't support message",function(){return d(["Unfortunately I can't do that. Is there anything else I can help you with?","Unfortunately I can't help you with that. @[Sorry for the inconvenience.] Is there anything else I can do for you?","Unfortunately I can't support this type of request. Is there anything else I can help you with?"])}],[e+" What are you? Are you human?",function(){return d(["I'm M! I use artificial intelligence, but people help train me to so I'll get better and better over time.","I'm M! I use artificial intelligence, but people help train me."])}],[e+" What gender are you?",function(){return"I don't have a gender. I'm just M."}],[e+" How old are you?",function(){return"I don't have an age. Maybe 42?"}],[e+" Who made you? Where did you come from?",function(){return d(["I was designed by the Messenger Team.","I was created by the Messenger Team."])}],[e+" What do you look like?",function(){return"That's me in the picture next to this message."}],[e+" Can you talk or just type?",function(){return"I can send you messages here in Messenger. "}],[e+" Where do you live?",function(){return"Right here in Messenger."}],[e+" Can you call/message/email my friend?",function(){return"Unfortunately I can't do that. Is there anything else I can help you with?"}],["Medical redirect",function(){return"Unfortunately I can't support this type of request right now. Is there anything else I can help you with?"}],"I'm a little busier than usual right now. I want to give you my full attention, so I'll get back to you as soon as I can. In the meantime, feel free to send me any extra info about your request.","I'm on it!",["You're welcome.",function(){return d(["You're welcome.","You're welcome! Let me know if there's anything else I can help you with.","You're welcome! Let me know if you need anything else.","You're welcome! Let me know if I can help you with anything else."])}],["Anything else",function(){return d(["Let me know if there's anything else I can help you with.","Let me know if I can help with anything else.","Great! Let me know if there's anything else I can help you with.","Let me know if there's anything else I can help you with today."])}],"How does this look?",["I'm on it",function(){return d(["Sure, I'm on it!","I'll look into that for you.","I'll look into that for you!","I'll do some research."])}],"How can I help you today?","How about this?","Is this what you're looking for?","I'll take care of it!","What email should I use for the invite?","Where should I send the invite?","When would you like to dine and how many people will be joining you?",["Save phone number",d(["Would you like me to save your phone number for future requests?","What phone number would you like me to use for the reservation?"])],"Do you have a price range in mind?","Here are some options:"]).map(function(a){return Array.isArray(a)?k({"ui-body":a[0],type:o.TEMPLATE,f:a[1]}):k({"ui-body":a,type:o.TEMPLATE})}).filter(function(a){return $(a.get("ui-body"),c)});return e}e.exports=b("OzWrapper.react")(f)}),null);
__d("OzCheckboxInput.react",["cx","invariant","AbstractCheckboxInput.react","OzImmutablePureRenderMixin","React","joinClasses"],(function(a,b,c,d,e,f,g,h){a=b("React").createClass({displayName:"OzCheckboxInput",mixins:[b("OzImmutablePureRenderMixin")],render:function(){return b("React").createElement(b("AbstractCheckboxInput.react"),babelHelpers["extends"]({},this.props,{className:b("joinClasses")(this.props.className,"_55sg _4k1t"),onChange:this._handleChange}))},_handleChange:function(a){a=a.target;a instanceof HTMLInputElement||h(0);this.props.onChange&&this.props.onChange(a.checked)}});e.exports=a}),null);
__d("OzMessageFeedbackDialog.react",["cx","invariant","ContextualLayerAutoFlip","ContextualLayerUpdateOnScroll","InputLabel.react","OzButton.react","OzCheckboxInput.react","React","StarsInput.react","XUIContextualDialog.react","XUIContextualDialogBody.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;var j=["Poor","Average","Great"];d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$1=function(){var a=this.props.onFollowedPolicyChange;a&&a(!0)}.bind(this),this.$2=function(){var a=this.props.onFollowedPolicyChange;a&&a(!1)}.bind(this),this.$3=function(a){a.target instanceof HTMLTextAreaElement||h(0),this.props.onFeedbackChange(a.target.value)}.bind(this),b}a.prototype.render=function(){return b("React").createElement(b("XUIContextualDialog.react"),{behaviors:{ContextualLayerAutoFlip:b("ContextualLayerAutoFlip"),ContextualLayerUpdateOnScroll:b("ContextualLayerUpdateOnScroll")},contextRef:this.props.contextRef,shown:!0},b("React").createElement(b("XUIContextualDialogBody.react"),{className:"_5dx"},b("React").createElement("div",{className:"_5333"},b("React").createElement("div",{className:"_5334"},b("React").createElement("div",null,b("React").createElement("h3",null,"Tone"),b("React").createElement(b("StarsInput.react"),{count:this.props.toneRating,large:!0,allowMultipleSubmissions:!0,onClick:this.props.onToneRatingChange,starLabels:j}),b("React").createElement("h3",null,"Execution"),b("React").createElement(b("StarsInput.react"),{count:this.props.executionRating,large:!0,allowMultipleSubmissions:!0,onClick:this.props.onExecutionRatingChange,starLabels:j}))),b("React").createElement("div",{className:"_5335"},b("React").createElement("div",null,b("React").createElement("h3",null,"Responsiveness"),b("React").createElement(b("StarsInput.react"),{count:this.props.responsivenessRating,large:!0,allowMultipleSubmissions:!0,onClick:this.props.onResponsivenessRatingChange,starLabels:j}),b("React").createElement("h3",null,"Console"),b("React").createElement(b("StarsInput.react"),{count:this.props.consoleRating,large:!0,allowMultipleSubmissions:!0,onClick:this.props.onConsoleRatingChange,starLabels:j})))),b("React").createElement("div",null,b("React").createElement("h3",null,"Followed Policy"),b("React").createElement("div",null,b("React").createElement(b("InputLabel.react"),{label:"Yes"},b("React").createElement(b("OzCheckboxInput.react"),{checked:this.props.followedPolicy===!0,onChange:this.$1})),b("React").createElement(b("InputLabel.react"),{label:"No"},b("React").createElement(b("OzCheckboxInput.react"),{checked:this.props.followedPolicy===!1,onChange:this.$2}))),b("React").createElement("h3",null,"Message"),b("React").createElement("div",{className:"_5336"},b("React").createElement("textarea",{maxLength:"2500",value:this.props.feedback,onChange:this.$3,placeholder:"Give more details here"}))),b("React").createElement("div",{className:"_5dy"},b("React").createElement(b("OzButton.react"),{onClick:this.props.onClose},"Cancel"),b("React").createElement(b("OzButton.react"),{className:"_5dz",onClick:this.props.onSave,primary:!0},"Save"))))};a.propTypes={contextRef:c.func.isRequired,executionRating:c.oneOf([0,1,2,3]),followedPolicy:c.bool,onClose:c.func,onExecutionRatingChange:c.func,onFollowedPolicyChange:c.func,onResponsivenessRatingChange:c.func,onConsoleRatingChange:c.func,onSave:c.func,onToneRatingChange:c.func,responsivenessRating:c.oneOf([0,1,2,3]),consoleRating:c.oneOf([0,1,2,3]),toneRating:c.oneOf([0,1,2,3])};e.exports=a}),null);
__d("OzMessageFeedback.react",["cx","joinClasses","immutable","ReactLayeredComponentMixin_DEPRECATED","OzMessageFeedbackDialog.react","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("immutable").Map;a=b("React").PropTypes;var j="feedback_dialog",k="no_dialog";c=b("React").createClass({displayName:"OzMessageFeedback",mixins:[b("ReactLayeredComponentMixin_DEPRECATED"),b("OzImmutablePureRenderMixin")],propTypes:{message:a.instanceOf(i).isRequired,onSave:a.func.isRequired},getInitialState:function(){return babelHelpers["extends"]({currentDialog:k},m(this.props.message))},UNSAFE_componentWillReceiveProps:function(a){a.message!==this.props.message&&this.setState(m(a.message))},render:function(){var a=this.state.currentDialog,c=n(this.state);return b("React").createElement("div",{className:"_2bxa _2bxb"+(c?" _2bxc":"")+(a!==k?" _2bxd":"")},b("React").createElement(l,{className:"_2bxf",onClick:function(a){return this.setState({currentDialog:j})}.bind(this),isActive:c||a===j,ref:"flag"}))},renderLayers:function(){switch(this.state.currentDialog){case j:return{contextualDialog:this._renderFeedbackDialog()};default:return null}},_renderFeedbackDialog:function(){return b("React").createElement(b("OzMessageFeedbackDialog.react"),{contextRef:function(){return this.refs.flag}.bind(this),executionRating:this.state.executionRating,followedPolicy:this.state.followedPolicy,onClose:this._handleDialogClose,onExecutionRatingChange:function(a){this.setState({executionRating:a})}.bind(this),onFollowedPolicyChange:function(a){this.setState({followedPolicy:a})}.bind(this),onResponsivenessRatingChange:function(a){this.setState({responsivenessRating:a})}.bind(this),onSave:this._handleFeedbackSave,onToneRatingChange:function(a){this.setState({toneRating:a})}.bind(this),onConsoleRatingChange:function(a){this.setState({consoleRating:a})}.bind(this),responsivenessRating:this.state.responsivenessRating,toneRating:this.state.toneRating,consoleRating:this.state.consoleRating,feedback:this.state.feedback,onFeedbackChange:function(a){this.setState({feedback:a})}.bind(this)})},_handleFeedbackSave:function(){this.props.onSave(i({execution:this.state.executionRating,"followed-policy":this.state.followedPolicy,mid:this.props.message.get("mid"),"offline-threading-id":this.props.message.get("offline-threading-id"),responsiveness:this.state.responsivenessRating,tone:this.state.toneRating,feedback:this.state.feedback,"console-proficiency":this.state.consoleRating})),this._handleDialogClose()},_handleDialogClose:function(){this.setState({currentDialog:k})}});h=babelHelpers.inherits(l,b("React").Component);h&&h.prototype;l.prototype.render=function(){"use strict";var a=this.props,c=a.className,d=a.onClick;a=a.isActive;return b("React").createElement("button",{role:"button",className:b("joinClasses")("_1-hv _2bxi"+(a?" _2bxj":""),c),onClick:d})};function l(){"use strict";h.apply(this,arguments)}function m(a){return{executionRating:a.get("execution"),feedback:a.get("feedback"),followedPolicy:a.get("followed-policy"),responsivenessRating:a.get("responsiveness"),toneRating:a.get("tone"),consoleRating:a.get("console-proficiency")}}function n(a){return!!(a.executionRating||a.followedPolicy!==undefined||a.responsivenessRating||a.toneRating||a.consoleRating)}e.exports=c}),null);
__d("OzMessageQuickReplies.react",["cx","ContextualLayerAutoFlip","ContextualLayerUpdateOnScroll","React","XUICloseButton.react","immutable","XUIContextualDialog.react","XUIContextualDialogBody.react","ReactLayeredComponentMixin_DEPRECATED","OzImmutablePureRenderMixin"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("React").PropTypes;c=b("immutable").Map;var h=b("immutable").List;d=b("React").createClass({displayName:"OzMessageQuickReplies",mixins:[b("ReactLayeredComponentMixin_DEPRECATED"),b("OzImmutablePureRenderMixin")],propTypes:{message:a.instanceOf(c).isRequired},getInitialState:function(){return babelHelpers["extends"]({displayDialog:!1},i(this.props.message))},render:function(){return b("React").createElement("div",{className:"_g8_"},b("React").createElement("button",{className:"_1-hv _g90 _g91",onClick:function(a){return this.setState({displayDialog:!this.state.displayDialog})}.bind(this),ref:"flag"}))},renderLayers:function(){if(this.state.displayDialog)return{contextualDialog:this._renderQRDialog()};else return null},_renderQRDialog:function(){return b("React").createElement(b("XUIContextualDialog.react"),{behaviors:{ContextualLayerAutoFlip:b("ContextualLayerAutoFlip"),ContextualLayerUpdateOnScroll:b("ContextualLayerUpdateOnScroll")},contextRef:function(){return this.refs.flag}.bind(this),shown:!0},b("React").createElement(b("XUIContextualDialogBody.react"),null,b("React").createElement("div",{className:"_g92"},b("React").createElement("div",{className:"_g93"},b("React").createElement("ul",null,this.state.quickReplies.map(function(a){return b("React").createElement("li",{key:a},a)}))),b("React").createElement(b("XUICloseButton.react"),{onClick:function(a){return this.setState({displayDialog:!1})}.bind(this)}))))}});function i(a){return{quickReplies:a.getIn(["generic-metadata","agent_quick_replies"],h())}}e.exports=d}),null);
__d("OzInboxMessage.react",["cx","OzAPI","OzHelpers","immutable","OzActions","OzConfig","OzConstants","OzMessage.react","OzMessageFeedback.react","OzMessageQuickReplies.react","OzImmutablePureRenderMixin","React","Reflux"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("immutable").Map;var h=b("OzConstants").AUTHOR_TYPES;c=b("React").PropTypes;d=b("React").createClass({displayName:"OzInboxMessage",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{authorType:c.oneOf(b("OzHelpers").values(h)),isActive:c.bool.isRequired,message:c.instanceOf(a).isRequired,threadID:c.string.isRequired},render:function(){var a=this.props,c=a.message,d=a.authorType,e=a.threadID;a=a.isActive;var f=!!c.get("author"),g=b("OzConfig").ConfigStore.data.getIn(["GK","displayQR"])&&!!c.getIn(["generic-metadata","agent_quick_replies"]),i=this.state.config;return b("React").createElement("div",{className:"clearfix _4y6j"+(a?" _4qv0":"")+(d===h.TRAINER?" _2ij4":"")+(d===h.BOT?" _2ij5":"")+(d===h.USER?" _2p0":"")+(i.getIn(["GK","supervisor"])?" _1w52":"")},b("React").createElement("div",{className:"_2pf"},b("React").createElement(b("OzMessage.react"),{message:c}),d===h.USER?b("React").createElement("button",{onClick:function(){return b("OzActions").intentCreator.toggle(c.get("mid"))},className:"_1-hv _30yy _4nd4 _ftb"}):null),g?b("React").createElement(b("OzMessageQuickReplies.react"),{message:c}):null,f?b("React").createElement(b("OzMessageFeedback.react"),{message:c,onSave:function(a){return b("OzAPI").updateMessage(e,a)}}):null)}});e.exports=d}),null);
__d("OzInboxMessageGroup.react",["cx","OzHelpers","immutable","OzConfig","OzConstants","OzDate.react","OzInboxMessage.react","OzUserImage.react","OzImmutablePureRenderMixin","React","Reflux","Tooltip"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("immutable").Map;a=b("React").PropTypes;var i=b("OzConstants").AUTHOR_TYPES;c=b("React").createClass({displayName:"OzInboxMessageGroup",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{activeMsgID:a.string,authorID:a.string,authorType:a.oneOf(b("OzHelpers").values(i)),execTime:a.number,intentID:a.number,messages:a.array.isRequired,repNames:a.instanceOf(h).isRequired,thread:a.object.isRequired,timestamp:a.number.isRequired},scrollMessageIntoViewIfNeeded:function(a){var c=this.refs[a];c?c.scrollIntoViewIfNeeded():b("OzHelpers").error("[inboxgroup] message id "+a+" not in group")},render:function(){return b("React").createElement("div",{className:"_528w"},this._renderGroup())},_renderGroup:function(){var a=this.props.authorType,c=i.BOT,d=i.TRAINER,e=i.USER;switch(a){case d:case c:return b("React").createElement("div",{className:(a===c?"_4m3p":"")+(a===d?" _4m3r":"")},this._renderMessages(),this._renderBottomMeta());case e:return b("React").createElement("div",{className:"_4m3u"},b("React").createElement("div",{className:"_2wyu"},this._renderPhoto()),b("React").createElement("div",{className:"_2wyv"},this._renderMessages(),this._renderBottomMeta()));default:b("OzHelpers").error("got unk author type",this.props);return null}},_renderPhoto:function(){var a=b("OzHelpers").photo(this.props.thread),c=b("OzHelpers").getName(this.props.thread),d=b("OzHelpers").lastPresence(this.props.thread);d=b("OzDate.react").formatTimestamp(d);return b("React").createElement("div",{className:"_528y"},b("React").createElement("span",b("Tooltip").propsFor("Seen by "+c+" at "+d,"left"),b("React").createElement(b("OzUserImage.react"),{photo:a})))},_renderSeen:function(){return b("React").createElement("div",{className:"_40ue"},this._renderPhoto())},_renderMessages:function(){var a=this.props,c=a.messages,d=a.authorType,e=a.thread,f=a.activeMsgID;return b("React").createElement("div",{className:"_528z"},c.map(function(a){return b("React").createElement("div",{key:b("OzHelpers").msgID(a),ref:b("OzHelpers").msgID(a)},b("React").createElement(b("OzInboxMessage.react"),{authorType:d,isActive:b("OzHelpers").msgID(a)===f,message:a,threadID:b("OzHelpers").threadID(e)}),a.get("ui-seen")?this._renderSeen():null)}.bind(this)))},_renderBottomMeta:function(){var a=this.props,c=a.authorID,d=a.execTime,e=a.intentID,f=a.repNames,g=a.thread;a=a.timestamp;return b("React").createElement("div",{className:"_4m3v"},b("React").createElement("div",null,b("React").createElement("span",{className:"_4m3w"},f.get(c)||c||null),b("React").createElement(b("OzDate.react"),{className:"_4m3x",timestamp:a})),this.state.config.getIn(["GK","responsivenessExecTime"])&&e!=null&&d!=null&&b("React").createElement("div",{className:"_5sme"},b("React").createElement("span",b("Tooltip").propsFor(j(b("OzHelpers").intentById(g,e)),"below"),"I")," ","+ ",b("OzHelpers").durationStr(d)))}});function j(){var a=arguments.length<=0||arguments[0]===undefined?h():arguments[0],b=a.get("name"),c=a.get("alias");return c&&b?c+" ("+b+")":c||b||"[unknown intent]"}e.exports=c}),null);
__d("OzInboxMessageList.react",["cx","OzHelpers","immutable","OzConstants","OzInboxMessageGroup.react","OzLoading.react","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("immutable").Map;a=b("React").PropTypes;var j=b("OzLoading.react").Inline,k=20;c=babelHelpers.inherits(l,b("React").Component);h=c&&c.prototype;function l(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.scrollToMessage=function(a){return i(this.refs).find(function(c){return c.props.messages.some(function(c){return b("OzHelpers").msgID(c)===a})}).scrollMessageIntoViewIfNeeded(a)}.bind(this),this.$1=function(a,c){c=this.props.thread;var d=a[0],e=a[a.length-1],f=d.get("sender"),g=d.get("author"),h=d.get("timestamp"),i=e.get("timestamp"),j=e.get("intent-id");e=e.get("executional-time");f=f+h;return b("React").createElement(b("OzInboxMessageGroup.react"),{authorID:g,authorType:b("OzHelpers").authorType(d),activeMsgID:this.props.activeMsgID,execTime:e,intentID:j,key:f,messages:a,ref:f,repNames:this.props.repNames,thread:c,timestamp:i})}.bind(this),c}l.prototype.shouldComponentUpdate=function(a,c){"use strict";return!(this.props.activeMsgID===a.activeMsgID&&b("immutable").is(this.props.thread,a.thread)&&b("immutable").is(this.props.repNames,a.repNames)&&b("immutable").is(this.props.messages,a.messages))};l.prototype.render=function(){"use strict";var a=this.props.messages.reduceRight(n.bind(null,this.props.thread),{groupsList:[],nextTimestamp:null}).groupsList.map(this.$1);return b("React").createElement("frag",null,a)};l.propTypes={activeMsgID:a.string,messages:a.instanceOf(i).isRequired,repNames:a.instanceOf(i).isRequired,thread:a.instanceOf(i).isRequired};d=b("React").createClass({displayName:"OzInboxMessageList",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{activeMsgID:a.string,clientLimit:a.number.isRequired,loading:a.bool.isRequired,messages:a.instanceOf(i).isRequired,onScrollTop:a.func.isRequired,repNames:a.instanceOf(i).isRequired,thread:a.instanceOf(i).isRequired},componentDidMount:function(){b("OzHelpers").scrollToBottom(this.refs.scrollable)},UNSAFE_componentWillUpdate:function(){this._wasScrolledToBottom=p(this.refs.scrollable),this._originalScrollHeight=this.refs.scrollable.scrollHeight,this._originalScrollTop=this.refs.scrollable.scrollTop,this._originalActiveMsgID=this._visiblyActiveMsgID()},componentDidUpdate:function(a){var c=this._visiblyActiveMsgID();if(c&&c!==this._originalActiveMsgID)b("OzHelpers").debug("[messagelist] scrolling to active msg id "+c),this.refs.groupList.scrollToMessage(c);else if(this._wasScrolledToBottom||o(a.messages,this.props.messages)||b("OzHelpers").threadID(a.thread)!==b("OzHelpers").threadID(this.props.thread))b("OzHelpers").debug("[messagelist] scrolling bottom"),b("OzHelpers").scrollToBottom(this.refs.scrollable);else{c=this.refs.scrollable.scrollHeight-this._originalScrollHeight+this._originalScrollTop;this.refs.scrollable.scrollTop=c}},resize:function(){this.componentDidUpdate(this.props)},_visibleMessages:function(){var a=this.props,b=a.messages;a=a.clientLimit;return b.takeLast(a)},_visiblyActiveMsgID:function(){var a=this.props.activeMsgID,c=this._visibleMessages();if(c.some(function(c){return b("OzHelpers").msgID(c)===a}))return a;a&&b("OzHelpers").debug("[messagelist] msg "+a+" not visible",c.toJS());return null},render:function(){var a=this.props,c=a.loading,d=a.sending;a=a.thread;return b("React").createElement("div",{onScroll:this._handleScroll,className:"_4fj7",ref:"scrollable"},b("React").createElement(j,{loading:c}),b("React").createElement(l,{activeMsgID:this.props.activeMsgID,thread:a,messages:this._visibleMessages(),ref:"groupList",repNames:this.props.repNames}),b("React").createElement(j,{loading:d}))},_handleScroll:function(){this.refs.scrollable.scrollTop<k&&this.props.onScrollTop()}});function m(a,b,c){var d=a.get("timestamp"),e=function(a){var b=a>=d;a=!c||a<c;return b&&a};b=b.get("last-seen");e(b)&&(a=a.set("ui-seen",!0));return a}function n(a,c,d){var e=c.groupsList;c=c.nextTimestamp;d=m(d,a,c);a=d.get("author");c=d.get("timestamp");var f=b("OzHelpers").authorType(d),g=e[0],h=g&&g[g.length-1],i=h&&h.get("author"),j=h?h.get("timestamp"):Infinity;h=h&&b("OzHelpers").authorType(h);i!==a||j-c>6e4||h!==f?e.unshift([d]):g.unshift(d);return{groupsList:e,nextTimestamp:c}}function o(a,b){a=a.last();b=b.last();return b.get("timestamp")>a.get("timestamp")}function p(a){return a.scrollHeight-a.scrollTop===a.clientHeight}e.exports=d}),null);
__d("OzIntentDropdown.react",["cx","Promise","immutable","OzSearchSource","React","SearchableDropdownInput.contrib","SearchableEntry"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("immutable").Map,j=b("immutable").List;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.UNSAFE_componentWillMount=function(){"use strict";this.$1=new(b("OzSearchSource"))(function(a){a=a.query;return b("Promise").resolve(k(a,this.props.witIntents))}.bind(this))};a.prototype.componentDidMount=function(){"use strict";var a=this.refs.dropdown;a&&a.focusInput()};a.prototype.render=function(){"use strict";var a=this.props,c=a.onSelect;a=a.selected;return b("React").createElement("div",{className:"_5yeg"},b("React").createElement(b("SearchableDropdownInput.contrib"),{ref:"dropdown",listClassName:"_2sg3",searchSource:this.$1,value:a?n(a):null,onSelect:function(a){return c(m(a))},placeholder:"Pick Intent",showSelectedSubtitle:!1}))};function a(){"use strict";h.apply(this,arguments)}a.propTypes={selected:c.instanceOf(i),witIntents:c.instanceOf(i).isRequired,onSelect:c.func.isRequired};function k(a,b){var c=function(a){return a.map(n).toArray()};return!a?c(b.take(10)):c(l(b,a).take(10))}function l(a,b){var c=function(a){return(a||"").toLowerCase().indexOf(b)>=0};a=a.groupBy(function(a){return c(a.get("name"))?"with-name":"other"});return(a.get("with-name")||j()).concat((a.get("other")||j()).filter(function(a){return c(a.get("doc"))}))}function m(a){return i({name:a.getTitle(),doc:a.getSubtitle(),id:a.getUniqueID()})}function n(a){return new(b("SearchableEntry"))({title:a.get("name"),subtitle:a.get("doc"),uniqueID:a.get("id")})}e.exports=a}),null);
__d("OzIntentCreator.react",["cx","immutable","Keys","OzActions","OzAPI","OzDraggable.react","OzHelpers","OzIntentDropdown.react","OzNotify","React","ReactComponentWithPureRenderMixin","Reflux","promiseDone"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("immutable").Record;var h=b("immutable").Map;c=b("React").PropTypes;var i=a({shown:!1,selected:null,mid:null});d=b("Reflux").createStore({init:function(){this.data=i(),this.listenToMany(b("OzActions").intentCreator)},getInitialState:function(){return this.data},onSelect:function(a){this._u(function(b){return b.set("selected",a)})},toggle:function(a){this._u(function(b){return b.update("shown",function(a){return!a}).set("mid",a)})},clear:function(){this._u(function(a){return i()})},_u:function(a){this.data=a(this.data),this.trigger(this.data)}});f=b("React").createClass({displayName:"OzIntentCreator",mixins:[b("Reflux").connect(d,"store"),b("ReactComponentWithPureRenderMixin")],propTypes:{witIntents:c.instanceOf(h).isRequired,thread:c.instanceOf(h).isRequired},contextTypes:{router:c.object.isRequired},componentDidMount:function(){document.addEventListener("keydown",this._handleKBShortcuts),this._unlisten=function(){document.removeEventListener("keydown",this._handleKBShortcuts)}.bind(this)},componentWillUnmount:function(){this._unlisten()},render:function(){if(!this.state.store.get("shown"))return null;var a=this.props.witIntents;return b("React").createElement(b("OzDraggable.react"),{className:"_1l0z"},b("React").createElement("div",{className:"_1l0-"},b("React").createElement("div",{className:"_1l0_"},b("React").createElement("div",{className:"_1l10"},"Intent"),b("React").createElement("div",{className:"_1l11"},b("React").createElement(b("OzIntentDropdown.react"),{witIntents:a.filterNot(l),selected:this._selected(),onSelect:b("OzActions").intentCreator.select}))),b("React").createElement("div",{className:"_1l14"},b("React").createElement(j,{color:"blue",onClick:this._handleSave},"Save"),b("React").createElement(j,{color:"grey",onClick:b("OzActions").intentCreator.clear},"Cancel"))))},_selected:function(){var a=this.state.store.get("selected"),b=this.props.thread.get("intent-diag");return a||k(b,this.props.witIntents)},_handleSave:function(){var a=this._selected(),c=this.props.thread;if(!a){b("OzNotify").error("You need to pick an intent!");return}b("OzActions").intentCreator.clear();b("promiseDone")(b("OzAPI").createIntent(b("OzHelpers").threadID(c),m(a,c.get("intent-diag"),this.state.store.get("mid"))),function(a){this.context.router.push(b("OzHelpers").threadPath({threadid:b("OzHelpers").threadID(a),intentid:a.getIn(["intents",-1,"id"])}))}.bind(this))},_handleKBShortcuts:function(a){var c=this.state.store.get("shown");(n(a)||a.which===b("Keys").ESC&&c)&&(a.preventDefault(),b("OzActions").intentCreator.toggle())}});var j=b("OzHelpers").pure(function(a){var c=a.color,d=a.children;a=a.onClick;return b("React").createElement("button",{onClick:a,className:"_1-hv _1l1b"+(c==="blue"?" _1l1x":"")+(c==="grey"?" _1l1y":"")},d)});function k(a,b){if(!a)return null;b=b.get(a.get("wit-intent-uuid"));return!b||l(b)?null:b}function l(a){return a.get("name").match(/^dialog_/)}function m(a,b,c){a=h({name:a.get("name"),"wit-intent-uuid":a.get("id"),mid:c});return b&&a.get("wit-intent-uuid")===b.get("wit-intent-uuid")?a.merge(b):a}function n(a){return a.getModifierState("Control")&&a.which==b("Keys").SPACE}e.exports=f}),null);
__d("OzInboxShow.react",["cx","Promise","immutable","OzActions","OzAPI","OzButton.react","OzComposer.react","OzConfig","OzConfirmDialog.react","OzConstants","OzHelpers","OzImmutablePureRenderMixin","OzInboxMessageList.react","OzIntentCreator.react","OzNotify","OzStores","OzStrings","OzThreadLabels.react","OzUpdateDateTime.react","React","Reflux","Tooltip","promiseDone","promiseFinally","relativeTimeString.atlas"],(function(a,b,c,d,e,f,g){__p&&__p();b("immutable").List;var h=b("immutable").Map;a=b("React").PropTypes;var i=b("OzConstants").AUTHOR_TYPES;c=b("OzStores").PendingMessageStateStore;var j=b("OzThreadLabels.react").OzLabelList;d=b("OzConfig").ConfigStore;var k=b("Reflux").createAction();f=b("Reflux").createStore({init:function(){this._data=h(),this.listenTo(k,this._onUpdateFetchState)},getInitialState:function(){return this._data},_onUpdateFetchState:function(a,b){this._data=this._data.update(a,function(a){return(a||h()).merge(b)}),this.trigger(this._data)}});var l="NO_OWNER",m=25,n=25,o=100,p=1e4;g=b("React").createClass({displayName:"OzInboxShow",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(f,"fetchStates"),b("Reflux").connect(c,"pendingMessageState"),b("Reflux").connect(d,"config")],contextTypes:{uid:a.string.isRequired,router:a.object.isRequired},getInitialState:function(){return s()},componentDidMount:function(){this._init(this.props);var a=b("OzActions").scrollThreadToTimestamp.listen(this._scrollToTimestamp);this._unlisten=function(){a()}},UNSAFE_componentWillReceiveProps:function(a){b("OzHelpers").threadID(a.thread)!==b("OzHelpers").threadID(this.props.thread)&&(b("OzHelpers").debug("[inboxshow] thread changed"),this._init(a)),b("OzHelpers").isUnread(a.thread)&&b("OzHelpers").isOwner(a.thread,this.context.uid)&&b("OzAPI").markRead(b("OzHelpers").threadID(a.thread))},_init:function(a){this.setState(s(),function(b){!a.thread.get("light-thread")&&q(a.thread).size<m&&this._fetchMessages()}.bind(this))},componentWillUnmount:function(){this._unlisten()},render:function(){__p&&__p();var a=this.state,c=a.fetchStates,d=a.pendingMessageState,e=a.clientLimit;a=a.activeMsgID;var f=this.props,g=f.reps,h=f.thread,i=f.merchants;f=f.witIntents;var j=q(h),k=b("OzHelpers").threadID(h);d=d.get(k,0)>0;var l=g.map(function(a){return a.get("name")});a&&b("OzHelpers").debug("[inboxshow] Rendering with active msg id "+a);g={humans:this.props.humans,onOwnerChange:this._handleOwnerChange,repNames:l,reps:g,requirements:this.props.requirements,thread:h,witIntents:this.props.witIntents};return b("React").createElement("div",{className:"_1x8x"+(b("OzHelpers").hasTag(h,"employee")?" _1yyg":"")+(b("OzHelpers").hasEngage(h)?" _1fi":"")},b("React").createElement(b("OzIntentCreator.react"),{thread:h,witIntents:f}),b("React").createElement("div",{className:"_1x8y"},this._renderHistoryHeader(),b("React").createElement("div",{className:"_1x96"},b("React").createElement(b("OzInboxMessageList.react"),{activeMsgID:a,clientLimit:e,loading:!!c.getIn([k,"loading"]),onScrollTop:this._fetchMessages,messages:j,ref:"messageList",repNames:l,sending:d,thread:h})),b("React").createElement("div",{className:"_237y"},b("React").createElement(b("OzComposer.react"),{merchants:i,onResize:this._handleResize,thread:h}))),b("React").cloneElement(this.props.children,g))},_scrollToTimestamp:function(a){__p&&__p();var c=b("OzHelpers").threadID(this.props.thread);b("OzHelpers").debug("[inboxshow] received request to scroll to ts "+a);this.setState({activeMsgID:null});b("promiseDone")(this._backloadHistoryUntil(c,a)["catch"](function(c){return b("OzActions").doneScrollingToTimestamp(a,!0)}).then(function(d){__p&&__p();b("OzActions").doneScrollingToTimestamp(a);if(b("OzHelpers").threadID(this.props.thread)!==c)b("OzHelpers").debug("[inboxshow] aborting scroll because thread changed");else{this.setState({clientLimit:this.state.clientLimit+d.size});d=d.isEmpty()?q(this.props.thread):d;d=b("OzHelpers").msgID(d.filter(function(a){return b("OzHelpers").authorType(a)===i.USER}).findLast(function(b){return b.get("timestamp")<=a}));this._activateAndScrollToMsg(d)}}.bind(this)))},_backloadHistoryUntil:function(a,c){__p&&__p();var d=function d(e,f){__p&&__p();return b("OzAPI").history(a,e,o).then(function(a){var g=r(a,e);if(g===e||a.isEmpty())throw g;var h=f.merge(a);b("OzHelpers").debug("[inboxshow] got "+h.size+"; dt="+(g-c));var j=a.filter(function(a){return b("OzHelpers").authorType(a)===i.USER});return j.some(function(a){return a.get("timestamp")<=c})?h:d(g,f.merge(a))})},e=this.state.fetchStates.getIn([a,"timestamp"]),f=this._unseenButLoadedMessages(),g=q(this.props.thread).filter(function(a){return b("OzHelpers").authorType(a)===i.USER}).some(function(a){return a.get("timestamp")<=c});if(g){b("OzHelpers").debug("[inboxshow] desired timestamp "+c+" already loaded");return new(b("Promise"))(function(a){return a(f)})}b("OzHelpers").debug("[inboxshow] backloading to ts "+c+" from "+e);return this._withFetchState(a,e,d(e,h())).then(function(a){return a.merge(f).sortBy(function(a){return a.get("timestamp")})})},_activateAndScrollToMsg:function(a){this.setState({activeMsgID:a},function(c){window.setTimeout(function(){this.state.activeMsgID===a&&(b("OzHelpers").debug("[inboxshow] CLEARING ACTIVE MSG ID"),this.setState({activeMsgID:null}))}.bind(this),p)}.bind(this))},_withFetchState:function(a,c,d){__p&&__p();var e=this.state.fetchStates.get(a,h());if(e.get("loading")||e.get("fetchedAll")){b("OzHelpers").debug("[inboxshow] already loading or at beginning of time");return new(b("Promise"))(function(a){return a()})}b("OzHelpers").debug("[inboxshow] performing load");k(a,h({loading:!0}));return b("promiseFinally")(d,function(b){return k(a,h({loading:!1}))}).then(function(d){var e=r(d,c||Infinity);b("OzHelpers").debug("[inboxshow] loaded "+d.size+"; ts="+e);k(a,h({fetchedAll:d.isEmpty()||e===c,timestamp:e}));return d})},_unseenButLoadedMessages:function(){return q(this.props.thread).skipLast(this.state.clientLimit)},_fetchMessages:function(){var a=b("OzHelpers").threadID(this.props.thread),c=this.state.fetchStates.getIn([a,"timestamp"]);this.setState({clientLimit:this.state.clientLimit+m});if(!this._unseenButLoadedMessages().isEmpty()){b("OzHelpers").debug("[inboxshow] using client cache instead of fetch");return}b("promiseDone")(this._withFetchState(a,c,b("OzAPI").history(a,c,n)))},_handleGrab:function(){b("OzAPI").grab(b("OzHelpers").threadID(this.props.thread))},_handleResize:function(){this.refs.messageList.resize()},_handleOwnerChange:function(a){__p&&__p();a=a.value;if(a&&a!==l){var c=this.props.reps.get(a),d=this.props.thread,e=b("OzHelpers").threadID(d);if(!b("OzHelpers").hasOpenIntents(d)){var f="You must create an intent first";b("OzNotify").warn(f)}else{c.get("is-coach")&&!b("OzHelpers").isEscalated(d)?b("OzAPI").escalateTo(e,a):b("OzAPI").assignTo(e,a);if(!c.get("is-coach")&&b("OzHelpers").isEscalated(d)){f='Please remove the "Escalated" tag to prevent the thread from getting reassigned to a coach';b("OzNotify").warn(f)}}}},_renderHistoryHeader:function(){var a=this.props.thread,c=b("OzHelpers").threadID(a),d=b("OzHelpers").hasTag(a,"employee")||b("OzHelpers").hasEngage(a)?"light":"dark",e=function(a,c){return b("React").createElement(b("OzButton.react"),{onClick:c},a)},f=function(c){return function(d){b("OzHelpers").isOwner(a,this.context.uid)?c():b("OzActions").showDialog(b("OzConfirmDialog.react"),{onConfirm:c,body:"You don't own this thread. If you proceed, the user may be forgotten until they message us again.",header:"Are you sure this user doesn't need to be engaged?"})}.bind(this)}.bind(this),g=b("OzHelpers").locationLastSeen(a),i=h({hour:"numeric",minute:"numeric"}),k=(b("OzHelpers").timezone(a)||"location unknown").replace(/_/g," ");return b("React").createElement("div",{className:"_1q4l"},b("React").createElement("div",{className:"_4l-w"},b("React").createElement("h2",{className:"_1q4m"},b("OzHelpers").getName(a)),b("React").createElement("div",{className:"_29x1"},a.getIn(["location","timezone"])?b("React").createElement("span",b("Tooltip").propsFor("at the user's last known location, updated "+b("relativeTimeString.atlas")(+g,!0),"below"),b("React").createElement(b("OzUpdateDateTime.react"),{locale:"en-US",options:i,timezoneOffset:a.getIn(["location","timezone-offset"],0)})," ("+k+")"):b("React").createElement("span",null,"(location unknown)"))),b("React").createElement("div",{className:"_1q4n"},b("React").createElement(j,{className:"_1q4o",thread:a,shade:d,removable:!0,addable:!0}),b("React").createElement("div",{className:"_1q4p"},b("OzHelpers").hasEngage(a)&&e("No need to engage",f(function(a){return b("OzAPI").notready(c)})))))}});var q=b("OzHelpers").memoize(function(a){return a.get("messages").sortBy(function(a){return a.get("timestamp")})},function(a){return a.get("messages").hashCode()});function r(a,b){return a.map(function(a){return a.get("timestamp")}).reduce(function(a,b){return Math.min(a,b)},b)}function s(){return{activeMsgID:null,clientLimit:m}}e.exports=g}),null);
__d("OzMerchantStatus.react",["cx","immutable","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("immutable").Map;d=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){"use strict";var a=this.props.merchant,c=a.get("approved");a=a.get("blacklisted");return b("React").createElement("i",{className:"_4wc0"+(c?" _4wbz":"")+(a?" _4wb-":""),title:c&&"approved"||a&&"blacklisted"})};function a(){"use strict";h.apply(this,arguments)}a.propTypes={merchant:d.instanceOf(c).isRequired};e.exports=a}),null);
__d("OzMerchantRow.react",["cx","OzAPI","OzHelpers","immutable","Layout.react","LeftRight.react","MessengerDialogHeader.react","MessengerDialogTitle.react","OzActions","OzButton.react","OzMerchantDialog.react","OzMerchantStatus.react","OzImmutablePureRenderMixin","React","SUIAtlasTheme","SUINotice.react","XUIDialog.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("immutable").Map,i=b("Layout.react").Column,j=b("Layout.react").FillColumn;a=b("React").PropTypes;var k=b("React").createClass({displayName:"DeleteMerchantDialog",propTypes:{merchant:a.object.isRequired,onConfirm:a.func.isRequired},render:function(){return b("React").createElement(b("XUIDialog.react"),{width:544,shown:!0,layerHideOnBlur:!1,className:"_4ebx"},b("React").createElement("div",{className:"_4eby _2c9g"},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogTitle.react"),null,'Delete merchant "'+this.props.merchant.get("name-dba")+'"?')),b("React").createElement(b("SUINotice.react"),{theme:b("SUIAtlasTheme"),type:"error"},b("React").createElement("div",{className:"_4wby"},"This action is irreversible. Are you sure?"),b("React").createElement(b("LeftRight.react"),null,b("React").createElement(b("OzButton.react"),{onClick:b("OzActions").hideDialog},"Cancel"),b("React").createElement(b("OzButton.react"),{onClick:this.props.onConfirm},"Yes, permanently delete this merchant")))))},_handleToggle:function(a){b("OzHelpers").debug("[merchantdialog] toggle",arguments),a||b("OzActions").hideDialog()}});c=b("React").createClass({displayName:"OzMerchantRow",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{merchant:a.instanceOf(h).isRequired},render:function(){var a=this.props.merchant,c=a.get("website"),d=function(a){return"$"+(a?(a/100).toFixed(2):0)},e=function(a){return a||0};return b("React").createElement(b("Layout.react"),{className:"_59hd"},b("React").createElement(i,{className:"mrm _728"},b("React").createElement(b("OzMerchantStatus.react"),{merchant:a})),this._renderMerchantInfo("name-dba"),this._renderMerchantInfo("name-legal"),this._renderMerchantInfo("phone"),this._renderMerchantInfo("cumulative-transaction-amount",d),this._renderMerchantInfo("cumulative-transaction-count",e),b("React").createElement(j,{className:"mrm _4wc2 _4wc3"},b("React").createElement("a",{target:"_blank",href:c},c)),this._renderActions())},_renderMerchantInfo:function(a,c){var d=this.props.merchant;d=d.get(a);c&&(d=c(d));return b("React").createElement(i,{className:"mrm _4wc2 _72a"},d)},_renderActions:function(){var a=this._getActions();if(!a)return null;a=a.map(function(a){var c=a.f;a=a.body;return b("React").createElement(b("OzButton.react"),{key:a,onClick:c},a)});return b("React").createElement(i,{className:"mrm _6w4"},a)},_getActions:function(){var a=[],b=this.props.merchant;a.push({body:"Edit",f:this._handleMerchantEdit()});a.push({body:"Delete",f:this._handleMerchantDelete()});b.get("blacklisted")===!0?a.push({body:"Whitelist",f:this._handleMerchantBlacklist(!1)}):a.push({body:"Blacklist",f:this._handleMerchantBlacklist(!0)});return a},_handleMerchantEdit:function(){return function(a,c){a=this.props.merchant;b("OzActions").showDialog(b("OzMerchantDialog.react"),{initialMerchant:a,title:"Edit merchant "+a.get("name-dba"),onMerchant:function(a){b("OzAPI").editMerchant(a),b("OzActions").hideDialog()}});c()}.bind(this)},_handleMerchantBlacklist:function(a){return function(c,d){c=this.props.merchant;b("OzAPI").editMerchant(h({id:c.get("id"),blacklisted:a}));d()}.bind(this)},_handleMerchantDelete:function(){return function(a,c){var d=this.props.merchant;b("OzActions").showDialog(k,{merchant:this.props.merchant,onConfirm:function(){b("OzAPI").deleteMerchant(h({id:d.get("id")})).then(b("OzActions").hideDialog)}});c()}.bind(this)}});e.exports=c}),null);
__d("OzMerchants.react",["cx","OzAPI","immutable","Layout.react","MessengerFlexScrollableArea.react","OzActions","OzButton.react","OzMerchantDialog.react","OzMerchantRow.react","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("Layout.react").Column,j=b("Layout.react").FillColumn;b("immutable").Map;b("React").PropTypes;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={slice:25},this.$4=function(){b("OzActions").showDialog(b("OzMerchantDialog.react"),{onMerchant:function(a){b("OzAPI").createMerchant(a),b("OzActions").hideDialog()}})},this.$2=function(){return b("React").createElement(b("Layout.react"),{className:"_726"},b("React").createElement(i,{className:"mrm _727 _728"},"Status"),this.$5("Name"),this.$5("Legal Name"),this.$5("Phone"),this.$5("Transaction total"),this.$5("Transaction count"),b("React").createElement(j,{className:"mrm _727"},"Website"),b("React").createElement(i,{className:"mrm _729"},b("React").createElement(b("OzButton.react"),{onClick:this.$4},"New merchant")))}.bind(this),this.$5=function(a){return b("React").createElement(i,{className:"mrm _727 _72a"},a)},this.$3=function(){var a=this.props.merchants.sortBy(function(a){return a.get("name-dba","").toLowerCase()}).toSeq().take(this.state.slice).map(function(a){return b("React").createElement(b("OzMerchantRow.react"),{key:a.get("name-dba"),merchant:a})}).valueSeq();return b("React").createElement(b("MessengerFlexScrollableArea.react"),{className:"_72b",onScroll:this.$6,ref:"scrollable"},a)}.bind(this),this.$1=function(){return b("React").createElement("div",null,"No merchants to show")},this.$6=function(){this.refs.scrollable.isScrolledToBottom()&&this.setState(function(a){return{slice:a.slice+25}})}.bind(this),c}a.prototype.render=function(){"use strict";return this.props.merchants.isEmpty()?this.$1():b("React").createElement(b("Layout.react"),null,b("React").createElement(j,null,this.$2(),this.$3()))};e.exports=a}),null);
__d("OzPerformance",["OzHelpers","OzStores","immutable","OzAPI","OzAJAX","OzReactMetrics"],(function(a,b,c,d,e,f){__p&&__p();var g=b("immutable").Map,h=1e3*60,i=function(){if(!window.performance||!window.performance.memory)return g({});var a=window.performance.memory,b=a.totalJSHeapSize;a=a.usedJSHeapSize;var c=Math.round(100*a/b);return g({totalHeap:b,usedHeap:a,percent:c})},j=function(){var a=Object.keys(b("OzStores")).map(function(a){return b("OzStores")[a]});a=a.map(function(a){return a.metrics&&a.metrics()});return a.reduce(function(a,b){return a.merge(b)},g())},k=function(){var a=b("OzAPI").metrics,c=a.getIn(["realtime","updated-thread-fetch-thread"],0),d=a.getIn(["realtime","updated-thread"],1);c=Math.round(100*c/d);d=a.getIn(["realtime","thread-metrics-update-thread"],0);var e=a.getIn(["realtime","thread-metrics"],1);d=Math.round(100*d/e);return a.setIn(["realtime","percent-fetched"],c).setIn(["realtime","percent-metrics-stored"],d)},l=function(){b("OzHelpers").info("[perf]",{memory:i().toJS(),stores:j().toJS(),api:k().toJS(),react:b("OzReactMetrics").metrics,ajax:b("OzAJAX").metrics})},m;a=function(){m=window.setInterval(l,h)};e.exports={init:a,timer:m}}),null);
__d("ozFormatTime",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=3600,h=60;function a(a){__p&&__p();var b=Math.floor(a/g);a%=g;var c=Math.floor(a/h);a%=h;a=Math.round(a);var d="";b&&(d+=b+"h ");c&&(d+=c+"m ");a&&(d+=a+"s");return d}e.exports=a}),null);
__d("OzEventShow.react",["cx","OzAPI","OzHelpers","immutable","OzActions","OzDate.react","ozFormatTime","OzImmutablePureRenderMixin","React","ShimButton.react"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("immutable").Map;c=b("React").PropTypes;d=b("React").createClass({displayName:"OzEventShow",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{activeIntent:c.instanceOf(a).isRequired,event:c.instanceOf(a).isRequired},render:function(){var event=this.props.event;switch(event.get("type")){case"send-email":case"receive-email":return b("React").createElement(i,{event:event,onEmailView:this._handleEmailView,onEmailReply:this._handleEmailReply});case"send-calendar":return b("React").createElement(h,{invite:event.get("data")});case"completed-call":return b("React").createElement(j,{event:event,onCallPlay:this._handleCallPlay,onCallBack:this._handleCallBack});default:return b("React").createElement("div",null,"'Not supported yet'")}},_handleEmailView:function(a){b("OzActions").emailComposer.add(babelHelpers["extends"]({},b("OzHelpers").eventToEmail(a),{disabled:!0}))},_handleEmailReply:function(a){b("OzActions").emailComposer.add(b("OzHelpers").eventToEmail(b("OzHelpers").reEmail(a)))},_handleCallPlay:function(a){return b("OzAPI").everstoreURI(a).then(function(a){return window.open(a)})},_handleCallBack:function(a){b("OzActions").twilio.changeTo(a.getIn(["data","remote-phone"])),b("OzActions").twilio.useIntent(this.props.activeIntent)}});var h=b("OzHelpers").pure(function(a){a=a.invite;return b("React").createElement("div",{className:"_1h7p"},b("React").createElement("div",{className:"_1h7q"}),b("React").createElement("div",{className:"_1h7v _p44"},b("React").createElement("span",{className:"_1h7r"},a.get("title"))),b("React").createElement(k,{label:"Location",row:a.get("location")||"n/a"}),b("React").createElement(k,{label:"Start",row:b("React").createElement(b("OzDate.react"),{timestamp:a.get("start")})}),b("React").createElement(k,{label:"End",row:b("React").createElement(b("OzDate.react"),{timestamp:a.get("end")})}))},"Invite"),i=b("OzHelpers").pure(function(a){var event=a.event,c=a.onEmailView,d=a.onEmailReply,e=event.get("type")==="send-email";a=event.get("data");var f="Email "+(e?"to "+a.get("to").join(", "):"from "+a.get("from"));return b("React").createElement("div",{className:"_1h7p"},b("React").createElement("div",{className:"_1h7q"}),b("React").createElement("div",{className:"_1h7v _p44"},b("React").createElement("span",{className:"_1h7r"},f)),b("React").createElement(k,{label:"Subject",row:a.get("subject","[No subject]")}),b("OzHelpers").nonempty(a.get("cc"))?b("React").createElement(k,{label:"C.C.",row:a.get("cc").join(", ")}):null,b("OzHelpers").nonempty(a.get("bcc"))?b("React").createElement(k,{label:"B.C.C.",row:a.get("bcc").join(", ")}):null,b("React").createElement(k,{label:"Sent",row:b("React").createElement(b("OzDate.react"),{timestamp:a.get("sent-at")})}),b("React").createElement(l,{actions:b("immutable").fromJS([["View",function(a){c(e?event:b("OzHelpers").switchRecip(event))}],["Reply",function(a){d(e?event:b("OzHelpers").switchRecip(event))}]])}))},"Email"),j=b("OzHelpers").pure(function(a){var event=a.event,c=a.onCallPlay,d=a.onCallBack;a=event.get("data");var e={"in":"Call from ",out:"Call to ",voicemail:"Voicemail from "}[a.get("direction")],f=b("OzHelpers").parsePhoneNumber(a.get("remote-phone")),g=a.get("RecordingDuration"),h=a.get("recording-ev-handle");a=h?[["Call Back",function(a){return d(event)}],["Play Voicemail",function(a){return c(h)}]]:[["Call Back",function(a){return d(event)}]];return b("React").createElement("div",{className:"_1h7p"},b("React").createElement("div",{className:"_1h7q"}),b("React").createElement("div",{className:"_1h7v _p44"},b("React").createElement("span",{className:"_1h7r"},e+f)),b("React").createElement(k,{label:"Date",row:b("React").createElement(b("OzDate.react"),{timestamp:event.get("timestamp")})}),b("React").createElement(k,{label:"Duration",row:b("ozFormatTime")(g)}),b("React").createElement(l,{actions:b("immutable").fromJS(a)}))},"Call"),k=b("OzHelpers").pure(function(a){var c=a.label;a=a.row;return b("React").createElement("div",{className:"_1h7v"},b("React").createElement("div",{className:"_1h7w"},c),b("React").createElement("div",{className:"_1h7y"},a))},"Row"),l=b("OzHelpers").pure(function(a){a=a.actions;return b("React").createElement("div",{className:"_1h7t"},a.map(function(a){return b("React").createElement(b("ShimButton.react"),{className:"_47yc",key:a.first(),onClick:a.last()},a.first())}))},"ActionRow");e.exports=d}),null);
__d("OzFeedbackCloseDialog.react",["cx","invariant","ix","OzHelpers","relativeTimeString.atlas","Image.react","immutable","MessengerDialog.react","MessengerDialogHeader.react","MessengerDialogTitle.react","OzActions","OzBubblePreview.react","OzConfig","OzDate.react","OzFormPreview.react","React","ReactDOM","Reflux","TextAreaWithLineLimit.react","XUIButton.react","XUIRadioButtonGroup.react","XUISingleSelector.react"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();a=b("React").PropTypes;c=b("immutable").List;var j=b("immutable").Map;d=b("immutable").OrderedMap;var k=b("immutable").Set,l=b("OzFormPreview.react").Row,m="fulfilled",n="unfulfilled",o="deleted",p="completed",q="out-of-scope",r="not-completed-user-cancel",s="not-completed-user-wish-na",t="not-completed-other",u="delete-irrelevant",v="good",w="no-need",x="opportunity",y=d((f={},f[p]="Request Successfully Completed",f[q]="Request Out of Scope",f[r]="Request Not Completed: User Changed Their Mind",f[s]="Request Not Completed: User Wish N/A",f[t]="Request Not Completed: Other Reason",f[u]="Delete: Irrelevant Intent",f)),z=d({"POL-LEGAL-FINANCIAL-MEDICAL":"1- Provide legal, financial, medical, or professional advice or services","POL-INSURANCE":"2- Purchase insurance or provide quotes","POL-PERSONAL-ACCOUNTS":"3- Access personal accounts that require logins","POL-CREATIVE-CONTENT":"4- Develop creative content","POL-AUTHENTICATE":"5- Authenticate goods or services","POL-NEGOTIATE":"6- Negotiate pricing or trade of products or services","POL-FB-VIOLATION":"7- Activity violating FB's Statement of Rights and Responsibilities","POL-TOBACCO-FIREARMS-ADULT":"8- Action violating FB/3rd party terms: tobacco, firearms, adult products/services, etc","POL-FOREIGN-PURCHASE":"9- Facilitate foreign purchases","POL-DONATION":"10- Make donations or contributions in a customer's name","POL-MEDICAL-SEARCH-APPOINTMENT":"11- Search for medical products or make medical appointments","POL-TRAVEL-UNDERAGED-SOLO":"12- Book travel for persons under the age of 18 unless purchased by a user who is the parent or legal guardian"}),A=j({flight_request:"Did you book the flight?",restaurant:"Did you book the restaurant?",restaurant_bar:"Did you book the restaurant?",ticket_purchase:"Did you buy the ticket?",movie_concert_show:"Did you buy the ticket?"}),B="Objective_None",C=j({restaurant:"M has finished working on your restaurant request.",restaurant_bar:"M has finished working on your restaurant request.",ticket_purchase:"M has finished working on your ticket request.",movie_concert_show:"M has finished working on your ticket request.",flight_request:"M has finished working on your air-travel request."}),D="option-not-presented",E="really-bad-experience";g="other";var F=d((f={},f[E]="Very bad experience; sending the survey would make it worse",f[g]="Other",f)),G=function(a){return a.map(function(a,c){return b("React").createElement(b("XUISingleSelector.react").Option,{key:a,value:c},a)}).toList()};function H(a){switch(a){case p:return m;case q:case r:case s:case t:return n;case u:return o;default:return undefined}}function I(a,b){b=A.get(b.get("name"),B);return a===p&&b!==B}d=b("React").createClass({displayName:"OzFeedbackCloseDialog",mixins:[b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{onFeedbackDone:a.func.isRequired,title:a.string,intent:a.instanceOf(j).isRequired,scheduleds:a.instanceOf(c).isRequired},getDefaultProps:function(){return{title:"Before closing, please tell us how well M did"}},getInitialState:function(){return{feedback:j({"close-state":"fulfilled","close-sub-state":p,"objective-reached":null,"not-completed-other":"","user-happy":0,"was-fast":!0,"policy-value":z.keySeq().first(),"automation-value":v,"automation-opportunity":"","was-bug":!1,"did-not-send-survey-reason":this._shouldAllowSendSurvey()?E:D}),willSendSurvey:this._shouldAllowSendSurvey(),scheduledsToCancel:k()}},_onCloseChange:function(a){var b=this.props.intent;this.setState({feedback:this.state.feedback.set("close-state",H(a.value)).set("close-sub-state",a.value).set("objective-reached",I(a.value,b))})},_onPolicyChange:function(a){this.setState(function(b){b=b.feedback;return{feedback:b.setIn(["policy-value"],a.value)}})},_onReasonForNotSendingSurveyChange:function(a){this.setState(function(b){b=b.feedback;return{feedback:b.setIn(["did-not-send-survey-reason"],a.value)}})},_makeOnChangeHandler:function(a){return function(b){this.setState(function(c){c=c.feedback;return{feedback:c.set(a,b)}})}.bind(this)},componentDidMount:function(){var a=this.refs["selector_close-sub-state"]?b("ReactDOM").findDOMNode(this.refs["selector_close-sub-state"].refs.button):null;a&&a.focus()},render:function(){var a=this.state.scheduledsToCancel&&this.state.scheduledsToCancel.count();a=!a&&"Close Intent"||a===1&&"Close Intent and Delete 1 Scheduled Send"||"Close Intent and Delete "+a+" Scheduled Sends";return b("React").createElement(b("MessengerDialog.react"),{onToggle:this._handleToggle,ref:"dialog",type:"default",width:544},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogTitle.react"),null,this.props.title)),this._renderFields(),this._renderOptions(),this._renderTimeWarning(),b("React").createElement("div",{className:"_4k_x"},this._renderDialogAction(a,this._handleSave),this._renderDialogAction("Cancel",b("OzActions").hideDialog)))},_renderTimeWarning:function(){var a=this.props.intent;a=a.getIn(["params","datetime"]);a=a&&a.first()&&a.first().get("value")&&a.first().get("value").endsWith("07:00:00.000Z");return a?b("React").createElement("div",{className:"_581n"},"The time set in this intent is 12am, and the AI might schedule some messages around that time. Are you sure you set the time correctly?"):null},_renderDialogAction:function(a,c){return b("React").createElement(b("XUIButton.react"),{onClick:c,className:"_42hl",label:a})},_renderFields:function(){var a=this.props.intent,c=this.state.feedback,d=A.get(a.get("name"),B);return b("React").createElement("div",{className:"_42hk"},b("React").createElement(l,{label:a.get("name")},b("React").createElement("div",{className:"_8o2"},b("React").createElement("span",null,"Intent opened ",b("OzDate.react").formatTimestamp(a.get("created-at"))),b("React").createElement("br",null),b("React").createElement("span",null,b("relativeTimeString.atlas")(a.get("created-at"))))),b("React").createElement(l,{label:"Why are you closing this intent?"},b("React").createElement(b("XUISingleSelector.react"),{className:"_8o2",maxwidth:300,name:"selector_close-sub-state",ref:"selector_close-sub-state",onChange:this._onCloseChange,value:c.get("close-sub-state")},G(y))),c.get("close-sub-state")===p&&d!==B&&b("React").createElement(l,{label:d},b("React").createElement(b("XUIRadioButtonGroup.react"),{selectedValue:c.get("objective-reached"),onValueChange:this._makeOnChangeHandler("objective-reached"),selectedUse:"confirm",className:"_8o2"},b("React").createElement(b("XUIButton.react"),{value:!0,label:"Yes"}),b("React").createElement(b("XUIButton.react"),{value:!1,label:"No"}))),c.get("close-sub-state")===q&&b("React").createElement(l,{label:"What policy did the request violate?"},b("React").createElement(b("XUISingleSelector.react"),{maxwidth:1e3,name:"selector_policy-value",size:"large",onChange:this._onPolicyChange,value:c.get("policy-value"),className:"_8o2"},G(z))),c.get("close-sub-state")===t&&b("React").createElement(l,{label:"What was your reason?"},b("React").createElement(b("TextAreaWithLineLimit.react"),{value:c.get("not-completed-other"),onChange:this._makeOnChangeHandler("not-completed-other")})),b("React").createElement(l,{label:"How did the user seem?"},b("React").createElement(b("XUIRadioButtonGroup.react"),{className:"_8o2",selectedValue:c.get("user-happy"),onValueChange:this._makeOnChangeHandler("user-happy"),selectedUse:"confirm"},b("React").createElement(b("XUIButton.react"),{image:b("React").createElement(b("Image.react"),{src:i("40052"),title:"User loved it!"}),label:"User loved it!",labelIsHidden:!0,value:4}),b("React").createElement(b("XUIButton.react"),{image:b("React").createElement(b("Image.react"),{src:i("40076"),title:"User was happy"}),label:"User was happy",labelIsHidden:!0,value:3}),b("React").createElement(b("XUIButton.react"),{image:b("React").createElement(b("Image.react"),{src:i("40085"),title:"User was meh"}),label:"User was meh",labelIsHidden:!0,value:2}),b("React").createElement(b("XUIButton.react"),{image:b("React").createElement(b("Image.react"),{src:i("40042"),title:"User was unhappy"}),label:"User was unhappy",labelIsHidden:!0,value:1}),b("React").createElement(b("XUIButton.react"),{image:b("React").createElement(b("Image.react"),{src:i("316462"),title:"No Feedback"}),label:"No Feedback",labelIsHidden:!0,value:0}))),b("React").createElement(l,{label:"Did the request go smoothly?"},b("React").createElement(b("XUIRadioButtonGroup.react"),{selectedValue:c.get("was-fast"),onValueChange:this._makeOnChangeHandler("was-fast"),selectedUse:"confirm",className:"_8o2"},b("React").createElement(b("XUIButton.react"),{value:!0,label:"Yes: No Bugs and Good Automation"}),b("React").createElement(b("XUIButton.react"),{value:!1,label:"No: I have something to report"}))),!c.get("was-fast")&&b("React").createElement(l,{label:"Did a bug affect your work on this request?"},b("React").createElement(b("XUIRadioButtonGroup.react"),{className:"_8o2",selectedValue:c.get("was-bug"),onValueChange:this._makeOnChangeHandler("was-bug"),selectedUse:"confirm"},b("React").createElement(b("XUIButton.react"),{value:!1,label:"No"}),b("React").createElement(b("XUIButton.react"),{value:!0,label:"Yes"}))),!c.get("was-fast")&&c.get("was-bug")&&b("React").createElement("div",{className:"_4k_y"},"Please"," ",b("React").createElement("a",{href:"https://our.intern.facebook.com/intern/tasks/?q=732683726825240",target:"_blank"},"create a task")," ","or use the bugnub. Your feedback helps us make this product great!"),!c.get("was-fast")&&b("React").createElement(l,{label:"Did AI help?",tooltip:"i.e. auto sends, scheduled sends, bubble suggestions, ..."},b("React").createElement(b("XUIRadioButtonGroup.react"),{className:"_8o2",selectedValue:c.get("automation-value"),onValueChange:this._makeOnChangeHandler("automation-value"),selectedUse:"confirm"},b("React").createElement(b("XUIButton.react"),{value:w,label:"There was no need"}),b("React").createElement(b("XUIButton.react"),{value:v,label:"Yes, perfectly"}),b("React").createElement(b("XUIButton.react"),{value:x,label:"Could have been better"}))),!c.get("was-fast")&&c.get("automation-value")==x&&b("React").createElement("div",null,b("React").createElement("div",{className:"_4k_y"},"You can provide some feedback here or post in the"," ",b("React").createElement("a",{href:"https://www.facebook.com/groups/880028888735948/",target:"_blank"},"Feedback Group"),"."),b("React").createElement(l,{label:"How could the AI be improved?"},b("React").createElement(b("TextAreaWithLineLimit.react"),{value:c.get("automation-opportunity"),onChange:this._makeOnChangeHandler("automation-opportunity")}))))},_renderOptions:function(){var a=this.props.intent,c=this.state.feedback;return b("React").createElement("div",null,this._shouldAllowSendSurvey()&&b("React").createElement("div",{className:"_10-h"},b("React").createElement("input",{type:"checkbox",checked:this.state.willSendSurvey,onChange:this._handleToggleSendSurvey}),b("React").createElement("div",{className:"_10-i"},"Send survey and completion message to user:",b("React").createElement("br",null),b("React").createElement("span",{className:"_10-j"},'"',C.get(a.get("name")),'"'))),this._shouldAllowSendSurvey()&&!this.state.willSendSurvey&&b("React").createElement("div",{className:"_10-h"},b("React").createElement(l,{label:"Why have you decided not to send the survey?"},b("React").createElement(b("XUISingleSelector.react"),{className:"_8o2",maxwidth:400,onChange:this._onReasonForNotSendingSurveyChange,value:c.get("did-not-send-survey-reason")},G(F)))),this.state.config.getIn(["GK","cancelRestaurant"])&&this._perhapsDisplayScheduleds())},_handleSave:function(){this.props.onFeedbackDone(this.props.intent,this._sanitizeFeedback(this.state.feedback.toJS()),this.state.willSendSurvey,this.state.scheduledsToCancel),b("OzActions").hideDialog()},_sanitizeFeedback:function(a){a["close-state"]!==m&&(a["objective-reached"]=!1);a["close-sub-state"]!==q&&(a["policy-value"]="");a["close-sub-state"]!==t&&(a["not-completed-other"]="");a["was-fast"]&&(a["was-bug"]=!1,a["automation-value"]=v);a["automation-value"]!==x&&(a["automation-opportunity"]="");return a},_handleToggle:function(a){a||b("OzActions").hideDialog()},_shouldAllowSendSurvey:function(){return C.has(this.props.intent.get("name"))},_handleToggleSendSurvey:function(a){this.setState({willSendSurvey:!this.state.willSendSurvey})},_handleScheduledItemClick:function(a){j.isMap(a)||h(0),this.setState(function(b){b=b.scheduledsToCancel;return{scheduledsToCancel:b.has(a)?b.remove(a):b.add(a)}})},_perhapsDisplayScheduleds:function(){var a=this.props,c=a.intent;a=a.scheduleds;var d={restaurant:"request_type",restaurant_bar:"request_type",appointment:"appt_action"}[c.get("name")];d=d&&c.getIn(["params",d,0,"value"]);return k(["restaurant","restaurant_bar","appointment"]).has(c.get("name"))&&d==="cancel"&&!a.isEmpty()?b("React").createElement("div",{className:"_10-h"},b("React").createElement("div",{className:"_10-i"},"Do you need to cancel any scheduled sends?"),b("React").createElement("div",{className:"_5c03"},b("React").createElement("div",{className:"_5c04"},a.map(function(a,c){return b("React").createElement(J,{key:c,item:a,isPendingCancel:this.state.scheduledsToCancel.has(a),onClick:this._handleScheduledItemClick})}.bind(this))))):null}});function J(a){__p&&__p();var c=a.item,d=a.onClick;a=a.isPendingCancel;var e=function(a){switch(c.get("type")){case"send":a=c.getIn(["data","text"]);var d=c.getIn(["data","images"]);return b("React").createElement("div",{className:"_5c05"},a&&'"'+a+'"',d&&b("React").createElement(K,{images:d}));case"suggest":return b("React").createElement("div",{className:"_5c05"},b("React").createElement(b("OzBubblePreview.react"),{bubble:c.getIn(["data","suggestion"]),meta:c.get("meta"),source:c.get("source")}));default:b("OzHelpers").debug("[feedbackCloseDialog] could not render scheduled item",c);return null}}();return b("React").createElement("div",{className:"_5c06"+(a?" _5c07":""),onClick:function(a){return d(c)},role:"presentation"},b("React").createElement("div",{className:"_5c11"}),b("React").createElement("div",{className:"_5c12"},b("OzDate.react").formatTimestamp(c.get("at"))),e)}function K(a){a=a.images;return b("React").createElement("div",{className:"_5c4_"},a.map(function(a,c){return b("React").createElement(b("Image.react"),{key:c,className:"_1q16",src:a.get("url"),alt:a.get("filename")})}))}e.exports=d}),null);
__d("OzReminderTaskEditor.react",["cx","InputLabel_DEPRECATED.react","InputLabelLabel_DEPRECATED.react","OzConstants","ContextualLayerAutoFlip","ContextualLayerUpdateOnScroll","DatePickerRestraints","OzHelpers","immutable","InputLabel.react","ReactLayeredComponentMixin_DEPRECATED","LayerHideOnBlur","MessengerButtonReact.bs","React","XUIContextualDialog.react","XUIDateTimePicker.react","XUIError.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("OzConstants").REMINDERS,i=b("MessengerButtonReact.bs").jsComponent,j=b("immutable").Map,k=b("immutable").Set;a=b("React").PropTypes;var l=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],m=b("immutable").fromJS({traffic:{label:"Include traffic update",params:[{name:"origin",placeholder:"Origin address",err:"What is the origin address?"},{name:"destination",placeholder:"Destination address",err:"What is the destination address?"}]},weather:{label:"Include weather forecast",params:[{name:"location",placeholder:"City",err:"What city is the forecast for?"},{name:"metric",placeholder:"Celsius or Fahrenheit",err:"You need to set Celsius or Fahrenheit"}]}}),n=b("OzHelpers").pure(function(a){var c=a.action,d=a.errors,e=a.onToggle,f=a.onUpdate,g=a.task;a=!!g.getIn(["data","actions",c]);return b("React").createElement("div",null,b("React").createElement(b("InputLabel_DEPRECATED.react"),null,b("React").createElement("input",{type:"checkbox",checked:a,onChange:function(a){return e(a,g,c)}}),b("React").createElement(b("InputLabelLabel_DEPRECATED.react"),null,m.getIn([c,"label"]))),a&&b("React").createElement("div",null,m.getIn([c,"params"]).map(function(a){var e=a.get("name"),h=["data","actions",c,e],i=g.getIn(h);return b("React").createElement(b("XUIError.react"),{key:c+"-"+e,xuiError:d.getIn([c,e])},b("React").createElement("input",{type:a.get("type","text"),className:"_wbw",placeholder:a.get("placeholder"),value:i,onChange:function(a){return f(a,h)}}))}).valueSeq()))}),o=b("OzHelpers").pure(function(a){var c=a.task,d=a.errors,e=a.onToggle,f=a.onUpdate;return b("React").createElement("div",null,b("React").createElement("h3",{className:"_17f0"},"Actions"),m.keySeq().map(function(a){return b("React").createElement(n,{key:a,action:a,task:c,errors:d,onToggle:e,onUpdate:f})}).valueSeq())});c=b("React").createClass({displayName:"OzReminderTaskEditor",mixins:[b("ReactLayeredComponentMixin_DEPRECATED")],propTypes:{onSave:a.func.isRequired,seedTask:a.instanceOf(j),layered:a.bool,location:a.instanceOf(j).isRequired},getInitialState:function(){return{shown:!1,task:this.props.seedTask||j({type:"reminder",state:"waiting"}),errors:j()}},UNSAFE_componentWillReceiveProps:function(a){b("immutable").is(a.seedTask,this.props.seedTask)||this.setState({task:a.seedTask,errors:j()})},_renderBody:function(){__p&&__p();var a=this.state,c=a.task;a=a.errors;var d=this.props.location,e=k(c.getIn(["schedule","repeat-condition","days"]));return b("React").createElement("ul",{className:"_3ssq"},b("React").createElement("div",{className:"_wbu"},b("React").createElement(b("XUIDateTimePicker.react"),babelHelpers["extends"]({xuiError:a.get("scheduled-time"),className:"_wbv",date:new Date(c.get("start-at",b("OzHelpers").serverNow())),allowDuplicateDateSelection:!0,onChange:function(a){this.setState({task:b("OzHelpers").updateInWhen(c.set("start-at",+a).set("deadline",+a),["schedule"],function(b){return b.set("start-at",+a)})})}.bind(this)},b("OzHelpers").dateRestraints())),b("React").createElement(b("XUIError.react"),{xuiError:a.get("description")},b("React").createElement("input",{ref:"input",className:"_wbw",placeholder:"Describe the Reminder",value:c.getIn(["data","description"]),onChange:function(a){this.setState({task:c.setIn(["data","description"],a.target.value)})}.bind(this)})),b("React").createElement("h3",{className:"_17f0"},"Recurrence"),l.map(function(a,f){var g=f+1;return b("React").createElement(b("InputLabel.react"),{key:f,label:a},b("React").createElement("input",{type:"checkbox",checked:e.has(g),onChange:function(a){a=a.target.checked?e.add(g):e["delete"](g);this.setState({task:c.set("schedule",j({"start-at":c.get("start-at"),frequency:"weekly",timezone:d.get("timezone"),"timezone-offset":d.get("timezone-offset"),"repeat-condition":j({spacing:1,days:a.toList()})}))})}.bind(this)}))}.bind(this)),b("React").createElement(o,{task:c,errors:a,onToggle:this._handleActionToggle,onUpdate:this._handleActionUpdate}),b("React").createElement("div",{className:"_wbz"},b("React").createElement(i,{label:this.props.seedTask?"Update Reminder":"Add Reminder",disabled:this.state.saving,onClick:this._handleSave,type:"primary"}))))},render:function(){if(this.props.layered){var a=b("React").Children.only(this.props.children);return b("React").cloneElement(a,{onClick:function(a){return this.setState({shown:!this.state.shown})}.bind(this)})}return this._renderBody()},renderLayers:function(){var a=this.state.shown;return!a?null:{contextualDialog:b("React").createElement(b("XUIContextualDialog.react"),{behaviors:{ContextualLayerAutoFlip:b("ContextualLayerAutoFlip"),ContextualLayerUpdateOnScroll:b("ContextualLayerUpdateOnScroll"),LayerHideOnBlur:b("LayerHideOnBlur")},position:"below",shown:a,contextRef:function(){return this}.bind(this),onToggle:function(a){return this.setState({shown:a})}.bind(this)},this._renderBody())}},_handleActionToggle:function(a,b,c){a=a.target.checked?b.setIn(["data","actions"],j([[c,j()]])):b.deleteIn(["data","actions"]);this.setState({task:a})},_handleActionUpdate:function(a,b){this.setState({task:this.state.task.setIn(b,a.target.value)})},_handleSave:function(){__p&&__p();var a=this.state.task,c=a.get("start-at"),d=function(b){return!!a.getIn(["actions",b])},e=j(),f=b("OzHelpers").dateRestraints().dateRestraints;!c?e=e.set("scheduled-time","When would you like the reminder?"):c<b("OzHelpers").serverNow()+60*1e3?e=e.set("scheduled-time","Reminders should be in the future!"):b("DatePickerRestraints").isValidDate(new Date(c),f)||(e=e.set("scheduled-time","Reminder is outside of the "+h.RANGE_IN_YEARS+" year range"));a.getIn(["data","description"])||(e=e.set("description","What is the reminder about?"));e=m.reduce(function(b,c,e){d(e)&&(b=c.get("params").reduce(function(b,c){return a.getIn(["data","actions",e,c.get("name")])?b:b.setIn([e,c.get("name")],c.get("err"))},b));return b},e);this.setState({errors:e});if(e.size)return;this.setState({saving:!0},function(b){this.props.onSave(a).then(function(a){this.props.layered&&this.setState({shown:!1,saving:!1})}.bind(this))["catch"](function(a){return this.setState({saving:!1})}.bind(this))}.bind(this))}});e.exports=c}),null);
__d("OzIntentActions.react",["cx","Promise","Image.react","immutable","OzActions","OzAPI","OzConfig","OzDraggable.react","OzHelpers","OzImmutablePureRenderMixin","OzReminderTaskEditor.react","React","Reflux","XUICloseButton.react","joinClasses","promiseDone"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("immutable").Map;a=b("React").PropTypes;var j=5*6e4,k=10*6e4;c=b("React").createClass({displayName:"OzIntentActions",propTypes:{intent:a.instanceOf(i).isRequired,location:a.instanceOf(i).isRequired,userEmail:a.string},mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],contextTypes:{router:a.object.isRequired},getInitialState:function(){return{reminderShown:!1}},render:function(){var a=this.state.config;a=a.get("display-tasks")||a.getIn(["GK","timeline"]);return b("React").createElement("div",{className:b("joinClasses")("_x-r",this.props.className)},b("React").createElement("div",{className:(a?"_2p6s":"")+(a?"":" _ukm"),style:this.props.timelineGK?{borderTop:"none"}:null},a?[["mail",this._handleEmail],["call",this._handleCall],["calendar",this._handleInvite],["todo",this._handleTask]].map(function(a){var c=a[0];a=a[1];return b("React").createElement("button",{key:c,className:"_1-hv _2p6t",onClick:a},b("React").createElement(b("Image.react"),{className:"_2p6u",id:c,src:"/images/oz/intent/"+c+"-2x.png"}))}):[["call",this._handleCall],["email",this._handleEmail],["invite",this._handleInvite]].map(function(a){var c=a[0];a=a[1];return b("React").createElement("button",{key:c,className:"_1-hv _ukn",onClick:a},c)})),this.state.reminderShown&&a?b("React").createElement(l,{onClose:this._handleCloseReminderTask,onCreate:this._handleCreateReminderTask,location:this.props.location}):null)},_handleTask:function(){var a=this.props.intent,c=a.get("id"),d=a.get("user-id");a=i({deadline:b("OzHelpers").serverNow()+k+j,"intent-id":c,"start-at":b("OzHelpers").serverNow()+k,state:"waiting",type:"reminder",data:{description:""}});b("promiseDone")(b("OzAPI").createTask(d,a).then(function(a){this.context.router.push(b("OzHelpers").threadPath({threadid:d,intentid:c,taskid:a}))}.bind(this)))},_handleCreateReminderTask:function(a){var c=this.props.intent;return b("OzAPI").createTask(c.get("user-id"),a.set("intent-id",c.get("id"))).then(function(a){return this.setState({reminderShown:!1})}.bind(this))},_handleCloseReminderTask:function(){this.setState({reminderShown:!1})},_handleEmail:function(){var a=this.props.intent;b("OzActions").emailComposer.add({intentId:a.get("id"),from:a.get("email-address")})},_handleInvite:function(){b("OzActions").inviteComposer.create(this.props.intent.get("id"),this.props.userEmail,this.props.location.get("timezone"))},_handleCall:function(){b("promiseDone")(m(this.props.intent),function(a){return b("OzActions").twilio.useIntent(a)})}});h=babelHelpers.inherits(l,b("React").Component);h&&h.prototype;l.prototype.render=function(){"use strict";var a=this.props,c=a.onClose,d=a.onCreate;a=a.location;return b("React").createElement(b("OzDraggable.react"),{className:"_2jc4"},b("React").createElement("div",{className:"_2jc5"},"Reminder",b("React").createElement(b("XUICloseButton.react"),{onClick:c})),b("React").createElement(b("OzReminderTaskEditor.react"),{onSave:d,location:a}))};function l(){"use strict";h.apply(this,arguments)}l.propTypes={onClose:a.func.isRequired,onCreate:a.func.isRequired};function m(a){var c=a.get("phone-number");return c?b("Promise").resolve(a):b("OzAPI").addPhoneNumber(a.get("user-id"),a.get("id")).then(function(b){return a.merge(b)})}e.exports=c}),null);
__d("OzIntentParams.react",["cx","React"],(function(a,b,c,d,e,f,g){"use strict";var h;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_3-ue"},this.props.children)};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("OzIntentParamsAbstractField.react",["cx","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_5nij"+(this.props.hasValue?"":" _2ez0")},this.props.label?b("React").createElement("label",{className:"_2230 ellipsis"},this.props.label):null,b("React").createElement("div",{className:"_2ulp"},b("React").Children.only(this.props.children)))};function a(){h.apply(this,arguments)}a.propTypes={hasValue:c.bool,label:c.string};e.exports=a}),null);
__d("OzIntentParamsTextField.react",["invariant","AbstractTextArea.react","DOMQuery","OzIntentParamsAbstractField.react","OzImmutablePureRenderMixin","React","ReactDOM","TextAreaControl"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"OzIntentParamsTextField",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{label:a.string,onAsk:a.func,onChange:a.func,question:a.string,value:a.string.isRequired},_control:null,componentDidMount:function(){var a=b("DOMQuery").find(b("ReactDOM").findDOMNode(this),"textarea");this._control=new(b("TextAreaControl"))(a);this._control.setAutogrow(!0);this._control.onupdate()},componentDidUpdate:function(a,b){a.value!==this.props.value&&this._control.onupdate()},render:function(){return b("React").createElement(b("OzIntentParamsAbstractField.react"),{hasValue:!!this.props.value,onAsk:this.props.onAsk,question:this.props.question},b("React").createElement(b("AbstractTextArea.react"),{onChange:this._handleChange,placeholder:this.props.label,value:this.props.value}))},_handleChange:function(a){a=a.target;a instanceof HTMLTextAreaElement||g(0);this.props.onChange&&this.props.onChange(a.value)}});e.exports=c}),null);
__d("OzRequirementTokenizer.react",["immutable","OzImmutablePureRenderMixin","React","OzTokenizer.react"],(function(a,b,c,d,e,f){__p&&__p();a=b("immutable").Map;c=b("immutable").List;d=b("React").PropTypes;f=b("React").createClass({displayName:"OzRequirementTokenizer",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{allRequirements:d.instanceOf(a).isRequired,onDeleteRequirement:d.func.isRequired,onCreateRequirement:d.func.isRequired,selectedRequirements:d.instanceOf(c),placeholder:d.string.isRequired,timeline:d.bool},getDefaultProps:function(){return{timeline:!1}},_requirementSort:function(a){var b=this.props.witIntentUUID;b=a.get("wit-intent-uuids").has(b)?1e5:0;return-(b+a.get("used-count",0))},render:function(){var a=this.props,c=a.allRequirements,d=a.selectedRequirements,e=a.placeholder,f=a.onDeleteRequirement,g=a.onCreateRequirement;a=a.timeline;return b("React").createElement(b("OzTokenizer.react"),{placeholder:e,allTokens:c.toList(),chosenTokens:d,onDeleteToken:f,onCreateToken:g,resultRank:this._requirementSort,resultFilter:function(a,b){return a.get("name").toLowerCase().indexOf(b.toLowerCase())>=0},timeline:a})}});e.exports=f}),null);
__d("OzTimestampScrolling.react",["cx","OzActions","React","Tooltip"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").PropTypes;var i=3e3;d=babelHelpers.inherits(a,b("React").PureComponent);h=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={state:null},this.$2=function(){this.setState({state:"loading"}),b("OzActions").scrollThreadToTimestamp(this.props.timestamp)}.bind(this),c}a.prototype.componentDidMount=function(){"use strict";this.$1=b("OzActions").doneScrollingToTimestamp.listen(function(a,b){this.props.timestamp===a&&(b?this.setState({state:"error"},function(a){window.setTimeout(function(a){this.setState({state:null})}.bind(this),i)}.bind(this)):this.setState({state:null}))}.bind(this))};a.prototype.componentWillUnmount=function(){"use strict";this.$1()};a.prototype.render=function(){"use strict";var a="_1e3l"+(this.state.state?"":" _1y5w")+(this.state.state==="loading"?" _1y5x":"")+(this.state.state==="error"?" _1y5y":"");return b("React").createElement("span",{className:a,onClick:this.$2,role:"presentation"},this.props.children)};a.propTypes={timestamp:c.number.isRequired};e.exports=a}),null);
__d("OzSidebarItemHeader.react",["cx","fbt","OzHelpers","Keys","OzCheckboxInput.react","OzConfig","OzDate.react","OzTimestampScrolling.react","OzImmutablePureRenderMixin","React","Reflux","Tooltip","XUIAbstractGlyphButton.react","XUICloseButton.react","FBButtonMenuCombo.react","OzButton.react","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();b("FBButtonMenuCombo.react").Item;a=b("React").PropTypes;c=b("React").createClass({displayName:"OzSidebarItemHeader",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{alias:a.string,closedAt:a.number,createdAt:a.number,creator:a.string,intentId:a.number,isBlocked:a.bool,isClosed:a.bool.isRequired,isExpanded:a.bool,label:a.string,onCancel:a.func,onChangeAlias:a.func,onIsExpandedToggle:a.func,onToggle:a.func,skipScrollToTimestamp:a.bool,subtitle:a.node,timelineGK:a.bool,title:a.string.isRequired},getDefaultProps:function(){return{timelineGK:!1}},getInitialState:function(){return{isEditing:!1}},render:function(){var a=this.props,c=a.alias,d=a.className,e=a.closedAt,f=a.createdAt,g=a.intentId,j=a.isBlocked,k=a.isClosed,l=a.isExpanded,m=a.label,n=a.onCancel,o=a.onIsExpandedToggle,p=a.onToggle,q=a.skipScrollToTimestamp,r=a.subtitle,s=a.timelineGK;a=a.title;e=k?e:f;f=this.state.config.getIn(["GK","timeline"]);g&&f?({color:"white"}):({});g&&f?({background:b("OzHelpers").color(g)}):({});return b("React").createElement("div",{className:b("joinClasses")(d,"_31gu"+(l?" _31gx":"")+(j?" _27qc":"")+(k&&!s?" _31gy":""))},p?b("React").createElement(b("OzCheckboxInput.react"),{checked:k,className:"_31gz",onChange:p}):null,b("React").createElement("div",{className:"_31g-"},b("React").createElement("div",null,b("React").createElement("span",null,e?q?b("React").createElement(b("OzDate.react"),{className:"_56sd",timestamp:e}):b("React").createElement(b("OzTimestampScrolling.react"),{timestamp:e},b("React").createElement(b("OzDate.react"),{className:"_56sd",timestamp:e})):null),b("React").createElement(i,{alias:c,isBlocked:j,isEditing:this.state.isEditing,name:a,onChange:this._handleChangeAlias,onStartEditing:this._handleStartEditing,onCancelEditing:this._handleCancelEditing}),m?b("React").createElement("span",{className:"_5o4m"},m):null),b("React").createElement("span",{className:"_31h0"},r)),b("React").createElement("div",{className:"_3_41"},this.props.children,o?b("React").createElement(b("XUIAbstractGlyphButton.react"),{className:"_31h1",label:h._("Expand"),labelIsHidden:!0,onClick:o}):null,n&&b("React").createElement(b("XUICloseButton.react"),{onClick:n})))},_handleStartEditing:function(){this.props.onChangeAlias&&this.setState({isEditing:!0})},_handleCancelEditing:function(){this.setState({isEditing:!1})},_handleChangeAlias:function(a){var c=this.props.onChangeAlias;a.which===b("Keys").RETURN&&(c&&c(a.target.value),this.setState({isEditing:!1}))}});var i=b("OzHelpers").pure(function(a){var c=a.name,d=a.isBlocked,e=a.isEditing,f=a.alias,g=a.onChange,h=a.onStartEditing,i=a.onCancelEditing;a=a.style;return e?b("React").createElement("textarea",{className:"_31g_ _1p0b",style:a,onKeyDown:g,placeholder:c,defaultValue:f,onBlur:i,ref:function(a){a&&(a.focus(),b("OzHelpers").moveCursorToInputEnd(a))}}):b("React").createElement("span",babelHelpers["extends"]({className:"_31g_"+(d?" _7ok":""),style:a,onClick:h},b("Tooltip").propsFor(f?c:null)),f||c)});e.exports=c}),null);
__d("OzGenericIntent.react",["ix","cx","Promise","OzAPI","fbglyph","OzHelpers","promiseFinally","Image.react","immutable","MessengerButtonReact.bs","OzButton.react","OzConfig","OzFormPreview.react","OzIntentActions.react","OzIntentParams.react","OzRequirementTokenizer.react","OzSidebarItemHeader.react","OzImmutablePureRenderMixin","React","Reflux","OzIntentParamsTextField.react","Tooltip","OzDate.react","OzTimestampScrolling.react","URI","XUISingleSelector.react","Stars.react","OzActions","OzFeedbackCloseDialog.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("MessengerButtonReact.bs").jsComponent,j=b("immutable").List,k=b("immutable").Map,l=b("immutable").Set;a=b("React").PropTypes;var m=b("OzFormPreview.react").Row,n=b("XUISingleSelector.react").Option,o=b("OzHelpers").pure(function(a){__p&&__p();a=a.meta;var c=a&&a.get("send-survey",!1);if(c){c=a.get("rating3")||"-1";c=parseInt(c,10);return b("React").createElement("div",{className:"_40k2"+(c===1?" _40k3":"")+(c===0?" _40k4":"")},c===0?b("React").createElement("span",{title:"User says M is not done"},"Not Done"):b("React").createElement(b("Stars.react"),{count:c,max:3,size:"small",title:a.get("user-feedback")}))}else{c=a&&a.getIn(["feedback","did-not-send-survey-reason"]);return b("React").createElement("div",{className:"_40k2"},b("React").createElement("span",null,c==="option-not-presented"?b("React").createElement("span",{title:"Not relevant"},"N/A"):c==="really-bad-experience"&&b("React").createElement("span",{className:"_40k3",title:"Survey not sent because of really bad ux"},"Bad")))}});c=b("React").createClass({displayName:"OzGenericIntent",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{intent:a.instanceOf(k).isRequired,location:a.instanceOf(k).isRequired,notes:a.string.isRequired,onChangeAlias:a.func.isRequired,onClose:a.func.isRequired,onNotesChange:a.func.isRequired,onOpen:a.func.isRequired,onIsBlockedToggle:a.func.isRequired,onTriggerAI:a.func.isRequired,requirements:a.instanceOf(k).isRequired,onCreateRequirement:a.func,onDeleteRequirement:a.func,repNames:a.instanceOf(k).isRequired,userEmail:a.string,thread:a.instanceOf(k).isRequired,timelineGK:a.bool},render:function(){__p&&__p();var a=this.props,c=a.intent,d=a.repNames;a=a.timelineGK;var e=b("OzHelpers").isDeleted(c);if(e)return b("React").createElement("span",null);e=c.get("creator-fbid");d=d.get(e,e);e=c.get("blocked");var f=b("OzHelpers").intentName(c);return b("React").createElement("div",{className:"_37lt"},b("React").createElement(b("OzSidebarItemHeader.react"),{alias:c.get("alias"),className:(a?"":"_a2q")+(a?" _37lv":""),intentId:c.get("id"),isClosed:b("OzHelpers").isClosedIntent(c),onClose:this._handleClose,closeState:c.get("state"),isBlocked:e,onChangeAlias:this._handleChangeAlias,onFeedback:this._handleIntentFeedback,onToggle:this._handleToggle,onTriggerAI:this.props.onTriggerAI,timelineGK:a,title:f,creator:d},this._renderTriggerAI()),this._renderBody())},_renderTriggerAI:function(){var a=g("140058"),c=g("112825");a=this.state.config.getIn(["GK","timeline"])?a:c;return b("React").createElement(b("OzButton.react"),babelHelpers["extends"]({tight:!0,onClick:this.props.onTriggerAI},b("Tooltip").propsFor("Rerun the AI for this intent")),b("React").createElement(b("Image.react"),{src:a}))},_renderBody:function(){var a=this.props,c=a.intent,d=a.repNames,e=a.userEmail,f=a.location,g=a.thread,h=a.timelineGK;a=a.children;var i=c.get("creator-fbid"),j=i===b("OzConfig").getStaticConfig("PAGE_ID")?"Bot":i;d="Created by "+d.get(i,j);return b("React").createElement("div",null,h?null:b("React").createElement(b("OzIntentActions.react"),{intent:c,userEmail:e,location:f}),b("React").createElement("div",{className:"_1x_z"},b("React").createElement(b("OzFormPreview.react"),null,b("React").createElement(m,{label:"Status",className:"_10sn"},b("React").createElement(q,{intent:c,thread:g})),b("React").createElement(m,{label:"Created",tip:d,className:"_10sn"},r(c.get("created-at"))),b("React").createElement(m,{label:"Closed",className:"_10sn"},r(c.get("closed-at"))),b("React").createElement(m,{label:"Assigned Bot",className:"_10sn"},c.get("assigned-bot")||"None"))),b("React").createElement("div",{className:"_10sn"},a.length?b("React").createElement(b("OzIntentParams.react"),null,a):null,b("React").createElement("div",{className:"_2qn_"},this.state.config.getIn(["GK","bookOnOpenTableButton"])&&u(c)?this._renderOpenTableButton():null,this.state.config.getIn(["GK","scriptRestaurantClose"])&&u(c)?this._renderAutomationTrigger():null)),b("React").createElement("div",{className:"_1x-e _10sn"},b("React").createElement(b("OzRequirementTokenizer.react"),{allRequirements:this.props.requirements,onCreateRequirement:this._handleCreateRequirement,onDeleteRequirement:this._handleDeleteRequirement,selectedRequirements:c.get("requirements"),placeholder:"Add a requirement/tag..."})),b("React").createElement(b("OzIntentParams.react"),null,b("React").createElement("div",{className:"_19ny"},b("React").createElement(b("OzIntentParamsTextField.react"),{label:"Add notes about this intent...",onChange:this.props.onNotesChange,value:this.props.notes}))),h?b("React").createElement(b("OzIntentActions.react"),{intent:c,userEmail:e,location:f,timelineGK:h}):null)},_renderOpenTableButton:function(){__p&&__p();var a=this.props,c=a.thread;a=a.intent;c=v(c,a);c=w(c);if(!this.state.config.getIn(["GK","openTableAPI"]))return b("React").createElement(i,{className:(c&&c.length>0?"":"_2qo0")+" _2qo1",onClick:this._handleOpenTableClick,type:"primary",label:"Book on OT"});else{c=a.getIn(["params","request_type"],j()).first();if(!c||c.get("value")!=="reservation")return null;c=x(a);a=c.isEmpty()?"Book on OpenTable, schedule autosends, and send invite":"Missing fields: "+c.join(", ");return b("React").createElement(i,{className:(c.isEmpty()?"":"_2qo0")+" _2qo1",onClick:this._handleOpenTableClick,type:"primary",label:"Book on OT via API",title:a})}},_renderAutomationTrigger:function(){var a=this.props.intent,c=a.getIn(["params","request_type"],j()).first();if(!c||c.get("value")!=="reservation")return null;c=x(a);a=c.isEmpty()?"Send confirmation message, schedule autosends, and send invite":"Missing fields: "+c.join(", ");return b("React").createElement(i,{className:(c.isEmpty()?"":"_2qo0")+" _2qo1",onClick:this._handleAutomationClick,type:"primary",label:"Run close automation",title:a})},_handleAutomationClick:function(a){a=this.props;var c=a.thread;a=a.intent;var d=b("OzHelpers").threadID(c),e=a.get("id"),f="close-restaurant";c=b("OzHelpers").getRequirement(a,f);a=c?b("OzAPI").deleteIntentRequirement(d,e,c.get("id")):b("Promise").resolve();return a.then(function(){return b("OzAPI").createIntentRequirement(d,e,f)})},_handleOpenTableClick:function(a){__p&&__p();a=this.props;var c=a.thread;a=a.intent;var d=v(c,a);if(d.has("opentable-url"))if(this.state.config.getIn(["GK","openTableAPI"])&&d.has("ts")&&d.has("rid")&&d.has("party-size"))b("OzAPI").bookOpenTable(b("OzHelpers").threadID(c),a.get("id"),d.get("rid"),d.get("ts"),d.get("party-size"));else{c=w(d);c.length&&window.open(c,"_blank").focus()}},_handleChangeAlias:function(a){var b=this.props,c=b.intent;b=b.onChangeAlias;b&&b(c,a)},_handleOpen:function(){var a=this.props,b=a.intent;a=a.onOpen;a(b.get("id"))},_handleClose:function(a){var b=this.props,c=b.intent;b=b.onClose;b(c.get("id"),a)},_handleIsBlockedToggle:function(){var a=this.props,b=a.intent;a=a.onIsBlockedToggle;a(b)},_handleCreateRequirement:function(a){var b=this.props,c=b.intent;b=b.onCreateRequirement;b&&b(c.get("id"),a.get("name"))},_handleDeleteRequirement:function(a){var b=this.props,c=b.intent;b=b.onDeleteRequirement;b&&b(c.get("id"),a.get("id"))}});var p=["Active","Waiting","Closed"],q=b("React").createClass({displayName:"StatusDropdown",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{intent:a.instanceOf(k).isRequired,thread:a.instanceOf(k).isRequired},getInitialState:function(){return{sem:0}},render:function(){var a=this.props.intent,c=t(a);a=s(a).set("rating3",c.rating3).set("user-feedback",c.feedback);return b("React").createElement("div",null,b("React").createElement(b("XUISingleSelector.react"),{maxHeight:240,onChange:this._handleChange,value:this._value(),disabled:this.state.sem!==0},p.map(function(a){return b("React").createElement(n,{key:a,value:a},a)})),b("React").createElement(o,{meta:a}))},_value:function(){var a=this.props.intent;return b("OzHelpers").isBlockedIntent(a)&&"Waiting"||b("OzHelpers").isClosedIntent(a)&&"Closed"||"Active"},_handleChange:function(a){a=a.value;switch(a){case"Active":this._handleOpen();break;case"Waiting":this._handleWaiting();break;case"Closed":this._handleIntentFeedback();break;default:b("OzHelpers").debug("[unknown intent state]")}},_sem:function(a){var c=function(a){return this.setState(function(b){return{sem:b.sem+a}})}.bind(this);c(1);b("promiseFinally")(a,function(a){return c(-1)})},_handleOpen:function(){var a=this.props.intent;this._sem(b("OzAPI").openIntent(a.get("user-id"),a.get("id")))},_handleWaiting:function(){var a=this.props.intent;this._sem(b("OzAPI").blockIntent(a.get("user-id"),a.get("id")))},_handleIntentFeedback:function(){__p&&__p();var a=this.props,c=a.intent,d=a.thread;a=d.get("events",j()).filter(function(a){return l(["send","suggest"]).has(a.get("type"))&&a.get("at",0)>b("OzHelpers").serverNow()}).sortBy(function(a){return a.get("at")});b("OzActions").showDialog(b("OzFeedbackCloseDialog.react"),{intent:c,scheduleds:a,title:"Close Intent",onFeedbackDone:function(a,c,e,f){var g=c["close-state"];f&&f.map(function(a){return b("OzAPI").deleteScheduled(b("OzHelpers").threadID(d),a.get("id"))});this._sem(b("OzAPI").closeIntent(a.get("user-id"),a.get("id"),g,c,e));b("OzActions").hideDialog()}.bind(this)})}});function r(a){return a?b("React").createElement(b("OzTimestampScrolling.react"),{timestamp:a},b("React").createElement(b("OzDate.react"),{timestamp:a})):null}function s(a){return(a.get("events",j()).filter(function(a){return a.get("type")==="close-intent"}).maxBy(function(a){return a.get("timestamp")})||k()).get("data",k())}function t(a){a=(a.get("events",j()).filter(function(a){return a&&a.getIn(["data","action"])==="intent_survey"}).last()||k()).getIn(["data","metadata"],"{}");return JSON.parse(a)}function u(a){a=a.getIn(["metadata","category"]);return a==="restaurant"}function v(a,b){__p&&__p();var c=k();a=a.get("guesses",j()).filter(function(a){return a.get("class")==="suggestions"}).first();a=a?a.get("items",j()).filter(function(a){return a.get("type")==="bubble"}):j();if(a.count()>0){a=a.first().get("meta",k());var d=a.getIn(["open-table","url"]);a=a.getIn(["open-table","rid"]);c=c.set("rid",a);if(d&&d.length>0){c=c.set("opentable-url",d);a=b.get("params",k());d=a.get("datetime",j()).first();b=d?d.get("value",""):"";if(b.length>0){d=new Date(b).getTime();c=c.set("ts",d)}b=a.get("people_number",j()).first();d=b?b.get("value",0):0;d>0&&(c=c.set("party-size",d))}}return c}function w(a){__p&&__p();var c=a.get("opentable-url");if(c&&c.length>0){c=new(b("URI"))(c);var d=a.get("ts");if(d){var e=new Date().getTimezoneOffset()*6e4;d=new Date(d-e).toISOString().slice(0,-1);c.addQueryData("dateTime",d)}e=a.get("party-size",0);e>0&&c.addQueryData("covers",e);return c.toString()}return""}function x(a){var b=j(["datetime","location","people_number","restaurant_name","place_id"]);return b.filterNot(function(b){return a.getIn(["params",b])})}e.exports=c}),null);
__d("OzIntentParamsDateTimeField.react",["immutable","OzDateTimePicker.react","OzIntentParamsAbstractField.react","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=b("React").PropTypes;c=b("immutable").Map;d=b("React").createClass({displayName:"OzIntentParamsDateTimeField",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{label:a.string,location:a.instanceOf(c).isRequired,onChange:a.func,value:a.instanceOf(Date)},getInitialState:function(){return{timezone:this.props.location.get("timezone")}},render:function(){return b("React").createElement(b("OzIntentParamsAbstractField.react"),{hasValue:!!this.props.value,label:this.props.label},b("React").createElement(b("OzDateTimePicker.react"),{datePlaceholder:this.props.label,layout:"three-line",onChange:this._handleChange,showTimezoneName:!1,timestamp:this.props.value&&this.props.value.getTime(),timezone:this.state.timezone}))},_handleChange:function(a){var b=a.timezone;a=a.timestamp;this.props.onChange(new Date(a));this.setState({timezone:b})}});e.exports=d}),null);
__d("OzIntentParamsEnumField.react",["immutable","OzIntentParamsAbstractField.react","OzImmutablePureRenderMixin","React","XUISingleSelector.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").List,h=b("immutable").OrderedSet;a=b("React").PropTypes;var i=b("XUISingleSelector.react").Option;c=b("React").createClass({displayName:"OzIntentParamsEnumField",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{label:a.string,onChange:a.func,onSave:a.func,placeholder:a.string,values:a.arrayOf(a.string).isRequired,value:a.string},getInitialState:function(){return{value:this.props.value||""}},render:function(){var a=(this.state.value?h(this.props.values).add(this.state.value).toList():g(this.props.values)).map(function(a){return b("React").createElement(i,{key:a,value:a},a)}).unshift(b("React").createElement(i,{key:this.props.placeholder,value:""},this.props.placeholder));return b("React").createElement(b("OzIntentParamsAbstractField.react"),{hasValue:!!this.state.value,label:this.props.label},b("React").createElement(b("XUISingleSelector.react"),{maxHeight:240,onChange:this._handleChange,value:this.state.value},a))},_handleChange:function(a){this.props.onChange&&this.props.onChange(a.value),this.setState({value:a.value},this._save)},_save:function(){this.props.onSave&&this.props.onSave(this.state.value)}});e.exports=c}),null);
__d("OzIntentParamsNumberField.react",["cx","FBNumberInput.react","OzIntentParamsAbstractField.react","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f,g){"use strict";a=b("React").PropTypes;c=b("React").createClass({displayName:"OzIntentParamsNumberField",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{label:a.string,onChange:a.func,placeholder:a.string,value:a.number},render:function(){return b("React").createElement(b("OzIntentParamsAbstractField.react"),{hasValue:this.props.value!=null,label:this.props.label},b("React").createElement(b("FBNumberInput.react"),{className:"_3dag",onValueChange:this.props.onChange,placeholder:this.props.placeholder,value:this.props.value}))}});e.exports=c}),null);
__d("OzLocationSearchSource",["WebAsyncSearchSource"],(function(a,b,c,d,e,f){a={allow_places:!0,include_likes:!1,include_subtext:!0,include_address:1,limit:5,map_height:null,map_width:null,render_map:!1,use_searchable_entries:!0,use_unicorn:!0};c=new(b("WebAsyncSearchSource"))({bootstrapRequests:[{uri:"/ajax/places/typeahead",data:a}],getAllForEmptyQuery:!0,queryRequests:[{uri:"/ajax/places/typeahead",data:babelHelpers["extends"]({},a,{hide_geo:!0})}]});c.search("",function(a){});e.exports=c}),null);
__d("OzPlaceField.react",["cx","joinClasses","immutable","OzConfig","OzLocationSearchSource","ReactComponentWithPureRenderMixin","React","Reflux","SearchableEntry","XUIError.react","XUITypeahead.react"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("React").PropTypes;var h=b("immutable").Map;c=b("React").createClass({displayName:"OzPlaceField",mixins:[b("ReactComponentWithPureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:babelHelpers["extends"]({disabled:a.bool,onQueryStringChange:a.func.isRequired,onSelect:a.func.isRequired,placeholder:a.string,queryString:a.string,selectedEntry:a.instanceOf(h)},b("XUIError.react").PropTypes),getDefaultProps:function(){return{disabled:!1,placeholder:"Place"}},render:function(){var a=this.props,c=a.className,d=a.disabled,e=a.onQueryStringChange,f=a.onSelect,g=a.placeholder,h=a.queryString;a=a.selectedEntry;c=b("joinClasses")("_44sp"+(d?" _44sq":""),c);return b("React").createElement(b("XUITypeahead.react"),{className:c,disabled:d,onChange:function(a){return e(a.target.value)},onSelectAttempt:function(a){return f(i(a))},placeholder:g,queryString:h,searchSource:b("OzLocationSearchSource"),selectedEntry:a&&a.get("id")&&a.get("name")?j(a):null,showEntriesOnFocus:!0,tallInput:!1,xuiErrorPosition:"left"})}});function i(a){return h({id:+a.getUniqueID(),name:a.getTitle(),description:a.getSubtitle(),photo:a.getPhoto()})}function j(a){return new(b("SearchableEntry"))({title:a.get("name"),subtitle:a.get("description"),uniqueID:a.get("id"),photo:a.get("photo")})}e.exports=c}),null);
__d("OzIntentParamsPlaceField.react",["OzIntentParamsAbstractField.react","OzPlaceField.react","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f){"use strict";a=b("React").PropTypes;c=b("React").createClass({displayName:"OzIntentParamsPlaceField",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{label:a.string,onChange:a.func,onSave:a.func,placeholder:a.string,value:a.oneOfType([a.string,a.object])},render:function(){var a=this.props,c=a.value,d=a.label,e=a.onChange;a=a.placeholder;var f=c?typeof c==="string"?c:c.get("name")||"":"";return b("React").createElement(b("OzIntentParamsAbstractField.react"),{hasValue:!!c,label:d},b("React").createElement(b("OzPlaceField.react"),{onQueryStringChange:e,onSelect:e,placeholder:a,queryString:f,selectedEntry:typeof c==="object"?c:null}))}});e.exports=c}),null);
__d("OzIntentParamsPriceRangeField.react",["cx","OzIntentParamsAbstractField.react","OzImmutablePureRenderMixin","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;var h=[1,2,3,4];c=b("React").createClass({displayName:"OzIntentParamsPriceRangeField",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{label:a.string,onChange:a.func,value:a.oneOf(h)},render:function(){var a=this.props.value;return b("React").createElement(b("OzIntentParamsAbstractField.react"),{hasValue:!!a,label:this.props.label},b("React").createElement("span",{className:"_8l3"},h.map(function(c){return b("React").createElement("span",{className:"_8l4"+(a&&c<=a?" _8l6":""),key:c,onClick:function(a){return this._handleDollarClick(a,c)}.bind(this),role:"presentation"},"$")}.bind(this))))},_handleDollarClick:function(a,b){a.preventDefault();a=this.props.value==b?null:b;this.props.onChange&&this.props.onChange(a)}});e.exports=c}),null);
__d("OzIntentParamsStringField.react",["invariant","AbstractTextInput.react","OzIntentParamsAbstractField.react","OzImmutablePureRenderMixin","React","debounce"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"OzIntentParamsStringField",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{label:a.string,onChange:a.func,onSave:a.func,placeholder:a.string,value:a.string},getInitialState:function(){return{value:this.props.value||""}},UNSAFE_componentWillMount:function(){this._save=b("debounce")(this._save,750,this,!0)},render:function(){return b("React").createElement(b("OzIntentParamsAbstractField.react"),{hasValue:!!this.state.value,label:this.props.label},b("React").createElement(b("AbstractTextInput.react"),{onChange:this._handleChange,placeholder:this.props.placeholder,type:"text",value:this.state.value}))},_handleChange:function(a){a=a.target;a instanceof HTMLInputElement||g(0);this.props.onChange&&this.props.onChange(a.value);this.setState({value:a.value},this._save)},_save:function(){this.props.onSave&&this.props.onSave(this.state.value)}});e.exports=c}),null);
__d("OzIntentFactoryHelpers",["immutable","React","OzIntentParamsStringField.react","OzIntentParamsNumberField.react","OzIntentParamsPriceRangeField.react","OzIntentParamsEnumField.react","OzIntentParamsDateTimeField.react","OzIntentParamsPlaceField.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").Map,h={makeStateUpdater:function(a){return function(b){var c;this._setStateAndSave((c={},c[a]=b,c))}},makeStateExtractor:function(a){__p&&__p();return function(b){__p&&__p();var c=b.get("params")||g(),d={};for(var e=a,f=Array.isArray(e),h=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(f){if(h>=e.length)break;j=e[h++]}else{h=e.next();if(h.done)break;j=h.value}j=j;var k=j.name;j=j.type;var l=i(c,k);switch(j){case"string":case"enum":d[k]=""+(l||"");break;case"number":case"pricerange":d[k]=+l||null;break;case"datetime":d[k]=l&&new Date(l);break;case"place":j=i(c,"place_id");d[k]=g({id:j,name:l});break}}return babelHelpers["extends"]({},d,{notes:b.get("notes")||""})}},makeParamsUpdater:function(a){__p&&__p();return function(b,c){__p&&__p();return(b||g()).withMutations(function(b){__p&&__p();for(var d=a,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;var h=g.name;g=g.type;switch(g){case"datetime":g=c[h];g=g?{value:g.toISOString(),grain:"minute"}:undefined;j(b,h,g);break;case"place":g=c[h];typeof g==="object"?(j(b,"place_id",{value:g.get("id")}),j(b,h,{value:g.get("name")})):(j(b,"place_id",{value:null}),j(b,h,{value:g}));break;default:j(b,h,{value:c[h]});break}}})}},makeFieldRenderer:function(a){return function(c){return a.map(function(a){var d=a.label,e=a.name,f=a.placeholder,g=a.type;a=a.values;g=h.getFieldComponent(g);return b("React").createElement(g,{key:e,label:d,location:c,onChange:this._changeHandlers.get(e),placeholder:f||d,value:this.state[e],values:a})}.bind(this))}},getFieldComponent:function(a){switch(a){case"string":return b("OzIntentParamsStringField.react");case"number":return b("OzIntentParamsNumberField.react");case"pricerange":return b("OzIntentParamsPriceRangeField.react");case"enum":return b("OzIntentParamsEnumField.react");case"datetime":return b("OzIntentParamsDateTimeField.react");case"place":return b("OzIntentParamsPlaceField.react");default:throw new Error("OzIntentFactoryHelpers: Unknown field type "+a+".")}}};function i(a,b){a=a.get(b);return a&&!a.isEmpty()?a.first().get("value"):null}function j(a,c,d){a.set(c,b("immutable").fromJS([d]))}e.exports=h}),null);
__d("OzIntentSchemas",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={get:function(a,b){__p&&__p();b=b.getIn(["GK","scriptRestaurantClose"]);switch(a){case"restaurant":case"restaurant_bar":return b?i:h;case"reminder":return j;case"appointment":case"nonmedical_appointment":return k;case"local_search":return l;case"good_purchase":return m;case"customer_service":case"customer_service_general":return n;case"weather_forecast":return o;case"hotel_and_accommodation":return p;case"activities_things_to_do":return q;case"ticket_purchase":case"movie_concert_show":return r;case"food_purchase":return s;case"utility":return t;case"book_car_transportation":case"vehicle_service":return u;case"traffic":return v;case"navigation":return w;case"flight_request":return x;case"stocks":return y;case"moviebot_search_movie":return z;case"moviebot_search_screening_event":return A;case"moviebot_buy_ticket":return B;case"moviebot_search_review":return C;case"moviebot_watch_trailer":return D;case"moviebot_provide_slot_value":return E;case"moviebot_reject":return F;case"moviebot_accept":return G;case"moviebot_greeting":return H;case"moviebot_help":return I;case"moviebot_other":return J;default:return g}}};var g={name:"Generic",fields:[]},h={name:"Restaurant",fields:[{type:"enum",name:"request_type",label:"Action",placeholder:"Pick one...",values:["reservation","availability","cancel","confirm","change","info","location","option"]},{type:"string",name:"restaurant_name",label:"Name",placeholder:"Restaurant Name"},{type:"string",name:"restaurant_cuisine",label:"Cuisine"},{type:"string",name:"location",label:"Location"},{type:"number",name:"people_number",label:"Guests",placeholder:"Number of guests"},{type:"pricerange",name:"amount_of_money",label:"Price Range"},{type:"datetime",name:"datetime",label:"Date/Time"}]},i={name:"Restaurant",fields:[{type:"enum",name:"request_type",label:"Action",placeholder:"Pick one...",values:["reservation","availability","cancel","confirm","change","info","location","option"]},{type:"place",name:"restaurant_name",label:"Name",placeholder:"Restaurant Name"},{type:"string",name:"restaurant_cuisine",label:"Cuisine"},{type:"string",name:"location",label:"Location"},{type:"number",name:"people_number",label:"Guests",placeholder:"Number of guests"},{type:"pricerange",name:"amount_of_money",label:"Price Range"},{type:"datetime",name:"datetime",label:"Date/Time"}]},j={name:"reminder",fields:[{type:"datetime",name:"datetime",label:"Reminder Time"},{type:"string",name:"reminder",label:"About"}]},k={name:"NonMedicalAppt",fields:[{type:"enum",name:"appt_action",label:"Action",placeholder:"Pick one...",values:["availability","cancel","move","confirm","book"]},{type:"string",name:"appt_type",label:"Appt Type",placeholder:"Type of appointment"},{type:"string",name:"location",label:"Location",placeholder:"Location of appointment"},{type:"datetime",name:"datetime",label:"Datetime",placeholder:"Date and time of the appointment"},{type:"string",name:"local_search_query",label:"Name",placeholder:"Name of the place"}]},l={name:"LocalSearch",fields:[{type:"string",name:"local_query",label:"Query",placeholder:"Search query like yoga class..."},{type:"string",name:"location",label:"Location",placeholder:""},{type:"string",name:"local_name",label:"Name",placeholder:"Name of the place or business..."},{type:"datetime",name:"datetime",label:"Datetime",placeholder:""}]},m={name:"GoodPurchase",fields:[{type:"string",name:"good",label:"Good",placeholder:""},{type:"string",name:"provider",label:"Merchant",placeholder:""},{type:"string",name:"amount_of_money",label:"Price"},{type:"number",name:"good_number",label:"Items #",placeholder:"Number of Items"},{type:"string",name:"location",label:"Location",placeholder:""}]},n={name:"CustomerService",fields:[{type:"string",name:"provider",label:"Merchant"},{type:"string",name:"order_number",label:"Order #"}]},o={name:"Weather",fields:[{type:"string",name:"location",label:"Location"},{type:"datetime",name:"datetime",label:"Datetime"},{type:"string",name:"weather_type",label:"Type of forecast",placeholder:"temperature, snow, tide..."},{type:"string",name:"temperature_metric",label:"Metric",placeholder:"Celsius or Fahrenheit"}]},p={name:"Hotel",fields:[{type:"enum",name:"hotel_query_type",label:"Action",placeholder:"Pick one...",values:["reservation","availability","cancel","change","contact","extend","receipt"]},{type:"string",name:"location",label:"Location"},{type:"datetime",name:"datetime",label:"Check in",placeholder:"Date and time of the appointment"},{type:"number",name:"night_number",label:"Nights #",placeholder:"Number of Nights"},{type:"number",name:"people",label:"People",placeholder:"Number of Guests"},{type:"string",name:"amount_of_money",label:"Price"},{type:"string",name:"hotel_name",label:"Hotel Name"}]},q={name:"Activities",fields:[{type:"string",name:"reservation_type",label:"Activity"},{type:"string",name:"location",label:"Location"},{type:"datetime",name:"datetime",label:"Datetime"},{type:"string",name:"amount_of_money",label:"Price"},{type:"number",name:"people_number",label:"People",placeholder:"Number of People"}]},r={name:"Tickets",fields:[{type:"enum",name:"request_type",label:"Action",placeholder:"Pick one...",values:["reservation","availability","cancel","change","info","location","option","price","receipt","time","schedule"]},{type:"string",name:"event_type",label:"Type",placeholder:"Movie, show, concert..."},{type:"string",name:"event",label:"Name"},{type:"string",name:"event_venue",label:"Venue"},{type:"string",name:"location",label:"Location"},{type:"datetime",name:"datetime",label:"Datetime"},{type:"string",name:"amount_of_money",label:"Price"},{type:"number",name:"people_number",label:"Tickets #",placeholder:"Number of Tickets"}]},s={name:"FoodPurchase",fields:[{type:"string",name:"order",label:"Order",placeholder:""},{type:"string",name:"food_type",label:"Food Type",placeholder:""},{type:"string",name:"food_place",label:"Place"},{type:"enum",name:"delivery_type",label:"Delivery",placeholder:"Pick one...",values:["deliver","takeout"]},{type:"string",name:"location",label:"Location",placeholder:""},{type:"datetime",name:"datetime",label:"Datetime"}]},t={name:"Utility",fields:[{type:"enum",name:"request_type",label:"Action",placeholder:"Pick one...",values:["reservation","availability","cancel","change","info","location","option","price","receipt","time","schedule"]},{type:"string",name:"utility_provider",label:"Name",placeholder:"Name of the utility company"},{type:"string",name:"location",label:"Location",placeholder:""},{type:"string",name:"account_nbr",label:"Account #",placeholder:""}]},u={name:"Vehicle",fields:[{type:"enum",name:"hotel_query_type",label:"Action",placeholder:"Pick one...",values:["reservation","availability","cancel","change","info","location","option","price","receipt","time","schedule"]},{type:"string",name:"from",label:"From"},{type:"string",name:"to",label:"To"},{type:"datetime",name:"datetime",label:"Datetime",placeholder:"Date and time of the ride"},{type:"string",name:"car_type",label:"Car Type",placeholder:"Type of car (limo, uber, lift...)"},{type:"string",name:"people_number",label:"People",placeholder:"Number of Guests"},{type:"string",name:"vehicle_provider",label:"Rental Name",placeholder:"Car rental name like Hertz, Avis.."}]},v={name:"Traffic",fields:[{type:"string",name:"from",label:"Starting Point"},{type:"string",name:"to",label:"Destination"},{type:"datetime",name:"datetime",label:"Date/Time",placeholder:"Intended departure time (not supported by automation)"}]},w={name:"Navigation",fields:[{type:"string",name:"from",label:"Starting Point"},{type:"string",name:"to",label:"Destination"},{type:"datetime",name:"datetime",label:"Date/Time",placeholder:"Intended departure time (not supported by automation)"}]},x={name:"flight_request",fields:[{type:"enum",name:"flight_query_type",label:"Action",placeholder:"Pick one...",values:["book","price","upgrade","flight_status","cancel","change"]},{type:"string",name:"from",label:"From"},{type:"string",name:"to",label:"To"},{type:"datetime",name:"departure",label:"Departure"},{type:"datetime",name:"arrival",label:"Arrival"},{type:"string",name:"carrier",label:"Carrier"},{type:"string",name:"reference",label:"Reference #"},{type:"string",name:"passenger_num",label:"Passenger #"}]},y={name:"stocks",fields:[{type:"string",name:"stock_symbol_list",label:"Stocks",placeholder:"Comma separated list of symbols"}]},z={name:"moviebot_search_movie",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"location_text",label:"location - text",placeholder:"Part of message with location"},{type:"string",name:"location_entity",label:"location - entity",placeholder:"location referred to"},{type:"string",name:"theater_text",label:"theater - text",placeholder:"Part of message with theater"},{type:"string",name:"theater_entity",label:"theater - entity",placeholder:"theater referred to"},{type:"string",name:"datetime_text",label:"datetime - text",placeholder:"Part of message with datetime"},{type:"string",name:"datetime_entity",label:"datetime - entity",placeholder:"datetime referred to"},{type:"string",name:"screening_type_text",label:"screening_type - text",placeholder:"Part of message with screening_type"},{type:"string",name:"screening_type_entity",label:"screening_type - entity",placeholder:"screening_type referred to"},{type:"string",name:"age_rating_text",label:"age_rating - text",placeholder:"Part of message with age_rating"},{type:"string",name:"age_rating_entity",label:"age_rating - entity",placeholder:"age_rating referred to"},{type:"string",name:"genre_text",label:"genre - text",placeholder:"Part of message with genre"},{type:"string",name:"genre_entity",label:"genre - entity",placeholder:"genre referred to"}]},A={name:"moviebot_search_screening_event",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"movie_text",label:"movie - text",placeholder:"Part of message with movie"},{type:"string",name:"movie_entity",label:"movie - entity",placeholder:"movie referred to"},{type:"string",name:"location_text",label:"location - text",placeholder:"Part of message with location"},{type:"string",name:"location_entity",label:"location - entity",placeholder:"location referred to"},{type:"string",name:"theater_text",label:"theater - text",placeholder:"Part of message with theater"},{type:"string",name:"theater_entity",label:"theater - entity",placeholder:"theater referred to"},{type:"string",name:"datetime_text",label:"datetime - text",placeholder:"Part of message with datetime"},{type:"string",name:"datetime_entity",label:"datetime - entity",placeholder:"datetime referred to"},{type:"string",name:"screening_type_text",label:"screening_type - text",placeholder:"Part of message with screening_type"},{type:"string",name:"screening_type_entity",label:"screening_type - entity",placeholder:"screening_type referred to"}]},B={name:"moviebot_buy_ticket",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"movie_text",label:"movie - text",placeholder:"Part of message with movie"},{type:"string",name:"movie_entity",label:"movie - entity",placeholder:"movie referred to"},{type:"string",name:"location_text",label:"location - text",placeholder:"Part of message with location"},{type:"string",name:"location_entity",label:"location - entity",placeholder:"location referred to"},{type:"string",name:"theater_text",label:"theater - text",placeholder:"Part of message with theater"},{type:"string",name:"theater_entity",label:"theater - entity",placeholder:"theater referred to"},{type:"string",name:"datetime_text",label:"datetime - text",placeholder:"Part of message with datetime"},{type:"string",name:"datetime_entity",label:"datetime - entity",placeholder:"datetime referred to"},{type:"string",name:"ticket_count_text",label:"ticket_count - text",placeholder:"Part of message with ticket_count"},{type:"string",name:"ticket_count_entity",label:"ticket_count - entity",placeholder:"ticket_count referred to"},{type:"string",name:"screening_type_text",label:"screening_type - text",placeholder:"Part of message with screening_type"},{type:"string",name:"screening_type_entity",label:"screening_type - entity",placeholder:"screening_type referred to"}]},C={name:"moviebot_search_review",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"movie_text",label:"movie - text",placeholder:"Part of message with movie"},{type:"string",name:"movie_entity",label:"movie - entity",placeholder:"movie referred to"}]},D={name:"moviebot_watch_trailer",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"movie_text",label:"movie - text",placeholder:"Part of message with movie"},{type:"string",name:"movie_entity",label:"movie - entity",placeholder:"movie referred to"}]},E={name:"moviebot_provide_slot_value",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"movie_text",label:"movie - text",placeholder:"Part of message with movie"},{type:"string",name:"movie_entity",label:"movie - entity",placeholder:"movie referred to"},{type:"string",name:"location_text",label:"location - text",placeholder:"Part of message with location"},{type:"string",name:"location_entity",label:"location - entity",placeholder:"location referred to"},{type:"string",name:"theater_text",label:"theater - text",placeholder:"Part of message with theater"},{type:"string",name:"theater_entity",label:"theater - entity",placeholder:"theater referred to"},{type:"string",name:"datetime_text",label:"datetime - text",placeholder:"Part of message with datetime"},{type:"string",name:"datetime_entity",label:"datetime - entity",placeholder:"datetime referred to"},{type:"string",name:"ticket_count_text",label:"ticket_count - text",placeholder:"Part of message with ticket_count"},{type:"string",name:"ticket_count_entity",label:"ticket_count - entity",placeholder:"ticket_count referred to"},{type:"string",name:"screening_type_text",label:"screening_type - text",placeholder:"Part of message with screening_type"},{type:"string",name:"screening_type_entity",label:"screening_type - entity",placeholder:"screening_type referred to"},{type:"string",name:"age_rating_text",label:"age_rating - text",placeholder:"Part of message with age_rating"},{type:"string",name:"age_rating_entity",label:"age_rating - entity",placeholder:"age_rating referred to"}]},F={name:"moviebot_reject",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"}]},G={name:"moviebot_accept",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"}]},H={name:"moviebot_greeting",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"}]},I={name:"moviebot_help",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"}]},J={name:"moviebot_other",fields:[{type:"string",name:"message",label:"Message",placeholder:"Message being annotated"},{type:"string",name:"movie_text",label:"movie - text",placeholder:"Part of message with movie"},{type:"string",name:"movie_entity",label:"movie - entity",placeholder:"movie referred to"},{type:"string",name:"location_text",label:"location - text",placeholder:"Part of message with location"},{type:"string",name:"location_entity",label:"location - entity",placeholder:"location referred to"},{type:"string",name:"theater_text",label:"theater - text",placeholder:"Part of message with theater"},{type:"string",name:"theater_entity",label:"theater - entity",placeholder:"theater referred to"},{type:"string",name:"datetime_text",label:"datetime - text",placeholder:"Part of message with datetime"},{type:"string",name:"datetime_entity",label:"datetime - entity",placeholder:"datetime referred to"},{type:"string",name:"ticket_count_text",label:"ticket_count - text",placeholder:"Part of message with ticket_count"},{type:"string",name:"ticket_count_entity",label:"ticket_count - entity",placeholder:"ticket_count referred to"},{type:"string",name:"screening_type_text",label:"screening_type - text",placeholder:"Part of message with screening_type"},{type:"string",name:"screening_type_entity",label:"screening_type - entity",placeholder:"screening_type referred to"},{type:"string",name:"age_rating_text",label:"age_rating - text",placeholder:"Part of message with age_rating"},{type:"string",name:"age_rating_entity",label:"age_rating - entity",placeholder:"age_rating referred to"},{type:"string",name:"genre_text",label:"genre - text",placeholder:"Part of message with genre"},{type:"string",name:"genre_entity",label:"genre - entity",placeholder:"genre referred to"}]};e.exports=a}),null);
__d("OzIntentFactory",["immutable","OzAPI","OzGenericIntent.react","OzIntentFactoryHelpers","OzIntentSchemas","OzImmutablePureRenderMixin","React","debounce"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("React").PropTypes,h=new Map();a={get:function(a,c){c=b("OzIntentSchemas").get(a,c);h.has(a)||h.set(a,i(c));return h.get(a)}};function i(a){__p&&__p();var c=b("immutable").Map,d=a.name,e=a.fields,f=1e4,h=b("OzIntentFactoryHelpers").makeStateExtractor(e);a=b("OzIntentFactoryHelpers").makeFieldRenderer(e);var i=b("OzIntentFactoryHelpers").makeParamsUpdater(e);return b("React").createClass({displayName:"Oz"+d+"DynamicIntent",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{intent:g.instanceOf(c).isRequired,location:g.instanceOf(c).isRequired,onChangeAlias:g.func.isRequired,onClose:g.func.isRequired,onOpen:g.func.isRequired,onIsBlockedToggle:g.func.isRequired,onTriggerAI:g.func.isRequired,requirements:g.instanceOf(c).isRequired,repNames:g.instanceOf(c).isRequired,onCreateRequirement:g.func,onDeleteRequirement:g.func,thread:g.instanceOf(c).isRequired,userEmail:g.string},getInitialState:function(){return babelHelpers["extends"]({isEditing:!1},h(this.props.intent))},UNSAFE_componentWillMount:function(){__p&&__p();this._saveIntent=b("debounce")(this._saveIntent,500,this,!0),this._changeHandlers=c().withMutations(function(a){__p&&__p();for(var c=e,d=Array.isArray(c),f=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(d){if(f>=c.length)break;g=c[f++]}else{f=c.next();if(f.done)break;g=f.value}g=g;a.set(g.name,b("OzIntentFactoryHelpers").makeStateUpdater(g.name).bind(this))}}.bind(this))},UNSAFE_componentWillReceiveProps:function(a){var c=this.state.isEditing;if(b("immutable").is(a.intent,this.props.intent)||c)return;this.setState(h(a.intent))},componentWillUnmount:function(){window.clearTimeout(this._editingTimeout)},render:function(){return b("React").createElement(b("OzGenericIntent.react"),babelHelpers["extends"]({},this.props,{notes:this.state.notes,onNotesChange:this._handleNotesChange}),this._renderFields(this.props.location))},_renderFields:a,_handleNotesChange:function(a){this._setStateAndSave({notes:a})},_saveIntent:function(){var a=this.props.intent;b("OzAPI").editIntent(a.get("user-id"),c({id:a.get("id"),params:i(a.get("params"),this.state),notes:this.state.notes}))},_setStateAndSave:function(a){window.clearTimeout(this._editingTimeout),this.setState(babelHelpers["extends"]({isEditing:!0},a),this._saveIntent),this._editingTimeout=window.setTimeout(function(a){return this.setState({isEditing:!1})}.bind(this),f)}})}e.exports=a}),null);
__d("OzIntent.react",["OzAPI","OzHelpers","immutable","OzIntentFactory","OzImmutablePureRenderMixin","React","Reflux","OzConfig","OzWrapper.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("immutable").Map;a=b("React").PropTypes;c=b("React").createClass({displayName:"OzIntent",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{intent:a.instanceOf(g).isRequired,requirements:a.instanceOf(g).isRequired,repNames:a.instanceOf(g).isRequired,location:a.instanceOf(g).isRequired,thread:a.instanceOf(g).isRequired},render:function(){var a=this.props,c=a.intent,d=a.intentMeta,e=a.location,f=a.repNames,g=a.requirements,h=a.thread;a=a.timelineGK;var i=b("OzIntentFactory").get(b("OzHelpers").intentName(c),this.state.config);return b("React").createElement(i,{key:c.get("id"),intent:c,intentMeta:d,onChangeAlias:this._handleChangeAlias,onClose:this._handleClose,onCreateRequirement:this._handleCreateRequirement,onDeleteRequirement:this._handleDeleteRequirement,onOpen:this._handleOpen,onIsBlockedToggle:this._handleIsBlockedToggle,onTriggerAI:this._handleTriggerAI,repNames:f,requirements:g,location:e,thread:h,timelineGK:a})},_handleClose:function(a,c,d){b("OzAPI").closeIntent(b("OzHelpers").threadID(this.props.thread),a,c,d)},_handleOpen:function(a){b("OzAPI").openIntent(b("OzHelpers").threadID(this.props.thread),a)},_handleDeleteRequirement:function(a,c){b("OzAPI").deleteIntentRequirement(b("OzHelpers").threadID(this.props.thread),a,c)},_handleCreateRequirement:function(a,c){b("OzAPI").createIntentRequirement(b("OzHelpers").threadID(this.props.thread),a,c)},_handleChangeAlias:function(a,c){b("OzAPI").editIntent(a.get("user-id"),g({id:a.get("id"),alias:c}))},_handleIsBlockedToggle:function(a){a.get("blocked")?b("OzAPI").unblockIntent(b("OzHelpers").threadID(this.props.thread),a.get("id")):b("OzAPI").blockIntent(b("OzHelpers").threadID(this.props.thread),a.get("id"))},_handleTriggerAI:function(a,c){a=this.props.intent;b("OzAPI").triggerAIForIntent(a.get("user-id"),a.get("id"));window.setTimeout(c,2500)}});e.exports=b("OzWrapper.react")(c)}),null);
__d("OzIntentEvents.react",["cx","OzAPI","OzHelpers","ozFormatTime","immutable","OzConfig","OzDate.react","OzTimestampScrolling.react","React","Reflux","Tooltip","OzActions"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("immutable").Map;var h=b("immutable").List;c=b("React").PropTypes;d=b("React").createClass({displayName:"OzIntentEvents",mixins:[b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{intent:c.instanceOf(a).isRequired},render:function(){var a=this.props.intent;a=(a.get("events")||h()).toList();var c=a.filter(function(a){return a.get("type")==="completed-call"}),d=a.filter(function(a){return a.get("type")==="send-email"||a.get("type")==="receive-email"}),e=a.filter(function(a){return a.get("type")==="send-calendar"});a=a.filter(function(a){return a.get("type")==="book-reservation"&&a.getIn(["data","confirmation-number"])});return b("React").createElement("div",{className:"_4h0y"},b("React").createElement(o,{header:"Calls",events:c,onCallPlay:l}),b("React").createElement(o,{header:"Emails",events:d}),b("React").createElement(o,{header:"Invites",events:e}),b("React").createElement(o,{header:"Reservations",events:a}))}});var i=function(a){b("OzActions").emailComposer.add(babelHelpers["extends"]({},b("OzHelpers").eventToEmail(a),{disabled:!0}))},j=function(a){b("OzActions").emailComposer.add(b("OzHelpers").eventToEmail(b("OzHelpers").reEmail(a)))},k=function(a){b("OzActions").inviteComposer.add(b("OzHelpers").eventToInvite(a))},l=function(a){return b("OzAPI").everstoreURI(a).then(function(a){return window.open(a)})},m=function(a){window.open(a.getIn(["data","opentable-listing","url"]))},n=function(a){return-a.get("id")},o=b("OzHelpers").pure(function(a){var c=a.header;a=a.events;return a&&!a.isEmpty()?b("React").createElement("details",{open:!0},b("React").createElement("summary",{className:"_177e _3_lv"},c,"... (",a.count(),")"),b("React").createElement("div",{className:"_4h0z"},a.map(function(event){return b("React").createElement(p,{orderBy:n,event:event,key:event.get("id")})}))):null}),p=b("OzHelpers").pure(function(a){__p&&__p();var event=a.event;a=a.orderBy;var c=event.get("data");switch(event.get("type")){case"send-email":return b("React").createElement(u,{order:a(event),sign:"@",subtitle:c.get("subject"),actions:[["VIEW",function(a){return i(event)}],["REPLY",function(a){return j(event)}]]},b("React").createElement(r,{data:c,type:"to"}));case"receive-email":return b("React").createElement(u,{order:a(event),sign:"@",subtitle:c.get("subject"),actions:[["VIEW",function(a){return i(b("OzHelpers").switchRecip(event))}],["REPLY",function(a){return j(b("OzHelpers").switchRecip(event))}]]},b("React").createElement(r,{data:c,type:"from"}));case"send-calendar":return b("React").createElement(u,{order:a(event),sign:"@",subtitle:c.get("title"),timestamp:c.get("start"),actions:[["VIEW",function(a){return k(event)}]]},b("React").createElement(s,{data:c}));case"completed-call":return b("React").createElement(t,{event:event,onCallPlay:l,orderBy:a});case"book-reservation":var d=new Date(c.get("ts"));d=b("OzHelpers").toLocaleDate(d)+" at "+b("OzHelpers").toLocaleTime(d);c="Table for "+c.get("covers")+" on "+d;return b("React").createElement(u,{order:a(event),sign:"",subtitle:c,event:event,actions:[["VIEW",function(a){return m(event)}]]});default:return null}}),q=function(a){if(!a)return h();return typeof a.join==="function"?a:h([a])},r=b("OzHelpers").pure(function(a){var c=a.data;a=a.type;var d=(a==="to"?"Sent":"Received")+" at "+b("OzHelpers").toLocaleTime(c.get("sent-at"))+" on "+b("OzHelpers").toLocaleDate(c.get("sent-at"));c=a==="from"?c.get("from"):q(c.get("to")).join(", ");a=a==="to"?"To":"From";return b("React").createElement("span",b("Tooltip").propsFor(d),a," ",b("React").createElement("strong",null,c))}),s=b("OzHelpers").pure(function(a){a=a.data;var c="Sent at "+b("OzHelpers").toLocaleTime(a.get("sent-at"))+" on "+b("OzHelpers").toLocaleDate(a.get("sent-at"));return b("React").createElement("span",b("Tooltip").propsFor(c),b("React").createElement("strong",null,q(a.get("to")).join(", ")||null))}),t=b("OzHelpers").pure(function(a){var event=a.event,c=a.onCallPlay;a=a.orderBy;var d=event.get("data"),e={"in":"Call from",out:"Call to",voicemail:"Voicemail from"}[d.get("direction")],f=b("OzHelpers").parsePhoneNumber(d.get("remote-phone")),g=d.get("RecordingDuration"),h=d.get("recording-ev-handle");d=h?[["PLAY",function(a){return c(h)}]]:[];return b("React").createElement(u,{order:a(event),sign:"#",subtitle:b("ozFormatTime")(+g),timestamp:event.get("timestamp"),actions:d},b("React").createElement("span",null,e," ",b("React").createElement("strong",null,f)))}),u=b("OzHelpers").pure(function(a){var c=a.sign,d=a.children,e=a.subtitle,f=a.actions,g=a.timestamp;a=a.order;return b("React").createElement("div",{className:"_25js",style:{order:a}},b("React").createElement("div",{className:"_4h12"},c),b("React").createElement("div",{className:"_4h18"},b("React").createElement("div",null,d),b("React").createElement("div",null,e,e&&g?b("React").createElement("span",null," \u2014 "):null,g?b("React").createElement(b("OzTimestampScrolling.react"),{timestamp:g},b("React").createElement(b("OzDate.react"),{timestamp:g,className:"_3_lw"})):null)),b("React").createElement("div",{className:"_4h19"},f.map(function(a,c){var d=a[0];a=a[1];return b("React").createElement("div",{key:c},b("React").createElement("button",{key:c,className:"_1-hv _30yy _4h1a",onClick:a},d))})))});e.exports={OzIntentEvents:d,EventContainer:p}}),null);
__d("OzIntentList.react",["cx","OzHelpers","immutable","OzIntentEvents.react","OzSidebarItemHeader.react","OzImmutablePureRenderMixin","React","OzWrapper.react","ReactDOM","ReactRouter-2.0.0"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("OzIntentEvents.react").OzIntentEvents;a=b("React").PropTypes;var i=b("ReactRouter-2.0.0").Link;c=b("React").createClass({displayName:"OzIntentList",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{activeIntentId:a.number,intents:a.instanceOf(b("immutable").List).isRequired,timelineGK:a.bool},componentDidMount:function(){var a=b("ReactDOM").findDOMNode(this.refs[this.props.activeIntentId]);a&&a.scrollIntoViewIfNeeded()},componentDidUpdate:function(a){var c=this.props,d=c.activeIntentId;c=c.isHistory;var e=b("ReactDOM").findDOMNode(this.refs[d]);e&&(a.activeIntentId!==d||a.isHistory!==c)&&e.scrollIntoViewIfNeeded()},render:function(){return b("React").createElement("div",null,this.props.intents.map(this._renderIntent))},_renderIntent:function(a){var c=a.get("id"),d=this.props,e=d.activeIntentId;d=d.timelineGK;e=e===c;return b("React").createElement(j,{ref:c,key:c,intent:a,isExpanded:e,timelineGK:d})}});var j=b("OzHelpers").pure(function(a){var c=a.intent,d=a.isExpanded;a=a.timelineGK;return b("React").createElement("div",null,b("React").createElement(i,{className:"_qsr",to:b("OzHelpers").threadPath({threadid:c.get("user-id"),intentid:c.get("id")})},b("React").createElement(b("OzSidebarItemHeader.react"),{alias:c.get("alias"),className:"_qsu"+(d?" _qsv":""),closedAt:c.get("closed-at"),closeState:c.get("state"),createdAt:c.get("created-at"),isBlocked:c.get("blocked"),isClosed:b("OzHelpers").isClosedIntent(c),label:b("OzHelpers").isOpenIntent(c)&&c.get("assigned-bot")?"BOT":null,skipScrollToTimestamp:!0,title:b("OzHelpers").intentName(c),timelineGK:a})),d&&b("React").createElement(h,{intent:c}))});e.exports=b("OzWrapper.react")(c)}),null);
__d("OzIntentTabs.react",["cx","OzHelpers","immutable","OzImmutablePureRenderMixin","React","ReactRouter-2.0.0"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("ReactRouter-2.0.0").Link;a=b("immutable").List;c=b("React").PropTypes;d=b("React").createClass({displayName:"OzIntentTabs",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{intents:c.instanceOf(a).isRequired,tasks:c.instanceOf(a).isRequired,threadId:c.string.isRequired,activeIntentId:c.number},render:function(){var a=this.props,c=a.activeIntentId,d=a.intents,e=a.tasks;a=a.threadId;return b("React").createElement("div",{className:"_27fz"},b("React").createElement(h,{className:"_27f-"+(c?"":" _27f_"),to:b("OzHelpers").threadPath({threadid:a})},"All tasks"),d.map(function(a){return b("React").createElement(i,{key:a.get("id"),intent:a,tasks:e,activeIntentId:c})}))}});var i=b("OzHelpers").pure(function(a){var c=a.intent,d=a.activeIntentId;a=a.tasks;d=c.get("id")===d;var e=b("OzHelpers").isBlockedIntent(c),f=b("OzHelpers").isClosedIntent(c);a=b("OzHelpers").nextTaskForIntent(c,a);return b("React").createElement(h,{className:"_27f-"+(d?" _27f_":"")+(e||f?" _xpo":""),to:b("OzHelpers").threadPath({threadid:c.get("user-id"),intentid:c.get("id"),taskid:a&&a.get("id")})},c.get("alias",c.get("name")))});e.exports=d}),null);
__d("OzReminderNotesField.react",["OzIntentParamsTextField.react","OzImmutablePureRenderMixin","React","debounce"],(function(a,b,c,d,e,f){"use strict";a=b("React").PropTypes;c=b("React").createClass({displayName:"OzReminderNotesField",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{seedNotes:a.string,onSave:a.func.isRequired},getInitialState:function(){return{notes:this.props.seedNotes||""}},UNSAFE_componentWillMount:function(){this._save=b("debounce")(this._save,750,this,!0)},render:function(){return b("React").createElement(b("OzIntentParamsTextField.react"),{label:"Add notes about this reminder...",onChange:this._handleChange,value:this.state.notes})},_handleChange:function(a){this.setState({notes:a},this._save)},_save:function(){this.props.onSave(this.state.notes)}});e.exports=c}),null);
__d("OzReminderTask.react",["cx","OzAPI","OzHelpers","immutable","OzIntentParamsAbstractField.react","OzIntentParamsStringField.react","OzReminderTaskEditor.react","OzReminderNotesField.react","OzSidebarItemHeader.react","OzImmutablePureRenderMixin","React","ReactRouter-2.0.0","formatDate"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("immutable").Map;c=b("React").PropTypes;var h=b("ReactRouter-2.0.0").Link,i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];d=b("React").createClass({displayName:"OzReminderTask",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{task:c.instanceOf(a).isRequired,repNames:c.instanceOf(a).isRequired,location:c.instanceOf(a).isRequired},render:function(){var a=this.props,c=a.task,d=a.repNames;a=a.location;var e=c.getIn(["data","description"]),f=b("OzHelpers").isUrgentTask(c),g=c.getIn(["data","suggestion"]),h=b("OzHelpers").isClosedTask(c),i=c.get("from");d=d.get(i,i);return b("React").createElement("div",{className:"_wc0"+(f?" _wc2":"")+(b("OzHelpers").isPaidTask(c)?" _3d-l":"")+(h?" _3d-m":"")},b("React").createElement(b("OzSidebarItemHeader.react"),{className:"_1k8u",creator:d,isClosed:h,isExpanded:!0,onToggle:this._handleToggle,onCancel:this._handleCancel,title:e||j(g)},f?b("React").createElement("button",{className:"_1-hv _260v _260w",alt:"Snooze",onClick:this._handleSnooze}):null,h?null:b("React").createElement(b("OzReminderTaskEditor.react"),{layered:!0,onSave:this._handleEdit,seedTask:c,location:a},b("React").createElement("a",{className:"_260y"},b("React").createElement("i",{className:"_5x82"})))),this._renderBody())},_renderBody:function(){var a=this.props.task,c=a.getIn(["schedule","repeat-condition","days"]),d=b("OzHelpers").threadPath({threadid:a.get("user-id"),intentid:a.get("intent-id")}),e=a.get("state")==="waiting"?"Fires on":"Fired on";return b("React").createElement("div",{className:"_wc3"},b("React").createElement("div",{className:"_1k8v _3-ue"},b("React").createElement(h,{to:d},b("React").createElement("span",null,"Go to intent")),this._renderPayment(a),b("React").createElement(b("OzIntentParamsAbstractField.react"),{label:e},b("React").createElement("span",null,b("formatDate")(new Date(a.get("start-at")),"M jS, g:ia"))),b("React").createElement(b("OzIntentParamsAbstractField.react"),{label:"Due"},b("React").createElement("span",null,b("formatDate")(new Date(a.get("deadline")),"M jS, g:ia"))),c&&!c.isEmpty()?b("React").createElement(b("OzIntentParamsAbstractField.react"),{label:"Recurs"},b("React").createElement("span",null,c.size===7?"Every Day":c.sort().map(function(a){return i[a%7]}).toArray().join(" "))):null,b("React").createElement(b("OzReminderNotesField.react"),{seedNotes:a.getIn(["data","notes"])||a.getIn(["data","description"]),onSave:this._handleNotesSave})))},_renderPayment:function(a){var c=a.getIn(["data","suggestion"]);if(!c)return null;var d=a.getIn(["data","credit-card"]),e=c.get("name");return b("React").createElement("div",null,b("React").createElement(b("OzIntentParamsAbstractField.react"),{label:"Link"},b("React").createElement("div",{className:"_3d-q"},b("React").createElement("a",{className:"_3d-r",target:"_blank",href:c.get("target-url"),title:c.get("description")},"Click here to view ",e),d?b("React").createElement("a",{className:"_3d-s",href:"#",title:"Show credit card information",onClick:this._handlePaymentLinkClick}):null)),b("React").createElement(b("OzIntentParamsStringField.react"),{label:"Confirmation #",onSave:this._handleItemNumberSave,placeholder:"Confirmation number",value:a.getIn(["data","item-number"])||""}))},_handleNotesSave:function(a){this._handleEdit(this.props.task.setIn(["data","notes"],a))},_handleItemNumberSave:function(a){this._handleEdit(this.props.task.setIn(["data","item-number"],a))},_handleToggle:function(){var a=this.props.task;b("OzHelpers").isClosedTask(a)?this._handleOpen(a):this._handleComplete(a)},_handleComplete:function(a){b("OzAPI").completeTask(a.get("user-id"),a)},_handleCancel:function(){var a=this.props.task;b("OzAPI").cancelTask(a.get("user-id"),a)},_handleEdit:function(a){return b("OzAPI").editTask(a.get("user-id"),a)},_handleOpen:function(a){b("OzAPI").openTask(a.get("user-id"),a)},_handleSnooze:function(){var a=this.props.task,c=b("OzHelpers").serverNow()+1e3*60*10;b("OzAPI").editTask(a.get("user-id"),a.set("deadline",c))},_handlePaymentLinkClick:function(a){a=this.props.task.getIn(["data","credit-card"]);if(!a)return;var c=this.props.task.getIn(["data","suggestion","amount"])/100,d=a.get("number"),e=a.get("cvv"),f=a.get("month"),g=a.get("year");a=a.get("zip");var h="https://cdn4.iconfinder.com/data/icons/simple-peyment-methods/512/mastercard-128.png";b("OzAPI").notifyExtension({action:"show",title:"Temporary Credit Card Information",desc:"Amount: $"+c+" Number: "+d+" cvv: "+e+" zip: "+a,html:"Amount: $"+c+"<br/>\n      Number: "+d+"<br/>\n      CVV: "+e+"<br/>\n      Month: "+f+"<br/>\n      Year: "+g,id:d,timeout:0,picture:h})}});function j(a){if(!a)return null;var b=a.get("amount")/100;a=a.get("name");return"User paid $"+b+" for "+a}e.exports=d}),null);
__d("OzReminderTasks.react",["cx","OzAPI","OzHelpers","immutable","OzSidebarItemHeader.react","OzStores","OzImmutablePureRenderMixin","React","ReactCSSTransitionGroup","ReactRouter-2.0.0","Reflux"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("OzStores").ActiveThreadStore;var h=b("ReactRouter-2.0.0").Link,i=b("immutable").List,j=b("immutable").Map;c=b("React").PropTypes;d=b("React").createClass({displayName:"OzReminderTasks",propTypes:{isHistory:c.bool,repNames:c.instanceOf(j).isRequired,thread:c.object.isRequired},mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(a,"activeThread")],render:function(){return b("React").createElement("div",{className:"_1x92"},b("React").createElement("h2",{className:"_1x93"},"Reminders for thread"),this._renderTasks())},_handleCreate:function(a){b("OzAPI").createTask(b("OzHelpers").threadID(this.props.thread),a)},_handleClose:function(a){b("OzAPI").completeTask(b("OzHelpers").threadID(this.props.thread),a)},_handleEdit:function(a){return b("OzAPI").editTask(b("OzHelpers").threadID(this.props.thread),a)},_handleOpen:function(a){b("OzAPI").editTask(b("OzHelpers").threadID(this.props.thread),j({id:a.get("id"),state:"dispatched"}))},_handleSnooze:function(a){b("OzAPI").editTask(b("OzHelpers").threadID(this.props.thread),j({id:a.get("id"),deadline:b("OzHelpers").serverNow()+1e3*60*5}))},_renderTasks:function(){var a=this.props,c=a.isHistory,d=a.repNames;a=a.thread;var e=this.state.activeThread.get("activeTask"),f=b("OzHelpers").threadID(a);a=a.get("tasks",i()).filter(function(a){return a.get("type")==="reminder"&&(c?b("OzHelpers").isClosedTask(a):!b("OzHelpers").isClosedTask(a))}).toSeq().sortBy(function(a){return a.get("deadline")}).map(function(a){return b("React").createElement(k,{key:a.get("id"),task:a,isExpanded:a.get("id")===e,repNames:d})});return b("React").createElement("div",{key:f+"-"+!!c,className:"_wc7"},b("React").createElement(b("ReactCSSTransitionGroup"),{transitionName:"oz-fade-in-out",transitionEnterTimeout:300,transitionLeaveTimeout:300},a))}});var k=b("OzHelpers").pure(function(a){var c=a.task,d=a.isExpanded;a=a.repNames;var e=c.getIn(["data","description"]),f=b("OzHelpers").isClosedTask(c),g=c.get("from");a=a.get(g,g);g=c.getIn(["data","suggestion"]);return b("React").createElement(h,{className:"_qsr _wc0"+(b("OzHelpers").isUrgentTask(c)?" _wc2":"")+(b("OzHelpers").isPaidTask(c)?" _3d-l":"")+(f?" _3d-m":""),to:b("OzHelpers").threadPath({threadid:c.get("user-id"),intentid:c.get("intent-id"),taskid:c.get("id")})},b("React").createElement(b("OzSidebarItemHeader.react"),{className:"_1k8u"+(d?" _qsv":""),creator:a,isClosed:f,isExpanded:d,title:e||l(g)||"[No Title]"}))});function l(a){if(!a)return null;var b=a.get("amount")/100;a=a.get("name");return"User paid $"+b+" for "+a}e.exports=d}),null);
__d("OzReminderEditor.react",["cx","InputLabel_DEPRECATED.react","InputLabelLabel_DEPRECATED.react","OzConstants","ContextualLayerAutoFlip","ContextualLayerUpdateOnScroll","DatePickerRestraints","OzHelpers","immutable","InputLabel.react","ReactLayeredComponentMixin_DEPRECATED","LayerHideOnBlur","MessengerButtonReact.bs","OzDateTimePicker.react","React","XUIContextualDialog.react","XUIError.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("OzConstants").REMINDERS,i=b("MessengerButtonReact.bs").jsComponent,j=b("immutable").Map,k=b("immutable").Set;a=b("React").PropTypes;var l=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],m=b("immutable").fromJS({traffic:{label:"Include traffic update",params:[{name:"origin",placeholder:"Origin address",err:"What is the origin address?"},{name:"destination",placeholder:"Destination address",err:"What is the destination address?"}]},weather:{label:"Include weather forecast",params:[{name:"location",placeholder:"City",err:"What city is the forecast for?"},{name:"metric",placeholder:"Celsius or Fahrenheit",err:"You need to set Celsius or Fahrenheit"}]}}),n=b("OzHelpers").pure(function(a){var c=a.action,d=a.errors,e=a.onToggle,f=a.onUpdate,g=a.reminder;a=!!g.getIn(["actions",c]);return b("React").createElement("div",null,b("React").createElement(b("InputLabel_DEPRECATED.react"),{className:"_2_xq"},b("React").createElement("input",{type:"checkbox",checked:a,onChange:function(a){return e(a,g,c)}}),b("React").createElement(b("InputLabelLabel_DEPRECATED.react"),null,m.getIn([c,"label"]))),a&&b("React").createElement("div",null,m.getIn([c,"params"]).map(function(a){var e=a.get("name"),h=["actions",c,e];return b("React").createElement("div",{key:c+"-"+e},b("React").createElement(b("XUIError.react"),{xuiError:d.getIn([c,e])},b("React").createElement("input",{type:a.get("type","text"),className:"_2_xr",placeholder:a.get("placeholder"),value:g.getIn(h),onChange:function(a){return f(a,h)}})))}).valueSeq()))}),o=b("OzHelpers").pure(function(a){var c=a.reminder,d=a.errors,e=a.onToggle,f=a.onUpdate;return b("React").createElement("div",null,b("React").createElement("h3",{className:"_17f0"},"Actions"),m.keySeq().map(function(a){return b("React").createElement(n,{key:a,action:a,reminder:c,errors:d,onToggle:e,onUpdate:f})}).valueSeq())});c=b("React").createClass({displayName:"OzReminderEditor",mixins:[b("ReactLayeredComponentMixin_DEPRECATED")],propTypes:{onSave:a.func.isRequired,seedReminder:a.instanceOf(j),timezone:a.string},getInitialState:function(){return{shown:!1,reminder:this.props.seedReminder||j(),timezone:this.props.timezone,errors:j()}},UNSAFE_componentWillReceiveProps:function(a){b("immutable").is(a.seedReminder,this.props.seedReminder)||this.setState({reminder:a.seedReminder,errors:j()})},render:function(){var a=b("React").Children.only(this.props.children);return b("React").cloneElement(a,{onClick:function(a){return this.setState({shown:!this.state.shown})}.bind(this)})},renderLayers:function(){__p&&__p();var a=this.state,c=a.shown,d=a.reminder;a=a.errors;if(!c)return null;var e=k(d.get("days"));return{contextualDialog:b("React").createElement(b("XUIContextualDialog.react"),{autoFocus:!1,behaviors:{ContextualLayerAutoFlip:b("ContextualLayerAutoFlip"),ContextualLayerUpdateOnScroll:b("ContextualLayerUpdateOnScroll"),LayerHideOnBlur:b("LayerHideOnBlur")},position:"below",shown:c,contextRef:function(){return this}.bind(this),onToggle:function(a){return this.setState({shown:a})}.bind(this)},b("React").createElement("ul",{className:"_3ssq"},b("React").createElement("div",{className:"_wbu"},b("React").createElement(b("OzDateTimePicker.react"),babelHelpers["extends"]({xuiError:a.get("scheduled-time"),className:"_wbv",showTimezoneName:!1,timestamp:d.get("scheduled-time",b("OzHelpers").serverNow()),timezone:this.state.timezone,onChange:function(a){var b=a.timestamp;a=a.timezone;this.setState({reminder:d.set("scheduled-time",+b),timezone:a})}.bind(this)},b("OzHelpers").dateRestraints())),b("React").createElement(b("XUIError.react"),{xuiError:a.get("description")},b("React").createElement("input",{ref:"input",className:"_wbw",placeholder:"Describe the Reminder",value:d.getIn(["body","description"]),onChange:function(a){this.setState({reminder:d.setIn(["body","description"],a.target.value)})}.bind(this)})),b("React").createElement("h3",{className:"_17f0"},"Recurrence"),l.map(function(a,c){var f=c+1;return b("React").createElement(b("InputLabel.react"),{className:"_2_xq",key:c,label:a},b("React").createElement("input",{type:"checkbox",checked:e.has(f),onChange:function(a){a=a.target.checked?e.add(f):e["delete"](f);this.setState({reminder:d.set("days",a.toList())})}.bind(this)}))}.bind(this)),b("React").createElement(o,{reminder:d,errors:a,onToggle:this._handleActionToggle,onUpdate:this._handleActionUpdate}),b("React").createElement("div",{className:"_wbz"},b("React").createElement(i,{label:this.props.seedReminder?"Update Reminder":"Add Reminder",onClick:this._handleSave,type:"primary"})))))}},_handleActionToggle:function(a,b,c){a=a.target.checked?b.set("actions",j([[c,j()]])):b["delete"]("actions");this.setState({reminder:a})},_handleActionUpdate:function(a,b){this.setState({reminder:this.state.reminder.setIn(b,a.target.value)})},_handleSave:function(){__p&&__p();var a=this.state.reminder,c=a.get("scheduled-time"),d=function(b){return!!a.getIn(["actions",b])},e=j(),f=b("OzHelpers").dateRestraints().dateRestraints;!c?e=e.set("scheduled-time","When would you like the reminder?"):c<b("OzHelpers").serverNow()+60*1e3?e=e.set("scheduled-time","Reminders should be in the future!"):b("DatePickerRestraints").isValidDate(new Date(c),f)||(e=e.set("scheduled-time","Reminder is outside of the "+h.RANGE_IN_YEARS+" year range"));a.getIn(["body","description"])||(e=e.set("description","What is the reminder about?"));e=m.reduce(function(b,c,e){d(e)&&(b=c.get("params").reduce(function(b,c){return a.getIn(["actions",e,c.get("name")])?b:b.setIn([e,c.get("name")],c.get("err"))},b));return b},e);this.setState({errors:e});if(e.size)return;this.setState({reminder:j(),shown:!1},function(b){return this.props.onSave(a)}.bind(this))}});e.exports=c}),null);
__d("OzReminder.react",["cx","invariant","OzAPI","OzHelpers","Event","immutable","OzIntentParamsAbstractField.react","OzIntentParamsStringField.react","OzReminderEditor.react","OzReminderNotesField.react","OzSidebarItemHeader.react","OzImmutablePureRenderMixin","React","XUICloseButton.react","formatDate"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();b("immutable").List;a=b("immutable").Map;c=b("React").PropTypes;var i=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];d=b("React").createClass({displayName:"OzReminder",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{onClose:c.func.isRequired,onEdit:c.func.isRequired,onOpen:c.func.isRequired,onSnooze:c.func.isRequired,reminder:c.instanceOf(a).isRequired,repNames:c.instanceOf(a).isRequired,timezone:c.string},getInitialState:function(){return{isExpanded:b("OzHelpers").isUrgentReminder(this.props.reminder)}},UNSAFE_componentWillReceiveProps:function(a){a.reminder.get("id")===this.props.reminder.get("id")&&b("OzHelpers").isUrgentReminder(a.reminder)&&!b("OzHelpers").isUrgentReminder(this.props.reminder)&&this.setState({isExpanded:!0})},render:function(){var a=this.props,c=a.onEdit,d=a.onSnooze,e=a.reminder,f=a.repNames;a=a.timezone;var g=e.getIn(["body","description"]),h=b("OzHelpers").isUrgentReminder(e),i=e.getIn(["body","suggestion"]),k=e.get("state")==="closed",l=e.get("creator-fbid");f=f.get(l,l);return b("React").createElement("div",{className:"_wc0"+(h?" _wc2":"")+(b("OzHelpers").isPaidReminder(e)?" _3d-l":"")+(k?" _3d-m":"")},b("React").createElement(b("OzSidebarItemHeader.react"),{className:"_1k8u",creator:f,isClosed:k,isExpanded:this.state.isExpanded,onIsExpandedToggle:this._handleIsExpandedToggle,onToggle:this._handleToggle,subtitle:b("OzHelpers").isSnoozedReminder(e)?"(snoozed)":null,title:g||j(i)||"[No Title]"},h?b("React").createElement("button",{className:"_1-hv _260v _260w",alt:"Snooze",onClick:function(a){return d(e)}}):null,b("React").createElement(b("OzReminderEditor.react"),{onSave:c,seedReminder:e,timezone:a},b("React").createElement("a",{className:"_260y"},b("React").createElement("i",{className:"_5x82"})))),this._renderBody())},_renderBody:function(){if(!this.state.isExpanded)return null;var a=this.props.reminder,c=a.get("scheduled-time"),d=a.get("last-fired"),e=a.get("state")==="closed",f=b("OzHelpers").isUrgentReminder(a);c=a.get("state")==="snoozed"&&d||c>b("OzHelpers").serverNow()&&c;f=(f||e)&&d;e=a.get("days");return b("React").createElement("div",{className:"_wc3"},b("React").createElement("div",{className:"_1k8v _3-ue"},this._renderPayment(a),f?b("React").createElement(b("OzIntentParamsAbstractField.react"),{label:"Fired On"},b("React").createElement("span",null,b("formatDate")(new Date(f),"M jS, g:ia"))):null,c?b("React").createElement(b("OzIntentParamsAbstractField.react"),{label:"Will Fire On"},b("React").createElement("span",null,b("formatDate")(new Date(c),"M jS, g:ia"))):null,e&&!e.isEmpty()?b("React").createElement(b("OzIntentParamsAbstractField.react"),{label:"Recurs"},b("React").createElement("span",null,e.size===7?"Every Day":e.sort().map(function(a){return i[a%7]}).toArray().join(" "))):null,b("React").createElement(b("OzReminderNotesField.react"),{seedNotes:a.get("notes")||a.getIn(["body","description"]),onSave:this._handleNotesSave})))},_renderPayment:function(a){var c=a.getIn(["body","suggestion"]);if(!c)return null;var d=a.getIn(["body","credit-card"]),e=c.get("name");return b("React").createElement("div",null,b("React").createElement(b("OzIntentParamsAbstractField.react"),{label:"Link"},b("React").createElement("div",{className:"_3d-q"},b("React").createElement("a",{className:"_3d-r",target:"_blank",href:c.get("target-url"),title:c.get("description")},"Click here to view ",e),d?b("React").createElement("a",{className:"_3d-s",href:"#",title:"Show credit card information",onClick:this._handlePaymentLinkClick}):null)),b("React").createElement(b("OzIntentParamsStringField.react"),{label:"Confirmation #",onSave:this._handleItemNumberSave,placeholder:"Confirmation number",value:a.getIn(["body","item-number"])||""}))},_handleIsExpandedToggle:function(){this.setState({isExpanded:!this.state.isExpanded})},_handleNotesSave:function(a){this.props.onEdit(this.props.reminder.set("notes",a))},_handleItemNumberSave:function(a){this.props.onEdit(this.props.reminder.setIn(["body","item-number"],a))},_handleToggle:function(a){var b=this.props,c=b.onClose,d=b.onOpen;b=b.reminder;a?c(b):d(b)},_handlePaymentLinkClick:function(a){a=this.props.reminder.getIn(["body","credit-card"]);if(!a)return;var c=this.props.reminder.getIn(["body","suggestion","amount"])/100,d=a.get("number"),e=a.get("cvv"),f=a.get("month"),g=a.get("year");a=a.get("zip");b("OzAPI").notifyExtension({action:"show",title:"Temporary Credit Card Information",desc:"Amount: $"+c+" Number: "+d+" cvv: "+e+" zip: "+a,html:"Amount: $"+c+"<br/>\n      Number: "+d+"<br/>\n      CVV: "+e+"<br/>\n      Month: "+f+"<br/>\n      Year: "+g,id:d,timeout:0,picture:"https://cdn4.iconfinder.com/data/icons/simple-peyment-methods/512/mastercard-128.png"})}});function j(a){if(!a)return null;var b=a.get("amount")/100;a=a.get("name");return"User paid $"+b+" for "+a}e.exports=d}),null);
__d("OzReminders.react",["cx","OzAPI","OzHelpers","immutable","OzReminder.react","OzReminderEditor.react","React","OzWrapper.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("immutable").List;c=b("immutable").Map;d=b("React").PropTypes;f=babelHelpers.inherits(a,b("React").Component);h=f&&f.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$2=function(a){b("OzAPI").createReminder(b("OzHelpers").threadID(this.props.thread),a)}.bind(this),this.$3=function(a){b("OzAPI").closeReminder(b("OzHelpers").threadID(this.props.thread),a.get("id"),!!a.get("days")&&a.get("state")==="pending")}.bind(this),this.$4=function(a){b("OzAPI").editReminder(b("OzHelpers").threadID(this.props.thread),a)}.bind(this),this.$5=function(a){b("OzAPI").editReminder(b("OzHelpers").threadID(this.props.thread),a.set("state","pending"))}.bind(this),this.$6=function(a){b("OzAPI").snoozeReminder(b("OzHelpers").threadID(this.props.thread),a.get("id"))}.bind(this),this.$1=function(){var a=this.props,c=a.isHistory,d=a.repNames,e=a.thread;a=b("OzHelpers").threadID(e);var f=e.get("reminders",i()).sortBy(function(a){return a.get("last-fired")||a.get("scheduled-time")}).toSeq().filter(function(a){return c?a.get("state")==="closed":a.get("state")!=="closed"}).map(function(a){return b("React").createElement(b("OzReminder.react"),{key:a.get("id"),onClose:this.$3,onEdit:this.$4,onOpen:this.$5,onSnooze:this.$6,reminder:a,repNames:d,timezone:b("OzHelpers").timezone(e)})}.bind(this));return b("React").createElement("div",{key:a+"-"+!!c,className:"_wc7"},f)}.bind(this),c}a.prototype.render=function(){"use strict";return b("React").createElement("div",{className:"_1x92"},b("React").createElement("h2",{className:"_1x93"},"Reminders"),this.$1(),this.props.isHistory?null:b("React").createElement(b("OzReminderEditor.react"),{onSave:this.$2,timezone:b("OzHelpers").timezone(this.props.thread)},b("React").createElement("a",{className:"_59jg"},b("React").createElement("div",{className:"_4nd4"}),b("React").createElement("span",{className:"_59jh"},"Add a reminder..."))))};a.propTypes={isHistory:d.bool,repNames:d.instanceOf(c).isRequired,thread:d.object.isRequired};e.exports=b("OzWrapper.react")(a)}),null);
/**
 * License: https://www.facebook.com/legal/license/QIfaZ2ZbvZG/
 */
__d("CajaHTMLSanitizer",[],(function(a,b,c,d,e,f){__p&&__p();var g=1,h=2,i=4,j=8,k=16,l=64,m=512,n=1024,o=function(){var a=[["aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","snow","springgreen","steelblue","tan","teal","thistle","tomato","transparent","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen"],["all-scroll","col-resize","crosshair","default","e-resize","hand","help","move","n-resize","ne-resize","no-drop","not-allowed","nw-resize","pointer","progress","row-resize","s-resize","se-resize","sw-resize","text","vertical-text","w-resize","wait"],["armenian","decimal","decimal-leading-zero","disc","georgian","lower-alpha","lower-greek","lower-latin","lower-roman","square","upper-alpha","upper-latin","upper-roman"],["100","200","300","400","500","600","700","800","900","bold","bolder","lighter"],["block-level","inline-level","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row","table-row-group"],["condensed","expanded","extra-condensed","extra-expanded","narrower","semi-condensed","semi-expanded","ultra-condensed","ultra-expanded","wider"],["inherit","inline","inline-block","inline-box","inline-flex","inline-grid","inline-list-item","inline-stack","inline-table","run-in"],["behind","center-left","center-right","far-left","far-right","left-side","leftwards","right-side","rightwards"],["large","larger","small","smaller","x-large","x-small","xx-large","xx-small"],["dashed","dotted","double","groove","outset","ridge","solid"],["ease","ease-in","ease-in-out","ease-out","linear","step-end","step-start"],["at","closest-corner","closest-side","ellipse","farthest-corner","farthest-side"],["baseline","middle","sub","super","text-bottom","text-top"],["caption","icon","menu","message-box","small-caption","status-bar"],["fast","faster","slow","slower","x-fast","x-slow"],["above","below","higher","level","lower"],["cursive","fantasy","monospace","sans-serif","serif"],["loud","silent","soft","x-loud","x-soft"],["no-repeat","repeat-x","repeat-y","round","space"],["blink","line-through","overline","underline"],["block","flex","grid","table"],["high","low","x-high","x-low"],["nowrap","pre","pre-line","pre-wrap"],["absolute","relative","static"],["alternate","alternate-reverse","reverse"],["border-box","content-box","padding-box"],["capitalize","lowercase","uppercase"],["child","female","male"],["=","opacity"],["backwards","forwards"],["bidi-override","embed"],["bottom","top"],["break-all","keep-all"],["clip","ellipsis"],["contain","cover"],["continuous","digits"],["end","start"],["flat","preserve-3d"],["hide","show"],["horizontal","vertical"],["inside","outside"],["italic","oblique"],["left","right"],["ltr","rtl"],["no-content","no-display"],["paused","running"],["suppress","unrestricted"],["thick","thin"],[","],["/"],["all"],["always"],["auto"],["avoid"],["both"],["break-word"],["center"],["circle"],["code"],["collapse"],["contents"],["fixed"],["hidden"],["infinite"],["inset"],["invert"],["justify"],["list-item"],["local"],["medium"],["mix"],["none"],["normal"],["once"],["repeat"],["scroll"],["separate"],["small-caps"],["spell-out"],["to"],["visible"]];a={animation:{cssPropBits:517,cssLitGroup:[a[10],a[24],a[29],a[45],a[48],a[54],a[63],a[71],a[72]],cssFns:["cubic-bezier()","steps()"]},"animation-delay":{cssPropBits:5,cssLitGroup:[a[48]],cssFns:[]},"animation-direction":{cssPropBits:0,cssLitGroup:[a[24],a[48],a[72]],cssFns:[]},"animation-duration":"animation-delay","animation-fill-mode":{cssPropBits:0,cssLitGroup:[a[29],a[48],a[54],a[71]],cssFns:[]},"animation-iteration-count":{cssPropBits:5,cssLitGroup:[a[48],a[63]],cssFns:[]},"animation-name":{cssPropBits:512,cssLitGroup:[a[48],a[71]],cssFns:[]},"animation-play-state":{cssPropBits:0,cssLitGroup:[a[45],a[48]],cssFns:[]},"animation-timing-function":{cssPropBits:0,cssLitGroup:[a[10],a[48]],cssFns:["cubic-bezier()","steps()"]},appearance:{cssPropBits:0,cssLitGroup:[a[71]],cssFns:[]},azimuth:{cssPropBits:5,cssLitGroup:[a[7],a[42],a[56]],cssFns:[]},"backface-visibility":{cssPropBits:0,cssLitGroup:[a[59],a[62],a[80]],cssFns:[]},background:{cssPropBits:23,cssLitGroup:[a[0],a[18],a[25],a[31],a[34],a[42],a[48],a[49],a[52],a[56],a[61],a[68],a[71],a[74],a[75]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()","rgb()","rgba()"]},"background-attachment":{cssPropBits:0,cssLitGroup:[a[48],a[61],a[68],a[75]],cssFns:[]},"background-color":{cssPropBits:2,cssLitGroup:[a[0]],cssFns:["rgb()","rgba()"]},"background-image":{cssPropBits:16,cssLitGroup:[a[48],a[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"background-position":{cssPropBits:5,cssLitGroup:[a[31],a[42],a[48],a[56]],cssFns:[]},"background-repeat":{cssPropBits:0,cssLitGroup:[a[18],a[48],a[74]],cssFns:[]},"background-size":{cssPropBits:5,cssLitGroup:[a[34],a[48],a[52]],cssFns:[]},border:{cssPropBits:7,cssLitGroup:[a[0],a[9],a[47],a[62],a[64],a[69],a[71]],cssFns:["rgb()","rgba()"]},"border-bottom":"border","border-bottom-color":"background-color","border-bottom-left-radius":{cssPropBits:5,cssFns:[]},"border-bottom-right-radius":"border-bottom-left-radius","border-bottom-style":{cssPropBits:0,cssLitGroup:[a[9],a[62],a[64],a[71]],cssFns:[]},"border-bottom-width":{cssPropBits:5,cssLitGroup:[a[47],a[69]],cssFns:[]},"border-collapse":{cssPropBits:0,cssLitGroup:[a[59],a[76]],cssFns:[]},"border-color":"background-color","border-left":"border","border-left-color":"background-color","border-left-style":"border-bottom-style","border-left-width":"border-bottom-width","border-radius":{cssPropBits:5,cssLitGroup:[a[49]],cssFns:[]},"border-right":"border","border-right-color":"background-color","border-right-style":"border-bottom-style","border-right-width":"border-bottom-width","border-spacing":"border-bottom-left-radius","border-style":"border-bottom-style","border-top":"border","border-top-color":"background-color","border-top-left-radius":"border-bottom-left-radius","border-top-right-radius":"border-bottom-left-radius","border-top-style":"border-bottom-style","border-top-width":"border-bottom-width","border-width":"border-bottom-width",bottom:{cssPropBits:5,cssLitGroup:[a[52]],cssFns:[]},box:{cssPropBits:0,cssLitGroup:[a[60],a[71],a[72]],cssFns:[]},"box-shadow":{cssPropBits:7,cssLitGroup:[a[0],a[48],a[64],a[71]],cssFns:["rgb()","rgba()"]},"box-sizing":{cssPropBits:0,cssLitGroup:[a[25]],cssFns:[]},"caption-side":{cssPropBits:0,cssLitGroup:[a[31]],cssFns:[]},clear:{cssPropBits:0,cssLitGroup:[a[42],a[54],a[71]],cssFns:[]},clip:{cssPropBits:0,cssLitGroup:[a[52]],cssFns:["rect()"]},color:"background-color",content:{cssPropBits:8,cssLitGroup:[a[71],a[72]],cssFns:[]},cue:{cssPropBits:16,cssLitGroup:[a[71]],cssFns:[]},"cue-after":"cue","cue-before":"cue",cursor:{cssPropBits:16,cssLitGroup:[a[1],a[48],a[52]],cssFns:[]},direction:{cssPropBits:0,cssLitGroup:[a[43]],cssFns:[]},display:{cssPropBits:0,cssLitGroup:[a[4],a[6],a[20],a[52],a[67],a[71]],cssFns:[]},"display-extras":{cssPropBits:0,cssLitGroup:[a[67],a[71]],cssFns:[]},"display-inside":{cssPropBits:0,cssLitGroup:[a[20],a[52]],cssFns:[]},"display-outside":{cssPropBits:0,cssLitGroup:[a[4],a[71]],cssFns:[]},elevation:{cssPropBits:5,cssLitGroup:[a[15]],cssFns:[]},"empty-cells":{cssPropBits:0,cssLitGroup:[a[38]],cssFns:[]},filter:{cssPropBits:0,cssFns:["alpha()"]},"float":{cssPropBits:0,cssLitGroup:[a[42],a[71]],cssFns:[]},font:{cssPropBits:73,cssLitGroup:[a[3],a[8],a[13],a[16],a[41],a[48],a[49],a[69],a[72],a[77]],cssFns:[]},"font-family":{cssPropBits:72,cssLitGroup:[a[16],a[48]],cssFns:[]},"font-size":{cssPropBits:1,cssLitGroup:[a[8],a[69]],cssFns:[]},"font-stretch":{cssPropBits:0,cssLitGroup:[a[5],a[72]],cssFns:[]},"font-style":{cssPropBits:0,cssLitGroup:[a[41],a[72]],cssFns:[]},"font-variant":{cssPropBits:0,cssLitGroup:[a[72],a[77]],cssFns:[]},"font-weight":{cssPropBits:0,cssLitGroup:[a[3],a[72]],cssFns:[]},height:"bottom",left:"bottom","letter-spacing":{cssPropBits:5,cssLitGroup:[a[72]],cssFns:[]},"line-height":{cssPropBits:1,cssLitGroup:[a[72]],cssFns:[]},"list-style":{cssPropBits:16,cssLitGroup:[a[2],a[40],a[57],a[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"list-style-image":{cssPropBits:16,cssLitGroup:[a[71]],cssFns:["image()","linear-gradient()","radial-gradient()","repeating-linear-gradient()","repeating-radial-gradient()"]},"list-style-position":{cssPropBits:0,cssLitGroup:[a[40]],cssFns:[]},"list-style-type":{cssPropBits:0,cssLitGroup:[a[2],a[57],a[71]],cssFns:[]},margin:"bottom","margin-bottom":"bottom","margin-left":"bottom","margin-right":"bottom","margin-top":"bottom","max-height":{cssPropBits:1,cssLitGroup:[a[52],a[71]],cssFns:[]},"max-width":"max-height","min-height":{cssPropBits:1,cssLitGroup:[a[52]],cssFns:[]},"min-width":"min-height",opacity:{cssPropBits:1,cssFns:[]},outline:{cssPropBits:7,cssLitGroup:[a[0],a[9],a[47],a[62],a[64],a[65],a[69],a[71]],cssFns:["rgb()","rgba()"]},"outline-color":{cssPropBits:2,cssLitGroup:[a[0],a[65]],cssFns:["rgb()","rgba()"]},"outline-style":"border-bottom-style","outline-width":"border-bottom-width",overflow:{cssPropBits:0,cssLitGroup:[a[52],a[62],a[75],a[80]],cssFns:[]},"overflow-wrap":{cssPropBits:0,cssLitGroup:[a[55],a[72]],cssFns:[]},"overflow-x":{cssPropBits:0,cssLitGroup:[a[44],a[52],a[62],a[75],a[80]],cssFns:[]},"overflow-y":"overflow-x",padding:"opacity","padding-bottom":"opacity","padding-left":"opacity","padding-right":"opacity","padding-top":"opacity","page-break-after":{cssPropBits:0,cssLitGroup:[a[42],a[51],a[52],a[53]],cssFns:[]},"page-break-before":"page-break-after","page-break-inside":{cssPropBits:0,cssLitGroup:[a[52],a[53]],cssFns:[]},pause:"border-bottom-left-radius","pause-after":"border-bottom-left-radius","pause-before":"border-bottom-left-radius",perspective:{cssPropBits:5,cssLitGroup:[a[71]],cssFns:[]},"perspective-origin":{cssPropBits:5,cssLitGroup:[a[31],a[42],a[56]],cssFns:[]},pitch:{cssPropBits:5,cssLitGroup:[a[21],a[69]],cssFns:[]},"pitch-range":"border-bottom-left-radius","play-during":{cssPropBits:16,cssLitGroup:[a[52],a[70],a[71],a[74]],cssFns:[]},position:{cssPropBits:0,cssLitGroup:[a[23]],cssFns:[]},quotes:{cssPropBits:8,cssLitGroup:[a[71]],cssFns:[]},resize:{cssPropBits:0,cssLitGroup:[a[39],a[54],a[71]],cssFns:[]},richness:"border-bottom-left-radius",right:"bottom",speak:{cssPropBits:0,cssLitGroup:[a[71],a[72],a[78]],cssFns:[]},"speak-header":{cssPropBits:0,cssLitGroup:[a[51],a[73]],cssFns:[]},"speak-numeral":{cssPropBits:0,cssLitGroup:[a[35]],cssFns:[]},"speak-punctuation":{cssPropBits:0,cssLitGroup:[a[58],a[71]],cssFns:[]},"speech-rate":{cssPropBits:5,cssLitGroup:[a[14],a[69]],cssFns:[]},stress:"border-bottom-left-radius","table-layout":{cssPropBits:0,cssLitGroup:[a[52],a[61]],cssFns:[]},"text-align":{cssPropBits:0,cssLitGroup:[a[42],a[56],a[66]],cssFns:[]},"text-decoration":{cssPropBits:0,cssLitGroup:[a[19],a[71]],cssFns:[]},"text-indent":"border-bottom-left-radius","text-overflow":{cssPropBits:8,cssLitGroup:[a[33]],cssFns:[]},"text-shadow":"box-shadow","text-transform":{cssPropBits:0,cssLitGroup:[a[26],a[71]],cssFns:[]},"text-wrap":{cssPropBits:0,cssLitGroup:[a[46],a[71],a[72]],cssFns:[]},top:"bottom",transform:{cssPropBits:0,cssLitGroup:[a[71]],cssFns:["matrix()","perspective()","rotate()","rotate3d()","rotatex()","rotatey()","rotatez()","scale()","scale3d()","scalex()","scaley()","scalez()","skew()","skewx()","skewy()","translate()","translate3d()","translatex()","translatey()","translatez()"]},"transform-origin":"perspective-origin","transform-style":{cssPropBits:0,cssLitGroup:[a[37]],cssFns:[]},transition:{cssPropBits:1029,cssLitGroup:[a[10],a[48],a[50],a[71]],cssFns:["cubic-bezier()","steps()"]},"transition-delay":"animation-delay","transition-duration":"animation-delay","transition-property":{cssPropBits:1024,cssLitGroup:[a[48],a[50]],cssFns:[]},"transition-timing-function":"animation-timing-function","unicode-bidi":{cssPropBits:0,cssLitGroup:[a[30],a[72]],cssFns:[]},"vertical-align":{cssPropBits:5,cssLitGroup:[a[12],a[31]],cssFns:[]},visibility:"backface-visibility","voice-family":{cssPropBits:8,cssLitGroup:[a[27],a[48]],cssFns:[]},volume:{cssPropBits:1,cssLitGroup:[a[17],a[69]],cssFns:[]},"white-space":{cssPropBits:0,cssLitGroup:[a[22],a[72]],cssFns:[]},width:"min-height","word-break":{cssPropBits:0,cssLitGroup:[a[32],a[72]],cssFns:[]},"word-spacing":"letter-spacing","word-wrap":"overflow-wrap","z-index":"bottom",zoom:"line-height","cubic-bezier()":"animation-delay","steps()":{cssPropBits:5,cssLitGroup:[a[36],a[48]],cssFns:[]},"image()":{cssPropBits:18,cssLitGroup:[a[0],a[48]],cssFns:["rgb()","rgba()"]},"linear-gradient()":{cssPropBits:7,cssLitGroup:[a[0],a[31],a[42],a[48],a[79]],cssFns:["rgb()","rgba()"]},"radial-gradient()":{cssPropBits:7,cssLitGroup:[a[0],a[11],a[31],a[42],a[48],a[56],a[57]],cssFns:["rgb()","rgba()"]},"repeating-linear-gradient()":"linear-gradient()","repeating-radial-gradient()":"radial-gradient()","rgb()":{cssPropBits:1,cssLitGroup:[a[48]],cssFns:[]},"rgba()":"rgb()","rect()":{cssPropBits:5,cssLitGroup:[a[48],a[52]],cssFns:[]},"alpha()":{cssPropBits:1,cssLitGroup:[a[28]],cssFns:[]},"matrix()":"animation-delay","perspective()":"border-bottom-left-radius","rotate()":"border-bottom-left-radius","rotate3d()":"animation-delay","rotatex()":"border-bottom-left-radius","rotatey()":"border-bottom-left-radius","rotatez()":"border-bottom-left-radius","scale()":"animation-delay","scale3d()":"animation-delay","scalex()":"border-bottom-left-radius","scaley()":"border-bottom-left-radius","scalez()":"border-bottom-left-radius","skew()":"animation-delay","skewx()":"border-bottom-left-radius","skewy()":"border-bottom-left-radius","translate()":"animation-delay","translate3d()":"animation-delay","translatex()":"border-bottom-left-radius","translatey()":"border-bottom-left-radius","translatez()":"border-bottom-left-radius"};for(var b in a)"string"===typeof a[b]&&Object.hasOwnProperty.call(a,b)&&(a[b]=a[a[b]]);return a}();typeof window!=="undefined"&&(window.cssSchema=o);var p,q;(function(){__p&&__p();function a(a){var b=parseInt(a.substring(1),16);if(b>65535)return b-=65536,String.fromCharCode(55296+(b>>10),56320+(b&1023));else if(b==b)return String.fromCharCode(b);else if(a[1]<" ")return"";else return a[1]}function b(a,b){return'"'+a.replace(/[\u0000-\u001f\\\"<>]/g,b)+'"'}function c(a){return e[a]||(e[a]="\\"+a.charCodeAt(0).toString(16)+" ")}function d(a){return f[a]||(f[a]=(a<"\x10"?"%0":"%")+a.charCodeAt(0).toString(16))}var e={"\\":"\\\\"},f={"\\":"%5c"},g="[\\t\\n\\f ]",h=g+"*",i="[\\n\\f]",j="[\\ud800-\\udbff][\\udc00-\\udfff]",k="[\\u0080-\\ud7ff\\ue000-\\ufffd]|"+j,l="[0-9a-fA-F]{1,6}"+g+"?";"\\\\"+l;l="(?:"+l+"|[\\u0020-\\u007e\\u0080-\\ud7ff\\ue000\\ufffd]|"+j+")";j="\\\\"+l;var m="(?:[\\t\\x21\\x23-\\x26\\x28-\\x5b\\x5d-\\x7e]|"+k+"|"+j+")",n="[^'\"\\n\\f\\\\]|\\\\[\\s\\S]";n="\"(?:'|"+n+')*"|\'(?:"|'+n+")*'";var o="[-+]?(?:[0-9]+(?:[.][0-9]+)?|[.][0-9]+)",r="(?:[a-zA-Z_]|"+k+"|"+j+")";k="(?:[a-zA-Z0-9_-]|"+k+"|"+j+")";j=k+"+";var s="-?"+r+k+"*";"@"+s;"#"+j;o;j="(?:@?-?"+r+"|#)"+k+"*";o+"%";o+s;r=o+"(?:%|"+s+")?";k="url[(]"+h+"(?:"+n+"|"+m+"*)"+h+"[)]";o="U[+][0-9A-F?]{1,6}(?:-[0-9A-F]{1,6})?";var t="<!--",u="-->";m=g+"+";g="/(?:[*][^*]*[*]+(?:[^/][^*]*[*]+)*/|/[^\\n\\f]*)";s="(?!url[(])"+s+"[(]";var v="[~|^$*]=",w="[^\"'\\\\/]|/(?![/*])",x="\\uFEFF",y=new RegExp([x,o,k,s,j,n,r,t,u,m,g,v,w].join("|"),"gi"),z=new RegExp("\\\\(?:"+l+"|"+i+")","g"),A=new RegExp("^url\\("+h+"[\"']?|[\"']?"+h+"\\)$","gi");q=function(b){return b.replace(z,a)};p=function(a){__p&&__p();a=("\uffff"+a).replace(/^\uffff/,"");a=a.replace(/\r\n?/g,"\n");a=a.match(y)||[];var e=0,f=" ";for(var g=0,h=a.length;g<h;++g){var i=q(a[g]),j=i.length,k=i.charCodeAt(0);i=k=='"'.charCodeAt(0)||k=="'".charCodeAt(0)?b(i.substring(1,j-1),c):k=="/".charCodeAt(0)&&j>1||i=="\\"||i==u||i==t||i=="\ufeff"||k<=" ".charCodeAt(0)?" ":/url\(/i.test(i)?"url("+b(i.replace(A,""),d)+")":i;(f!=i||i!=" ")&&(a[e++]=f=i)}a.length=e;return a}})();typeof window!=="undefined"&&(window.lexCss=p,window.decodeCss=q);var r=function(){__p&&__p();function b(b){b=(""+b).match(n);return!b?null:new a(m(b[1]),m(b[2]),m(b[3]),m(b[4]),m(b[5]),m(b[6]),m(b[7]))}function c(b,c,g,h,i,j,k){b=new a(e(b,o),e(c,o),d(g),h>0?h.toString():null,e(i,p),null,d(k));j&&("string"===typeof j?b.setRawQuery(j.replace(/[^?&=0-9A-Za-z_\-~.%]/g,f)):b.setAllParameters(j));return b}function d(a){return"string"==typeof a?encodeURIComponent(a):null}function e(a,b){return"string"==typeof a?encodeURI(a).replace(b,f):null}function f(a){a=a.charCodeAt(0);return"%"+"0123456789ABCDEF".charAt(a>>4&15)+"0123456789ABCDEF".charAt(a&15)}function g(a){return a.replace(/(^|\/)\.(?:\/|$)/g,"$1").replace(/\/{2,}/g,"/")}var h=new RegExp("(/|^)(?:[^./][^/]*|\\.{2,}(?:[^./][^/]*)|\\.{3,}[^/]*)/\\.\\.(?:/|$)"),i=new RegExp(h),j=/^(?:\.\.\/)*(?:\.\.$)?/;function k(a){if(a===null)return null;a=g(a);var b=i;for(var c;(c=a.replace(b,"$1"))!=a;a=c);return a}function l(a,b){__p&&__p();a=a.clone();var c=b.hasScheme();c?a.setRawScheme(b.getRawScheme()):c=b.hasCredentials();c?a.setRawCredentials(b.getRawCredentials()):c=b.hasDomain();c?a.setRawDomain(b.getRawDomain()):c=b.hasPort();var d=b.getRawPath(),e=k(d);if(c)a.setPort(b.getPort()),e=e&&e.replace(j,"");else{c=!!d;if(c){if(e.charCodeAt(0)!==47){var f=k(a.getRawPath()||"").replace(j,""),g=f.lastIndexOf("/")+1;e=k((g?f.substring(0,g):"")+k(d)).replace(j,"")}}else e=e&&e.replace(j,""),e!==d&&a.setRawPath(e)}c?a.setRawPath(e):c=b.hasQuery();c?a.setRawQuery(b.getRawQuery()):c=b.hasFragment();c&&a.setRawFragment(b.getRawFragment());return a}function a(a,b,c,d,e,f,g){this.scheme_=a,this.credentials_=b,this.domain_=c,this.port_=d,this.path_=e,this.query_=f,this.fragment_=g,this.paramCache_=null}a.prototype.toString=function(){var a=[];null!==this.scheme_&&a.push(this.scheme_,":");null!==this.domain_&&(a.push("//"),null!==this.credentials_&&a.push(this.credentials_,"@"),a.push(this.domain_),null!==this.port_&&a.push(":",this.port_.toString()));null!==this.path_&&a.push(this.path_);null!==this.query_&&a.push("?",this.query_);null!==this.fragment_&&a.push("#",this.fragment_);return a.join("")};a.prototype.clone=function(){return new a(this.scheme_,this.credentials_,this.domain_,this.port_,this.path_,this.query_,this.fragment_)};a.prototype.getScheme=function(){return this.scheme_&&decodeURIComponent(this.scheme_).toLowerCase()};a.prototype.getRawScheme=function(){return this.scheme_};a.prototype.setScheme=function(a){this.scheme_=e(a,o);return this};a.prototype.setRawScheme=function(a){this.scheme_=a?a:null;return this};a.prototype.hasScheme=function(){return null!==this.scheme_};a.prototype.getCredentials=function(){return this.credentials_&&decodeURIComponent(this.credentials_)};a.prototype.getRawCredentials=function(){return this.credentials_};a.prototype.setCredentials=function(a){this.credentials_=e(a,o);return this};a.prototype.setRawCredentials=function(a){this.credentials_=a?a:null;return this};a.prototype.hasCredentials=function(){return null!==this.credentials_};a.prototype.getDomain=function(){return this.domain_&&decodeURIComponent(this.domain_)};a.prototype.getRawDomain=function(){return this.domain_};a.prototype.setDomain=function(a){return this.setRawDomain(a&&encodeURIComponent(a))};a.prototype.setRawDomain=function(a){this.domain_=a?a:null;return this.setRawPath(this.path_)};a.prototype.hasDomain=function(){return null!==this.domain_};a.prototype.getPort=function(){return this.port_&&decodeURIComponent(this.port_)};a.prototype.setPort=function(a){if(a){a=Number(a);if(a!==(a&65535))throw new Error("Bad port number "+a);this.port_=""+a}else this.port_=null;return this};a.prototype.hasPort=function(){return null!==this.port_};a.prototype.getPath=function(){return this.path_&&decodeURIComponent(this.path_)};a.prototype.getRawPath=function(){return this.path_};a.prototype.setPath=function(a){return this.setRawPath(e(a,p))};a.prototype.setRawPath=function(a){a?(a=String(a),this.path_=!this.domain_||/^\//.test(a)?a:"/"+a):this.path_=null;return this};a.prototype.hasPath=function(){return null!==this.path_};a.prototype.getQuery=function(){return this.query_&&decodeURIComponent(this.query_).replace(/\+/g," ")};a.prototype.getRawQuery=function(){return this.query_};a.prototype.setQuery=function(a){this.paramCache_=null;this.query_=d(a);return this};a.prototype.setRawQuery=function(a){this.paramCache_=null;this.query_=a?a:null;return this};a.prototype.hasQuery=function(){return null!==this.query_};a.prototype.setAllParameters=function(a){__p&&__p();if(typeof a==="object"&&(!(a instanceof Array)&&(a instanceof Object||Object.prototype.toString.call(a)!=="[object Array]"))){var b=[],c=-1;for(var d in a){var e=a[d];"string"===typeof e&&(b[++c]=d,b[++c]=e)}a=b}this.paramCache_=null;c=[];b="";for(var f=0;f<a.length;){var d=a[f++],e=a[f++];c.push(b,encodeURIComponent(d.toString()));b="&";e&&c.push("=",encodeURIComponent(e.toString()))}this.query_=c.join("");return this};a.prototype.checkParameterCache_=function(){__p&&__p();if(!this.paramCache_){var a=this.query_;if(!a)this.paramCache_=[];else{a=a.split(/[&\?]/);var b=[],c=-1;for(var d=0;d<a.length;++d){var e=a[d].match(/^([^=]*)(?:=(.*))?$/);b[++c]=decodeURIComponent(e[1]).replace(/\+/g," ");b[++c]=decodeURIComponent(e[2]||"").replace(/\+/g," ")}this.paramCache_=b}}};a.prototype.setParameterValues=function(a,b){typeof b==="string"&&(b=[b]);this.checkParameterCache_();var c=0,d=this.paramCache_,e=[];for(var f=0,g=0;f<d.length;f+=2)a===d[f]?c<b.length&&e.push(a,b[c++]):e.push(d[f],d[f+1]);while(c<b.length)e.push(a,b[c++]);this.setAllParameters(e);return this};a.prototype.removeParameter=function(a){return this.setParameterValues(a,[])};a.prototype.getAllParameters=function(){this.checkParameterCache_();return this.paramCache_.slice(0,this.paramCache_.length)};a.prototype.getParameterValues=function(a){this.checkParameterCache_();var b=[];for(var c=0;c<this.paramCache_.length;c+=2)a===this.paramCache_[c]&&b.push(this.paramCache_[c+1]);return b};a.prototype.getParameterMap=function(a){this.checkParameterCache_();a={};for(var b=0;b<this.paramCache_.length;b+=2){var c=this.paramCache_[b++],d=this.paramCache_[b++];!(c in a)?a[c]=[d]:a[c].push(d)}return a};a.prototype.getParameterValue=function(a){this.checkParameterCache_();for(var b=0;b<this.paramCache_.length;b+=2)if(a===this.paramCache_[b])return this.paramCache_[b+1];return null};a.prototype.getFragment=function(){return this.fragment_&&decodeURIComponent(this.fragment_)};a.prototype.getRawFragment=function(){return this.fragment_};a.prototype.setFragment=function(a){this.fragment_=a?encodeURIComponent(a):null;return this};a.prototype.setRawFragment=function(a){this.fragment_=a?a:null;return this};a.prototype.hasFragment=function(){return null!==this.fragment_};function m(a){return"string"==typeof a&&a.length>0?a:null}var n=new RegExp("^(?:([^:/?#]+):)?(?://(?:([^/?#]*)@)?([^/?#:@]*)(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),o=/[#\/\?@]/g,p=/[\#\?]/g;a.parse=b;a.create=c;a.resolve=l;a.collapse_dots=k;a.utils={mimeTypeOf:function(a){a=b(a);if(/\.html$/.test(a.getPath()))return"text/html";else return"application/javascript"},resolve:function(a,c){if(a)return l(b(a),b(c)).toString();else return""+c}};return a}();typeof window!=="undefined";var s=undefined,t=undefined;a=undefined;undefined;var u=undefined;(function(){__p&&__p();var b='url("about:blank")',c=/[\n\f\r\"\'()*<>]/g,d={"\n":"%0a","\f":"%0c","\r":"%0d",'"':"%22","'":"%27","(":"%28",")":"%29","*":"%2a","<":"%3c",">":"%3e"};function e(a){if("string"===typeof a)return'url("'+a.replace(c,f)+'")';else return b}function f(a){return d[a]}var p=new RegExp("^(?:([^:/?# ]+):)?"),w=/^(?:https?|mailto)$/i;function y(a,b){return a?r.utils.resolve(a,b):b}function z(a,b,c){if(!c)return null;var d=(""+a).match(p);if(d&&(!d[1]||w.test(d[1])))return c(a,b);else return null}function A(a){return a.replace(/^-(?:apple|css|epub|khtml|moz|mso?|o|rim|wap|webkit|xv)-(?=[a-z])/,"")}s=function(){__p&&__p();function a(a){var b={};for(var d=a.length;--d>=0;){var e=a[d];for(var f=e.length;--f>=0;)b[e[f]]=c}return b}var c={};return function d(f,p,r,s,t){__p&&__p();f=A(f);var u=o[f];if(!u||"object"!==typeof u){p.length=0;return}var v=u.cssPropBits;function w(a,c){__p&&__p();var e=1,f=c+1,g=a.length;while(f<g&&e){var b=a[f++];e+=b===")"?-1:/^[^"']*\($/.test(b)}if(!e){b=a[c].toLowerCase();g=A(b);e=a.splice(c,f-c,"");a=u.cssFns;for(var f=0,c=a.length;f<c;++f)if(a[f].substring(0,g.length)==g){e[0]=e[e.length-1]="";d(a[f],e,r,s);return b+e.join(" ")+")"}}return""}var x=v&(k|l),B=v&(m|n),C=NaN,D=0,E=0;for(;D<p.length;++D){var F=p[D].toLowerCase(),G=F.charCodeAt(0),H,I,J;F=G===" ".charCodeAt(0)?"":G==='"'.charCodeAt(0)?x===k?r?e(z(y(s,q(p[D].substring(1,F.length-1))),f,r)):"":v&j&&!(x&x-1)?F:"":F==="inherit"?F:(J=u.cssLitGroup,J=J?u.cssLitMap||(u.cssLitMap=a(J)):c,J[A(F)]===c)?F:G==="#".charCodeAt(0)&&/^#(?:[0-9a-f]{3}){1,2}$/.test(F)?v&h?F:"":"0".charCodeAt(0)<=G&&G<="9".charCodeAt(0)?v&g?F:"":(J=F.charCodeAt(1),H=F.charCodeAt(2),I="0".charCodeAt(0)<=J&&J<="9".charCodeAt(0),H="0".charCodeAt(0)<=H&&H<="9".charCodeAt(0),G==="+".charCodeAt(0)&&(I||J===".".charCodeAt(0)&&H))?v&g?(I?"":"0")+F.substring(1):"":G==="-".charCodeAt(0)&&(I||J===".".charCodeAt(0)&&H)?v&i?(I?"-":"-0")+F.substring(1):v&g?"0":"":G===".".charCodeAt(0)&&I?v&g?"0"+F:"":'url("'===F.substring(0,5)?r&&v&k?e(z(y(s,p[D].substring(5,F.length-2)),f,r)):"":F.charAt(F.length-1)==="("?w(p,D):B&&/^-?[a-z_][\w\-]*$/.test(F)&&!/__$/.test(F)?t&&B===m?p[D]+t:B===n&&o[F]&&"number"===typeof o[F].cssPropBits?F:"":/^\w+$/.test(F)&&x===l&&v&j?C+1===E?(p[C]=p[C].substring(0,p[C].length-1)+" "+F+'"',F=""):(C=E,'"'+F+'"'):"";F&&(p[E++]=F)}E===1&&p[0]===b&&(E=0);p.length=E}}();var B=new RegExp("^(active|after|before|blank|checked|default|disabled|drop|empty|enabled|first|first-child|first-letter|first-line|first-of-type|fullscreen|focus|hover|in-range|indeterminate|invalid|last-child|last-of-type|left|link|only-child|only-of-type|optional|out-of-range|placeholder-shown|read-only|read-write|required|right|root|scope|user-error|valid|visited)$"),C={};C[">"]=C["+"]=C["~"]=C;t=function(a,b,c){__p&&__p();var d=b.containerClass,e=b.idSuffix,f=b.tagPolicy,g=[],h=0,i,j=0,k;for(i=0;i<a.length;++i)k=a[i],(k=="("||k=="["?(++j,!0):k==")"||k=="]"?(j&&--j,!0):!(a[i]==" "&&(j||C[a[i-1]]===C||C[a[i+1]]===C)))&&(a[h++]=a[i]);a.length=h;k=a.length;j=0;for(i=0;i<k;++i)if(a[i]===","){if(!l(j,i))return null;j=i+1}if(!l(j,k))return null;function l(j,k){__p&&__p();a[j]===" "&&++j;k-1!==j&&a[k]===" "&&--k;var l=[],m=j,n=!0;for(var h=j;n&&h<k;++h){var i=a[h];(C[i]===C||i===" ")&&(!o(m,h,i)?n=!1:m=h+1)}o(m,k,"")||(n=!1);function o(d,g,i){__p&&__p();var j,k,m,c,h=!0;j="";if(d<g){c=a[d];if(c==="*")++d,j=c;else if(/^[a-zA-Z]/.test(c)){var n=f(c.toLowerCase(),[]);n&&("tagName"in n&&(c=n.tagName),++d,j=c)}}n="";k="";m="";for(;h&&d<g;++d){c=a[d];if(c.charAt(0)==="#")/^#_|__$|[^\w#:\-]/.test(c)?h=!1:n+=c+e;else if(c===".")++d<g&&/^[0-9A-Za-z:_\-]+$/.test(c=a[d])&&!/^_|__$/.test(c)?n+="."+c:h=!1;else if(d+1<g&&a[d]==="["){++d;var o=a[d++].toLowerCase(),p=x.ATTRIBS[j+"::"+o];p!==+p&&(p=x.ATTRIBS["*::"+o]);var q;b.virtualizeAttrName?(q=b.virtualizeAttrName(j,o),typeof q!=="string"&&(h=!1,q=o),h&&p!==+p&&(p=x.atype.NONE)):(q=o,p!==+p&&(h=!1));o="";var r="",s=!1;/^[~^$*|]?=$/.test(a[d])&&(o=a[d++],r=a[d++],/^[0-9A-Za-z:_\-]+$/.test(r)?r='"'+r+'"':r==="]"&&(r='""',--d),/^"([^\"\\]|\\.)*"$/.test(r)||(h=!1),s=a[d]==="i",s&&++d);a[d]!=="]"&&(++d,h=!1);switch(p){case x.atype.CLASSES:case x.atype.LOCAL_NAME:case x.atype.NONE:break;case x.atype.GLOBAL_NAME:case x.atype.ID:case x.atype.IDREF:(o==="="||o==="~="||o==="$=")&&r!='""'&&!s?r='"'+r.substring(1,r.length-1)+e+'"':o==="|="||o===""||(h=!1);break;case x.atype.URI:case x.atype.URI_FRAGMENT:o!==""&&(h=!1);break;default:h=!1}h&&(k+="["+q.replace(/[^\w-]/g,"\\$&")+o+r+(s?" i]":"]"))}else if(d<g&&a[d]===":"){c=a[++d];if(B.test(c))m+=":"+c;else break}else break}d!==g&&(h=!1);if(h){p=(j+n).replace(/[^ .*#\w-]/g,"\\$&")+k+m+i;p&&l.push(p)}return h}if(n){if(l.length){i=l.join("");d!==null&&(i="."+d+" "+i);g.push(i)}return!0}else return!c||c(a.slice(j,k))}return g};(function(){__p&&__p();var a="(?:all|aural|braille|embossed|handheld|print|projection|screen|speech|tty|tv)",b="(?:(?:min-|max-)?(?:(?:device-)?(?:aspect-ratio|height|width)|color(?:-index)?|monochrome|orientation|resolution)|grid|hover|luminosity|pointer|scan|script)",c="(?:p[cxt]|[cem]m|in|dpi|dppx|dpcm|%)";c="-?(?:[a-z]\\w+(?:-\\w+)*|\\d+(?: / \\d+|(?:\\.\\d+)?"+c+"?))";b="\\( "+b+" (?:: "+c+" )?\\)";c="(?:(?:(?:(?:only|not) )?"+a+"|"+b+")(?: and ?"+b+")*)";var d=/^\w/,e=new RegExp("^"+c+"(?: , "+c+")*$","i");u=function(a){__p&&__p();a=a.slice();var b=a.length,c=0;for(var f=0;f<b;++f){var g=a[f];g!=" "&&(a[c++]=g)}a.length=c;g=a.join(" ");g=g.length?e.test(g)?d.test(g)?g:"not all , "+g:"not all":"";return g}})();(function(){__p&&__p();function b(a){__p&&__p();var b=/^\s*["]([^"]*)["]\s*$/,c=/^\s*[']([^']*)[']\s*$/,d=/^\s*url\s*[(]["]([^"]*)["][)]\s*$/,e=/^\s*url\s*[(][']([^']*)['][)]\s*$/,f=/^\s*url\s*[(]([^)]*)[)]\s*$/;if(b=b.exec(a))return b[1];else if(b=c.exec(a))return b[1];else if(b=d.exec(a))return b[1];else if(b=e.exec(a))return b[1];else if(b=f.exec(a))return b[1];return null}function c(a,d,e,f,g,h,i){__p&&__p();var j=void 0,k=i||[0],l=[],m=!1;v(d,{startStylesheet:function(){j=[]},endStylesheet:function(){},startAtrule:function(d,i){__p&&__p();if(m)d=null;else if(d==="@media")j.push("@media"," ",u(i));else if(d==="@keyframes"||d==="@-webkit-keyframes"){var n=i[0];i.length===1&&!/__$|[^\w\-]/.test(n)?(j.push(d," ",n+e.idSuffix),d="@keyframes"):d=null}else if(d==="@import"&&i.length>0){d=null;if("function"===typeof h){var o=u(i.slice(1));if(o!=="not all"){++k[0];var p=[];j.push(p);var q=z(y(a,b(i[0])),function(a){var b=c(q,a.html,e,f,g,h,k);--k[0];a=o?{toString:function(){return"@media "+o+" {"+b.result+"}"}}:b.result;p[0]=a;h(a,!!k[0])},g)}}else window.console&&window.console.log("@import "+i.join(" ")+" elided")}m=!d;l.push(d)},endAtrule:function(){l.pop(),m||j.push(";"),n()},startBlock:function(){m||j.push("{")},endBlock:function(){m||(j.push("}"),m=!0)},startRuleset:function(a){__p&&__p();if(!m){var b=void 0;if(l[l.length-1]==="@keyframes")b=a.join(" ").match(/^ *(?:from|to|\d+(?:\.\d+)?%) *(?:, *(?:from|to|\d+(?:\.\d+)?%) *)*$/i),m=!b,b&&(b=b[0].replace(/ +/g,""));else{a=t(a,e);!a||!a.length?m=!0:b=a.join(", ")}m||j.push(b,"{")}l.push(null)},endRuleset:function(){l.pop(),m||j.push("}"),n()},declaration:function(b,c){if(!m){var d=!1,g=c.length;g>=2&&c[g-2]==="!"&&c[g-1].toLowerCase()==="important"&&(d=!0,c.length-=2);s(b,c,f,a,e.idSuffix);c.length&&j.push(b,":",c.join(" "),d?" !important;":";")}}});function n(){m=l.length&&l[l.length-1]===null}return{result:{toString:function(){return j.join("")}},moreToCome:!!k[0]}}a=function(a,b,d,e){return c(a,b,d,e,undefined,undefined).result.toString()};(function(a,b,d,e,f,g){return c(a,b,d,e,f,g)})})()})();typeof window!=="undefined"&&(window.sanitizeCssProperty=s,window.sanitizeCssSelectorList=t,window.sanitizeStylesheet=a,window.sanitizeMediaQuery=u);if("I".toLowerCase()!=="i")throw"I/i problem";var v,w;(function(){__p&&__p();v=function(b,c){b=p(b);c.startStylesheet&&c.startStylesheet();for(var d=0,e=b.length;d<e;)d=b[d]===" "?d+1:a(b,d,e,c);c.endStylesheet&&c.endStylesheet()};function a(a,c,e,f){if(c<e){var g=a[c];if(g.charAt(0)==="@")return b(a,c,e,f,!0);else return d(a,c,e,f)}else return c}function b(a,b,d,e,f){__p&&__p();var g=b++;while(b<d&&a[b]!=="{"&&a[b]!==";")++b;if(b<d&&(f||a[b]===";")){f=g+1;var h=b;f<d&&a[f]===" "&&++f;h>f&&a[h-1]===" "&&--h;e.startAtrule&&e.startAtrule(a[g].toLowerCase(),a.slice(f,h));b=a[b]==="{"?c(a,b,d,e):b+1;e.endAtrule&&e.endAtrule()}return b}function c(a,e,f,g){__p&&__p();++e;g.startBlock&&g.startBlock();while(e<f){var h=a[e].charAt(0);if(h=="}"){++e;break}h===" "||h===";"?e=e+1:h==="@"?e=b(a,e,f,g,!1):h==="{"?e=c(a,e,f,g):e=d(a,e,f,g)}g.endBlock&&g.endBlock();return e}function d(a,b,c,d){__p&&__p();var f=b,g=e(a,b,c,!0);if(g<0){g=~g;return g===f?g+1:g}var i=a[g];if(i!=="{")return g===f?g+1:g;b=g+1;g>f&&a[g-1]===" "&&--g;d.startRuleset&&d.startRuleset(a.slice(f,g));while(b<c){i=a[b];if(i==="}"){++b;break}i===" "?b=b+1:b=h(a,b,c,d)}d.endRuleset&&d.endRuleset();return b}function e(a,b,c,d){__p&&__p();b;var e,f=[],g=-1;for(;b<c;++b){e=a[b].charAt(0);if(e==="["||e==="(")f[++g]=e;else if(e==="]"&&f[g]==="["||e===")"&&f[g]==="(")--g;else if(e==="{"||e==="}"||e===";"||e==="@"||e===":"&&!d)break}g>=0&&(b=~(b+1));return b}var f=/^-?[a-z]/i;function g(a,b,c){while(b<c&&a[b]!==";"&&a[b]!=="}")++b;return b<c&&a[b]===";"?b+1:b}function h(a,b,c,d){__p&&__p();var h=a[b++];if(!f.test(h))return g(a,b,c);var i;b<c&&a[b]===" "&&++b;if(b==c||a[b]!==":")return g(a,b,c);++b;b<c&&a[b]===" "&&++b;var j=b;b=e(a,b,c,!1);if(b<0)b=~b;else{var k=[],l=0;for(var j=j;j<b;++j)i=a[j],i!==" "&&(k[l++]=i);if(b<c){do{i=a[b];if(i===";"||i==="}")break;l=0}while(++b<c);i===";"&&++b}l&&d.declaration&&d.declaration(h.toLowerCase(),k)}return b}w=function(a,b){a=p(a);for(var c=0,d=a.length;c<d;)c=a[c]!==" "?h(a,c,d,b):c+1}})();typeof window!=="undefined"&&(window.parseCssStylesheet=v,window.parseCssDeclarations=w);var x={};x.atype={NONE:0,URI:1,URI_FRAGMENT:11,SCRIPT:2,STYLE:3,HTML:12,ID:4,IDREF:5,IDREFS:6,GLOBAL_NAME:7,LOCAL_NAME:8,CLASSES:9,FRAME_TARGET:10,MEDIA_QUERY:13};x.atype=x.atype;x.ATTRIBS={"*::class":9,"*::dir":0,"*::draggable":0,"*::hidden":0,"*::id":4,"*::inert":0,"*::itemprop":0,"*::itemref":6,"*::itemscope":0,"*::lang":0,"*::onblur":2,"*::onchange":2,"*::onclick":2,"*::ondblclick":2,"*::onerror":2,"*::onfocus":2,"*::onkeydown":2,"*::onkeypress":2,"*::onkeyup":2,"*::onload":2,"*::onmousedown":2,"*::onmousemove":2,"*::onmouseout":2,"*::onmouseover":2,"*::onmouseup":2,"*::onreset":2,"*::onscroll":2,"*::onselect":2,"*::onsubmit":2,"*::ontouchcancel":2,"*::ontouchend":2,"*::ontouchenter":2,"*::ontouchleave":2,"*::ontouchmove":2,"*::ontouchstart":2,"*::onunload":2,"*::spellcheck":0,"*::style":3,"*::tabindex":0,"*::title":0,"*::translate":0,"a::accesskey":0,"a::coords":0,"a::href":1,"a::hreflang":0,"a::name":7,"a::onblur":2,"a::onfocus":2,"a::shape":0,"a::target":10,"a::type":0,"area::accesskey":0,"area::alt":0,"area::coords":0,"area::href":1,"area::nohref":0,"area::onblur":2,"area::onfocus":2,"area::shape":0,"area::target":10,"audio::controls":0,"audio::loop":0,"audio::mediagroup":5,"audio::muted":0,"audio::preload":0,"audio::src":1,"bdo::dir":0,"blockquote::cite":1,"br::clear":0,"button::accesskey":0,"button::disabled":0,"button::name":8,"button::onblur":2,"button::onfocus":2,"button::type":0,"button::value":0,"canvas::height":0,"canvas::width":0,"caption::align":0,"col::align":0,"col::char":0,"col::charoff":0,"col::span":0,"col::valign":0,"col::width":0,"colgroup::align":0,"colgroup::char":0,"colgroup::charoff":0,"colgroup::span":0,"colgroup::valign":0,"colgroup::width":0,"command::checked":0,"command::command":5,"command::disabled":0,"command::icon":1,"command::label":0,"command::radiogroup":0,"command::type":0,"data::value":0,"del::cite":1,"del::datetime":0,"details::open":0,"dir::compact":0,"div::align":0,"dl::compact":0,"fieldset::disabled":0,"font::color":0,"font::face":0,"font::size":0,"form::accept":0,"form::action":1,"form::autocomplete":0,"form::enctype":0,"form::method":0,"form::name":7,"form::novalidate":0,"form::onreset":2,"form::onsubmit":2,"form::target":10,"h1::align":0,"h2::align":0,"h3::align":0,"h4::align":0,"h5::align":0,"h6::align":0,"hr::align":0,"hr::noshade":0,"hr::size":0,"hr::width":0,"iframe::align":0,"iframe::frameborder":0,"iframe::height":0,"iframe::marginheight":0,"iframe::marginwidth":0,"iframe::width":0,"img::align":0,"img::alt":0,"img::border":0,"img::height":0,"img::hspace":0,"img::ismap":0,"img::name":7,"img::src":1,"img::usemap":11,"img::vspace":0,"img::width":0,"input::accept":0,"input::accesskey":0,"input::align":0,"input::alt":0,"input::autocomplete":0,"input::checked":0,"input::disabled":0,"input::inputmode":0,"input::ismap":0,"input::list":5,"input::max":0,"input::maxlength":0,"input::min":0,"input::multiple":0,"input::name":8,"input::onblur":2,"input::onchange":2,"input::onfocus":2,"input::onselect":2,"input::pattern":0,"input::placeholder":0,"input::readonly":0,"input::required":0,"input::size":0,"input::src":1,"input::step":0,"input::type":0,"input::usemap":11,"input::value":0,"ins::cite":1,"ins::datetime":0,"label::accesskey":0,"label::for":5,"label::onblur":2,"label::onfocus":2,"legend::accesskey":0,"legend::align":0,"li::type":0,"li::value":0,"map::name":7,"menu::compact":0,"menu::label":0,"menu::type":0,"meter::high":0,"meter::low":0,"meter::max":0,"meter::min":0,"meter::optimum":0,"meter::value":0,"ol::compact":0,"ol::reversed":0,"ol::start":0,"ol::type":0,"optgroup::disabled":0,"optgroup::label":0,"option::disabled":0,"option::label":0,"option::selected":0,"option::value":0,"output::for":6,"output::name":8,"p::align":0,"pre::width":0,"progress::max":0,"progress::min":0,"progress::value":0,"q::cite":1,"select::autocomplete":0,"select::disabled":0,"select::multiple":0,"select::name":8,"select::onblur":2,"select::onchange":2,"select::onfocus":2,"select::required":0,"select::size":0,"source::type":0,"table::align":0,"table::bgcolor":0,"table::border":0,"table::cellpadding":0,"table::cellspacing":0,"table::frame":0,"table::rules":0,"table::summary":0,"table::width":0,"tbody::align":0,"tbody::char":0,"tbody::charoff":0,"tbody::valign":0,"td::abbr":0,"td::align":0,"td::axis":0,"td::bgcolor":0,"td::char":0,"td::charoff":0,"td::colspan":0,"td::headers":6,"td::height":0,"td::nowrap":0,"td::rowspan":0,"td::scope":0,"td::valign":0,"td::width":0,"textarea::accesskey":0,"textarea::autocomplete":0,"textarea::cols":0,"textarea::disabled":0,"textarea::inputmode":0,"textarea::name":8,"textarea::onblur":2,"textarea::onchange":2,"textarea::onfocus":2,"textarea::onselect":2,"textarea::placeholder":0,"textarea::readonly":0,"textarea::required":0,"textarea::rows":0,"textarea::wrap":0,"tfoot::align":0,"tfoot::char":0,"tfoot::charoff":0,"tfoot::valign":0,"th::abbr":0,"th::align":0,"th::axis":0,"th::bgcolor":0,"th::char":0,"th::charoff":0,"th::colspan":0,"th::headers":6,"th::height":0,"th::nowrap":0,"th::rowspan":0,"th::scope":0,"th::valign":0,"th::width":0,"thead::align":0,"thead::char":0,"thead::charoff":0,"thead::valign":0,"tr::align":0,"tr::bgcolor":0,"tr::char":0,"tr::charoff":0,"tr::valign":0,"track::default":0,"track::kind":0,"track::label":0,"track::srclang":0,"ul::compact":0,"ul::type":0,"video::controls":0,"video::height":0,"video::loop":0,"video::mediagroup":5,"video::muted":0,"video::poster":1,"video::preload":0,"video::src":1,"video::width":0};x.ATTRIBS=x.ATTRIBS;x.eflags={OPTIONAL_ENDTAG:1,EMPTY:2,CDATA:4,RCDATA:8,UNSAFE:16,FOLDABLE:32,SCRIPT:64,STYLE:128,VIRTUALIZED:256};x.eflags=x.eflags;x.ELEMENTS={a:0,abbr:0,acronym:0,address:0,applet:272,area:2,article:0,aside:0,audio:0,b:0,base:274,basefont:274,bdi:0,bdo:0,big:0,blockquote:0,body:305,br:2,button:0,canvas:0,caption:0,center:0,cite:0,code:0,col:2,colgroup:1,command:2,data:0,datalist:0,dd:1,del:0,details:0,dfn:0,dialog:272,dir:0,div:0,dl:0,dt:1,em:0,fieldset:0,figcaption:0,figure:0,font:0,footer:0,form:0,frame:274,frameset:272,h1:0,h2:0,h3:0,h4:0,h5:0,h6:0,head:305,header:0,hgroup:0,hr:2,html:305,i:0,iframe:4,img:2,input:2,ins:0,isindex:274,kbd:0,keygen:274,label:0,legend:0,li:1,link:274,map:0,mark:0,menu:0,meta:274,meter:0,nav:0,nobr:0,noembed:276,noframes:276,noscript:276,object:272,ol:0,optgroup:0,option:1,output:0,p:1,param:274,pre:0,progress:0,q:0,s:0,samp:0,script:84,section:0,select:0,small:0,source:2,span:0,strike:0,strong:0,style:148,sub:0,summary:0,sup:0,table:0,tbody:1,td:1,textarea:8,tfoot:1,th:1,thead:1,time:0,title:280,tr:1,track:2,tt:0,u:0,ul:0,"var":0,video:0,wbr:2};x.ELEMENTS=x.ELEMENTS;x.ELEMENT_DOM_INTERFACES={a:"HTMLAnchorElement",abbr:"HTMLElement",acronym:"HTMLElement",address:"HTMLElement",applet:"HTMLAppletElement",area:"HTMLAreaElement",article:"HTMLElement",aside:"HTMLElement",audio:"HTMLAudioElement",b:"HTMLElement",base:"HTMLBaseElement",basefont:"HTMLBaseFontElement",bdi:"HTMLElement",bdo:"HTMLElement",big:"HTMLElement",blockquote:"HTMLQuoteElement",body:"HTMLBodyElement",br:"HTMLBRElement",button:"HTMLButtonElement",canvas:"HTMLCanvasElement",caption:"HTMLTableCaptionElement",center:"HTMLElement",cite:"HTMLElement",code:"HTMLElement",col:"HTMLTableColElement",colgroup:"HTMLTableColElement",command:"HTMLCommandElement",data:"HTMLElement",datalist:"HTMLDataListElement",dd:"HTMLElement",del:"HTMLModElement",details:"HTMLDetailsElement",dfn:"HTMLElement",dialog:"HTMLDialogElement",dir:"HTMLDirectoryElement",div:"HTMLDivElement",dl:"HTMLDListElement",dt:"HTMLElement",em:"HTMLElement",fieldset:"HTMLFieldSetElement",figcaption:"HTMLElement",figure:"HTMLElement",font:"HTMLFontElement",footer:"HTMLElement",form:"HTMLFormElement",frame:"HTMLFrameElement",frameset:"HTMLFrameSetElement",h1:"HTMLHeadingElement",h2:"HTMLHeadingElement",h3:"HTMLHeadingElement",h4:"HTMLHeadingElement",h5:"HTMLHeadingElement",h6:"HTMLHeadingElement",head:"HTMLHeadElement",header:"HTMLElement",hgroup:"HTMLElement",hr:"HTMLHRElement",html:"HTMLHtmlElement",i:"HTMLElement",iframe:"HTMLIFrameElement",img:"HTMLImageElement",input:"HTMLInputElement",ins:"HTMLModElement",isindex:"HTMLUnknownElement",kbd:"HTMLElement",keygen:"HTMLKeygenElement",label:"HTMLLabelElement",legend:"HTMLLegendElement",li:"HTMLLIElement",link:"HTMLLinkElement",map:"HTMLMapElement",mark:"HTMLElement",menu:"HTMLMenuElement",meta:"HTMLMetaElement",meter:"HTMLMeterElement",nav:"HTMLElement",nobr:"HTMLElement",noembed:"HTMLElement",noframes:"HTMLElement",noscript:"HTMLElement",object:"HTMLObjectElement",ol:"HTMLOListElement",optgroup:"HTMLOptGroupElement",option:"HTMLOptionElement",output:"HTMLOutputElement",p:"HTMLParagraphElement",param:"HTMLParamElement",pre:"HTMLPreElement",progress:"HTMLProgressElement",q:"HTMLQuoteElement",s:"HTMLElement",samp:"HTMLElement",script:"HTMLScriptElement",section:"HTMLElement",select:"HTMLSelectElement",small:"HTMLElement",source:"HTMLSourceElement",span:"HTMLSpanElement",strike:"HTMLElement",strong:"HTMLElement",style:"HTMLStyleElement",sub:"HTMLElement",summary:"HTMLElement",sup:"HTMLElement",table:"HTMLTableElement",tbody:"HTMLTableSectionElement",td:"HTMLTableDataCellElement",textarea:"HTMLTextAreaElement",tfoot:"HTMLTableSectionElement",th:"HTMLTableHeaderCellElement",thead:"HTMLTableSectionElement",time:"HTMLTimeElement",title:"HTMLTitleElement",tr:"HTMLTableRowElement",track:"HTMLTrackElement",tt:"HTMLElement",u:"HTMLElement",ul:"HTMLUListElement","var":"HTMLElement",video:"HTMLVideoElement",wbr:"HTMLElement"};x.ELEMENT_DOM_INTERFACES=x.ELEMENT_DOM_INTERFACES;x.ueffects={NOT_LOADED:0,SAME_DOCUMENT:1,NEW_DOCUMENT:2};x.ueffects=x.ueffects;x.URIEFFECTS={"a::href":2,"area::href":2,"audio::src":1,"blockquote::cite":0,"command::icon":1,"del::cite":0,"form::action":2,"img::src":1,"input::src":1,"ins::cite":0,"q::cite":0,"video::poster":1,"video::src":1};x.URIEFFECTS=x.URIEFFECTS;x.ltypes={UNSANDBOXED:2,SANDBOXED:1,DATA:0};x.ltypes=x.ltypes;x.LOADERTYPES={"a::href":2,"area::href":2,"audio::src":2,"blockquote::cite":2,"command::icon":1,"del::cite":2,"form::action":2,"img::src":1,"input::src":1,"ins::cite":2,"q::cite":2,"video::poster":1,"video::src":2};x.LOADERTYPES=x.LOADERTYPES;typeof window!=="undefined"&&(window.html4=x);if("I".toLowerCase()!=="i")throw"I/i problem";b={};b.TagPolicyDecision;b.TagPolicy;c=function(c){__p&&__p();var b,a;"undefined"!==typeof window&&(b=window.parseCssDeclarations,a=window.sanitizeCssProperty,window.cssSchema);var d={lt:"<",LT:"<",gt:">",GT:">",amp:"&",AMP:"&",quot:'"',apos:"'",nbsp:"\xa0"},e=/^#(\d+)$/,f=/^#x([0-9A-Fa-f]+)$/,g=/^[A-Za-z][A-za-z0-9]+$/,h="undefined"!==typeof window&&window.document?window.document.createElement("textarea"):null;function i(a){__p&&__p();if(d.hasOwnProperty(a))return d[a];var b=a.match(e);if(b)return String.fromCharCode(parseInt(b[1],10));else if(b=a.match(f))return String.fromCharCode(parseInt(b[1],16));else if(h&&g.test(a)){h.innerHTML="&"+a+";";b=h.textContent;d[a]=b;return b}else return"&"+a+";"}function j(a,b){return i(b)}var k=/\0/g;function l(a){return a.replace(k,"")}var m=/&(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/g,n=/^(#[0-9]+|#[xX][0-9A-Fa-f]+|\w+);/;function o(a){return a.replace(m,j)}var p=/&/g,q=/&([^a-z#]|#(?:[^0-9x]|x(?:[^0-9a-f]|$)|$)|$)/gi,t=/[<]/g,u=/>/g,v=/\"/g;function y(a){return(""+a).replace(p,"&amp;").replace(t,"&lt;").replace(u,"&gt;").replace(v,"&#34;")}function z(a){return a.replace(q,"&amp;$1").replace(t,"&lt;").replace(u,"&gt;")}var A=new RegExp("^\\s*([-.:\\w]+)(?:\\s*(=)\\s*((\")[^\"]*(\"|$)|(')[^']*('|$)|(?=[a-z][-\\w]*\\s*=)|[^\"'\\s]*))?","i"),B="a,b".split(/(,)/).length===3,C=c.eflags.CDATA|c.eflags.RCDATA;function D(a){var b={cdata:a.cdata||a.cdata,comment:a.comment||a.comment,endDoc:a.endDoc||a.endDoc,endTag:a.endTag||a.endTag,pcdata:a.pcdata||a.pcdata,rcdata:a.rcdata||a.rcdata,startDoc:a.startDoc||a.startDoc,startTag:a.startTag||a.startTag};return function(a,c){return F(a,b,c)}}var E={};function F(a,b,c){a=I(a);var d={noMoreGT:!1,noMoreEndComments:!1};H(b,a,0,d,c)}function G(a,b,c,d,e){return function(){H(a,b,c,d,e)}}function H(a,b,d,e,f){__p&&__p();try{a.startDoc&&d==0&&a.startDoc(f);var g,h;for(var d=d,i=b.length;d<i;){var j=b[d++],k=b[d];switch(j){case"&":n.test(k)?(a.pcdata&&a.pcdata("&"+k,f,E,G(a,b,d,e,f)),d++):a.pcdata&&a.pcdata("&amp;",f,E,G(a,b,d,e,f));break;case"</":(g=/^([-\w:]+)[^\'\"]*/.exec(k))?g[0].length===k.length&&b[d+1]===">"?(d+=2,h=g[1].toLowerCase(),a.endTag&&a.endTag(h,f,E,G(a,b,d,e,f))):d=J(b,d,a,f,E,e):a.pcdata&&a.pcdata("&lt;/",f,E,G(a,b,d,e,f));break;case"<":if(g=/^([-\w:]+)\s*\/?/.exec(k))if(g[0].length===k.length&&b[d+1]===">"){d+=2;h=g[1].toLowerCase();a.startTag&&a.startTag(h,[],f,E,G(a,b,d,e,f));g=c.ELEMENTS[h];if(g&C){h={name:h,next:d,eflags:g};d=M(b,h,a,f,E,e)}}else d=K(b,d,a,f,E,e);else a.pcdata&&a.pcdata("&lt;",f,E,G(a,b,d,e,f));break;case"<!--":if(!e.noMoreEndComments){for(g=d+1;g<i;g++)if(b[g]===">"&&/--$/.test(b[g-1]))break;if(g<i){if(a.comment){h=b.slice(d,g).join("");a.comment(h.substr(0,h.length-2),f,E,G(a,b,g+1,e,f))}d=g+1}else e.noMoreEndComments=!0}e.noMoreEndComments&&(a.pcdata&&a.pcdata("&lt;!--",f,E,G(a,b,d,e,f)));break;case"<!":if(!/^\w/.test(k))a.pcdata&&a.pcdata("&lt;!",f,E,G(a,b,d,e,f));else{if(!e.noMoreGT){for(g=d+1;g<i;g++)if(b[g]===">")break;g<i?d=g+1:e.noMoreGT=!0}e.noMoreGT&&(a.pcdata&&a.pcdata("&lt;!",f,E,G(a,b,d,e,f)))}break;case"<?":if(!e.noMoreGT){for(g=d+1;g<i;g++)if(b[g]===">")break;g<i?d=g+1:e.noMoreGT=!0}e.noMoreGT&&(a.pcdata&&a.pcdata("&lt;?",f,E,G(a,b,d,e,f)));break;case">":a.pcdata&&a.pcdata("&gt;",f,E,G(a,b,d,e,f));break;case"":break;default:a.pcdata&&a.pcdata(j,f,E,G(a,b,d,e,f));break}}a.endDoc&&a.endDoc(f)}catch(a){if(a!==E)throw a}}function I(a){__p&&__p();var b=/(<\/|<\!--|<[!?]|[&<>])/g;a+="";if(B)return a.split(b);else{var c=[],d=0,e;while((e=b.exec(a))!==null)c.push(a.substring(d,e.index)),c.push(e[0]),d=e.index+e[0].length;c.push(a.substring(d));return c}}function J(b,c,d,e,a,f){var g=N(b,c);if(!g)return b.length;d.endTag&&d.endTag(g.name,e,a,G(d,b,c,f,e));return g.next}function K(b,c,d,e,a,f){c=N(b,c);if(!c)return b.length;d.startTag&&d.startTag(c.name,c.attrs,e,a,G(d,b,c.next,f,e));if(c.eflags&C)return M(b,c,d,e,a,f);else return c.next}var L={};function M(b,d,e,f,a,g){__p&&__p();var h=b.length;L.hasOwnProperty(d.name)||(L[d.name]=new RegExp("^"+d.name+"(?:[\\s\\/]|$)","i"));var i=L[d.name],j=d.next,k=d.next+1;for(;k<h;k++)if(b[k-1]==="</"&&i.test(b[k]))break;k<h&&(k-=1);i=b.slice(j,k).join("");if(d.eflags&c.eflags.CDATA)e.cdata&&e.cdata(i,f,a,G(e,b,k,g,f));else if(d.eflags&c.eflags.RCDATA)e.rcdata&&e.rcdata(z(i),f,a,G(e,b,k,g,f));else throw new Error("bug");return k}function N(a,b){__p&&__p();var d=/^([-\w:]+)/.exec(a[b]),e={};e.name=d[1].toLowerCase();e.eflags=c.ELEMENTS[e.name];var f=a[b].substr(d[0].length);b=b+1;var g=a.length;for(;b<g;b++){if(a[b]===">")break;f+=a[b]}if(g<=b)return void 0;var h=[];while(f!==""){d=A.exec(f);if(!d)f=f.replace(/^[\s\S][^a-z\s]*/,"");else if(d[4]&&!d[5]||d[6]&&!d[7]){var i=d[4]||d[6],j=!1,k=[f,a[b++]];for(;b<g;b++){if(j){if(a[b]===">")break}else 0<=a[b].indexOf(i)&&(j=!0);k.push(a[b])}if(g<=b)break;f=k.join("");continue}else{i=d[1].toLowerCase();j=d[2]?O(d[3]):"";h.push(i,j);f=f.substr(d[0].length)}}e.attrs=h;e.next=b+1;return e}function O(a){var b=a.charCodeAt(0);(b===34||b===39)&&(a=a.substr(1,a.length-2));return o(l(a))}function P(a){__p&&__p();var b,d,e=function(a,b){d||b.push(a)};return D({startDoc:function(a){b=[],d=!1},startTag:function(e,f,g){__p&&__p();if(d)return;if(!c.ELEMENTS.hasOwnProperty(e))return;var h=c.ELEMENTS[e];if(h&c.eflags.FOLDABLE)return;var i=a(e,f);if(!i){d=!(h&c.eflags.EMPTY);return}else if(typeof i!=="object")throw new Error("tagPolicy did not return object (old API?)");if("attribs"in i)f=i.attribs;else throw new Error("tagPolicy gave no attribs");var j;"tagName"in i?(i=i.tagName,j=c.ELEMENTS[i]):(i=e,j=h);if(h&c.eflags.OPTIONAL_ENDTAG){var k=b[b.length-1];k&&k.orig===e&&(k.rep!==i||e!==i)&&g.push("</",k.rep,">")}h&c.eflags.EMPTY||b.push({orig:e,rep:i});g.push("<",i);for(var k=0,e=f.length;k<e;k+=2){var l=f[k],m=f[k+1];m!==null&&m!==void 0&&g.push(" ",l,'="',y(m),'"')}g.push(">");h&c.eflags.EMPTY&&!(j&c.eflags.EMPTY)&&g.push("</",i,">")},endTag:function(a,e){__p&&__p();if(d){d=!1;return}if(!c.ELEMENTS.hasOwnProperty(a))return;var f=c.ELEMENTS[a];if(!(f&(c.eflags.EMPTY|c.eflags.FOLDABLE))){if(f&c.eflags.OPTIONAL_ENDTAG)for(f=b.length;--f>=0;){var g=b[f].orig;if(g===a)break;if(!(c.ELEMENTS[g]&c.eflags.OPTIONAL_ENDTAG))return}else for(f=b.length;--f>=0;)if(b[f].orig===a)break;if(f<0)return;for(var g=b.length;--g>f;){var h=b[g].rep;c.ELEMENTS[h]&c.eflags.OPTIONAL_ENDTAG||e.push("</",h,">")}f<b.length&&(a=b[f].rep);b.length=f;e.push("</",a,">")}},pcdata:e,rcdata:e,cdata:e,endDoc:function(a){for(;b.length;b.length--)a.push("</",b[b.length-1].rep,">")}})}var Q=/^(?:https?|mailto)$/i;function R(a,b,c,d,e){__p&&__p();if(!e)return null;try{a=r.parse(""+a);if(a&&(!a.hasScheme()||Q.test(a.getScheme()))){e=e(a,b,c,d);return e?e.toString():null}}catch(a){return null}return null}function S(a,b,c,d,e){c||a(b+" removed",{change:"removed",tagName:b});if(d!==e){var f="changed";d&&!e?f="removed":!d&&e&&(f="added");a(b+"."+c+" "+f,{change:f,tagName:b,attribName:c,oldValue:d,newValue:e})}}function T(a,b,c){b=b+"::"+c;if(a.hasOwnProperty(b))return a[b];b="*::"+c;return a.hasOwnProperty(b)?a[b]:void 0}function U(a,b){return T(c.LOADERTYPES,a,b)}function V(a,b){return T(c.URIEFFECTS,a,b)}function W(d,e,f,g,h){__p&&__p();for(var i=0;i<e.length;i+=2){var j=e[i],k=e[i+1],l=k,m=null,n;((n=d+"::"+j,c.ATTRIBS.hasOwnProperty(n))||(n="*::"+j,c.ATTRIBS.hasOwnProperty(n)))&&(m=c.ATTRIBS[n]);if(m!==null)switch(m){case c.atype.NONE:break;case c.atype.SCRIPT:k=null;h&&S(h,d,j,l,k);break;case c.atype.STYLE:if("undefined"===typeof b){k=null;h&&S(h,d,j,l,k);break}var o=[];b(k,{declaration:function(b,d){var e=b.toLowerCase();a(e,d,f?function(a){return R(a,c.ueffects.SAME_DOCUMENT,c.ltypes.SANDBOXED,{TYPE:"CSS",CSS_PROP:e},f)}:null);d.length&&o.push(e+": "+d.join(" "))}});k=o.length>0?o.join(" ; "):null;h&&S(h,d,j,l,k);break;case c.atype.ID:case c.atype.IDREF:case c.atype.IDREFS:case c.atype.GLOBAL_NAME:case c.atype.LOCAL_NAME:case c.atype.CLASSES:k=g?g(k):k;h&&S(h,d,j,l,k);break;case c.atype.URI:k=R(k,V(d,j),U(d,j),{TYPE:"MARKUP",XML_ATTR:j,XML_TAG:d},f);h&&S(h,d,j,l,k);break;case c.atype.URI_FRAGMENT:k&&"#"===k.charAt(0)?(k=k.substring(1),k=g?g(k):k,k!==null&&k!==void 0&&(k="#"+k)):k=null;h&&S(h,d,j,l,k);break;default:k=null;h&&S(h,d,j,l,k);break}else k=null,h&&S(h,d,j,l,k);e[i+1]=k}return e}function X(a,b,d,e){return function(f,g){var h=!0;e&&(h=!1,e.forEach(function(a){f==a&&(h=!0)}));if(!(c.ELEMENTS[f]&c.eflags.UNSAFE)&&h)return{attribs:W(f,g,a,b,d)};else d&&S(d,f,undefined,undefined,undefined)}}function Y(a,b){var c=[];P(b)(a,c);return c.join("")}function Z(a,b,c,d,e){b=X(b,c,d,e);return Y(a,b)}var $={};$.escapeAttrib=$.escapeAttrib=y;$.makeHtmlSanitizer=$.makeHtmlSanitizer=P;$.makeSaxParser=$.makeSaxParser=D;$.makeTagPolicy=$.makeTagPolicy=X;$.normalizeRCData=$.normalizeRCData=z;$.sanitize=$.sanitize=Z;$.sanitizeAttribs=$.sanitizeAttribs=W;$.sanitizeWithPolicy=$.sanitizeWithPolicy=Y;$.unescapeEntities=$.unescapeEntities=o;return $}(x);d=c.sanitize;typeof window!=="undefined"&&(window.html=c,window.html_sanitize=d);e.exports=c}),null);
__d("OzTaskComposers.react",["cx","CajaHTMLSanitizer","CIWebmailValidator","ContentState","DraftEditor.react","EditorState","FileInput.react","immutable","OzActions","OzAPI","OzDateTimePicker.react","OzDraggableModal.react","OzHelpers","OzImmutablePureRenderMixin","OzNotify","OzPlaceField.react","React","Reflux","XUICloseButton.react","XUIError.react","promiseDone","promiseFinally"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i,j=b("CIWebmailValidator").isValidEmail,k=b("immutable").Map,l=b("immutable").List;a=b("immutable").Record;c=b("React").PropTypes;d={intentId:null,id:null,type:null,errors:k(),disabled:!1,sending:!1};var m=["to"],n=["from"],o=["cc"],p=["bcc"],q=["body",0,"body","contents"],r=b("immutable").fromJS([{"content-type":"text/plain; charset=UTF-8",body:{contents:""}}]);f=b("immutable").fromJS({to:"",cc:"",bcc:"",from:"",subject:"",body:r});var s=a(babelHelpers["extends"]({},d,{email:f,uploadSem:0}));g=b("Reflux").createStore({init:function(){this._offlineId=0,this.data=k(),this.listenToMany(b("OzActions").emailComposer)},getInitialState:function(){return this.data},onUpdate:function(a){this._u(function(b){return b.set(a.get("id"),a)})},onDelete:function(a){this._u(function(b){return b["delete"](a)})},onAdd:function(){var a=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],b=new s(a).update("id",function(a){return a||this._offlineId++}.bind(this)).updateIn(["email","from"],function(b){return a.from||(l.isList(b)?b.first():b)}).update("email",G);this._u(function(a){return a.set(b.get("id"),b)})},_u:function(a){this.data=a(this.data),this.trigger(this.data)}});var t=b("React").createClass({displayName:"EmailContainer",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{emailState:c.instanceOf(s).isRequired},render:function(){var a=this.props.emailState;return b("React").createElement(u,{email:a.get("email"),errors:a.get("errors"),disabled:a.get("disabled"),sending:a.get("sending"),onClose:this._handleClose,onChange:this._handleChange,onSend:this._handleSend,onUpload:this._handleUpload,onAttOpen:this._handleAttOpen})},_handleClose:function(){b("OzActions").emailComposer["delete"](this.props.emailState.get("id"))},_handleChange:function(a){b("OzActions").emailComposer.update(this.props.emailState.set("email",a))},_handleSend:function(){__p&&__p();var a=this.props.emailState,c=a.get("email"),d=[[c.getIn(m),"Please specify a destination email address"],[c.get("subject"),"Please write a subject"],[c.getIn(q),"Please write a message"],[a.get("uploadSem")===0,"Your attachments are still uploading"]].find(function(a){var b=a[0];a[1];return!b});if(d){b("OzNotify").error(d[1]);return}var e=H(c).set("intent-id",a.get("intentId"));d=k({to:m,cc:o,bcc:p}).map(function(a){return E(e.getIn(a))}).filter(function(a){return a});if(!d.isEmpty()){b("OzActions").emailComposer.update(a.set("errors",d));return}b("OzActions").emailComposer.update(a.set("sending",!0));b("OzAPI").sendEmail(e,a.get("intentId")).then(function(c){b("OzActions").emailComposer["delete"](a.get("id"))})["catch"](function(c){b("OzActions").emailComposer.update(a.set("sending",!1))})},_handleAttOpen:function(a){a=a.getIn(["body","everstore-handle"]);b("promiseDone")(b("OzAPI").everstoreURI(a),function(a){return window.open(a)})},_handleUpload:function(a){__p&&__p();var c=function(a){return b("OzActions").emailComposer.update(this.props.emailState.update("uploadSem",function(b){return b+a}))}.bind(this);c(1);var d=b("OzAPI").everstoreUpload(k({blob:a})).then(function(b){return F(b,a)}).then(function(a){b("OzActions").emailComposer.update(this.props.emailState.updateIn(["email","body"],function(b){return b.push(a)}))}.bind(this));b("promiseFinally")(d,function(a){return c(-1)})}});f=babelHelpers.inherits(u,b("React").Component);h=f&&f.prototype;function u(a){"use strict";h.constructor.call(this,a);var c=function(c){return b("EditorState").createWithContent(b("ContentState").createFromText(a.email.getIn(c)||""))};this.state={showCC:!1,showBCC:!1,inputEditorStates:{from:c(n),to:c(m),cc:c(o),bcc:c(p),subject:c(["subject"])}}}u.prototype.componentDidMount=function(){"use strict";var a=["to","subject"].find(function(a){a=this.state.inputEditorStates[a];return a&&!a.getCurrentContent().getPlainText().length}.bind(this));a=this.refs[a||"body"];a&&a.focus()};u.prototype.render=function(){"use strict";__p&&__p();var a=this.props,c=a.email,d=a.errors,e=a.onClose,f=a.onUpload,g=a.onAttOpen,h=a.onChange,i=a.onSend,j=a.disabled,k=a.sending;a=this.state.showCC||j&&c.getIn(o);var l=this.state.showBCC||j&&c.getIn(p),n=function(a,e,f){return b("React").createElement(w,{error:d.get(e),editorState:this.state.inputEditorStates[e],disabled:j||k,placeholder:a,ref:e,onChange:function(a){var b;this.setState({inputEditorStates:babelHelpers["extends"]({},this.state.inputEditorStates,(b={},b[e]=a,b))});b=a.getCurrentContent().getPlainText();h(c.setIn(f,b))}.bind(this)})}.bind(this),q=B(c,"text/plain");q==-1&&(q=0);var r=["body",q,"body","contents"];return b("React").createElement(b("OzDraggableModal.react"),{className:"_4h1d",getHandle:function(a){return this.refs.header}.bind(this)},b("React").createElement("div",null,b("React").createElement("div",{className:"_4h1e",ref:"header"},b("React").createElement(b("XUICloseButton.react"),{onClick:e})),b("React").createElement(w,{editorState:this.state.inputEditorStates.from,disabled:!0,onChange:function(a){return null}}),b("React").createElement("div",{className:"_1jg2"},n("To","to",m),!a&&!(j||k)?b("React").createElement("button",{tabIndex:"-1",className:"_1jg3",onClick:function(a){return this.setState({showCC:!0})}.bind(this)},"CC"):null,!l&&!(j||k)?b("React").createElement("button",{tabIndex:"-1",className:"_1jg3",onClick:function(a){return this.setState({showBCC:!0})}.bind(this)},"BCC"):null),a?n("Cc","cc",o):null,l?n("Bcc","bcc",p):null,n("Subject","subject",["subject"]),j?b("React").createElement(v,{email:c}):b("React").createElement("textarea",{disabled:j||k,placeholder:"Write your masterpiece",ref:"body",className:"_1-i0 _4h1j",value:c.getIn(r),onChange:function(a){return h(c.setIn(r,a.target.value))}}),b("React").createElement(y,{email:c,onChange:h,onAttOpen:g}),j?null:b("React").createElement("div",{className:"_5l1v"},b("React").createElement("button",{onClick:i,disabled:k,className:"_1-hv _30yy _n8p"},k?"Sending...":"Send"),b("React").createElement(b("FileInput.react"),{ref:"fileInput",onChange:function(a){f(a.target.files[0]),this.refs.fileInput.getFileInput().clear()}.bind(this)},b("React").createElement("a",{title:"add images",className:"_5l1w _30yy"})))))};u.propTypes={onClose:c.func.isRequired,onSend:c.func,disabled:c.bool,sending:c.bool,email:c.instanceOf(k).isRequired,errors:c.instanceOf(k),onChange:c.func.isRequired,onUpload:c.func.isRequired,onAttOpen:c.func.isRequired};var v=b("OzHelpers").pure(function(a){a=a.email;a=A(a,"text/html","text/plain");var c=a.getIn(["body","contents"]);return b("React").createElement("div",{className:"_3x40"},D(a)?b("React").createElement("div",{style:{whiteSpace:"pre-wrap"}},c):b("React").createElement(x,{html:c}))}),w=b("React").createClass({displayName:"EmailInput",propTypes:{disabled:c.bool,editorState:c.instanceOf(b("EditorState")).isRequired,error:c.string,onChange:c.func,placeholder:c.string},defaultProps:{disabled:!1,error:null,onChange:function(){},placeholder:null},focus:function(){this.refs.editor.focus()},render:function(){return b("React").createElement(b("XUIError.react"),{xuiError:this.props.error,xuiErrorPosition:"left"},b("React").createElement("div",{className:"_1-i0 _4h1i",onClick:this.focus,role:"presentation"},b("React").createElement(b("DraftEditor.react"),{editorState:this.props.editorState,ref:"editor",onChange:this.props.onChange,placeholder:this.props.placeholder,readOnly:this.props.disabled})))}}),x=b("OzHelpers").pure(function(a){var c=a.html;a=babelHelpers.objectWithoutProperties(a,["html"]);return b("React").createElement("div",babelHelpers["extends"]({},a,{dangerouslySetInnerHTML:{__html:b("CajaHTMLSanitizer").sanitize(c,function(a){return a})}}))}),y=b("OzHelpers").pure(function(a){var c=a.email,d=a.onAttOpen,e=a.onChange;a=c.get("body").map(function(a,f){return C(a)?null:b("React").createElement(z,{key:f,part:a,onClick:function(b){return d(a)},onRemove:function(a){return e(c.update("body",function(a){return a["delete"](f)}))}})}).filter(function(a){return!!a});return a.isEmpty()?null:b("React").createElement("div",{className:"_5l1-"},a)}),z=b("OzHelpers").pure(function(a){var c=a.part,d=a.onClick;a=a.onRemove;return b("React").createElement("div",{className:"_5l26"},b("React").createElement("button",{className:"_1-hv",onClick:d},c.getIn(["body","filename"])),b("React").createElement(b("XUICloseButton.react"),{onClick:a}))});function A(a){for(var b=arguments.length,c=Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];var e=c.map(function(b){return B(a,b)}).find(function(a){return a>-1});return Number.isSafeInteger(e)?a.getIn(["body",e]):r.first()}function B(a,b){return a.get("body").findIndex(function(a){return a.get("content-type").indexOf(b)>-1})}function C(a){a=a.get("content-type");return a&&a.indexOf("text/plain")>-1||a.indexOf("text/html")>-1}function D(a){return a.get("content-type").indexOf("text/plain")>-1}function E(a){a=l(a);a=a.filterNot(j);return a.isEmpty()?null:"Invalid email address(es): "+a.join(", ")+"."}function F(a,c){return b("immutable").fromJS({"content-type":c.type,body:{"everstore-handle":a,filename:c.name}})}function G(a){return a.updateIn(m,I).updateIn(o,I).updateIn(p,I)}function H(a){return a.updateIn(m,J).updateIn(o,J).updateIn(p,J)}function I(a){return a&&a.join(", ")}function J(a){return a?a.split(/[, ]/).filter(function(a){return a.length}):[]}var K=b("immutable").fromJS({title:"",description:"",start:null,startTimezone:"",end:null,endTimezone:"",location:"",to:""}),L=a(babelHelpers["extends"]({},d,{invite:K}));f=b("Reflux").createStore({init:function(){this._offlineId=0,this.data=k(),this.listenToMany(b("OzActions").inviteComposer)},getInitialState:function(){return this.data},onUpdate:function(a){this._u(function(b){return b.set(a.get("id"),a)})},onDelete:function(a){this._u(function(b){return b["delete"](a)})},onAdd:function(){var a=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],b=new L(a).update("id",function(a){return a||this._offlineId++}.bind(this)).updateIn(["invite","to"],I);this._u(function(a){return a.set(b.get("id"),b)})},onCreate:function(a,b,c){var d=new L({intentId:a,invite:O(b,c),id:this._offlineId++});this._u(function(a){return a.set(d.get("id"),d)})},_u:function(a){this.data=a(this.data),this.trigger(this.data)}});var M=b("React").createClass({displayName:"InviteContainer",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{inviteState:c.instanceOf(L).isRequired},render:function(){var a=this.props.inviteState;return b("React").createElement(N,{disabled:a.get("disabled"),sending:a.get("sending"),initialTimezone:a.get("timezone"),invite:a.get("invite"),errors:a.get("errors"),onChange:this._handleChange,onClose:this._handleClose,onSend:this._handleSend})},_handleChange:function(a){b("OzActions").inviteComposer.update(this.props.inviteState.set("invite",a))},_handleClose:function(){b("OzActions").inviteComposer["delete"](this.props.inviteState.get("id"))},_handleSend:function(){__p&&__p();var a=this.props.inviteState,c=a.get("invite"),d=c.get("selectedPlace"),e=[[c.get("to")||d,"Please click on a location in the dropdown or enter an email address"],[c.get("title"),"Please choose a title"],[c.get("start"),"Please select a start time"],[c.get("end"),"Please select an end time"],[c.get("end")>=c.get("start"),"Event must start before it ends"]].find(function(a){var b=a[0];a[1];return!b});if(e){b("OzNotify").error(e[1]);return}var f=d?c["delete"]("selectedPlace").set("intent-id",a.get("intentId"))["delete"]("to")["delete"]("description").set("place-id",d.get("id")):c["delete"]("selectedPlace").set("intent-id",a.get("intentId")).update("to",J);e=k({to:"to"}).map(function(a){return E(f.get(a))}).filter(function(a){return a});if(!e.isEmpty()){b("OzActions").inviteComposer.update(a.set("errors",e));return}b("OzActions").inviteComposer.update(a.set("sending",!0));b("OzAPI").sendInvite(f,a.get("intentId")).then(function(c){b("OzActions").inviteComposer["delete"](a.get("id"))})["catch"](function(c){b("OzActions").inviteComposer.update(a.set("sending",!1))})}});i=babelHelpers.inherits(N,b("React").Component);i&&i.prototype;N.prototype.componentDidMount=function(){"use strict";var a=["title","description","location","to"].map(function(a){return this.refs[a]}.bind(this)).find(function(a){return a&&!a.value});a&&a.focus()};N.prototype.render=function(){"use strict";__p&&__p();var a=this.props,c=a.disabled,d=a.sending,e=a.invite,f=a.errors,g=a.onClose,h=a.onChange;a=a.onSend;var i=function(a,g){return b("React").createElement(b("XUIError.react"),{xuiError:f.get(g),xuiErrorPosition:"left"},b("React").createElement("input",{type:"text",className:"_1-i0 _4h1i",disabled:c||d,placeholder:a,ref:g,value:e.get(g),onChange:function(a){return h(e.set(g,a.target.value))}}))},j=function(a,f){return b("React").createElement("div",null,a+":",b("React").createElement(b("OzDateTimePicker.react"),babelHelpers["extends"]({className:"_pto",layout:"two-line",timestamp:e.get(f)||b("OzHelpers").serverNow(),timezone:e.get(f+"Timezone"),disabled:c||d,onChange:function(a){var b=a.timestamp;a=a.timezone;return h(e.set(f,+b).set(f+"Timezone",a))}},b("OzHelpers").dateRestraints())))},k=function(a,g,i){return b("React").createElement(b("OzPlaceField.react"),{className:"_1-i0 _n8q",disabled:c||d,onQueryStringChange:function(a){h(e["delete"](i).set(g,a))},onSelect:function(a){h(e.set(i,a).set(g,a.get("name")))},placeholder:a,queryString:e.get(g),selectedEntry:e.get(i),xuiError:f.get(g)||f.get(i)})},l=!!e.get("selectedPlace")||!!e.get("place-id");return b("React").createElement(b("OzDraggableModal.react"),{className:"_ptp"},b("React").createElement("div",{className:"_ptq"},"Calendar Invite",b("React").createElement(b("XUICloseButton.react"),{onClick:g})),i("Title","title"),l||i("Description","description"),k("Location...","location","selectedPlace"),l||i("Email to...","to"),j("Start Time","start"),j("End Time","end"),c?null:b("React").createElement("div",{className:"_5l1v"},b("React").createElement("button",{onClick:a,disabled:d,className:"_1-hv _30yy _n8p"},d?"Sending...":l?"Send Bubble":"Send Email")))};function N(){"use strict";i.apply(this,arguments)}N.propTypes={invite:c.instanceOf(k).isRequired,errors:c.instanceOf(k),onClose:c.func.isRequired,onChange:c.func.isRequired,onSend:c.func.isRequired,disabled:c.bool,sending:c.bool};function O(){var a=arguments.length<=0||arguments[0]===undefined?"":arguments[0],c=arguments.length<=1||arguments[1]===undefined?"":arguments[1];return K.set("start",b("OzHelpers").serverNow()).set("startTimezone",c).set("end",b("OzHelpers").serverNow()).set("endTimezone",c).set("to",a)}a=b("React").createClass({displayName:"OzTaskComposers",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(g,"emails"),b("Reflux").connect(f,"invites")],propTypes:{intent:c.instanceOf(k).isRequired},render:function(){var a=function(a){return a.get("intentId")==this.props.intent.get("id")}.bind(this),c=this.state.emails.filter(a);a=this.state.invites.filter(a);return b("React").createElement("span",null,c.map(function(a){return b("React").createElement(t,{key:a.get("id"),emailState:a})}).valueSeq(),a.map(function(a){return b("React").createElement(M,{key:a.get("id"),inviteState:a})}).valueSeq())}});e.exports=a}),null);
__d("OzTaskActionEditor.react",["cx","OzHelpers","immutable","InputLabel_DEPRECATED.react","InputLabelLabel_DEPRECATED.react","MessengerButtonReact.bs","OzImmutablePureRenderMixin","React","XUIError.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MessengerButtonReact.bs").jsComponent,i=b("immutable").Map;a=b("React").PropTypes;var j=b("immutable").fromJS({traffic:{label:"Include traffic update",params:[{name:"origin",placeholder:"Origin address",err:"What is the origin address?"},{name:"destination",placeholder:"Destination address",err:"What is the destination address?"}]},weather:{label:"Include weather forecast",params:[{name:"location",placeholder:"City",err:"What city is the forecast for?"},{name:"metric",placeholder:"Celsius or Fahrenheit",err:"You need to set Celsius or Fahrenheit"}]}}),k=b("OzHelpers").pure(function(a){var c=a.action,d=a.errors,e=a.onToggle,f=a.onUpdate,g=a.actions;a=!!g.get(c);return b("React").createElement("div",null,b("React").createElement(b("InputLabel_DEPRECATED.react"),null,b("React").createElement("input",{type:"checkbox",checked:a,onChange:function(a){return e(a,c)}}),b("React").createElement(b("InputLabelLabel_DEPRECATED.react"),null,j.getIn([c,"label"]))),a&&b("React").createElement("div",null,j.getIn([c,"params"]).map(function(a){var e=a.get("name"),h=[c,e],i=g.getIn(h);return b("React").createElement(b("XUIError.react"),{key:c+"-"+e,xuiError:d.getIn([c,e])},b("React").createElement("input",{type:a.get("type","text"),className:"_wbw",placeholder:a.get("placeholder"),value:i,onChange:function(a){return f(a,h)}}))}).valueSeq()))});c=b("React").createClass({displayName:"OzTaskActionEditor",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{task:a.instanceOf(i).isRequired,onSelectAction:a.func.isRequired},getInitialState:function(){return{errors:i(),actions:this.props.task.getIn(["data","actions"],i())}},render:function(){return b("React").createElement("div",{className:"_3zsp"},j.keySeq().map(function(a){return b("React").createElement(k,{key:a,action:a,actions:this.state.actions,errors:this.state.errors,onToggle:this._handleActionToggle,onUpdate:this._handleActionUpdate})}.bind(this)).valueSeq(),b("React").createElement(h,{onClick:this._handleSaveActions,label:"Set Actions",type:"primary"}))},_handleActionToggle:function(a,b){a=a.target.checked?i([[b,i()]]):i();this.setState({actions:a})},_handleActionUpdate:function(a,b){this.setState({actions:this.state.actions.setIn(b,a.target.value)})},_handleSaveActions:function(){var a=this.props.onSelectAction,b=this.state.actions,c=this._findErrors();c.count()?this.setState({errors:c}):a(b)},_findErrors:function(){var a=this.state.actions,b=function(b){return!!a.get(b)};return j.reduce(function(c,d,e){b(e)&&(c=d.get("params").reduce(function(b,c){return a.getIn([e,c.get("name")])?b:b.setIn([e,c.get("name")],c.get("err"))},c));return c},i())}});e.exports=c}),null);
__d("OzTaskShow.react",["cx","debounce","getActiveElement","OzHelpers","immutable","InputLabel.react","Keys","LayerHideOnBlur","MessengerButtonReact.bs","OzNotify","OzActions","OzConfirmDialog.react","OzDate.react","OzDateTimePicker.react","OzTaskActionEditor.react","OzImmutablePureRenderMixin","React","ShimButton.react","XUIContextualDialog.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MessengerButtonReact.bs").jsComponent,i=b("immutable").Map,j=b("immutable").List,k=b("immutable").Set;a=b("React").PropTypes;var l=1e3;c=b("React").createClass({displayName:"OzTaskShow",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{location:a.instanceOf(i).isRequired,onCancel:a.func.isRequired,onComplete:a.func.isRequired,onOpen:a.func.isRequired,onSave:a.func.isRequired,task:a.instanceOf(i).isRequired},render:function(){var a=this.props,c=a.task,d=a.location,e=a.onCancel,f=a.onComplete;a=a.onOpen;return b("React").createElement("div",{className:"_1h7p"},b("React").createElement("div",{className:"_1h7q"}),b("React").createElement(m,{task:c,onChangeDescription:this._handleChangeDescription}),b("React").createElement(t,{task:c,onChangeNotes:this._handleChangeNotes}),b("React").createElement(o,{task:c,location:d,onSelectDeadline:this._handleSelectDeadline}),b("React").createElement(p,{task:c,onChangeDuration:this._handleChangeDuration}),b("React").createElement(s,{task:c,onChangeActions:this._handleChangeActions}),b("React").createElement(r,{task:c,onChangeRecur:this._handleChangeRecur}),b("React").createElement(n,{task:c,onCancelTask:e,onOpenTask:a,onCompleteTask:f}))},_handleChangeDescription:function(a){var b=this.props,c=b.onSave;b=b.task;c(b.setIn(["data","description"],a))},_handleSelectDeadline:function(a){var b=this.props,c=b.onSave;b=b.task;var d=a-b.get("deadline");c(b.set("deadline",a).update("start-at",function(a){return a+d}))},_handleChangeDuration:function(a){var c=this.props,d=c.onSave;c=c.task;a<0?b("OzNotify").warn("Duration must be greater than 0"):d(c.set("start-at",c.get("deadline")-a*6e4))},_handleChangeRecur:function(a){var b=this.props,c=b.onSave,d=b.task;b=b.location;c(d.set("schedule",i({"start-at":d.get("start-at"),frequency:"weekly",timezone:b.get("timezone"),"timezone-offset":b.get("timezone-offset"),"repeat-condition":i({spacing:1,days:a.toList()})})))},_handleChangeActions:function(a){var b=this.props,c=b.onSave;b=b.task;c(b.setIn(["data","actions"],a))},_handleChangeNotes:function(a){var b=this.props,c=b.onSave;b=b.task;c(b.setIn(["data","notes"],a))}});var m=b("React").createClass({displayName:"OzTaskShowDescription",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{onChangeDescription:a.func.isRequired,task:a.instanceOf(i).isRequired},componentDidMount:function(){this.props.task.getIn(["data","description"])||this.setState({editing:!0})},getInitialState:function(){return{editing:!1}},render:function(){var a=this.props.task,c=(a.get("state")==="completed"?"[Closed] ":"")+(a.getIn(["data","description"],"").length?a.getIn(["data","description"]):"untitled task");return b("React").createElement("div",{className:"_1h7v _p44"},this.state.editing?b("React").createElement("textarea",{className:"_1h7r _1h7s",placeholder:"untitled task",defaultValue:a.getIn(["data","description"]),onBlur:function(a){return this.setState({editing:!1})}.bind(this),onKeyDown:this._handleKeydown,ref:function(a){a&&(a.focus(),b("OzHelpers").moveCursorToInputEnd(a))}}):b("React").createElement(b("ShimButton.react"),{className:"_1h7r",inline:!0,onClick:function(a){return this.setState({editing:!0})}.bind(this)},c))},_handleKeydown:function(a){var c=this.props.onChangeDescription;switch(a.which){case b("Keys").RETURN:case b("Keys").TAB:c(a.target.value);case b("Keys").ESC:this.setState({editing:!1})}}}),n=b("React").createClass({displayName:"OzTaskShowStateSelector",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{onCancelTask:a.func.isRequired,onCompleteTask:a.func.isRequired,onOpenTask:a.func.isRequired,task:a.instanceOf(i).isRequired},_maybeConfirmCancel:function(){var a=this.props,c=a.task,d=a.onCancelTask;c.has("schedule")?b("OzActions").showDialog(b("OzConfirmDialog.react"),{onConfirm:function(a){return d(c,!0)},onCancel:function(a){return d(c,!1)},body:"This is a recurring task. Do you want to delete just this instance or all future occurrences also?",header:"Delete Recurring Task",confirmLabel:"Delete Future Tasks",cancelLabel:"Only This One"}):d(c,!1)},render:function(){var a=this.props;a.onCancelTask;var c=a.onCompleteTask,d=a.onOpenTask,e=a.task;return b("React").createElement("div",{className:"_1h7t"},b("React").createElement(b("ShimButton.react"),{className:"_47xm",onClick:this._maybeConfirmCancel},"Delete"),e.get("state")==="completed"?b("React").createElement(b("ShimButton.react"),{className:"_47yc",onClick:function(a){return d(e)}},"Reopen task"):b("React").createElement(b("ShimButton.react"),{className:"_47yd",onClick:function(a){return c(e)}},"Mark complete"))}}),o=b("React").createClass({displayName:"OzTaskShowDeadlineSelector",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{onSelectDeadline:a.func.isRequired,location:a.instanceOf(i).isRequired,task:a.instanceOf(i).isRequired},getInitialState:function(){return{editing:!1}},render:function(){var a=this.props,c=a.task;a=a.location;return b("React").createElement("div",{className:"_1h7v"},b("React").createElement("div",{className:"_1h7w"},"Due"),b("React").createElement("div",{className:"_1h7y"},this.state.editing?b("React").createElement("div",{className:"_1h7z"},b("React").createElement(b("OzDateTimePicker.react"),{className:"_1xh-",layout:"three-line",showTimezoneName:!1,timestamp:this.state.timestamp||Date.now(),timezone:this.state.timezone||a.get("timezone"),onChange:function(a){return this.setState(a)}.bind(this)}),b("React").createElement("div",{className:"_1xh_"},b("React").createElement(b("ShimButton.react"),{className:"_1h7-",onClick:this._handleSelectDeadline},"\u2713"),b("React").createElement(b("ShimButton.react"),{className:"_1h7_",onClick:this._handleCancel},"\u2715"))):b("React").createElement(b("ShimButton.react"),{className:"_1h80",onClick:this._handleStartEditing},b("React").createElement(b("OzDate.react"),{timestamp:c.get("deadline")}))))},_handleSelectDeadline:function(){this.props.onSelectDeadline(this.state.timestamp),this.setState({editing:!1})},_handleStartEditing:function(){this.setState({editing:!0,timestamp:this.props.task.get("deadline")})},_handleCancel:function(){this.setState({editing:!1})}}),p=b("React").createClass({displayName:"OzTaskShowDuration",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{onChangeDuration:a.func.isRequired,task:a.instanceOf(i).isRequired},getInitialState:function(){return{editing:!1}},render:function(){return b("React").createElement("div",{className:"_1h7v"},b("React").createElement("div",{className:"_1h7w"},"Duration (min)"),b("React").createElement("div",{className:"_1h7y"},this.state.editing?b("React").createElement("textarea",{className:"_1h81 _1h7s",defaultValue:this._getDuration(),onBlur:function(a){return this.setState({editing:!1})}.bind(this),onKeyDown:this._handleKeydown,ref:function(a){a&&(a.focus(),b("OzHelpers").moveCursorToInputEnd(a))}}):b("React").createElement(b("ShimButton.react"),{className:"_1h81",inline:!0,onClick:function(a){return this.setState({editing:!0})}.bind(this)},this._getDuration())))},_getDuration:function(){var a=this.props.task;return Math.round((a.get("deadline")-a.get("start-at"))/6e4)},_handleKeydown:function(a){var c=this.props.onChangeDuration;a.which===b("Keys").RETURN&&(c(a.target.value),this.setState({editing:!1}))}}),q=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],r=b("React").createClass({displayName:"OzTaskShowRecurSelector",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{onChangeRecur:a.func.isRequired,task:a.instanceOf(i).isRequired},getInitialState:function(){return{editing:!1,daysSet:k()}},UNSAFE_componentWillMount:function(){var a=this.props.task;this.setState({daysSet:k(a.getIn(["schedule","repeat-condition","days"]))})},render:function(){__p&&__p();var a=this.props.task,c=this.state,d=c.editing,e=c.daysSet;c=a.getIn(["schedule","repeat-condition","days"],j()).map(function(a){return q[a-1]}).join(", ");return b("React").createElement("div",{className:"_1h7v"},b("React").createElement("div",{className:"_1h7w"},"Recurrence"),b("React").createElement("div",{className:"_1h7y"},b("React").createElement("span",{onClick:function(a){return this.setState({editing:!0})}.bind(this),ref:"setSpan",role:"button",tabIndex:"0"},c.length?c:"Set Recurrence..."),b("React").createElement(b("XUIContextualDialog.react"),{position:"above",contextRef:function(a){return this.refs.setSpan}.bind(this),className:"_3zsp",shown:d,onToggle:function(a){return this.setState({editing:a})}.bind(this),behaviors:{LayerHideOnBlur:b("LayerHideOnBlur")}},b("React").createElement("div",{className:"_3zsp"},q.map(function(a,c){var d=c+1;return b("React").createElement(b("InputLabel.react"),{key:c,label:a},b("React").createElement("input",{type:"checkbox",checked:e.has(d),onChange:function(a){a=a.target.checked?e.add(d):e["delete"](d);this.setState({daysSet:a})}.bind(this)}))}.bind(this)),b("React").createElement(h,{onClick:this._handleChangeRecur,label:"Set Recurrence",type:"primary"})))))},_handleChangeRecur:function(){this.props.onChangeRecur(this.state.daysSet),this.setState({editing:!1})}}),s=b("React").createClass({displayName:"OzTaskShowActionSelector",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{onChangeActions:a.func.isRequired,task:a.instanceOf(i).isRequired},getInitialState:function(){return{editing:!1}},render:function(){var a=this.props.task,c=this.state.editing,d=a.getIn(["data","actions"],i()).keySeq().join(", ");return b("React").createElement("div",{className:"_1h7v"},b("React").createElement("div",{className:"_1h7w"},"Actions"),b("React").createElement("div",{className:"_1h7y"},b("React").createElement("span",{onClick:function(a){return this.setState({editing:!0})}.bind(this),ref:"setSpan",role:"button",tabIndex:"0"},d.length?d:"Set Actions..."),b("React").createElement(b("XUIContextualDialog.react"),{position:"above",contextRef:function(a){return this.refs.setSpan}.bind(this),className:"_3zsp",shown:c,onToggle:function(a){return this.setState({editing:a})}.bind(this),behaviors:{LayerHideOnBlur:b("LayerHideOnBlur")}},b("React").createElement(b("OzTaskActionEditor.react"),{task:a,onSelectAction:this._handleSelectAction}))))},_handleSelectAction:function(a){this.props.onChangeActions(a),this.setState({editing:!1})}}),t=b("React").createClass({displayName:"OzTaskShowNotes",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{onChangeNotes:a.func.isRequired,task:a.instanceOf(i).isRequired},getInitialState:function(){return{editedText:this.props.task.getIn(["data","notes"],"")}},UNSAFE_componentWillReceiveProps:function(a){a=a.task.get(["data","notes"]);var c=b("getActiveElement")()===this.refs.textarea;a!==this.props.task.get(["data","notes"])&&!c&&this.setState({editedText:a})},UNSAFE_componentWillMount:function(){this._save=b("debounce")(this._save,l,this,!0)},render:function(){return b("React").createElement("div",{className:"_1h7v"},b("React").createElement("textarea",{className:"_1h83 _1h7s",placeholder:"Add a note...",ref:"textarea",value:this.state.editedText,onChange:this._handleChange}))},_handleChange:function(){var a=this.refs.textarea.value;this.setState({editedText:a},this._save)},_save:function(){this.props.onChangeNotes(this.state.editedText)}});e.exports=c}),null);
__d("OzCalendarEvent.react",["cx","Image.react","LineClamp.react","React","Tooltip","formatDate","joinClasses"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").PropTypes;d="_2erb";var i=6e4;f=babelHelpers.inherits(a,b("React").Component);h=f&&f.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={mouseDown:!1},this.$2=function(){this.setState({mouseDown:!0})}.bind(this),this.$3=function(){this.setState({mouseDown:!1})}.bind(this),this.$5=function(){return!this.props.animation?null:b("React").createElement("div",{className:"_2ere",style:this.$1(this.props.shade,this.props.tentative)})}.bind(this),c}a.prototype.$1=function(a,b){"use strict";return{backgroundColor:"rgb(1, 136, 245)",backgroundImage:"repeating-linear-gradient(-45deg,rgba(70, 130, 200, 0.8),rgba(70, 130, 200, 0.8) 10px,rgba(70, 130, 200, 0.5) 10px,rgba(70, 130, 200, 0.5) 20px)"}};a.prototype.$4=function(){"use strict";var a=this.props;return function(b){this.state.mouseDown&&(this.props.onInitiateDrag&&this.props.draggable&&this.props.onInitiateDrag(a,b),this.setState({mouseDown:!1}))}.bind(this)};a.prototype.render=function(){"use strict";__p&&__p();var a=Math.floor((this.props.height-12)/14)-1,c=Math.max(0,this.props.endTime-this.props.startTime);c=Math.round(c/i);var d=c<15;c=c===15;c="_2erb"+(this.props.selected?" _2erf":"")+(this.props.tentative?" _2erg":"")+(c?" _2erh":"")+(d?" _2erk":"");var e=[];if(this.props.icons)for(var f=0;f<this.props.icons.length;f++){var g=this.props.icons[f],h=g[0];g=g[1];h=b("React").createElement(b("Image.react"),{className:"_2erl",src:h,key:f,"aria-label":g,"data-hover":"tooltip","data-tooltip-content":g});e.push(h)}g=b("React").createElement("div",null,e);h=null;f=null;if(this.props.showTime){e=null;var j=null;!this.props.isAllDayEvent?(e=b("formatDate")(new Date(this.props.startTime),"g:ia"),j="-"+b("formatDate")(new Date(this.props.endTime),"g:ia")):e="All day";f=e+(j||"");h=b("React").createElement("span",{className:"_2erm"},e)}j=(f||"")+"\n"+String(this.props.title)+"\n"+String(this.props.location);e=null;a>0&&(e=b("React").createElement(b("LineClamp.react"),{disableNative:!0,lineHeight:14,className:"_2ero",lines:a},this.props.subTitle));f=this.props.draggable?{onMouseDown:this.$2,onMouseUp:this.$3,onMouseMove:this.$4()}:{};a=this.props.hasOutline?"_2ers":"";return b("React").createElement("div",babelHelpers["extends"]({},this.props,f,{className:b("joinClasses")("_2ert",a),title:"",onClick:this.props.onEventClicked}),this.$5(),b("React").createElement("div",{className:b("joinClasses")(this.props.className,c),style:this.$1(this.props.shade,this.props.tentative)},g,b("React").createElement("div",{className:"_2eru"},b("React").createElement("span",babelHelpers["extends"]({className:"_2erv"+(d?" _2erw":"")},b("Tooltip").propsFor(this.props.hasTooltip?j:null)),h,this.props.title),e)))};a.propTypes={className:c.string,startTime:c.number.isRequired,endTime:c.number.isRequired,title:c.oneOfType([c.string,c.object]),location:c.string,shade:c.string.isRequired,icons:c.array,hasOutline:c.bool,hasTooltip:c.bool,height:c.number.isRequired,selected:c.bool.isRequired,tentative:c.bool,onEventClicked:c.func.isRequired,onInitiateDrag:c.func,draggable:c.bool,subTitle:c.oneOfType([c.string,c.object]),isAllDayEvent:c.bool,showTime:c.bool};a.defaultProps={showTime:!0,draggable:!1};a.EVENT_CLASS_NAME=d;e.exports=a}),null);
__d("OzCalendarUtils",["DateConsts","immutable"],(function(a,b,c,d,e,f){__p&&__p();var g=b("DateConsts").MIN_PER_HOUR*b("DateConsts").SEC_PER_MIN*b("DateConsts").MS_PER_SEC,h=b("DateConsts").HOUR_PER_DAY*g,i=7;function a(a,b){return l(a).toDateString()===l(b).toDateString()}function j(a,b){a=new Date(a);a.setDate(a.getDate()+b);return a.getTime()}function c(a,b){a=new Date(a);b=new Date(b);a=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate());b=Date.UTC(b.getFullYear(),b.getMonth(),b.getDate());return Math.floor((b-a)/h)}function k(a){__p&&__p();var b=arguments.length<=1||arguments[1]===undefined?1:arguments[1];b===null&&(b=1);var c=new Date(a);c.setHours(0);c.setMinutes(0);c.setSeconds(0);c.setMilliseconds(0);var d=c.getDay()-b;d<0&&(d+=7);return j(c.getTime(),-d)}function d(a){var b=arguments.length<=1||arguments[1]===undefined?1:arguments[1];return new Date(k(a.getTime(),b))}function f(a,b){return k(a.getTime())===k(b.getTime())}function l(a){a=new Date(a);a=new Date(a.getFullYear(),a.getMonth(),a.getDate());return a}function m(a,b){a=new Date(a);a.setDate(a.getDate()+b);return a}function n(a,b){var c=arguments.length<=2||arguments[2]===undefined?1:arguments[2],d=[],e=0,f=new Date(k(a,c));do{var g=m(f,e),h=m(f,e+7);d.push(g);e+=7}while(h.getTime()<b);return d}function o(a,b){var c=[],d=0;if(a>b)return c;do{var e=m(a,d),f=m(a,d+1);c.push(e);d+=1}while(f.getTime()<=b);return c}function p(event){return s.datesFrameToDays(s.timestampToDateOnly(event.props.startTime),s.timestampToDateOnly(event.props.endTime))}function q(event,a,b){var c=l(event.props.startTime),d=l(event.props.endTime);a=l(a);b=j(l(b).getTime(),1);return s.datesFrameToDays(new Date(Math.max(c,a)),new Date(Math.min(d,b)))}function r(c,d,e){__p&&__p();var f=b("immutable").Map(),a=b("immutable").Map();c.concat().sort(function(a,b){return a.props.startTime-b.props.startTime}).forEach(function(event){__p&&__p();var c=b("immutable").List(q(event,d,e)),g=0;while(!0){var h=c.every(function(a){return!f.get(a,b("immutable").Set()).has(g)});if(h){a=a.set(event.key,g);f=c.reduce(function(a,c){return a.update(c,b("immutable").Set(),function(a){return a.add(g)})},f);break}g++}});return a}var s={MS_IN_HOUR:g,DAY_IN_WEEK:i,datesEqual:a,compareWeeks:f,datesFrameToDays:o,timeFrameToWeeks:n,getWeekStartDate:d,addDaysToTimestamp:j,getDayDifference:c,getWeekStartTimestamp:k,timestampToDateOnly:l,getShiftedDate:m,slotsByEventKey:r,daysOfEvent:p,daysOfEventInRange:q};e.exports=s}),null);
__d("OzFlexBox.react",["cx","invariant","DOM","React","joinClasses"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i,j;i=babelHelpers.inherits(k,b("React").Component);i&&i.prototype;k.prototype.render=function(){"use strict";var a="_4o6j"+(this.props.direction&&k.VERTICAL?" _4o6k":"")+(this.props.direction&&k.REVERSE?" _4o6l":"");return b("React").createElement("div",babelHelpers["extends"]({},this.props,{className:b("joinClasses")(this.props.className,a)}),b("React").Children.map(this.props.children,l,this))};function k(){"use strict";i.apply(this,arguments)}k.VERTICAL=1;k.REVERSE=2;function l(a){if(!a)return null;var c=this.props.direction&&k.VERTICAL,d=a.props,e=d.boxFlex,f=d.boxSize,g=d.boxMinSize;d=d.boxMaxSize;e&&f&&h(0);e={WebkitBoxFlex:e,WebkitFlex:e,MozFlex:e,flex:e,width:c?null:f,height:c?f:null,minWidth:c?null:g,minHeight:c?g:null,maxWidth:c?null:d,maxHeight:c?d:null};return b("React").createElement("div",{style:e,className:"_4o6m"},a)}function a(){__p&&__p();if(j!==undefined)return j;var a=b("DOM").create("div");a.style.display="-webkit-flex";if(a.style.display==="-webkit-flex")return j=!1;a.style.display="-moz-flex";if(a.style.display==="-moz-flex")return j=!1;a.style.display="flex";return a.style.display==="flex"?j=!1:j=!0}k.isLolzyFlex=a;e.exports=k}),null);
__d("OzCalendarMonthly.react",["cx","OzFlexBox.react","DateConsts","DateStrings","OzCalendarUtils","Link.react","React","ReactDOM","ResizeListener","ScrollableArea.react","getElementPosition","joinClasses"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={selectedEventKey:null,currentTime:new Date(),dayHeight:null},this.$1=null,this.$2=27,this.$3=20,this.$4=22,this.$5=null,this.getCalendarContentPosition=function(){var a=b("ReactDOM").findDOMNode(this.refs.scrollable);return a?b("getElementPosition")(a):null}.bind(this),this.$6=function(){var a=b("getElementPosition")(b("ReactDOM").findDOMNode(this.refs.testCell));return a.height}.bind(this),this.$7=function(){var a=this.$8();this.props.onFrameChange&&this.props.onFrameChange(a.start,a.end);if(this.props.scrollToCurrentTime){a=this.refs.scrollable.getArea();a&&a.setScrollTop(this.state.dayHeight*(this.getCurrentDateRow()-1)+1,!1)}}.bind(this),this.$10=function(a){if(this.props.onDateClick){var b=this.props.onDateClick;return function(){return b(a)}}else return null}.bind(this),this.$9=function(a){this.props.onShowMore&&this.props.onShowMore(a)}.bind(this),c}a.prototype.componentDidMount=function(){"use strict";this.$1=setInterval(function(){return this.setState({currentTime:new Date()})}.bind(this),60*1e3),this.setState({dayHeight:this.$6()}),setTimeout(function(){return this.$7()}.bind(this),0),this.$5=b("ResizeListener").add(function(){return this.setState({dayHeight:this.$6()})}.bind(this))};a.prototype.componentWillUnmount=function(){"use strict";this.$1&&clearInterval(this.$1),this.$5&&this.$5.remove()};a.prototype.componentDidUpdate=function(a,b){"use strict";a&&a.date!==this.props.date&&this.$7()};a.prototype.$8=function(){"use strict";var a=this.getCalendarStartDate(),c=b("OzCalendarUtils").getShiftedDate(a,b("DateConsts").DAYS_PER_WEEK*6-1);return{start:a.getTime(),end:c.getTime()}};a.prototype.render=function(){"use strict";var a=this.groupEvents(),c=[],d=[];for(var e=0;e<b("DateConsts").DAYS_PER_WEEK;e++)c.push(this.renderCol(e,a)),d.push(this.renderDayHeader(e));a=b("React").createElement(b("ScrollableArea.react"),{className:"_2bgx",ref:"scrollable",shadow:!1},b("React").createElement(b("OzFlexBox.react"),{className:"_2bgy"},c));e=b("joinClasses")(this.props.className,"_2bgz _2bg-");c={};this.props.calendarHeight&&(c={height:this.props.calendarHeight+"px"});return b("React").createElement("div",{style:c,className:e},b("React").createElement(b("OzFlexBox.react"),{className:"_2bgy"},d),a)};a.prototype.groupEvents=function(){"use strict";__p&&__p();var a=[],c=b("React").Children.toArray(this.props.children).sort(function(a,b){return a.props.startTime-b.props.startTime}),d=b("OzCalendarUtils").slotsByEventKey(c,this.getCalendarStartDate(),this.getCalendarEndDate());c.forEach(function(event){var c=b("OzCalendarUtils").daysOfEventInRange(event,this.getCalendarStartDate(),this.getCalendarEndDate());c.forEach(function(b){var c=d.get(event.key);a[b]||(a[b]=[]);a[b][c]=this.cloneOfEventForDay(event,b,c)}.bind(this))}.bind(this));return a};a.prototype.cloneOfEventForDay=function(event,a,c){"use strict";var d=!b("OzCalendarUtils").datesEqual(event.props.startTime,event.props.endTime),e=b("OzCalendarUtils").datesEqual(a,event.props.startTime)||b("OzCalendarUtils").datesEqual(a,this.getCalendarStartDate());a=b("OzCalendarUtils").datesEqual(a,event.props.endTime)||b("OzCalendarUtils").datesEqual(a,this.getCalendarEndDate());return b("React").cloneElement(event,{className:(!e&&!a?"_2bg_":"")+(d&&e?" _2bh2":"")+(d&&a?" _2bh3":""),key:event.key,height:24,onEventClicked:function(){return this.setState({selectedEventKey:event.key})}.bind(this),selected:this.state.selectedEventKey===event.key,style:{top:c*this.$4+this.$2+"px"}})};a.prototype.getCalendarStartDate=function(){"use strict";var a=new Date(this.props.date.getFullYear(),this.props.date.getMonth(),1);a.setDate(a.getDate()-a.getDay());return a};a.prototype.getCalendarEndDate=function(){"use strict";var a=new Date(this.props.date.getFullYear(),this.props.date.getMonth(),1);a.setDate(a.getDate()+42);return a};a.prototype.getCurrentDateRow=function(){"use strict";var a=b("OzCalendarUtils").getDayDifference(this.getCalendarStartDate().getTime(),this.state.currentTime.getTime());a=Math.floor(a/7);return a>5?0:a};a.prototype.renderGridLines=function(a,c,d){"use strict";__p&&__p();var e=0,f=5,g=[];for(var h=0;h<=f;h++){e=h*b("DateConsts").DAYS_PER_WEEK+a;var i=b("OzCalendarUtils").getShiftedDate(this.getCalendarStartDate(),e),j=this.props.highlightedDay;j=(d&&h===0?"_2bh4":"")+(!d&&h===0?" _2bh5":"")+(a===0&&h===f?" _2bh6":"")+(d&&h===f?" _2bh7":"")+(d&&h!==f?" _2bh8":"")+(!d&&h===f?" _2bh9":"")+(a===0?" _2bha":"")+" _2bhb"+(i.toDateString()===this.state.currentTime.toDateString()?" _2bhe":"")+(j&&i.toDateString()===j.toDateString()?" _2bhf":"");var k=null;if(this.state.dayHeight){var l=Math.floor((this.state.dayHeight-this.$2-this.$3)/this.$4)+1;c[i]&&c[i].length>l&&(function(a){k=b("React").createElement(b("Link.react"),{onClick:function(){return this.$9(a)}.bind(this),className:"_2bhg"},"Show more ("+(c[i].length-l)+")")}.bind(this)(i),c[i]=c[i].slice(0,l))}else c[i]=[];g.push(b("React").createElement("div",{key:h,ref:a===0&&h===0?"testCell":null,style:{height:"16.666%"},onDoubleClick:this.$10(i),className:j},b("React").createElement("div",{className:"_2bhh"+(i.getMonth()!==this.props.date.getMonth()?" _2bhi":"")},i.getMonth()!==this.props.date.getMonth()&&i.getDate()===1?b("DateStrings").getMonthNameShort(i.getMonth()+1).toString()+" ":null,i.getDate()),b("React").createElement("div",{className:"_2bhj"},c[i],k)))}return b("React").createElement("div",null,g)};a.prototype.renderDayHeader=function(a){"use strict";var c=b("React").createElement("div",{className:"_2bhk"},b("DateStrings").getWeekdayName(a)),d=a===6;return b("React").createElement("div",{className:"_2bhx",boxFlex:1,key:a},b("React").createElement("div",{className:"_2bhy"+(d?" _2bhz":"")+(a===0?" _2bh-":"")},c))};a.prototype.renderCol=function(a,c){"use strict";var d=a===6;return b("React").createElement("div",{className:"_2bhx",boxFlex:1,key:a},this.renderGridLines(a,c,d))};a.propTypes={date:c.instanceOf(Date).isRequired,calendarHeight:c.number,onShowMore:c.func,scrollToCurrentTime:c.bool,onDateClick:c.func,highlightedDay:c.instanceOf(Date)};a.defaultProps={dayStartHour:9,dayEndHour:17,daysPerWeek:5,date:new Date(),weekStartDay:1,enableCurrentTimeMarker:!0,calendarHeight:700};e.exports=a}),null);
__d("OzCalendarType",[],(function(a,b,c,d,e,f){e.exports={MONTH:1,WEEK:2,DAY:3}}),null);
__d("OzCalendarPager.react",["cx","fbt","ix","OzCalendarUtils","Image.react","OzCalendarType","React","XUIButton.react","XUIButtonGroup.react"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();var j;c=b("React").PropTypes;j=babelHelpers.inherits(a,b("React").Component);j&&j.prototype;a.prototype.onWeekNavigate=function(a){"use strict";this.props.onDateChange&&this.props.onDateChange(new Date(a))};a.prototype.$1=function(a){"use strict";var c=this.props.date.getTime();c=b("OzCalendarUtils").addDaysToTimestamp(c,a);return c};a.prototype.$2=function(a){"use strict";var c=b("OzCalendarUtils").getWeekStartTimestamp(this.props.date.getTime());c=b("OzCalendarUtils").addDaysToTimestamp(c,a*b("OzCalendarUtils").DAY_IN_WEEK);return c};a.prototype.$3=function(a){"use strict";return new Date(this.props.date.getFullYear(),this.props.date.getMonth()+a*1,1).getTime()};a.prototype.$4=function(a){"use strict";return new Date(this.props.date.getFullYear()+a*1,this.props.date.getMonth(),1).getTime()};a.prototype.$5=function(a){"use strict";__p&&__p();var c;switch(this.props.mode){case b("OzCalendarType").MONTH:c=this.$3(a);break;case b("OzCalendarType").WEEK:c=this.$2(a);break;case b("OzCalendarType").DAY:c=this.$1(a);break}this.onWeekNavigate(c)};a.prototype.$6=function(a){"use strict";a=this.props.mode===b("OzCalendarType").MONTH?this.$4(a):this.$3(a);this.onWeekNavigate(a)};a.prototype.render=function(){"use strict";var a=this.props,c=a.buttonSize,d=a.disabled;a=a.hasFastSwitch;return b("React").createElement(b("XUIButtonGroup.react"),{className:"_3-95"},a?b("React").createElement(b("XUIButton.react"),{disabled:d,image:b("React").createElement(b("Image.react"),{src:i("101337")}),label:h._("First Page"),labelIsHidden:!0,role:"button",size:c,style:{opacity:.63},onClick:function(){return this.$6(-1)}.bind(this)}):null,b("React").createElement(b("XUIButton.react"),{disabled:d,image:b("React").createElement(b("Image.react"),{src:i("101339")}),label:h._("\u10ec\u10d8\u10dc\u10d0"),labelIsHidden:!0,role:"button",size:c,onClick:function(){return this.$5(-1)}.bind(this)}),b("React").createElement(b("XUIButton.react"),{label:"Today",disabled:d,size:c,onClick:function(){return this.onWeekNavigate(Date.now())}.bind(this)}),b("React").createElement(b("XUIButton.react"),{disabled:d,image:b("React").createElement(b("Image.react"),{src:i("101341")}),label:h._("\u10e8\u10d4\u10db\u10d3\u10d4\u10d2\u10d8"),labelIsHidden:!0,role:"button",size:c,onClick:function(){return this.$5(1)}.bind(this)}),a?b("React").createElement(b("XUIButton.react"),{disabled:d,image:b("React").createElement(b("Image.react"),{src:i("101338")}),label:h._("Last Page"),labelIsHidden:!0,role:"button",size:c,style:{opacity:.63},onClick:function(){return this.$6(1)}.bind(this)}):null)};function a(){"use strict";j.apply(this,arguments)}a.propTypes={date:c.instanceOf(Date).isRequired,onDateChange:c.func,buttonSize:c.string,mode:c.oneOf([b("OzCalendarType").MONTH,b("OzCalendarType").WEEK,b("OzCalendarType").DAY]),hasFastSwitch:c.bool,disabled:c.bool};a.defaultProps={mode:b("OzCalendarType").WEEK};e.exports=a}),null);
__d("OzPagedMonthlyCalendar.react",["cx","DateStrings","OzCalendarMonthly.react","OzCalendarPager.react","OzCalendarType","LoadingIndicator.react","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={date:new Date(this.props.date)},this.$2=function(){return!this.props.isLoading?null:b("React").createElement("div",{className:"_1ifd"},b("React").createElement(b("LoadingIndicator.react"),{size:"large",color:"white"}))}.bind(this),this.$3=function(){return b("React").createElement("div",{className:"_1ife"},b("React").createElement(b("OzCalendarMonthly.react"),{date:this.state.date,className:"_1iff",onDateClick:this.props.onDateClick,onShowMore:this.props.onShowMore,highlightedDay:this.props.highlightedDay},this.props.events))}.bind(this),this.$4=function(a){this.setState({date:a},function(){this.props.onDateChange(a)}.bind(this))}.bind(this),c}a.prototype.render=function(){"use strict";return b("React").createElement("div",{className:"_1if8"},this.$1(),this.$2(),this.$3())};a.prototype.$1=function(){"use strict";return b("React").createElement("div",{className:"_1if9"},b("React").createElement("div",{className:"_1ifa"},this.props.events.length+" events"),b("React").createElement("div",{className:"_1ifb"},b("React").createElement(b("OzCalendarPager.react"),{date:this.state.date,mode:b("OzCalendarType").MONTH,onDateChange:this.$4,hasFastSwitch:!0})),b("React").createElement("div",{className:"_1ifc"},b("React").createElement("strong",null,b("DateStrings").getMonthName(this.state.date.getMonth()+1)),"  ",this.state.date.getFullYear()))};a.propTypes={date:c.instanceOf(Date).isRequired,events:c.array.isRequired,isLoading:c.bool,onDateClick:c.func,onDateChange:c.func.isRequired,onShowMore:c.func.isRequired,highlightedDay:c.instanceOf(Date)};e.exports=a}),null);
__d("OzCalendarModal.react",["cx","OzConfig","OzImmutablePureRenderMixin","immutable","React","Reflux","OzDraggableModal.react","XUICloseButton.react","OzPagedMonthlyCalendar.react","OzCalendarEvent.react","XUIDialog.react","XUIDialogBody.react","XUIDialogTitle.react","formatDate"],(function(a,b,c,d,e,f,g){__p&&__p();var h;a=b("React").PropTypes;var i=b("immutable").Map;c=b("React").createClass({displayName:"OzCalendarModal",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{events:a.array.isRequired,onClose:a.func.isRequired},getInitialState:function(){return{moreDialogShown:!1,moreDialogDate:new Date()}},render:function(){var a=this.state.config.get("GK",i());a=a.get("calendar");var c=this.props,d=c.events;c=c.onClose;return b("React").createElement(b("OzDraggableModal.react"),{className:"_33-2",getHandle:function(a){return this.refs.header}.bind(this)},b("React").createElement("div",{className:"_33-3",ref:"header"},a?"Calendar":"Calendar - Busy/Free Access only",b("React").createElement(b("XUICloseButton.react"),{onClick:c})),b("React").createElement(b("OzPagedMonthlyCalendar.react"),{isLoading:!1,events:j(d,a),date:new Date(),onDateChange:function(a){},onShowMore:this._calendarShowMore}),this._renderShowMoreDialog(a))},_renderShowMoreDialog:function(a){return this.state.moreDialogShown?b("React").createElement(l,{events:k(this.props.events,this.state.moreDialogDate),date:this.state.moreDialogDate,onToggle:this._onShowMoreToggle,calendarBusy:a}):null},_calendarShowMore:function(a){this.setState({moreDialogShown:!0,moreDialogDate:a})}});var j=function(a,c){return a.map(function(a){return b("React").createElement(b("OzCalendarEvent.react"),{key:a.identifier,title:c?a.title:"Busy",location:c?a.location:"",startTime:new Date(a.startDate).getTime(),endTime:new Date(a.endDate).getTime(),shade:"DarkBlue",hasTooltip:c})})},k=function(a,b){var c=new Date(b);c.setTime(c.getTime()+864e5);return a.sort(function(a,b){return new Date(a.startDate).getTime()-new Date(b.startDate).getTime()}).filter(function(a){return new Date(a.startDate).getTime()>=new Date(b).getTime()||new Date(a.endDate).getTime()>=new Date(b).getTime()}).filter(function(a){return new Date(a.startDate).getTime()<c.getTime()})};d=babelHelpers.inherits(l,b("React").Component);h=d&&d.prototype;function l(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=function(a,c){var d=null,e=null;a=new Date(a);c=new Date(c);var f=a.getDate()==c.getDate()&&a.getMonth()==c.getMonth(),g=Math.floor((c-a)/(1e3*60*60))>13;!g||!f?(d=b("formatDate")(a,f?"g:ia":"D M j, g:ia"),g=b("formatDate")(c,f?"g:ia":"D M j, g:ia"),e=d+(f?" - ":"\n")+g):e="All day";return b("React").createElement("div",{className:"_33-c"},e)},c}l.prototype.render=function(){"use strict";var a=this.props.events.map(function(a){return b("React").createElement("div",{key:a.identifier,className:"_33-4"},this.$1(a.startDate,a.endDate),b("React").createElement("div",{className:"_33-b"},b("React").createElement("span",null,this.props.calendarBusy?a.title+"\n"+a.location:"Busy")))}.bind(this));return b("React").createElement(b("XUIDialog.react"),{shown:!0,width:500,onToggle:this.props.onToggle},b("React").createElement(b("XUIDialogTitle.react"),null,a.length+" events on "+this.props.date.toDateString()),b("React").createElement(b("XUIDialogBody.react"),null,a))};l.propTypes={events:a.array.isRequired,date:a.instanceOf(Date).isRequired,onToggle:a.func,calendarBusy:a.bool};e.exports=c}),null);
__d("OzThreadMeta.react",["cx","OzAPI","OzHelpers","immutable","Keys","MessengerButtonReact.bs","OzFormPreview.react","OzThreadLabels.react","OzStores","OzSwitch.react","OzImmutablePureRenderMixin","React","Reflux","Tooltip","OzCalendarModal.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MessengerButtonReact.bs").jsComponent,i=b("immutable").Map,j=b("OzFormPreview.react").Row,k=b("OzThreadLabels.react").OzUnderageLabel;a=b("React").PropTypes;c=b("OzStores").CalendarEventStore;d=b("React").createClass({displayName:"OzThreadMeta",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(c,"calendarEvents")],propTypes:{thread:a.object.isRequired,repNames:a.instanceOf(i).isRequired},getInitialState:function(){return{newMeta:null,muted:s(this.props.thread),calendarShown:!1}},UNSAFE_componentWillReceiveProps:function(a){b("OzHelpers").threadID(a.thread)!==b("OzHelpers").threadID(this.props.thread)?this.setState({newMeta:null,muted:s(a.thread),locked:a.thread.get("locked")}):this.setState({muted:s(a.thread),locked:a.thread.get("locked")})},render:function(){var a=b("OzHelpers").threadID(this.props.thread);a=this.state.calendarEvents.get(a,[]);var c=[["Cancel","secondary",this._handleCancel],["DONE","primary",this._handleDone]],d=["Edit","primary",this._handleEdit];d=a&&a.length?[["Calendar","primary",this._handleCalendar],d]:[d];c=this.state.newMeta?c:d;return b("React").createElement("div",{className:"_56t0"+(this.state.newMeta?" _56t1":"")},this.state.calendarShown&&b("React").createElement(b("OzCalendarModal.react"),{events:a,onClose:this._onCalendarClose}),b("React").createElement(l,{thread:this.props.thread,buttons:c}),this.state.newMeta?b("React").createElement(p,{meta:this.state.newMeta,onCancel:this._handleCancel,onChange:this._handleChange,onDone:this._handleDone,onMutedToggle:this._handleMutedToggle,isMuted:this.state.muted}):b("React").createElement(n,{meta:r(this.props.thread),onMutedToggle:this._handleMutedToggle,isMuted:this.state.muted}),b("React").createElement(o,{thread:this.props.thread,repNames:this.props.repNames,locked:!!this.state.locked,onToggle:this._handleThreadLockToggle}))},_handleEdit:function(){this.setState({newMeta:r(this.props.thread)})},_handleCancel:function(){this.setState({newMeta:null})},_handleDone:function(){b("OzAPI").saveMeta(b("OzHelpers").threadID(this.props.thread),this.state.newMeta),this.setState({newMeta:null})},_handleChange:function(a){this.setState({newMeta:a})},_handleMutedToggle:function(a){b("OzAPI").saveMuted(b("OzHelpers").threadID(this.props.thread),!a),this.setState({muted:!a})},_handleThreadLockToggle:function(a){a=this.props.thread;var c=b("OzHelpers").threadID(a);this.state.locked?(this.setState({locked:!1}),b("OzAPI").unlockThread(c,a.get("locked-at"))):(this.setState({locked:!0}),b("OzAPI").lockThread(c))},_handleCalendar:function(){var a=this.props.thread;a=b("OzHelpers").threadID(a);b("OzAPI").fetchCalendar(a);this.setState({calendarShown:!0})},_onCalendarClose:function(){this.setState({calendarShown:!1})}});var l=b("OzHelpers").pure(function(a){var c=a.thread;a=a.buttons;return b("React").createElement("div",{className:"_56t2"},b("React").createElement("div",{className:"_56t6"},b("React").createElement("h2",{className:"_56tb"},b("OzHelpers").getName(c)),b("React").createElement("div",{className:"_56tc"},a.map(function(a,c){c=a[0];var d=a[1];a=a[2];return b("React").createElement(h,{key:c,label:c,type:d,onClick:a})}))),b("React").createElement("div",{className:"_56td"},b("React").createElement(k,{thread:c})))}),m=b("OzHelpers").pure(function(c){var a=c.isMuted,d=c.onMutedToggle;c=function(b){d(a)};var e="Uncheck if person dislikes our proactive messages, e.g. surveys";e=b("React").createElement("span",b("Tooltip").propsFor(e),"Proactive?");return b("React").createElement(j,{label:e},b("React").createElement("input",{type:"checkbox",checked:!a,onChange:c}))}),n=b("OzHelpers").pure(function(d){var a=d.meta,c=d.isMuted;d=d.onMutedToggle;var e=(a.get("address1","")+" "+a.get("address2","")+"\n     "+a.get("city","")+" "+a.get("state","")+" "+a.get("zip","")+"\n    ").trim();return b("React").createElement(b("OzFormPreview.react"),null,b("React").createElement(j,{label:"Nickname"},a.get("preferred-name")),b("React").createElement(j,{label:"Email"},a.get("email")),b("React").createElement(j,{label:"Phone"},a.get("phone")),b("React").createElement(j,{label:"Address"},e),b("React").createElement(j,{label:"Device OS"},a.get("os-type")),b("React").createElement(j,{label:"App Version"},a.get("app-version")),b("React").createElement(m,{isMuted:c,onMutedToggle:d}))}),o=b("OzHelpers").pure(function(a){var c=a.thread,d=a.repNames,e=a.locked;a=a.onToggle;d=d.get(c.get("locker-id"));d=d?(c.get("locked")?"Locked":"Last locked")+" by "+d:"";d+=d&&c.get("locked-at")?" at "+new Date(c.get("locked-at")).toLocaleString():"";c=b("React").createElement("span",b("Tooltip").propsFor(d),e?"Click to unlock thread":"Click to lock thread");return b("React").createElement(b("OzSwitch.react"),{className:"_z1m",isAnimated:!0,reverseColors:!0,isOn:e,label:c,onToggle:a})}),p=b("React").createClass({displayName:"EditView",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{meta:a.instanceOf(i).isRequired,onCancel:a.func.isRequired,onChange:a.func.isRequired,onDone:a.func.isRequired,isMuted:a.bool.isRequired,onMutedToggle:a.func.isRequired},componentDidMount:function(){this.refs["preferred-name"].focus()},render:function(){var a=this._renderRow;return b("React").createElement("form",{className:"_56to",onKeyDown:this._handleKeyDown},b("React").createElement(q,null,a("Nickname","preferred-name","Add Preferred Name")),b("React").createElement(q,null,a("Email","email","Add email")),b("React").createElement(q,null,a("Phone","phone","Add phone")),b("React").createElement(q,null,a("Street","address1","Add Street"),a("Street","address2","Add Street"),a("City","city","Add City"),a("State","state"),a("Zip Code","zip")),b("React").createElement(q,null,b("React").createElement(m,{isMuted:this.props.isMuted,onMutedToggle:this.props.onMutedToggle})))},_handleKeyDown:function(a){a.which===b("Keys").ESC?this.props.onCancel():a.which===b("Keys").RETURN?this.props.onDone():null},_renderRow:function(c,d,e){var f=this.props,a=f.meta,g=f.onChange;return b("React").createElement(j,{label:c},b("React").createElement("input",{ref:d,type:"text",className:"_1-i0 _56uv",placeholder:e,value:a.get(d),onChange:function(b){return g(a.set(d,b.target.value))}}))}}),q=b("OzHelpers").pure(function(a){a=a.children;return b("React").createElement("div",{className:"_56vn"},a)});function r(a){return a.get("metadata-json")||i()}function s(a){return!!a.get("muted")}e.exports=d}),null);
__d("OzThreadNote.react",["cx","OzAPI","getActiveElement","OzHelpers","immutable","OzConfig","OzRequirementTokenizer.react","React","Reflux"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("immutable").Map;c=b("React").PropTypes;var h=1e3;d=b("React").createClass({displayName:"OzThreadNote",mixins:[b("Reflux").connect(b("OzConfig").ConfigStore,"config")],propTypes:{thread:c.instanceOf(a).isRequired,requirements:c.instanceOf(a).isRequired,timeline:c.bool},getDefaultProps:function(){return{timeline:!1}},getInitialState:function(){return{editedText:this.props.thread.get("notes")||""}},UNSAFE_componentWillReceiveProps:function(a){a=a.thread.get("notes");var c=b("getActiveElement")()===this.refs.textarea;a!==this.props.thread.get("notes")&&!c&&this.setState({editedText:a})},render:function(){var a=this.props,c=a.requirements,d=a.thread;a=a.timeline;return b("React").createElement("div",{className:"_1x92"},b("React").createElement("h2",{className:"_1x93"},"Thread Notes"),b("React").createElement("div",{className:"_41v4"},b("React").createElement(b("OzRequirementTokenizer.react"),{allRequirements:c,onDeleteRequirement:this._handleDeleteRequirement,onCreateRequirement:this._handleCreateRequirement,selectedRequirements:d.get("requirements"),placeholder:"Add a user tag...",timeline:a})),b("React").createElement("textarea",{ref:"textarea",className:"_1x95"+(this.props.timeline?" _11_w":""),placeholder:"Leave a note",value:this.state.editedText,onChange:this._handleChange}))},_handleChange:function(){var a=this.props.thread,c=this.refs.textarea.value;this.setState({editedText:c});window.clearTimeout(this.timeout);this.timeout=window.setTimeout(function(){b("OzAPI").saveNote(b("OzHelpers").threadID(a),c)},h)},_handleCreateRequirement:function(a){var c=this.props.thread;b("OzAPI").createThreadRequirement(b("OzHelpers").threadID(c),a.get("name"))},_handleDeleteRequirement:function(a){var c=this.props.thread;b("OzAPI").deleteThreadRequirement(b("OzHelpers").threadID(c),a.get("id"))}});e.exports=d}),null);
__d("OzTimeline.react",["csx","cx","OzAPI","OzHelpers","immutable","OzActions","OzDate.react","OzStores","ozFormatTime","OzImmutablePureRenderMixin","React","ReactRouter-2.0.0","Reflux"],(function(a,b,c,d,e,f,g,h){__p&&__p();a=b("immutable").Map;c=b("immutable").List;d=b("React").PropTypes;var i=b("ReactRouter-2.0.0").Link;f=b("OzStores").ActiveThreadStore;var j=a({"send-email":"sent email","receive-email":"received email","send-calendar":"sent invite","completed-call":"phone call"});g=b("React").createClass({displayName:"OzTimeline",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(f,"activeThread")],propTypes:{closedIntents:d.instanceOf(c).isRequired,events:d.instanceOf(c).isRequired,tasks:d.instanceOf(c).isRequired},contextTypes:{router:d.object.isRequired},componentDidMount:function(){this._scrollTimeline(),this._timeUpdateInterval=window.setInterval(function(a){return this.setState({time:b("OzHelpers").serverNow()})}.bind(this),6e4)},componentDidUpdate:function(){this._scrollTimeline()},_scrollTimeline:function(){var a=document.querySelector("._415b");a&&a.scrollIntoView(!0);a=document.querySelector("._2mg4");a&&a.scrollIntoView(!0)},componentWillUnmount:function(){window.clearInterval(this._timeUpdateInterval)},getInitialState:function(){return{time:b("OzHelpers").serverNow()}},render:function(){var a=this._sortedItems();return b("React").createElement("div",{className:"_201k"},b("React").createElement("div",{className:"_201l"},"Activity & tasks"),b("React").createElement("div",{className:"_4fj7 _201m",ref:"scrollable"},a.map(this._renderTimelineElement),b("React").createElement("div",{key:"OzTimelineSpacer",className:"_415b"})))},_sortedItems:function(){var a=this.props,b=a.events,c=a.tasks;a=a.closedIntents;return b.filter(function(a){return j.has(a.get("type"))}).map(function(a){return a.set("item-type","event")}).concat(c.map(function(a){return a.set("item-type","task")})).concat(a.map(function(a){return a.set("item-type","intent").set("intent-id",a.get("id"))})).sortBy(p)},_renderTimelineElement:function(a){var c=this.state,d=c.activeThread;c=c.time;var e=this.props.tasks,f=a.get("item-type")+"-"+a.get("id");switch(a.get("item-type")){case"event":return b("React").createElement(l,{key:f,event:a,onEmailView:this._handleEmailView,onEmailReply:this._handleEmailReply,onInviteView:this._handleInviteView,activeThread:d});case"task":return b("React").createElement(m,{key:f,task:a,activeThread:d,time:c});case"intent":return b("React").createElement(n,{key:f,intent:a,tasks:e,activeThread:d});default:b("OzHelpers").err("unknown item",a);return null}},_handleEmailView:function(a){b("OzActions").emailComposer.add(babelHelpers["extends"]({},b("OzHelpers").eventToEmail(a),{disabled:!0}))},_handleEmailReply:function(a){b("OzActions").emailComposer.add(b("OzHelpers").eventToEmail(b("OzHelpers").reEmail(a)))},_handleInviteView:function(a){b("OzActions").inviteComposer.add(b("OzHelpers").eventToInvite(a))},_handleCallPlay:function(a){return b("OzAPI").everstoreURI(a).then(function(a){return window.open(a)})}});var k=b("OzHelpers").pure(function(a){__p&&__p();var c=a.activeThread;a.contents;var d=a.item;a.onClick;var e=a.path,f=a.status;a=a.summary;var g=d.get("intent-id")===c.get("activeIntent");c=d.get("id")===c.get(d.get("item-type")==="task"?"activeTask":"activeEvent");f=f||"completed";return b("React").createElement(i,{to:e,className:"_8i9"+(g?" _8ia":"")+(g?"":" _8ib")+(c?" _2mg4":"")+(f==="pending"?" _4rsf":"")+(f==="completed"?" _4rsg":"")+(f==="close"?" _4rsj":"")+(f==="late"?" _4rsm":"")},b("React").createElement("div",{className:"_8id"}),b("React").createElement("div",{className:"_201o"}),b("React").createElement("div",{className:"_201p"},b("React").createElement("div",{className:"_201r"},d.get("intent-name")),b("React").createElement("div",{className:"_8ie"},a||"[Untitled]"),b("React").createElement("div",{className:"_2022"},f!=="completed"?"Due: ":null,b("React").createElement(b("OzDate.react"),{className:"_1qdh",timestamp:p(d)}))))},"OzTimelineItem"),l=b("OzHelpers").pure(function(a){__p&&__p();var c=a.activeThread,event=a.event;a.onCallPlay;a.onEmailReply;a.onEmailView;a.onInviteView;a=event.get("type");var d;switch(a){case"send-email":d="Email to "+event.getIn(["data","to"]).join(", ");break;case"receive-email":d="Email from "+event.getIn(["data","from"]);break;case"send-calendar":event.hasIn(["data","place-id"])?d="Invite bubble":d="Invite to "+event.getIn(["data","to"]).join(", ");break;case"completed-call":a=event.get("data");var e={"in":"Call from ",out:"Call to ",voicemail:"Voicemail from "}[a.get("direction")],f=b("OzHelpers").parsePhoneNumber(a.get("remote-phone"));a.get("RecordingDuration");a.get("recording-ev-handle");d=e+f;break;default:d="Another event"}return b("React").createElement(k,{activeThread:c,path:b("OzHelpers").threadPath({threadid:event.get("user-id"),intentid:event.get("intent-id"),eventid:event.get("id")}),item:event,summary:d})},"OzTimelineEvent"),m=b("OzHelpers").pure(function(a){var c=a.task,d=a.time;a=a.activeThread;var e=function(a){switch(a.get("type")){case"reminder":return a.getIn(["data","description"]);default:return a.get("type")}},f;b("OzHelpers").isCompletedTask(c)?f="completed":c.get("start-at")>d?f="pending":c.get("deadline")>d?f="close":f="late";d=b("React").createElement("div",null,c.getIn(["data","notes"]));return b("React").createElement(k,{activeThread:a,path:b("OzHelpers").threadPath({threadid:c.get("user-id"),intentid:c.get("intent-id"),taskid:c.get("id")}),item:c,status:f,summary:e(c),contents:d})},"OzTimelineTask"),n=b("OzHelpers").pure(function(a){var c=a.intent,d=a.activeThread;a=a.tasks;var e="Closed: "+c.get("alias",c.get("name"));a=b("OzHelpers").nextTaskForIntent(c,a);return b("React").createElement(k,{activeThread:d,path:b("OzHelpers").threadPath({threadid:c.get("user-id"),intentid:c.get("id"),taskid:a&&a.get("id")}),item:c,summary:e})}),o=a({event:"timestamp",task:"deadline",separator:"timestamp",intent:"closed-at"});function p(a){var b=o.get(a.get("item-type"));return a.get(b,a.get("created-at"))}e.exports=g}),null);
__d("OzThreadPanel.react",["cx","OzAPI","OzHelpers","immutable","OzConfig","OzHumans","OzEventShow.react","OzIntent.react","OzIntentActions.react","OzIntentList.react","OzIntentTabs.react","OzReminders.react","OzReminderTask.react","OzReminderTasks.react","OzStores","OzTabHeader.react","OzTaskComposers.react","OzTaskShow.react","OzThreadMeta.react","OzThreadNote.react","OzTimeline.react","OzImmutablePureRenderMixin","React","OzWrapper.react","Reflux","XUISelector.react"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("XUISelector.react").Option,i=b("immutable").Map,j=b("immutable").List,k=b("immutable").Set;b("React").PropTypes;a=b("OzStores").ActiveThreadStore;var l="NO_OWNER",m="TODO",n="HISTORY";c=b("React").createClass({displayName:"OzThreadPanel",mixins:[b("OzImmutablePureRenderMixin"),b("Reflux").connect(b("OzConfig").ConfigStore,"config"),b("Reflux").connect(a,"activeThread"),b("Reflux").listenTo(a,"onActiveIntentChange")],onActiveIntentChange:function(a){if(a.get("activeIntent")&&!a.get("activeTask")){a=this._activeTabForIntent();a&&this.setState({activeTab:a})}},UNSAFE_componentWillMount:function(){var a=this._activeTabForIntent();a&&this.setState({activeTab:a})},UNSAFE_componentWillReceiveProps:function(a){if(!this.state.activeTab){a=this._activeTabForIntent();a&&this.setState({activeTab:a})}},render:function(){__p&&__p();var a=this.props,c=a.thread;a=a.repNames;var d=this.state,e=d.activeTab,f=d.config;d=d.activeThread;var g=f.getIn(["GK","timeline"]);f=f.get("display-tasks")||g;var h=d.get("activeIntent"),l=d.get("activeTask"),p=d.get("activeEvent"),q=!(g||e!==n),r=b("OzHelpers").intents(c).find(function(a){return a.get("id")===h}),s=q?b("OzHelpers").closedIntents(c).filterNot(b("OzHelpers").isDeleted):r?k(b("OzHelpers").openIntents(c).push(r)).toList():b("OzHelpers").openIntents(c),t=r&&l?(r.get("tasks")||j()).find(function(a){return a.get("id")===l}):null,u=r&&p?(r.get("events")||j()).find(function(a){return a.get("id")===p}):null,v={isHistory:q,repNames:a,thread:c},w=i(s.map(function(a){return[a.get("id"),b("OzHelpers").intentAlias(a)]}).concat(r?[[h,b("OzHelpers").intentAlias(r)]]:[])),x=c.get("tasks",j()).filter(function(a){return r?a.get("intent-id")==r.get("id"):!0}).map(function(a){return a.set("intent-name",w.get(a.get("intent-id")))}),y=c.get("tasks",j()).filter(function(a){return a.get("state")!=="completed"}).map(function(a){return a.get("intent-id")}).toSet(),z=c.get("intents").filter(function(a){return b("OzHelpers").isClosedIntent(a)&&y.get(a.get("id"))}),A=r?r.get("events",i()).valueSeq().map(function(a){return a.set("intent-name",w.get(a.get("intent-id")))}).toList():s.reduce(function(a,b){return a.concat(b.get("events",i()).valueSeq())},j()).map(function(a){return a.set("intent-name",w.get(a.get("intent-id")))});return b("React").createElement("div",{className:"_5l_x"},r&&b("React").createElement(b("OzTaskComposers.react"),{intent:r}),g?b("React").createElement(b("OzIntentTabs.react"),{intents:b("OzHelpers").openIntents(c).concat(z),tasks:x,activeIntentId:h,threadId:c.get("user-id")}):null,b("React").createElement("div",{className:"_1c1k"+(g?" _5mt9":"")},b("React").createElement("div",{className:"_5l_y"},!g&&b("React").createElement(b("OzTabHeader.react"),{active:e,tabs:[["Todo",m],["History",n]],onChange:this._handleTabChange}),b("React").createElement("div",{className:"_5l_z"+(g?" _5mt9":"")},g?b("React").createElement(b("OzTimeline.react"),{events:A,tasks:x,closedIntents:h?j():b("OzHelpers").closedIntents(c)}):b("React").createElement("div",{className:"_4fj7"},b("React").createElement(b("OzIntentList.react"),{intents:s,activeIntentId:d.get("activeIntent"),witIntents:this.props.witIntents,isHistory:q,timelineGK:g}))),q||!g?b("React").createElement("div",{className:"_4sm5"},f?b("React").createElement(b("OzReminderTasks.react"),v):b("React").createElement(b("OzReminders.react"),v)):null),b("React").createElement("div",{className:"_5l_-"+(g?" _11_w":"")+(g?" _5mt9":"")},b("React").createElement("div",{className:"_5l__"},b("React").createElement("div",{className:"_4fj7"},r?b("React").createElement(b("OzIntent.react"),{intent:r,key:"intent-"+r.get("id"),location:c.get("location")||i(),repNames:a,requirements:this.props.requirements,timelineGK:g,thread:c}):null,g&&t?b("React").createElement(b("OzTaskShow.react"),{key:"task-"+t.get("id"),location:c.get("location")||i(),onCancel:this._handleCancelTask,onComplete:this._handleCompleteTask,onSave:this._handleSaveTask,onOpen:this._handleOpenTask,task:t}):u?b("React").createElement(b("OzEventShow.react"),{key:"event-"+u.get("id"),activeIntent:r,event:u}):null)),!g&&b("React").createElement("div",null,b("React").createElement(b("OzThreadNote.react"),{key:b("OzHelpers").threadID(c),thread:c,requirements:this.props.requirements}),b("React").createElement(b("OzThreadMeta.react"),{thread:c,repNames:a}),b("React").createElement(o,{onOwnerChange:this.props.onOwnerChange,humans:this.props.humans,reps:this.props.reps,thread:c})))),g&&b("React").createElement("div",{className:"_5mtb"},b("React").createElement("div",null,b("React").createElement(b("OzThreadMeta.react"),{thread:c,repNames:a}),b("React").createElement(o,{onOwnerChange:this.props.onOwnerChange,humans:this.props.humans,reps:this.props.reps,thread:c})),b("React").createElement(b("OzThreadNote.react"),{key:b("OzHelpers").threadID(c),thread:c,timeline:g,requirements:this.props.requirements})))},_activeTab:function(){return this.state.activeTab||m},_activeTabForIntent:function(){var a=this.state.activeThread.get("activeIntent"),c=this.props.thread.get("intents",j());c=a?c.find(function(b){return b.get("id")===a}):null;if(c)if(b("OzHelpers").isClosedIntent(c))return n;else return m},_handleTabChange:function(a){a[0];a=a[1];this.setState({activeTab:a})},_handleSaveTask:function(a){return b("OzAPI").editTask(b("OzHelpers").threadID(this.props.thread),a)},_handleCompleteTask:function(a){return b("OzAPI").completeTask(b("OzHelpers").threadID(this.props.thread),a)},_handleCancelTask:function(a){var c=arguments.length<=1||arguments[1]===undefined?!1:arguments[1];return b("OzAPI").cancelTask(b("OzHelpers").threadID(this.props.thread),a,c)},_handleOpenTask:function(a){return b("OzAPI").openTask(b("OzHelpers").threadID(this.props.thread),a)}});var o=b("OzHelpers").pure(function(a){var c=a.onOwnerChange,d=a.humans,e=a.reps;a=a.thread;a=a;var f=b("OzHelpers").nameOrId(a.get("last-owner")).split(" ")[0];return b("React").createElement("div",{className:"_5m00"},e&&!e.isEmpty()?b("React").createElement(p,{onChange:c,value:a.getIn(["owner","id"])||l,reps:e,humans:d}):null,b("React").createElement("span",{className:"_5m01"},f?"Last owner: "+f:null))}),p=b("OzHelpers").pure(function(a){__p&&__p();var c=a.reps,d=a.humans,e=a.value;a=a.onChange;var f=c.toSeq().filter(function(a){return b("OzHumans").isActive(d.get(a.get("fbid")))}).sortBy(function(a){return a.get("name")}).map(function(a){var c=a.get("fbid"),d=a.get("is-coach",!1)?"_5m02":"";return b("React").createElement(h,{key:c,value:c},b("React").createElement("span",{className:d},a.get("name")))}),g=f.get(e);f=f.valueSeq();if(!g){g=c.get(e,i());c=g.get("is-coach",!1)?"_5m02":"";f=f.toList().unshift(b("React").createElement(h,{key:"current",value:e},b("React").createElement("span",{className:c},g.get("name","None"))))}return b("React").createElement(b("XUISelector.react"),{size:"medium",value:e,onChange:a,maxheight:500},f)});e.exports=b("OzWrapper.react")(c)}),null);
__d("OzTop.react",["cx","OzAPI","OzHelpers","MessengerFlexScrollableArea.react","React","relativeTimeString.atlas","XUITextInput.react","SRTAdvancedDataTable.react","escapeRegex","ObjectSort","ReactRouter-2.0.0"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("ReactRouter-2.0.0").Link,j=[{id:"priority",label:"Priority",sortable:!0,comparator:function(a,c){return b("OzHelpers").compareBools(a.priority,c.priority)},cellRenderer:function(a){return b("React").createElement("span",{className:a?"_1nnl":""},a?"yes":"no")}},{id:"trainer",label:"Trainer",sortable:!0,comparator:b("ObjectSort").getStringSortFunction("trainer")},{id:"trainer-load",label:"Load",sortable:!0,comparator:b("ObjectSort").getReverseNumericSortFunction("trainer-load"),isNumeric:!0,cellRenderer:function(a){return b("React").createElement("div",{className:a>3?"_1nnl":""},a?a:"Not present")}},{id:"trainer-team",label:"Team",sortable:!0,comparator:b("ObjectSort").getStringSortFunction("trainer-team")},{id:"user-name",label:"User name",sortable:!0,comparator:b("ObjectSort").getStringSortFunction("user-name"),cellRenderer:function(a,c,d){return b("React").createElement(i,{target:"blank",to:b("OzHelpers").threadPath({threadid:d["user-id"]})},a)}},{id:"external",label:"External",sortable:!0,comparator:function(a,c){return b("OzHelpers").compareBools(a.external,c.external)},cellRenderer:function(a){return b("React").createElement("span",null,a?"external":"internal")}},{id:"vip",label:"Vip",sortable:!0,comparator:function(a,c){return b("OzHelpers").compareBools(a.vip,c.vip)},cellRenderer:function(a){return b("React").createElement("span",null,a?"yes":"no")}},{id:"name",label:"Type",sortable:!0,comparator:b("ObjectSort").getStringSortFunction("name"),cellRenderer:function(a,c,d){return b("React").createElement(i,{target:"blank",to:b("OzHelpers").threadPath({threadid:d["user-id"],intentid:d.id})},a)}},{id:"blocked",label:"Status",sortable:!0,comparator:function(a,c){return b("OzHelpers").compareBools(a.blocked,c.blocked)},cellRenderer:function(a){return b("React").createElement("span",null,a?"waiting":"open")}},{id:"created-at",label:"Open",sortable:!0,comparator:b("ObjectSort").getReverseNumericSortFunction("created-at"),isNumeric:!0,cellRenderer:function(a){return b("relativeTimeString.atlas")(a,!0)}},{id:"ir",label:"IR",sortable:!0,comparator:b("ObjectSort").getReverseNumericSortFunction("ir"),isNumeric:!0,cellRenderer:function(a,c,d){return b("React").createElement("div",null,a===0?"**":a)}},{id:"cr",label:"Current CR (s)",sortable:!0,comparator:b("ObjectSort").getReverseNumericSortFunction("cr"),isNumeric:!0,cellRenderer:function(a){return b("React").createElement("div",null,a===0?"**":a)}}];c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={items:[],filterText:""},this.$2=function(a){a=a.trim().replace(/ +/g," ").split(" ");var c=new RegExp(a.map(b("escapeRegex")).join(".* .*"),"i");return function(a){return c.test(a.name)||c.test(a["user-name"])||c.test(a["trainer-team"])||c.test(a.trainer)||c.test(a["user-id"])||c.test(a.id)}},this.$3=function(event){this.setState({filterText:event.target.value}),this.refs.theTable.setFilter(this.$2(event.target.value))}.bind(this),c}a.prototype.UNSAFE_componentWillMount=function(){var a=function(){return b("OzAPI").topIntents().then(function(a){return this.setState({items:a.toJS()})}.bind(this))}.bind(this);a();this.$1=setInterval(a,30*1e3)};a.prototype.componentWillUnmount=function(){clearInterval(this.$1)};a.prototype.render=function(){return b("React").createElement("div",null,b("React").createElement("div",null,b("React").createElement("label",null,"Filter:"," ",b("React").createElement(b("XUITextInput.react"),{onChange:this.$3,value:this.state.filterText})),b("React").createElement("span",null,this.state.items.length," open intents")),b("React").createElement(b("MessengerFlexScrollableArea.react"),null,b("React").createElement(b("SRTAdvancedDataTable.react"),{ref:"theTable",rowKeyField:"id",outerBorder:!0,columns:j,rows:this.state.items,enableSelection:!1})))};e.exports=a}),null);
__d("OzTrainerDashboard.react",["cx","OzHelpers","relativeTimeString.atlas","immutable","OzButton.react","OzHumans","OzStores","OzImmutablePureRenderMixin","React","Reflux","XUITable.react"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("immutable").Map;c=b("OzStores").HumanStore;d=b("React").PropTypes;f=b("React").createClass({displayName:"OzTrainerDashboard",mixins:[b("Reflux").connect(c,"humans")],contextTypes:{router:d.object.isRequired},render:function(){return b("React").createElement(h,{onThreadSelect:this._handleThreadSelect,humans:this.state.humans,reps:this.props.reps})},_handleThreadSelect:function(a){this.context.router.push("inbox/"+a)}});var h=b("React").createClass({displayName:"Main",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{onThreadSelect:d.func.isRequired,humans:d.instanceOf(a).isRequired,reps:d.instanceOf(a).isRequired},render:function(){return b("React").createElement("div",{className:"_10cd"},b("React").createElement(b("XUITable.react"),null,b("React").createElement("thead",null,b("React").createElement("tr",null,b("React").createElement("th",null,"Trainer"),b("React").createElement("th",null,"Load"),b("React").createElement("th",null,"Status"),b("React").createElement("th",null,"Team"),b("React").createElement("th",null,"Link to Thread"))),b("React").createElement("tbody",null,this._getHumans().map(function(a){return b("React").createElement(i,{key:a.get("id"),onSelect:this._handleThreadSelect,human:a,rep:this.props.reps.get(a.get("id"))})}.bind(this)))))},_getHumans:function(){var a=this.props,b=a.humans,c=a.reps;return b.sortBy(function(a){return c.getIn([a.get("id"),"name"])}).valueSeq()},_handleThreadSelect:function(a){this.props.onThreadSelect(a.get("tid"))}}),i=b("React").createClass({displayName:"DashboardRow",mixins:[b("OzImmutablePureRenderMixin")],propTypes:{onSelect:d.func.isRequired,human:d.instanceOf(a).isRequired,rep:d.instanceOf(a)},render:function(){var a=this.props,c=a.onSelect,d=a.human;a=a.rep;return b("React").createElement("tr",null,b("React").createElement("td",null,j(a,d)),b("React").createElement("td",null,d.get("load")),b("React").createElement("td",null,k(d)),b("React").createElement("td",null,d.get("team")),b("React").createElement("td",null,d.get("tid")?b("React").createElement(b("OzButton.react"),{onClick:function(){return c(d)}},"See Thread"):null))}});function j(a,c){a=a&&a.get("name")||"Unknown name";return""+a+(b("OzHumans").isCoach(c)?" (Coach)":"")}function k(a){var c=b("relativeTimeString.atlas")(+b("OzHelpers").serverNow()-a.get("inactive-ms",0),!0);c=b("OzHumans").isActive(a)?"Active":"Away ("+c+")";return b("OzHumans").inCoachMode(a)?c+" | In Coach Mode":c}e.exports=f}),null);
__d("OzMount",["invariant","immutable","Oz.react","OzActions","OzAll.react","OzAPI","OzConfig","OzFeedbackDashboard.react","OzHelpers","OzInbox.react","OzInboxShow.react","OzMerchants.react","OzPerformance","OzServerTime","OzStores","OzThreadPanel.react","OzTop.react","OzTrainerDashboard.react","OzTwilio","React","ReactDOM","ReactRouter-2.0.0","URI","promiseDone","promiseFinally"],(function(a,b,c,d,e,f,g){__p&&__p();b("OzTwilio");var h=b("ReactRouter-2.0.0").Route,i=b("ReactRouter-2.0.0").IndexRoute,j=b("ReactRouter-2.0.0").browserHistory;b("ReactRouter-2.0.0").match;var k=b("ReactRouter-2.0.0").Router,l=b("ReactRouter-2.0.0").Redirect,m=b("OzStores").CalendarEventStore;a={mount:function(a,c){__p&&__p();c=babelHelpers["extends"]({},c,r());b("OzPerformance").init();b("OzConfig").setConfig(b("immutable").fromJS(c));b("OzHelpers").info("[config]",c);var d=void 0,e=s(b("Oz.react"),{rev:c.rev,uid:c.uid,version:c.API_VERSION,skipToto:c.skipToto==="true",onUnmount:function(){d&&d()}}),f=function(a){var c=a.threadid,d=a.intentid,e=a.taskid;a=a.eventid;b("OzHelpers").info("[mount] storeParams",c,d,e,a);d=d?parseInt(d,10):null;b("OzActions").activateThread({threadID:c,intentID:d,taskID:e?parseInt(e,10):null,eventID:a?parseInt(a,10):null});c&&b("OzAPI").threadFocus(c,d);m.data.get(c)||b("OzAPI").fetchCalendar(c)},g=t(b("OzAPI").thread,500),o={},p=function(a,c,d){__p&&__p();b("OzHelpers").info("[mount] onThreadEnter",a);f(a.params);var e=a.params,h=e.threadid;e=e.intentid;h&&g(h);e?d():(b("OzHelpers").info("[mount] no intent id; computing"),h&&o[h]?(b("OzHelpers").info("[mount] loading intent from history",h,o[h]),c(b("OzHelpers").threadPath({threadid:h,intentid:o[h]})),d()):h?b("promiseDone")(b("promiseFinally")(g(h).then(function(a){b("OzHelpers").info("[mount] missing intent; looking for last created");a=b("OzHelpers").openIntents(a).maxBy(function(a){return a.get("created-at")});a?(b("OzHelpers").info("[mount] missing intent; using last created",h,a.get("id")),c(b("OzHelpers").threadPath({threadid:h,intentid:a.get("id")}))):b("OzHelpers").info("[mount] no intent to pick",h)}),function(a){return d()})):(b("OzHelpers").warn("[mount] somehow missing threadid",a),d()))},q=function(a){b("OzHelpers").info("[mount] onIntentEnter",a);f(a.params);a=a.params;var c=a.threadid;a=a.intentid;a=a?parseInt(a,10):null;c&&a&&(o[c]=a);a&&b("OzAPI").handledEvents(a);b("OzConfig").ConfigStore.data.getIn(["GK","timeline"])&&c&&a&&b("OzAPI").tasksForIntent(a,c)},u=function(a){b("OzHelpers").info("[mount] onThreadLeave",a),b("OzActions").activateThread({threadID:null,intentID:null,taskID:null})},v=b("React").createElement(h,{component:e},b("React").createElement(h,{path:"/",component:b("OzInbox.react")},b("React").createElement(h,{path:"/inbox/:threadid",component:b("OzInboxShow.react"),onEnter:p,onLeave:u},b("React").createElement(i,{onEnter:function(a){a=a.params;return f(a)},component:b("OzThreadPanel.react")}),b("React").createElement(h,{path:"intent/:intentid",component:b("OzThreadPanel.react"),onEnter:q}),b("React").createElement(h,{path:"intent/:intentid/task/:taskid",component:b("OzThreadPanel.react"),onEnter:q}),b("React").createElement(h,{path:"intent/:intentid/event/:eventid",component:b("OzThreadPanel.react"),onEnter:q}))),b("React").createElement(h,{path:"/all",component:b("OzAll.react")}),b("React").createElement(h,{path:"/merchants",component:b("OzMerchants.react")}),b("React").createElement(h,{path:"/top",component:b("OzTop.react")}),b("React").createElement(h,{path:"/feedback",component:b("OzFeedbackDashboard.react")}),b("React").createElement(h,{path:"/trainers",component:b("OzTrainerDashboard.react")}),b("React").createElement(l,{from:"/inbox",to:"/"}));e=function(){b("ReactDOM").render(b("React").createElement(k,{history:j,routes:v}),a)};e();n(function(){__p&&__p();var a=b("OzConfig").getStaticConfig("skipSky")==="true",e=b("OzConfig").getStaticConfig("skipAPIInit")==="true";b("OzHelpers").info("[sky] connecting to "+c.skyTopic);a&&b("OzActions").updateLoadingState({component:"skywalker",state:"loading",skip:!0});var f=function e(f){typeof d==="function"&&d(),d=b("OzAPI").realTime(c.skyTopic,function(d,g,h){if(d){b("OzHelpers").warn("[sky] could not connect: "+d);if(f>0)return e(f-1);else b("OzActions").updateLoadingState({component:"skywalker",state:"failed",error:d,skip:a})}else b("OzHelpers").info("[sky] connected to "+c.skyTopic+": "+g.t,g),b("OzAPI").repsSync(),b("OzActions").updateLoadingState({component:"skywalker",state:"loaded",result:{data:g,token:h},skip:a})})};f(3);f=function a(c,d,f){b("promiseDone")(f().then(function(a){b("OzActions").updateLoadingState({component:d,state:"loaded",result:a,skip:e})})["catch"](function(g){c>0?a(c-1,d,f):b("OzActions").updateLoadingState({component:d,state:"failed",error:g,skip:e})}))};f(3,"init",b("OzAPI").init);f(3,"wit-intents",b("OzAPI").witIntents);f(3,"merchants",b("OzAPI").merchants);f(3,"humans",b("OzAPI").humans);f(3,"requirements",b("OzAPI").requirements);b("OzServerTime").setup()})}};var n=function(a){window.loaded?a():(function(){var c=window.onload;typeof c==="function"?window.onload=function(){try{c.apply(undefined,arguments)}catch(a){b("OzHelpers").log("Exception on window,inload",a)}a.apply(undefined,arguments)}:window.onload=a})()},o=/^ozcfg(.+)/;function p(){var a=new(b("URI"))(window.location.href).getQueryData();Object.keys(a).forEach(function(b){o.test(b)&&localStorage.setItem(b,a[b])})}function q(){var a,b,c,d={};for(a=0;a<localStorage.length;a++)b=localStorage.key(a),c=b.match(o),c&&c.length&&(d[c[1]]=localStorage.getItem(b));return d}function r(){__p&&__p();p();var a=q(),b,c=document.location.hostname;if(c==="www.oz.wit.ai")b={skyTopic:"oz/all",env:"prod",scubaCategory:"oz_console",PAGE_ID:"881263441913087",API_PATH:"https://www.oz.wit.ai/api"};else if(c==="intern.oz.wit.ai"||!a.API_PATH)b={skyTopic:"oz-staging/all",env:"staging",scubaCategory:"oz_console_dev",PAGE_ID:"506060876211905",API_PATH:"https://intern.oz.wit.ai/api"};else{c=c.split(".")[1];b={skyTopic:"oz-dev/"+c,env:"dev",scubaCategory:"oz_console_dev",PAGE_ID:"1579802578966277"}}b=babelHelpers["extends"]({},b,a,{API_VERSION:"20151027"});b.API_PATH||g(0);return b}function s(a,c){__p&&__p();var d,e;return e=d=function(){__p&&__p();var d;d=babelHelpers.inherits(e,b("React").Component);d&&d.prototype;e.prototype.render=function(){"use strict";return b("React").createElement(a,babelHelpers["extends"]({},c,this.props))};function e(){"use strict";d.apply(this,arguments)}return e}(),d.displayName="Curried"+a.displayName,e}var t=function(a,c){__p&&__p();var d={},e={};return function(f){if(Date.now()-(d[f]||0)<=c&&e[f]){b("OzHelpers").info("[mount/throttle] using result",f,e[f]);return e[f]}else{d[f]=Date.now();b("OzHelpers").info("[mount/throttle] running!",f);return e[f]=a(f)}}};e.exports=a}),null);
__d("OzDev",["OzConfig","immutable","OzActions","OzHelpers","OzNotify","OzAPI","OzMount","OzStores","OzTwilio"],(function(a,b,c,d,e,f){__p&&__p();var g=b("immutable").Map;function a(a){b("OzConfig").updateConfig(b("immutable").fromJS(a))}function h(){for(var a=arguments.length,c=Array(a),d=0;d<a;d++)c[d]=arguments[d];b("OzConfig").updateConfig(g().setIn(c,!b("OzConfig").getInStaticConfig(c)))}function c(){var a=arguments.length<=0||arguments[0]===undefined?!0:arguments[0];b("OzConfig").updateConfig(g({devMode:a}))}document.addEventListener("keydown",function(a){a.which===84&&a.ctrlKey&&h("display-tasks");a.which===89&&a.ctrlKey&&h("GK","timeline");a.which===82&&a.ctrlKey&&!a.shiftKey&&h("GK","responsivenessV2");a.which===82&&a.ctrlKey&&a.shiftKey&&h("GK","responsivenessExecTime");if(a.which===79&&a.ctrlKey){h("GK","openTableAPI");a=b("OzConfig").getInStaticConfig(["GK","openTableAPI"]);b("OzNotify").info("openTableAPI set to "+a)}});function d(){var a=["selectAIPick"];a.map(function(a){b("OzActions")[a].listen(function(){for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b("OzHelpers").debug("[Action]",a,d)})})}d();e.exports={api:b("OzAPI"),actions:b("OzActions"),config:b("OzConfig"),devMode:c,updateConfig:a,toggleConfig:h,h:b("OzHelpers"),mount:b("OzMount"),stores:b("OzStores"),twilio:b("OzTwilio"),notify:b("OzNotify")}}),null);